---
title: Диалоговое окно "Расширенное редактирование" (условие) | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: security
ms.topic: conceptual
f1_keywords:
- sql12.swb.dmf.condition.advancededit.f1
ms.assetid: a0bbe501-78c5-45ad-9087-965d04855663
author: MikeRayMSFT
ms.author: mikeray
manager: craigg
ms.openlocfilehash: 5849baa119174cacc99d4ab99a68de28c2966c53
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68210809"
---
# <a name="advanced-edit-condition-dialog-box"></a>Диалоговое окно «Расширенное редактирование» (условие)
  С помощью диалогового окна **Расширенное редактирование** создаются сложные выражения для условий управления на основе политик.  
  
## <a name="options"></a>Параметры  
 **Значение ячейки**  
 Отображает функцию или выражение, которое будет использовано в качестве значения для ячейки при ее создании. При нажатии кнопки **ОК**значение ячейки появится в ячейке **Поле** или **Значение** в поле выражения условия диалогового окна **Создание нового условия** или **Открытие условия** на странице **Общие** .  
  
 **Функции и свойства**  
 Отображает доступные функции и свойства.  
  
 **Дополнительно**  
 Отображает сведения о функциях и свойствах в следующем формате: подпись функции, описание функции, возвращаемое значение и пример.  
  
## <a name="syntax"></a>Синтаксис  
 Допустимые выражения должны быть представлены в следующем формате:  
  
 `{property | function | constant}`  
  
 `{operator}`  
  
 `{property | function | constant}`  
  
## <a name="examples"></a>Примеры  
 Ниже приводятся примеры допустимых выражений:  
  
-   *Свойство1*> 5  
  
-   *Свойство1*=*свойство2*  
  
-   Add(5, Multiply(.2,*Property1*))<*Property2*  
  
-   *Сометекст* В *свойство1*  
  
-   *Свойство1* \< FN (*свойство2*)  
  
-   BitwiseAnd(*Property1*,*Property2*)= 0  
  
## <a name="additional-function-information"></a>Дополнительные сведения о функциях  
 В следующих разделах приводятся дополнительные сведения о функциях, которые можно использовать при создании сложных выражений для условий управления на основе политик.  
  
> [!IMPORTANT]  
>  В функциях, которые можно использовать для создания условий управления на основе политик, не всегда используется синтаксис [!INCLUDE[tsql](../../includes/tsql-md.md)] . Необходимо следовать синтаксисту примера. Например, при использовании функций `DateAdd` или `DatePart` необходимо заключить аргумент *DatePart* в одинарные кавычки.  
  
|Компонент|Description|Аргументы|Возвращаемое значение|Пример|  
|--------------|-----------------|---------------|------------------|-------------|  
|`Add()`|Numeric Add (Numeric *expression1*, Numeric *expression2*)<br /><br /> складывает два числа.|*expression1* и *Expression2* — любое допустимое выражение любого из типов данных числовой категории, за исключением типа `bit` данных. Может быть константой, свойством или функцией, возвращающей числовой тип данных.|**Возвращаемое значение:** Возвращает тип данных аргумента с более высоким приоритетом.|**Пример:**`Add(Property1, 5)`|  
|`Array()`|Array Array (VarArgs *expression*)<br /><br /> создает массив из заданного списка значений. Может использоваться с агрегатными функциями, например Sum() или Count().|*Expression* — выражение, которое будет преобразовано в массив.|массив.|`Array(2,3,4,5,6)`|  
|`Avg()`|Numeric Avg (*VarArgs*)<br /><br /> возвращает среднее значение значений в списке аргументов.|*Varargs* — список выражений типа Variant для категории точных числовых или приблизительных числовых типов данных, за исключением типа `bit` данных.|возвращаемый тип определяется типом вычисленного результата выражения.<br /><br /> Если результат выражения относится к категории `integer`, `decimal`, `money` или `smallmoney`, `float` или `real`, возвращаемыми типами будут `int`, `decimal`, `money` и `float` соответственно.|
  `Avg(1.0, 2.0, 3.0, 4.0, 5.0)` в этом примере возвращает значение `3.0` .|  
|`BitwiseAnd()`|Numeric BitwiseAnd (Numeric *expression 1*, Numeric *expression2*)<br /><br /> Выполняет побитовую логическую операцию «И» между двумя целочисленными значениями.|*expression1* и *Expression2* — любое допустимое выражение любого типа данных из категории целочисленных типов данных.|возвращает значение из категории типа данных integer.|`BitwiseAnd(Property1, Property2)`|  
|`BitwiseOr()`|Numeric BitwiseOr (Numeric *expression1*, Numeric *expression2*)<br /><br /> выполняет побитовую логическую операцию «ИЛИ» применительно к двум указанным целочисленным значениям.|*expression1* и *Expression2* — любое допустимое выражение любого типа данных из категории целочисленных типов данных.|возвращает значение из категории типа данных integer.|`BitwiseOr(Property1, Property2)`|  
|`Concatenate()`|String Concatenate (String *string1*, String *string2*)<br /><br /> Объединяет две строки.|*строка1* и *строка2* — две строки, которые необходимо сцепить. Допускаются любые строки со значением, отличным от NULL.|Объединенная строка, в которой за строкой *string1* следует строка *string2*.|`Concatenate("Hello", " World``")` возвращает значение`Hello World`"".|  
|`Count()`|Numeric Count (*VarArgs*)<br /><br /> возвращает количество элементов в списке аргументов.|*Varargs* — выражение любого типа, за исключением `text`, `image`и `ntext`.|возвращает значение из категории типа данных integer.|
  `Count(1.0, 2.0, 3.0, 4.0, 5.0)` в этом примере возвращает значение `5` .|  
|`DateAdd()`|DateTime DateAdd (String *datepart*, Numeric *number*, DateTime *date*)<br /><br /> возвращает новое значение типа `datetime`, получаемое за счет добавления интервала к указанной дате.|*DatePart* — параметр, указывающий, в какой части даты следует возвращать новое значение. Некоторыми из поддерживаемых типов являются: year (yy, yyyy), month (mm, m) и dayofyear (dy, y). Дополнительные сведения см. в разделе [DATEADD (Transact-SQL)](/sql/t-sql/functions/dateadd-transact-sql).<br /><br /> *Number* — значение, которое используется для увеличения значения *DatePart*.<br /><br /> *Date* — выражение, возвращающее `datetime` значение или символьную строку в формате даты.|Новое значение типа `datetime`, получаемое за счет добавления интервала к указанной дате.|
  `DateAdd('day', 21, DateTime('2007-08-06 14:21:50'))` в этом примере возвращает значение `'2007-08-27 14:21:50'` .<br /><br /> Ниже перечислены пары *дат* и сокращений, которые поддерживаются этой функцией:<br /><br /> **год**: гг, гггг<br /><br /> **месяц**: mm, m<br /><br /> **DayOfYear**: DY, y<br /><br /> **день**: дд, d<br /><br /> **неделя**: WK, WW<br /><br /> **день недели**: DW, w<br /><br /> **час**: чч<br /><br /> **минута**: MI, n<br /><br /> **секунда**: СС, s<br /><br /> **миллисекунда**: МС|  
|`DatePart()`|Numeric DatePart (String *datepart*, DateTime *date*)<br /><br /> Возвращает целое число, представляющее указанную часть *datepart* указанной даты.|*DatePart* — параметр, указывающий возвращаемую часть даты. Некоторыми из поддерживаемых типов являются: year (yy, yyyy), month (mm, m) и dayofyear (dy, y). Дополнительные сведения см. в разделе [DATEPART (Transact-SQL)](/sql/t-sql/functions/datepart-transact-sql).<br /><br /> *Date* — выражение, возвращающее `datetime` значение или символьную строку в формате даты.|Возвращает значение из категории типов данных integer, представляя указанную часть *datepart* указанной даты.|
  `DatePart('month', DateTime('2007-08-06 14:21:50.620'))` в этом примере возвращает значение `8` .|  
|`DateTime()`|DateTime DateTime (String *dateString*)<br /><br /> создает значение типа datetime из строки.|*dateString* — значение даты и времени в виде строки.|возвращает значение даты и времени, созданное на основе входной строки.|`DateTime('3/12/2006')`|  
|`Divide()`|Numeric Divide (Numeric *expression_dividend*, Numeric *expression_divisor*)<br /><br /> делит одно число на другое.|*expression_dividend* — числовое выражение, которое необходимо разделить. Делимое может представлять собой любое допустимое выражение любого из типов данных категории числовых типов данных, кроме типа данных `datetime`.<br /><br /> *expression_divisor* — числовое выражение, на которое делится делимое. Делитель может представлять собой любое допустимое выражение любого из типов данных категории числовых типов данных, кроме типа данных `datetime`.|возвращает тип данных аргумента, у которого более высокий приоритет.|`Divide(Property1, 2)`<br /><br /> Примечание. Это операция со значениями типа double. Чтобы выполнить целочисленное сравнение, необходимо применить к результатам функцию `Round()`. Например, `Round(Divide(10, 3), 0) = 3`.|  
|`Enum()`|Numeric Enum (String *enumTypeName*, String *enumValueName*)<br /><br /> создает значение типа enum из строки.|*enumTypeName* — имя типа перечисления.<br /><br /> *enumValueName* — значение перечисления.|возвращает значение типа enum в виде числового значения.|`Enum('CompatibilityLevel','Version100')`|  
|`Escape()`|String Escape (String *replaceString*, String *stringToEscape*, String *escapeString*)<br /><br /> Экранирует подстроку входной строки заданной экранизирующей строкой.|*replaceString* — входная строка.<br /><br /> *stringToEscape* — это подстрока *replaceString*. Это строка, перед которой добавляется экранизирующая строка.<br /><br /> *escapeString* — это escape-строка, которую необходимо добавить перед каждым экземпляром *stringToEscape*.|Возвращает измененную строку *replaceString* , в которой перед каждым экземпляром строки *stringToEscape* помещена строка *escapeString*.|`Escape("Hello", "l", "[")`Возвращает значение`He[l[lo`"".|  
|`ExecuteSQL()`|Variant ExecuteSQL (String *returnType*, String *sqlQuery*)<br /><br /> выполняет запрос [!INCLUDE[tsql](../../includes/tsql-md.md)] к целевому серверу.<br /><br /> Дополнительные сведения о функции ExecuteSql() см. в разделе [Функция ExecuteSql()](https://blogs.msdn.com/b/sqlpbm/archive/2008/07/03/executesql.aspx).|*ReturnType* — указывает возвращаемый тип данных, возвращаемых [!INCLUDE[tsql](../../includes/tsql-md.md)] инструкцией. Допустимые литералы для *ReturnType* следующие: `Numeric`, `String`, `Bool`, `DateTime` `Array`, и. `Guid`<br /><br /> *sqlQuery* — строка, содержащая запрос для выполнения.||`ExecuteSQL ('Numeric', 'SELECT COUNT(*) FROM msdb.dbo.sysjobs') <> 0`<br /><br /> Выполняет скалярный запрос Transact-SQL к целевому экземпляру SQL Server. В инструкции `SELECT` можно указать только один столбец; дополнительные столбцы вслед за первым не учитываются. Результирующий запрос должен возвращать только одну строку; дополнительные строки не учитываются. Если запрос возвращает пустой набор, то выражение условия, построенное на функции `ExecuteSQL` , возвращает значение false. `ExecuteSql`поддерживает режимы оценки **по запросу** и **по расписанию** .<br /><br /> `@@ObjectName`— Соответствует полю имени в [таблице sys. Objects](/sql/relational-databases/system-catalog-views/sys-objects-transact-sql). Переменная будет заменена именем текущего объекта.<br /><br /> `@@SchemaName`— Соответствует полю имени в [таблице sys. schemas](/sql/relational-databases/system-catalog-views/schemas-catalog-views-sys-schemas). Переменная будет заменена именем схемы текущего объекта, если это возможно.<br /><br /> <br /><br /> Примечание. Если в инструкцию ExecuteSQL необходимо включить одиночную кавычку, ее следует экранировать второй одиночной кавычкой. Например, чтобы включить ссылку на пользователя с именем O'Brian, следует ввести O''Brian.|  
|`ExecuteWQL()`|Variant ExecuteWQL (string *returnType* , string *namespace*, string *wql*)<br /><br /> выполняет скрипт WQL по отношению к предоставленному пространству имен. Инструкция выборки может содержать только единственный возвращаемый столбец. Если предоставлен больше чем один столбец, выдается ошибка.|*ReturnType* — указывает возвращаемый тип данных, возвращаемый WQL. Допустимыми литералами являются `Numeric`, `String`, `Bool`, `DateTime`, `Array` и `Guid`.<br /><br /> *Namespace* — пространство имен WMI для выполнения.<br /><br /> *WQL* — строка, содержащая WQL-запрос для выполнения.||`ExecuteWQL('Numeric', 'root\CIMV2', 'select NumberOfProcessors from win32_ComputerSystem') <> 0`|  
|`False()`|Bool False()<br /><br /> возвращает логическое значение FALSE.||возвращает логическое значение FALSE.|`IsDatabaseMailEnabled = False()`|  
|`GetDate()`|DateTime GetDate()<br /><br /> возвращает системную дату.||возвращает системную дату как значение типа DateTime.|`@DateLastModified = GetDate()`|  
|`Guid()`|Guid Guid(String *guidString*)<br /><br /> возвращает значение идентификатора GUID из строки.|*guidString* — это строковое представление СОЗДАВАЕМОГО идентификатора GUID.|возвращает идентификатор GUID, созданный на основе строки.|`Guid('12340000-0000-3455-0000-000000000454')`|  
|`IsNull()`|Variant IsNull (Variant *check_expression*, Variant *replacement_value*)<br /><br /> Возвращается значение *check_expression* , если это выражение не равно NULL; в противном случае возвращается значение *replacement_value* . Если тип аргументов отличается, тип аргумента *replacement_value* неявно преобразуется в тип аргумента *check_expression*.|*check_expression* — выражение, проверяемое на наличие значения NULL. *check_expression* могут быть любыми типами, поддерживаемыми системой управления на основе политик: числовые, строковые, логические, DateTime, Array и GUID.<br /><br /> *replacement_value* — выражение, возвращаемое, если *check_expression* имеет значение null. *replacement_value* должен иметь тип, который неявно преобразуется в тип *check_expression*.|Возвращаемый тип — *check_expression* в том случае, если значение *check_expression* не равно NULL. В противном случае возвращается тип *replacement_value* .||  
|`Len()`|Numeric Len (*string_expression*)<br /><br /> возвращает количество символов указанного строкового выражения, исключая конечные пробелы.|*String_Expression* — это строковое выражение для вычисления.|возвращает значение из категории типа данных integer.|
  `Len('Hello')` в этом примере возвращает значение `5` .|  
|`Lower()`|String Lower (String *_expression*)<br /><br /> возвращает строку после преобразования всех символов верхнего регистра в нижний регистр.|*Expression* — это исходное строковое выражение.|возвращает строку, которая представляет исходную строку после преобразования всех символов верхнего регистра в нижний регистр.|
  `Len('HeLlO')` в этом примере возвращает значение `'hello'` .|  
|`Mod()`|Numeric Mod (Numeric *expression_dividend*, Numeric *expression_divisor*)<br /><br /> вычисляет целочисленный остаток после деления первого числового выражения на второе.|*expression_dividend* — числовое выражение, которое необходимо разделить. *expression_dividend* должно быть допустимым выражением любого из типов данных в категории целочисленных или числовых типов данных.<br /><br /> *expression_divisor* — числовое выражение для деления делимого на. *expression_divisor* должно быть любым допустимым выражением любого из типов данных в категории целочисленных или числовых типов данных.|возвращает значение из категории типа данных integer.|`Mod(Property1, 3)`|  
|`Multiply()`|Numeric Multiply (Numeric *expression1*, Numeric *expression2*)<br /><br /> умножает два выражения.|*expression1* и *Expression2* — любое допустимое выражение любого из типов данных числовой категории, за исключением типа `datetime` данных.|возвращает тип данных аргумента, у которого более высокий приоритет.|`Multiply(Property1, .20)`|  
|`Power()`|Numeric Power (Numeric *numeric_expression*, Numeric *expression_power*)<br /><br /> Возвращает результат возведения указанного числового выражения в заданную степень.|*Numeric_Expression* — это выражение категории точного числового или приближенного числового типа данных, за исключением типа данных bit.<br /><br /> *expression_power* — это степень, с которой следует вызывать *Numeric_Expression*. *expression_power* может быть выражением категории точного числового или приблизительного числового типа данных, за исключением типа `bit` данных.|Возвращаемым типом является такой же тип, как и у выражения *numeric_expression*.|`Power(Property1, 3)`|  
|`Round()`|Numeric Round (Numeric *expression*, Numeric *expression_precision*)<br /><br /> Возвращает числовое выражение, округленное до указанной длины или точности.|*Expression* — выражение категории точного числового или приближенного числового типа данных, за исключением типа `bit` данных.<br /><br /> *expression_precision* — точность округления выражения. Если аргумент *expression_precision* является положительным числом, значение *numeric_expression* округляется до числа десятичных разрядов, указанных в виде длины. Когда *expression_precision* является отрицательным числом, *numeric_expression* округляется слева от точки, отделяющей десятичную дробь от целого числа, как указано в *expression_precision*.|Возвращает тот же тип, что и аргумент *numeric_expression*.|`Round(5.333, 0)`|  
|`String()`|String String (Variant *_expression*)<br /><br /> преобразует данные типа Variant в строку.|*Expression* — выражение типа Variant, которое должно быть преобразовано в строку.|возвращает строковое значение выражения типа Variant.|`String(4)`|  
|`Sum()`|Numeric Sum (*VarArgs*)<br /><br /> возвращает сумму всех значений в списке аргументов. Эту функцию можно использовать с численными значениями.|*Varargs*— список выражений типа Variant для категории точных числовых или приблизительных числовых типов данных, за исключением типа `bit` данных.|возвращает сумму всех значений выражения, представленную в наиболее точном формате данных.<br /><br /> Если результат выражения относится к категории `integer`, `numeric`, `money` или `small money`, `float` или `real`, возвращаемыми типами будут `int`, `numeric`, `money` и `float` соответственно.|
  `Sum(1.0, 2.0, 3.0, 4.0, 5.0)` в этом примере возвращает значение `15` .|  
|`True()`|Bool TRUE()<br /><br /> возвращает логическое значение TRUE.||возвращает логическое значение TRUE.|`IsDatabaseMailEnabled = True()`|  
|`Upper()`|String Upper (String *_expression*)<br /><br /> возвращает строку после преобразования всех символов нижнего регистра в верхний регистр.|*Expression* — это исходное строковое выражение.|возвращает строку, представляющую собой исходное строковое выражение после преобразования всех символов нижнего регистра в верхний регистр.|
  `Len('HeLlO')` в этом примере возвращает значение `'HELLO'` .|  
  
## <a name="see-also"></a>См. также:  
 [Диалоговое окно «Создание нового условия» или «открытие условия», страница «Общие»](../../integration-services/general-page-of-integration-services-designers-options.md)   
 [Администрирование серверов с помощью управления на основе политик](administer-servers-by-using-policy-based-management.md)  
  
  
