---
title: Развертывание базы данных SQL Server на виртуальной машине Microsoft Azure | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
f1_keywords:
- sql12.swb.deploymentwizard.deploymentsettings.f1
- sql12.swb.deploymentwizard.progress.f1
- sql11.swb.usevmdialog.f1
- sql11.swb.deploymentwizard.f1
- sql12.swb.deploymentwizard.azuresignin.f1
- sql11.swb.deploymentwizard.summary.f1
- sql11.swb.deploymentwizard.azuresignin.f1
- sql12.swb.deploymentwizard.f1
- sql12.swb.sqlvmdialog.f1
- sql11.swb.newvmdialog.f1
- sql12.swb.deploymentwizard.results.f1
- sql11.swb.deploymentwizard.progress.f1
- sql12.swb.newvmdialog.f1
- sql12.swb.deploymentwizard.sourcesettings.f1
- sql12.swb.usevmdialog.f1
- sql11.swb.deploymentwizard.sourcesettings.f1
- sql11.swb.deploymentwizard.results.f1
- sql12.swb.deploymentwizard.summary.f1
- sql11.swb.deploymentwizard.deploymentsettings.f1
helpviewer_keywords:
- Deploy a database
- Deploy to Azure VM
- Migrate to Azure
- Windows Azure virtual machine
- Migrate to Azure VM
- Migrate to the cloud
- SQL Server Management Studio
- SSMS
- Deploy database wizard
- Deploy a SQL Server database to Azure
- Azure VM
ms.assetid: 5e82e66a-262e-4d4f-aa89-39cb62696d06
author: stevestein
ms.author: sstein
manager: craigg
ms.openlocfilehash: 933a03f2e6192be32eebd84923f4e513bd1716e6
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "66054052"
---
# <a name="deploy-a-sql-server-database-to-a-microsoft-azure-virtual-machine"></a>Развертывание базы данных SQL Server в виртуальной машине Microsoft Azure
  Используйте мастер **развертывания базы данных SQL Server на виртуальной машине Windows Azure** для развертывания базы данных из экземпляра [!INCLUDE[ssDE](../../includes/ssde-md.md)] на [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в виртуальной машине (ВМ) Windows Azure. Мастер использует операцию полного резервного копирования базы данных, поэтому он всегда копирует всю схему базы данных и данные из пользовательской базы данных SQL Server. Мастер также выполняет всю настройку ВМ Azure, поэтому дополнительные действия для задания параметров ВМ не требуются.  
  
 Нельзя использовать мастер для создания разностных резервных копий, поскольку он не перезаписывает существующую базу данных, имя которой совпадает с именем обрабатываемой базы данных. Чтобы заменить существующую базу данных на ВМ, сначала необходимо удалить существующую базу данных или изменить имя базы данных. В случае возникновения конфликта имен между базой данных, в отношении которой выполняется операция развертывания на лету, и существующей базой данных на виртуальной машине мастер предложит имя базы данных с добавлением определенных символов для развертываемой на лету базы данных, чтобы можно было завершить операцию.  
  
##  <a name="before_you_begin"></a> Перед началом  
 Чтобы завершить этот мастер, необходима возможность предоставить следующие сведения и назначить следующие параметры конфигурации:  
  
-   Данные учетной записи Microsoft, связанной с подпиской Windows Azure.  
  
-   Ваш профиль публикации Windows Azure.  
  
    > [!CAUTION]  
    >  SQL Server в настоящий момент поддерживает версию 2.0 профиля публикации. Для загрузки поддерживаемой версии профиля публикации см. раздел [Загрузка профиля публикации 2.0](https://go.microsoft.com/fwlink/?LinkId=396421).  
  
-   Сертификат управления, загруженный в подписку Windows Azure.  
  
-   Сертификат управления, сохраненный в хранилище личных сертификатов на компьютере, где запущен мастер.  
  
-   Необходимо временное место хранения, доступное для компьютера, на котором размещается база данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] . Временное место хранения также должно быть доступным для компьютера, на котором запущен мастер.  
  
-   При развертывании базы данных на существующей виртуальной машине в экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] должно быть настроено прослушивание порта TCP/IP.  
  
-   Виртуальная машина Windows Azure или образ из коллекции, который планируется использовать для создания виртуальных машин, должен иметь настроенную и запущенную службу Cloud Adapter для SQL Server.  
  
-   Необходимо настроить открытую конечную точку под службу Cloud Adapter для SQL Server в шлюзе Windows Azure с частным портом 11435.  
  
 Кроме того, если планируется развернуть базу данных в существующей виртуальной машине Windows Azure, необходимо также предоставить:  
  
-   Имя DNS облачной службы, в которой размещается виртуальная машина.  
  
-   Учетные данные администратора для виртуальной машины.  
  
-   Учетные данные с правами доступа для выполнения оператора резервного копирования базы данных, которую планируется развернуть из исходного экземпляра служб [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
 Дополнительные сведения о запуске SQL Server в виртуальных машинах Microsoft Azure см. в разделе [Подготовка к переходу на SQL Server в виртуальных машинах Microsoft Azure](https://msdn.microsoft.com/library/dn133142.aspx).  
  
 На компьютерах, работающих под управлением операционных систем Windows Server, для запуска мастера необходимо использовать следующие параметры конфигурации.  
  
-   Отключите конфигурацию усиленной безопасности:  Используйте диспетчер серверов > локальный сервер, чтобы установить Internet Explorer конфигурация усиленной безопасности (ESC) **OFF**.  
  
-   Включите JavaScript:  Internet Explorer > Свойства обозревателя > Безопасность > уровень пользователя > сценариев > Активные скрипты: **Включить**.  
  
###  <a name="limitations"></a> Ограничения  
 Размер базы данных для этой операции не может превышать 1 ТБ.  
  
 Эта функция развертывания доступна в среде SQL Server Management Studio для [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)].  
  
 Эта функция развертывания предназначена для использования только в отношении пользовательских баз данных. Развертывание системных баз данных не поддерживается.  
  
 Функция развертывания не поддерживает размещаемые службы, связанные с группой сходства. Например, учетные записи хранения, связанные с группой сходства, нельзя выбрать для использования на странице мастера **Параметры развертывания** .  
  
 Версия SQL Server в виртуальной машине должна быть такой же, что и исходная версия SQL Server, или более поздней. Версии базы данных SQL Server, которые могут быть развернуты на виртуальной машине Windows Azure с помощью этого мастера:  
  
-   SQL Server 2008  
  
-   SQL Server 2008 R2  
  
-   SQL Server 2012  
  
-   [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]  
  
 Версии баз данных SQL Server, работающих на виртуальной машине Windows Azure, могут быть развернуты в следующем:  
  
-   SQL Server 2012  
  
-   [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]  
  
 В случае возникновения конфликта имен между базой данных, в отношении которой выполняется операция развертывания на лету, и существующей базой данных на виртуальной машине мастер предложит имя базы данных с добавлением определенных символов для развертываемой на лету базы данных, чтобы можно было завершить операцию.  
  
###  <a name="filestream"></a> Основные моменты при развертывании базы данных с поддержкой FILESTREAM на виртуальную машину SQL Azure  
 Обратите внимание на следующие правила и ограничения при развертывании баз данных с большими двоичными объектами, хранящихся в объектах FILESTREAM.  
  
-   Функция развертывания не может развернуть базу данных с поддержкой FILESTREAM на новой виртуальной машине. Если функция FILESTREAM отключена в виртуальной машине до запуска мастера, то операция восстановления базы данных завершится ошибкой, а операция мастера не будет завершена успешно. Для успешного развертывания базы данных, в которой используется FILESTREAM, перед запуском мастера включите FILESTREAM в экземпляре [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] на виртуальной машине основного приложения. Дополнительные сведения см. в разделе [FILESTREAM (SQL Server)](https://msdn.microsoft.com/library/gg471497.aspx).  
  
-   Если база данных использует функции OLTP в памяти, то можно развернуть базу данных в виртуальной машине Azure без каких-либо изменений в базе данных. Дополнительные сведения см. в разделе [In-Memory OLTP (оптимизация в памяти)](https://msdn.microsoft.com/library/dn133186\(SQL.120\).aspx).  
  
###  <a name="geography"></a> Вопросы территориального распределения активов  
 Обратите внимание, что следующие активы должны находиться в одной и той же географической области.  
  
-   Облачная служба  
  
-   Расположение виртуальной машины  
  
-   Служба хранения диска данных  
  
 Если приведенные выше активы не находятся в одном месте, мастер не сможет завершиться успешно.  
  
###  <a name="configuration_settings"></a> Параметры конфигурации мастера  
 Используйте следующие параметры конфигурации для изменения настроек для развертывания базы данных [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] на виртуальной машине Azure.  
  
-   **Путь по умолчанию к файлу конфигурации** : "%LOCALAPPDATA%\SQL Server\Deploy to SQL in WA VM\DeploymentSettings.xml".  
  
-   **Структура файла конфигурации**  
  
    -   \<DeploymentSettings>  
  
        -   <OtherSettings  
  
            -   TraceLevel="Debug" \<! — Уровень журналирования -->  
  
            -   BackupPath="\\\\[имя сервера]\\[том]\\" \<! — последний путь, использованный для резервного копирования. Используется в мастере в качестве значения по умолчанию. -->  
  
            -   CleanupDisabled = False /> \<! — мастер не удаляет промежуточные файлы и объекты Windows Azure (ВМ, CS, SA). -->  
  
        -   <PublishProfile \<! — последние использованные сведения профиля публикации. -->  
  
            -   Certificate="12A34B567890123ABCD4EF567A8" \<! — сертификат для использования в мастере. -->  
  
            -   Subscription="1a2b34c5-67d8-90ef-ab12-xxxxxxxxxxxxx" \<! — подписка для использования в мастере. -->  
  
            -   Name= "Моя подписка" \<! — имя подписки. -->  
  
            -   Publisher="" />  
  
    -   \</DeploymentSettings>  
  
 **Значения файла конфигурации**  
  
###  <a name="permissions"></a> Разрешения  
 Развертываемая база данных должна находиться в нормальном состоянии, база данных должна быть доступна для учетной записи пользователя, запустившего мастер, и учетная запись должна иметь разрешения для выполнения операции резервного копирования.  
  
##  <a name="launch_wizard"></a> С помощью развертывания базы данных мастер создания виртуальной Машины Azure Windows  
 **Для запуска мастера выполните следующие действия.**  
  
1.  Использование среды SQL Server Management Studio для подключения к экземпляру [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] с базой данных, развертывание которой требуется выполнить.  
  
2.  В **обозревателе объектов**разверните имя экземпляра, затем узел **Databases** .  
  
3.  Щелкните правой кнопкой мыши базу данных, которую требуется развернуть, выберите **задачи**, а затем выберите **развертывание базы данных на виртуальной Машине Windows Azure...**  
  

  
##  <a name="Introduction"></a> Вводная страница  
 На этой странице рассматривается мастер **развертывания базы данных SQL Server на виртуальную машину Windows Azure** .  
  
 **Параметры**  
  
-   **Больше не показывать эту страницу.** Установите этот флажок, чтобы вводная страница больше не отображалась.  
  
-   **Следующая** — переход к странице **Параметры источника** .  
  
-   **Отмена** — отмена операции и закрытие мастера.  
  
-   **Справка** — запуск раздела справки MSDN для мастера.  
  
##  <a name="Source_settings"></a> Параметры источника  
 Эта страница используется для соединения с экземпляром [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , на котором размещена база данных, развертываемая в виртуальной машине Windows Azure. Можно также указать временное местоположение для файлов, которые будут сохраняться с локального компьютера, прежде чем они будут переданы в Windows Azure. Это может быть общая сетевая папка.  
  
 **Параметры**  
  
-   Нажмите кнопку **подключения...**  и укажите сведения о подключении для экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] с базой данных для развертывания.  
  
-   Используйте раскрывающийся список **Выбор базы данных** , чтобы указать базу данных для развертывания.  
  
-   В поле **Другие параметры** укажите общую папку, которая будет доступна службе виртуальной машины Windows Azure.  
  
##  <a name="Azure_sign-in"></a> Windows вход в Azure  
 Эта страница используется для подключения к Windows Azure и для предоставления сведений о сертификате управления или профиле публикации.  
  
 **Параметры**  
  
-   **Сертификат управления** -используйте этот параметр, чтобы указать сертификат из локального хранилища сертификатов, соответствующий сертификату управления из Windows Azure.  
  
-   **Профиль публикации** -используйте этот параметр, если у вас уже есть профиль публикации, загруженный на компьютер.  
  
-   **Sign In** - используйте этот параметр для входа Windows Azure с помощью Microsoft учетной записи — например, Live ID или учетной записи Hotmail - для создания и загрузки нового сертификата управления. Обратите внимание, что количество сертификатов на одну подписку ограниченно.  
  
-   **Подписка** — выберите, введите или вставьте идентификатор подписки Windows Azure, который соответствует сертификату управления из локального хранилища сертификатов или профиля публикации.  
  
##  <a name="Deployment_settings"></a> Страница «Параметры развертывания»  
 На этой странице указываются целевой сервер и подробные сведения о новой базе данных.  
  
 **Параметры**  
  
-   **Виртуальная машина Azure** -указать сведения о виртуальной Машине, которая будет размещена база данных SQL Server:  
  
-   **Имя облачной службы** -укажите имя службы, которая размещена на виртуальной Машине. Чтобы создать новую облачную службу укажите для нее имя.  
  
-   **Имя виртуальной машины** -укажите имя виртуальной Машины, которая будет размещена база данных SQL Server. Для создания новой виртуальной машины Windows Azure укажите для нее имя.  
  
-   **Параметры** — использовать кнопку «Параметры» для создания новой виртуальной Машины для размещения базы данных SQL Server. Если используется существующая виртуальная машина, предоставленные сведения будут использоваться для проверки подлинности учетных данных.  
  
-   **Учетная запись хранения** -выберите учетную запись из раскрывающегося списка. Для создания новой учетной записи хранения укажите для нее имя. Обратите внимание, что учетные записи хранения, связанные с группой сходства, не будут доступны в раскрывающемся списке.  
  
-   **Целевая база данных** -укажите подробные сведения о целевой базе данных.  
  
-   **Соединение с сервером** -сведения о подключении для сервера.  
  
-   **База данных** — укажите или подтвердите имя новой базы данных. Если имя базы данных уже существует на целевом экземпляре SQL Server, измените имя базы данных.  
  
##  <a name="Summary"></a> Страница «Сводка»  
 На этой странице можно просмотреть указанные параметры операции. Чтобы выполнить развертывание с заданными параметрами, нажмите кнопку **Готово**. Чтобы отменить операцию развертывания и выйти из мастера, нажмите кнопку **Отмена**.  
  
 Возможно, потребуется выполнить вручную шаги для развертывания сведений о базах данных в базе данных SQL Server на виртуальной машине Windows Azure. Эти действия будут подробно описаны.  
  
##  <a name="Results"></a> Страница «Результаты»  
 На этой странице отображаются сведения об успешности операции развертывания по результатам каждого действия. Для каждого действия, в котором обнаружена ошибка, предусмотрен индикатор в столбце **Результат** . Щелкните эту ссылку, чтобы просмотреть отчет об ошибках, относящихся к данному действию.  
  
 Чтобы завершить работу мастера, нажмите кнопку **Готово** .  
  
## <a name="see-also"></a>См. также  
 [адаптер для облака SQL Server](../../database-engine/cloud-adapter-for-sql-server.md)   
 [Управление жизненным циклом базы данных](../database-lifecycle-management.md)   
 [Экспорт приложения уровня данных](../data-tier-applications/export-a-data-tier-application.md)   
 [Импорт файла BACPAC для создания новой пользовательской базы данных](../data-tier-applications/import-a-bacpac-file-to-create-a-new-user-database.md)   
 [Резервное копирование и восстановление баз данных SQL Azure](https://msdn.microsoft.com/library/azure/jj650016.aspx)   
 [Развертывание SQL Server на виртуальных машинах Windows Azure](https://msdn.microsoft.com/library/dn133141.aspx)   
 [Подготовка к переходу на SQL Server на виртуальных машинах Windows Azure](https://msdn.microsoft.com/library/dn133142.aspx)  
  
  
