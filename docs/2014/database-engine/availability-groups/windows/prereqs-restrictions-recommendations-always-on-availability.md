---
title: Предварительные требования, ограничения и рекомендации для группы доступности AlwaysOn (SQL Server) | Документация Майкрософт
ms.custom: ''
ms.date: 06/14/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- Availability Groups [SQL Server], server instance
- Availability Groups [SQL Server], deploying
- Availability Groups [SQL Server], WSFC clusters
- Availability Groups [SQL Server], about
- Availability Groups [SQL Server], prerequisites and restrictions
- Availability Groups [SQL Server], Failover Cluster Instances
- Availability Groups [SQL Server], databases
- Availability Groups [SQL Server]
ms.assetid: edbab896-42bb-4d17-8d75-e92ca11f7abb
author: MashaMSFT
ms.author: mathoma
manager: craigg
ms.openlocfilehash: b12b9030d27e371e0299e06917464b1467b9b10e
ms.sourcegitcommit: a165052c789a327a3a7202872669ce039bd9e495
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/22/2019
ms.locfileid: "72782963"
---
# <a name="prerequisites-restrictions-and-recommendations-for-alwayson-availability-groups-sql-server"></a>предварительными требованиями, и ограничениями и рекомендациями для групп доступности AlwaysOn (SQL Server)
  В этом разделе приводятся рекомендации по развертыванию [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], в т.ч. предварительные условия, ограничения и рекомендации в отношении компьютеров, отказоустойчивых кластеров Windows Server (WSFC), экземпляров сервера и групп доступности. Для каждого из этих компонентов описываются имеющиеся вопросы безопасности и необходимые разрешения.  
  
> [!IMPORTANT]  
>  Перед началом развертывания [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] настоятельно рекомендуется ознакомиться со всеми подразделами данного раздела.  
  
 
  
##  <a name="DotNetHotfixes"></a>Исправления .NET, которые поддерживают группы доступности AlwaysOn  
 Возможно, потребуется установка дополнительных исправлений .Net, в зависимости от того, какие компоненты и возможности [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)] будут использоваться вместе с [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]. Исправления приведены в следующей таблице. Исправления можно устанавливать в любом порядке.  
  
||Зависимый компонент|Исправление|Ссылка|  
|------|-----------------------|------------|----------|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|[!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)]|Исправление для .Net 3.5 с пакетом обновления 1 (SP1) добавляет в клиент SQL поддержку функций AlwaysOn: Read-intent, readonly и multisubnetfailover. Это исправление необходимо установить на каждом сервере отчетов служб [!INCLUDE[ssRSnoversion](../../../includes/ssrsnoversion-md.md)] .|KB 2654347 [Исправление для .NET 3.5 с пакетом обновления 1 (SP1), добавляющее поддержку функций AlwaysOn](https://go.microsoft.com/fwlink/?LinkId=242896)|  
  
##  <a name="SystemReqsForAOAG"></a> Рекомендации и системные требования Windows  
  
  
###  <a name="SystemRequirements"></a> Контрольный список: требования (ОС Windows)  
 Чтобы обеспечить поддержку функции [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] , необходимо, чтобы каждый компьютер, участвующий в одной или нескольких группах доступности, соответствовал следующим основным требованиям.  
  
||Требование|Ссылка|  
|------|-----------------|----------|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Убедитесь, что система не является контроллером домена.|Группы доступности не поддерживаются на контроллерах домена.|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Убедитесь, что каждый компьютер работает под управлением либо системы x86 (без режима WoW64), либо на платформе x64 Windows Server 2008 или более поздних версиях.|WOW64 (Windows 32-бит на Windows 64-бит) не поддерживает функцию [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)].|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Убедитесь, что каждый компьютер является узлом в отказоустойчивой кластеризации Windows Server (WSFC).|[Отказоустойчивая кластеризация Windows Server (WSFC) с SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Убедитесь, что кластер WSFC содержит достаточное количество узлов для поддержки требуемых конфигураций групп доступности.|На узле WSFC можно размещать только одну реплику доступности для отдельной группы доступности. На каждом отдельном узле WSFC один или несколько экземпляров [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] могут содержать реплики доступности для многих групп доступности.<br /><br /> Обратитесь к администраторам базы данных, чтобы узнать, сколько узлов кластера WSFC требуется для поддержки реплик доступности для планируемых групп доступности.<br /><br /> [Обзор групп доступности AlwaysOn (SQL Server)](overview-of-always-on-availability-groups-sql-server.md).|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Убедитесь, что все применимые исправления Windows были установлены на всех узлах кластера WSFC.|**\*\* важное \*\*** Для узлов кластера WSFC, на которых развертывается [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], требуются или рекомендуются некоторые исправления. Дополнительные сведения см. в подразделе [Исправления Windows для поддержки групп доступности AlwaysOn (ОС Windows)](#WinHotfixes) ниже.|  
  
> [!IMPORTANT]  
>  Кроме того, убедитесь, что среда правильно настроена для соединения с группой доступности. Дополнительные сведения см. в разделе [подключение клиента AlwaysOn (SQL Server)](always-on-client-connectivity-sql-server.md).  
  
####  <a name="WinHotfixes"></a>Исправления Windows, которые поддерживают группы доступности AlwaysOn (Windows System)  
 В зависимости от топологии кластера для поддержки [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] могут потребоваться несколько дополнительных исправлений Windows Server 2008 с пакетом обновления 2 (SP2) или Windows Server 2008 R2. Эти исправления перечислены в следующей таблице. Их можно устанавливать в любом порядке.  
  
||Область применения: Windows 2008 с пакетом обновления 2 (SP2)|Область применения: Windows 2008 R2 с пакетом обновления 1 (SP1)|Входит в состав Windows 2012|Для поддержки...|Исправление|Ссылка|  
|------|---------------------------------|------------------------------------|------------------------------|-----------------|------------|----------|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Да|Да|Да|**Настройка оптимального кворума WSFC**|Убедитесь, что на каждом узле кластера WSFC было установлено исправление, описанное в статье базы знаний 2494036.<br /><br /> Это исправление поддерживает настройку оптимального кворума с неавтоматическими целями отработки отказа. Эта функция улучшает работу многосайтовых кластеров, позволяя выбирать голосующие узлы.|KB 2494036:  [Доступно исправление, позволяющее настраивать узел кластера, на котором нет кворума голосов, в Windows Server 2008 и в Windows Server 2008 R2](https://support.microsoft.com/kb/2494036)<br /><br /> Сведения о голосовании кворума см. в разделе [Режим кворума и участвующая в голосовании конфигурация WSFC (SQL Server)](../../../sql-server/failover-clusters/windows/wsfc-quorum-modes-and-voting-configuration-sql-server.md)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Да|Да|Да|**Более эффективное использование пропускной способности сети**|Убедитесь, что на каждом узле кластера WSFC было установлено исправление, описанное в статье базы знаний 2616514.<br /><br /> Без этого исправления служба кластеров будет отправлять узлам кластера ненужные уведомления реестра. Такое поведение ограничивает пропускную способность сети, что является серьезной проблемой для [!INCLUDE[ssHADRc](../../../includes/sshadrc-md.md)].|KB 2616514.  [Служба кластеров отправляет узлам кластера ненужные уведомления об изменении разделов реестра в Windows Server 2008 и Windows Server 2008 R2](https://support.microsoft.com/kb/2616514)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")||Да|Неприменимо|**Тестирование хранилища VPD на дисках, которые недоступны для всех узлов WSFC**|Если узел WSFC работает под управлением Windows Server 2008 R2 с пакетом обновления 1 (SP1) и тест системы хранения «Проверка SCSI устройства жизненно важных продуктов данных (VPD)» завершается неудачно после некорректного запуска на дисках, которые подключены, но недоступны для всех узлов кластера WSFC, установите исправление, описанное в статье KB 2531907 базы знаний.<br /><br /> Это исправление отключает неверные предупреждения и ошибки в отчете проверки, когда диски подключены.|KB 2531907: [Тест "Проверка важных данных продукта (VPD) SCSI-устройства" завершается неудачей после установки Windows Server 2008 R2 с пакетом обновления 1 (SP1)](https://support.microsoft.com/kb/2531907)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")||Да|Да|**Более быстрый переход на локальные реплики**|Если на узле WSFC работает Windows Server 2008 R2 с пакетом обновления 1 (SP1), убедитесь, что установлено исправление, описанное в статье базы знаний 2687741.<br /><br /> Это исправление позволяет повысить производительность перехода [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] на локальные реплики при сбое.|KB 2687741.  [Исправление, повышающее производительность функции «Группы доступности AlwaysOn» в SQL Server 2012, доступно в Windows Server 2008 R2](https://support.microsoft.com/KB/2687741)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Да|Да|Да|**Асимметричное хранилище — для экземпляров отказоустойчивого кластера (FCI)**|Если будет включен какой-либо экземпляр отказоустойчивого кластера (FCI) для [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], установите исправление 976097 для Windows Server 2008.<br /><br /> Это исправление включает оснастку консоли управления (MMC) отказоустойчивого кластера для поддержки асимметричных общих дисков хранилища, доступных только на некоторых узлах WSFC.|Статья базы знаний 976097: [Исправление, предназначенное для добавления функции поддержки асимметричных систем хранения данных в оснастку MMC управления отказоустойчивым кластером для отказоустойчивых кластеров под управлением ОС Windows Server 2008 или Windows Server 2008 R2](https://support.microsoft.com/kb/976097)<br /><br /> [Руководство по архитектуре AlwaysOn. Создание решения для обеспечения высокого уровня доступности и аварийного восстановления с помощью экземпляров отказоустойчивого кластера и групп доступности](https://technet.microsoft.com/library/jj215886.aspx)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Да|Да|Неприменимо|**Безопасность протокола IP (IPsec)**|Если в среде используются соединения IPsec, то в процессе повторного установления клиентскими компьютерами соединения по протоколу IPsec с виртуальным сетевым именем (в данном контексте — к прослушивателю группы доступности) могут возникать длительные задержки (около двух-трех минут). Если используются соединения IPsec, то рекомендуется изучить соответствующие сценарии, описанные в следующей статье базы знаний (KB 980915).|KB 980915.  [На компьютерах под управлением Windows Server 2003, Windows Vista, Windows Server 2008, Windows 7 или Windows Server 2008 R2 возникают длительные задержки при повторном соединении по протоколу IPSec](https://support.microsoft.com/kb/980915)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Да|Да|Да|**Протокол**|При использовании IPv6 рекомендуется изучить специфические сценарии, рассмотренные в статье 2578103 или 2578113 базы знаний, в зависимости от операционной системы Windows Server.<br /><br /> Если в топологии Windows Server используются IP-адреса версии 6 (IPv6), то службе кластеров WSFC требуется примерно 30 секунд для отработки отказа при обработке IP-адресов IPv6. При этом клиенту приходится ждать около 30 секунд для повторного соединения по IP-адресу IPv6.|KB 2578103 (Windows Server 2008): [Службе кластеров необходимо около 30 секунд для отработки отказа IP-адресов IPv6 на Windows Server 2008](https://support.microsoft.com/kb/2578103)<br /><br /> KB 2578113 (Windows Server 2008 R2): **Windows Server 2008 R2:** [Службе кластеров необходимо около 30 секунд для отработки отказа IP-адресов IPv6 на Windows Server 2008 R2](https://support.microsoft.com/kb/2578113)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Да|Да|Да|**Нет маршрутизатора между кластером и сервером приложений**|Если между отказоустойчивым кластером и сервером приложений нет маршрутизатора, то служба кластеров выполняет обработку отказа медленно для ресурсов, зависимых от сети. В результате этого возникнут задержки при повторном соединении клиентов после отработки отказа группой доступности. При отсутствии маршрутизатора рекомендуется изучить специфические сценарии, рассмотренные в статье 2582281 базы знаний, и установить исправление, если оно применимо к конкретной среде.|KB 2582281.  [Медленная отработка отказа при отсутствии маршрутизатора между кластером и сервером приложений](https://support.microsoft.com/kb/2582281)|  
  
###  <a name="ComputerRecommendations"></a> Рекомендации для компьютеров, на которых размещены реплики доступности (ОС Windows)  
  
-   **Сопоставимые системы.**  Для одной группы доступности все реплики доступности должны работать на сопоставимых системах, способных выдержать примерно одинаковую рабочую нагрузку.  
  
-   **Выделенные сетевые адаптеры**  . Для наилучшей производительности при использовании [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]используйте выделенный сетевой адаптер.  
  
-   **Достаточно свободного места на диске.**  Каждый компьютер, на котором экземпляр сервера содержит реплику доступности, должен иметь достаточно свободного места на диске для всех баз данных в группе доступности. Помните, что по мере роста баз данных-источников так же будут расти и соответствующие базы данных-получатели.  
  
###  <a name="PermissionsWindows"></a> Разрешения (ОС Windows)  
 Для администрирования кластера WSFC, пользователь должен быть администратором на каждом узле кластера.  
  
 Дополнительные сведения об учетной записи для администрирования кластера см. в [Приложении A. Требования к отказоустойчивому кластеру](https://technet.microsoft.com/library/dd197454\(WS.10\).aspx).  
  
###  <a name="RelatedTasksWindows"></a> Связанные задачи (ОС Windows)  
  
|Задача|Ссылка|  
|----------|----------|  
|Установите значение HostRecordTTL.|[Изменение параметра HostRecordTTL (с помощью Windows PowerShell)](#ChangeHostRecordTTLps)|  
  
####  <a name="ChangeHostRecordTTLps"></a> Изменение параметра HostRecordTTL (с помощью Windows PowerShell)  
  
1.  Откройте окно Powershell с помощью варианта **Запуск от имени администратора**.  
  
2.  Импортируйте модуль FailoverClusters.  
  
3.  С помощью командлета `Get-ClusterResource` найдите ресурс сетевого имени, затем с помощью командлета `Set-ClusterParameter` задайте значение `HostRecordTTL` следующим образом:  
  
     Get-ClusterResource " *\<имя_сетевого_ресурса>* " | Set-ClusterParameter HostRecordTTL *\<время_в_секундах>*  
  
     В следующем примере для PowerShell задается значение HostRecordTTL в 300 секунд для сетевого ресурса сетевого имени «`SQL Network Name (SQL35)`».  
  
    ```powershell
    Import-Module FailoverClusters  
  
    $nameResource = "SQL Network Name (SQL35)"  
    Get-ClusterResource $nameResource | Set-ClusterParameter ClusterParameter HostRecordTTL 300  
    ```  
  
    > [!TIP]  
    >  Каждый раз при открытии нового окна Powershell нужно импортировать модуль `FailoverClusters`.  
  
##### <a name="related-content-powershell"></a>См. также (PowerShell)  
  
-   [Кластеризация и высокая доступность](https://blogs.msdn.com/b/clustering/archive/2009/05/23/9636665.aspx) (блог группы отказоустойчивой кластеризации и балансировки сетевой нагрузки)  
  
-   [Приступая к работе с Windows PowerShell в отказоустойчивом кластере](https://technet.microsoft.com/library/ee619762\(WS.10\).aspx)  
  
-   [Команды ресурса кластера и соответствующие командлеты Windows PowerShell](https://msdn.microsoft.com/library/ee619744.aspx#BKMK_resource)  
  
###  <a name="RelatedContentWS"></a> См. также (система Windows)  
  
-   [Настройка параметров DNS для многосайтового отказоустойчивого кластера](https://technet.microsoft.com/library/dd197562\(WS.10\).aspx)  
  
-   [Регистрация DNS в ресурсе сетевого имени](https://blogs.msdn.com/b/clustering/archive/2009/07/17/9836756.aspx)  
  
-   [Отказоустойчивая кластеризация Windows 2008 R2 с несколькими сайтами](https://kiruba4u.blogspot.com/2012/03/failover-clustering-in-windows-server.html)  
  
##  <a name="ServerInstance"></a> Предварительные условия и ограничения для экземпляров SQL Server  
 Каждой группе доступности требуется набор партнеров по обеспечению отработки отказа, известных как *реплики доступности*, которые расположены в экземплярах [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. Данный экземпляр сервера может быть *изолированным экземпляром* или [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]*экземпляром отказоустойчивого кластера*.  
  
 
  
###  <a name="PrerequisitesSI"></a> Контрольный список: предварительные требования (экземпляр сервера)  
  
||Предварительные требования|Ссылки|  
|-|------------------|-----------|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Главный компьютер должен являться узлом отказоустойчивой кластеризации Windows Server (WSFC). Экземпляры [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , на которых размещаются реплики доступности для данной группы доступности, должны размещаться на отдельных узлах одного WSFC-кластера. Единственное исключение состоит в том, что при переносе в другой кластер WSFC группа доступности может временно находится в двух кластерах.|[Отказоустойчивая кластеризация Windows Server (WSFC) с SQL Server](../../../sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server.md)<br /><br /> [Отказоустойчивая кластеризация и &#40;группы доступности AlwaysOn SQL Server&#41;](failover-clustering-and-always-on-availability-groups-sql-server.md)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Если необходима группа доступности для работы с Kerberos:<br /><br /> Все экземпляры сервера, на которых размещена реплика доступности для группы доступности, должны использовать одинаковые учетные записи службы SQL Server.<br /><br /> Администратору домена необходимо вручную зарегистрировать имя участника-службы (SPN) с помощью службы каталогов Active Directory на учетной записи службы SQL Server для виртуального сетевого имени (VNN) прослушивателя группы доступности. Если имя участника-службы (SPN) зарегистрировано на учетной записи, отличной от учетной записи службы SQL Server, то проверку подлинности пройти не удастся.<br /><br /> **\*\* Важно! \*\*** При изменении учетной записи службы SQL Server администратору домена необходимо вручную повторно зарегистрировать имя субъекта-службы (SPN).|[Регистрация имени участника-службы для соединений Kerberos](../../configure-windows/register-a-service-principal-name-for-kerberos-connections.md)<br /><br /> **Краткое описание:**<br /><br /> Kerberos и имена участников-служб обеспечивают взаимную проверку подлинности. Имя участника-службы (SPN) сопоставляется с учетной записью Windows, которая запускает службы SQL Server. Если регистрация имени участника-службы (SPN) не была выполнена должным образом или завершилась неудачно, уровень безопасности Windows не может определить учетную запись, связанную с именем участника-службы, и проверка подлинности Kerberos не может использоваться.<br /><br /> Примечание. Для NTLM нет таких требований.|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Если вы планируете использовать экземпляр отказоустойчивого кластера [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] для размещения реплики доступности, убедитесь, что понимаете ограничения, связанные с использованием отказоустойчивых кластеров, и что требования для создания такого кластера удовлетворены.|[Необходимые условия и требования, связанные с использованием экземпляра отказоустойчивого кластера SQL Server для размещения реплики доступности](#FciArLimitations) (далее в этом разделе)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|На каждом экземпляре сервера должен быть установлен выпуск [!INCLUDE[ssCurrent](../../../includes/sscurrent-md.md)]Enterprise Edition.|[Возможности, поддерживаемые различными выпусками SQL Server 2014](../../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Все экземпляры сервера, на которых размещены реплики доступности для одной группы доступности, должны использовать одинаковые параметры сортировки [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].|[Задание или изменение параметров сортировки сервера](../../../relational-databases/collations/set-or-change-the-server-collation.md)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Необходимо включить функцию [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] на каждом экземпляре сервера, на котором будет размещена реплика доступности для группы доступности. На одном компьютере можно включить столько экземпляров серверов, поддерживающих [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)], сколько поддерживает установка [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].|[Включение и отключение групп доступности AlwaysOn (SQL Server)](enable-and-disable-always-on-availability-groups-sql-server.md)<br /><br /> **\*\* Важно! \*\*** При удалении и повторном создании кластера WSFC необходимо отключить и повторно включить функцию [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] в каждом экземпляре сервера, в котором была включена функция [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] в исходном кластере WSFC.|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Каждый экземпляр сервера должен иметь конечную точку зеркального отображения базы данных. Обратите внимание, что эта конечная точка совместно используется всеми репликами доступности и участниками зеркального отображения базы данных на этом экземпляре сервера.<br /><br /> Если экземпляр сервера, выбранный для размещения реплики доступности, работает под доменной учетной записью и еще не содержит конечной точки зеркального отображения базы данных, то [мастер создания группы доступности](use-the-availability-group-wizard-sql-server-management-studio.md) (или [мастер добавления реплики в группу доступности](use-the-add-replica-to-availability-group-wizard-sql-server-management-studio.md)) может создать конечную точку и предоставить учетной записи службы экземпляра сервера разрешение CONNECT, если этот экземпляр запускается с учетной записью службы домена. Но если служба [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] запущена от имени встроенной учетной записи, такой как «Локальная система», «Локальная служба» или «Сетевая служба», или от имени учетной записи, не входящей в домен, то для проверки подлинности конечных точек необходимо пользоваться сертификатами, а мастер не сможет создать точку зеркального отображения базы данных на этом экземпляре сервера. В этом случае рекомендуется создавать конечные точки зеркального отображения базы данных вручную до запуска мастера.<br /><br /> **\*\* Примечание по безопасности \*\*** . Механизм безопасности транспорта для [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] такой же, как и при зеркальном отображении базы данных.|[Конечная точка зеркального отображения базы данных (SQL Server)](../../database-mirroring/the-database-mirroring-endpoint-sql-server.md)<br /><br /> [Безопасность транспорта для зеркального отображения базы данных &#40;и SQL Server группы доступности AlwaysOn&#41;](../../database-mirroring/transport-security-database-mirroring-always-on-availability.md)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Если в группу доступности будут добавляться любые базы данных, использующие FILESTREAM, убедитесь, что функция FILESTREAM включена на каждом экземпляре сервера, на котором планируется разместить реплику доступности.|[Enable and Configure FILESTREAM](../../../relational-databases/blob/enable-and-configure-filestream.md)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Если в группу доступности будут добавляться любые автономные базы данных, то убедитесь, что параметру сервера `contained database authentication` присвоено значение `1` на каждом экземпляре, где планируется разместить реплику доступности.|[Параметр конфигурации сервера «contained database authentication»](../../configure-windows/contained-database-authentication-server-configuration-option.md)<br /><br /> [Параметры конфигурации сервера (SQL Server)](../../configure-windows/server-configuration-options-sql-server.md)|  
  
###  <a name="ThreadUsage"></a> Использование потока группами доступности  
 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] предъявляет к рабочим потокам следующие требования.  
  
-   На простаивающем экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] используется 0 потоков.  
  
-   Максимальное число потоков, используемых для групп доступности, — это заданный настройками параметр максимального числа потоков сервера («`max worker threads`») минус 40.  
  
-   Реплики доступности, размещенные на конкретном экземпляре сервера, совместно используют один пул потоков.  
  
     Потоки совместно используются по требованию следующим образом.  
  
    -   Обычно имеется 3–10 общих потоков, но это число может возрасти в зависимости от рабочей нагрузки первичной реплики.  
  
    -   Если заданный поток в течение определенного периода времени простаивает, то он возвращается в общий пул потоков [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] . Обычно неактивный поток освобождается примерно через 15 секунд неактивности. Однако в зависимости от последней активности бездействующий поток может сохраняться дольше.  
  
-   Кроме того, группы доступности используют неразделенные потоки следующим образом.  
  
    -   Каждая первичная реплика использует по одному потоку для записи журнала в каждой базе данных-источнике. Кроме того, она использует по одному потоку для отправки журнала в каждой из баз данных-получателей. Потоки отправки журнала освобождаются примерно через 15 секунд неактивности.  
  
    -   Для каждой из баз данных-получателей используется один поток повтора в каждой из баз данных-получателей. Потоки повтора освобождаются примерно через 15 секунд неактивности.  
  
    -   Резервное копирование на вторичной реплике удерживает поток на первичной реплике на время операции резервного копирования.  
  
 Дополнительные сведения см. в разделе [Обучающая серия AlwaysOn — HADRON: использование рабочего пула для баз данных с поддержкой HADRON](https://blogs.msdn.com/b/psssql/archive/2012/05/17/alwayson-hadron-learning-series-worker-pool-usage-for-hadron-enabled-databases.aspx) (блог инженеров CSS [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]).  
  
###  <a name="PermissionsSI"></a> Разрешения (экземпляр сервера)  
  
|Задача|Необходимые разрешения|  
|----------|--------------------------|  
|Создание конечной точки зеркального отображения базы данных|Требуется разрешение CREATE ENDPOINT или членство в предопределенной роли сервера **sysadmin** .  Также требуется разрешение CONTROL ON ENDPOINT. Дополнительные сведения см. в разделе [GRANT, предоставление разрешений конечной точке (Transact-SQL)](/sql/t-sql/statements/grant-endpoint-permissions-transact-sql).|  
|Включение [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]|Требуется членство в группе **Администратор** на локальном компьютере и полный контроль над кластером WSFC.|  
  
###  <a name="RelatedTasksSI"></a> Связанные задачи (экземпляр сервера)  
  
|Задача|Раздел|  
|----------|-----------|  
|Определение наличия конечной точки зеркального отображения базы данных|[sys.database_mirroring_endpoints (Transact-SQL)](/sql/relational-databases/system-catalog-views/sys-database-mirroring-endpoints-transact-sql)|  
|Создание конечной точки зеркального отображения базы данных (если она еще не существует)|[Создание конечной точки зеркального отображения базы данных с проверкой подлинности Windows (Transact-SQL)](../../database-mirroring/create-a-database-mirroring-endpoint-for-windows-authentication-transact-sql.md)<br /><br /> [Использование сертификатов для конечной точки зеркального отображения базы данных (Transact-SQL)](../../database-mirroring/use-certificates-for-a-database-mirroring-endpoint-transact-sql.md)<br /><br /> [Создание конечной точки зеркального отображения базы данных &#40;для группы доступности AlwaysOn SQL Server PowerShell&#41;](database-mirroring-always-on-availability-groups-powershell.md)|  
|Включение функции «Группы доступности AlwaysOn»|[Включение и отключение групп доступности AlwaysOn (SQL Server)](enable-and-disable-always-on-availability-groups-sql-server.md)|  
  
###  <a name="RelatedContentSI"></a> См. также (экземпляр сервера)  
  
-   [Учебные серии AlwaysON — HADRON. Использование пула рабочих ролей для баз данных с поддержкой HADRON](https://blogs.msdn.com/b/psssql/archive/2012/05/17/alwayson-hadron-learning-series-worker-pool-usage-for-hadron-enabled-databases.aspx)  
  
##  <a name="NetworkConnect"></a> Рекомендации по сетевым возможностям подключения  
 Настоятельно рекомендуется использовать одни и те же сетевые соединения для обмена данными между членами кластера WSFC и репликами доступности.  Использование отдельных сетевых соединений может привести к непредвиденному поведению в случае отказа даже некоторых из них.  
  
 Например, чтобы группа доступности поддерживала автоматический переход на другой ресурс, вторичная реплика, которая является участником обработки отказа, должна находиться в состоянии SYNCHRONIZED. В случае отказа (даже временного) сетевого соединения с этой вторичной репликой она переходит в состояние UNSYNCHRONIZED и не может начать повторную синхронизацию до тех пор, пока соединение не будет восстановлено. Если кластер WSFC запрашивает автоматический переход на другой ресурс, пока вторичная реплика не синхронизирована, то автоматический переход на другой ресурс не выполняется.  
  
##  <a name="ClientConnSupport"></a> Поддержка возможности подключения клиента  
 Сведения о поддержке [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] для подключения клиентов см. в разделе [подключение клиента AlwaysOn (SQL Server)](always-on-client-connectivity-sql-server.md).  
  
##  <a name="FciArLimitations"></a> Предварительные условия и ограничения, связанные с использованием экземпляра отказоустойчивого кластера SQL Server для размещения реплики доступности  
 
  
###  <a name="RestrictionsFCI"></a> Ограничения (экземпляры отказоустойчивого кластера)  
  
> [!NOTE]  
>  Начиная с версии [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)], экземпляры отказоустойчивого кластера AlwaysOn поддерживают кластерные общие тома (CSV) как в [!INCLUDE[winserver2008r2](../../../includes/winserver2008r2-md.md)], так и в [!INCLUDE[win8srv](../../../includes/win8srv-md.md)]. Дополнительные сведения о CSV-файле см. в разделе [Основные сведения о кластерных общих томах в отказоустойчивом кластере](https://technet.microsoft.com/library/dd759255.aspx).  
  
-   **На узле кластера FCI может быть размещена только одна реплика для одной группы доступности.**  При добавлении в FCI реплики доступности узлы кластера WSFC, которые являются возможными владельцами FCI, не могут содержать другую реплику той же группы доступности.  
  
     Более того, каждая реплика должна быть размещена на экземпляре SQL Server 2012, который находится на отдельном узле WSFC того же кластера WSFC. Единственное исключение состоит в том, что при переносе в другой кластер WSFC группа доступности может временно находится в двух кластерах.  
  
-   **FCI не поддерживают автоматический переход на другой ресурс для групп доступности.**  FCI не поддерживают автоматический переход на другой ресурс для групп доступности, поэтому любая реплика доступности, размещенная в FCI, может быть настроена только для перехода на другой ресурс вручную.  
  
-   **Изменение сетевого имени отказоустойчивого кластера FCI.**  Если необходимо изменить сетевое имя FCI, на котором размещена реплика доступности, то сначала необходимо удалить эту реплику из группы доступности, а затем вернуть ее обратно в эту же группу доступности. Удалить основную реплику нельзя, поэтому при переименовании экземпляра отказоустойчивого кластера, на котором размещена основная реплика, необходимо выполнить отработку отказа на вторичную реплику, удалить из группы доступности основную реплику и добавить ее снова. Обратите внимание, что переименование FCI может привести к изменению URL-адреса конечной точки зеркального отображения базы данных. При добавлении реплики убедитесь, что указываете URL-адрес текущей конечной точки.  
  
###  <a name="PrerequisitesFCI"></a> Контрольный список: предварительные требования FCI)  
  
||Предварительные требования|Ссылка|  
|-|------------------|----------|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Перед использованием экземпляра отказоустойчивого кластера для размещения реплики доступности убедитесь, что администратор системы установил исправление для Windows Server 2008, описанное в статье базы знаний KB 976097. Это исправление включает оснастку консоли управления (MMC) отказоустойчивого кластера для поддержки асимметричных общих дисков хранилища, доступных только на некоторых узлах WSFC.|Статья базы знаний 976097: [Исправление, предназначенное для добавления функции поддержки асимметричных систем хранения данных в оснастку MMC управления отказоустойчивым кластером для отказоустойчивых кластеров под управлением ОС Windows Server 2008 или Windows Server 2008 R2](https://support.microsoft.com/kb/976097)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Убедитесь, что каждый экземпляр отказоустойчивого кластера SQL Server обладает требуемым пространством хранения, как и в случае со стандартным экземпляром отказоустойчивого кластера SQL Server.||  
  
###  <a name="RelatedTasksFCIs"></a> Связанные задачи (FCI)  
  
|Задача|Раздел|  
|----------|-----------|  
|Установка отказоустойчивого кластера SQL Server|[Создание отказоустойчивого кластера SQL Server (программа установки)](../../../sql-server/failover-clusters/install/create-a-new-sql-server-failover-cluster-setup.md)|  
|Обновление существующего отказоустойчивого кластера SQL Server на месте|[Обновление экземпляра отказоустойчивого кластера SQL Server (программа установки)](../../../sql-server/failover-clusters/windows/upgrade-a-sql-server-failover-cluster-instance-setup.md)|  
|Обслуживание существующего отказоустойчивого кластера SQL Server|[Добавление или удаление узлов в отказоустойчивом кластере SQL Server (программа установки)](../../../sql-server/failover-clusters/install/add-or-remove-nodes-in-a-sql-server-failover-cluster-setup.md)|  
  
###  <a name="RelatedContentFCIs"></a> См. также (FCI)  
  
-   [Отказоустойчивая кластеризация и &#40;группы доступности AlwaysOn SQL Server&#41;](failover-clustering-and-always-on-availability-groups-sql-server.md)  
  
-   [Руководство по архитектуре AlwaysOn. Создание решения для обеспечения высокого уровня доступности и аварийного восстановления с помощью экземпляров отказоустойчивого кластера и групп доступности](https://technet.microsoft.com/library/jj215886.aspx)  
  
##  <a name="PrerequisitesForAGs"></a> Обязательные условия и ограничения для группы доступности  

  
###  <a name="RestrictionsAG"></a> Ограничения (группы доступности)  
  
-   **Реплики доступности должны размещаться на разных узлах одного кластера WSFC.**  Для каждой группы доступности реплики доступности должны находиться на разных экземплярах сервера, работающих на разных узлах одного и того же кластера WSFC. Единственное исключение состоит в том, что при переносе в другой кластер WSFC группа доступности может временно находится в двух кластерах.  
  
    > [!NOTE]  
    >  На каждой виртуальной машине на одном физическом компьютере может размещаться реплика доступности для одной и той же группы доступности, так как каждая виртуальная машина работает как отдельный компьютер.  
  
-   **Уникальное имя группы доступности.**  Имя каждой группы доступности должно быть уникальным в пределах кластера WSFC. Максимальная длина имени группы доступности составляет 128 символов.  
  
-   **Реплики доступности.**  Каждая группа доступности поддерживает одну первичную реплику и до восьми вторичных реплик. Все реплики могут выполняться в режиме асинхронной фиксации или до трех из них могут работать в режиме синхронной фиксации (одна первичная реплика с двумя синхронными вторичными репликами).  
  
-   **Максимальное количество групп доступности и баз данных доступности на компьютер** . Фактическое количество баз данных и групп доступности, которые можно разместить на компьютере (физической или виртуальной машине), зависит от оборудования и загрузки, но какое-либо строгое ограничение отсутствует. В корпорации Майкрософт проводились интенсивные испытания 10 групп доступности и 100 баз данных на один физический компьютер. К символам перегрузки систем могут относиться, помимо прочего, исчерпание ресурса рабочего потока, увеличенное время ответа для системных представлений и динамических административных представлений AlwaysOn и/или остановка дампов системы диспетчера. Обязательно проведите тщательное тестирование среды с рабочей нагрузкой, чтобы убедиться, что система в состоянии обрабатывать пиковую нагрузку в рамках соглашений об уровне обслуживания приложений. При рассмотрении соглашений об уровне обслуживания обязательно проверяйте нагрузку в условиях сбоя, а также ожидаемое время ответа.  
  
-   **Не используйте диспетчер отказоустойчивости кластеров для управления группами доступности.**  
  
     Пример:  
  
    -   Не изменяйте свойства групп доступности, такие как список возможных владельцев.  
  
    -   Не используйте диспетчер отказоустойчивости кластеров для переключения групп доступности. Необходимо использовать [!INCLUDE[tsql](../../../includes/tsql-md.md)] или среду [!INCLUDE[ssManStudioFull](../../../includes/ssmanstudiofull-md.md)].  
  
###  <a name="RequirementsAG"></a> Предварительные условия (группы доступности)  
 При создании или повторной настройке конфигурации групп доступности обязательно следуйте описанным ниже требованиям.  
  
||Предварительные требования|Описание|  
|-|------------------|-----------------|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Если вы планируете использовать экземпляр отказоустойчивого кластера [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] для размещения реплики доступности, убедитесь, что понимаете ограничения, связанные с использованием отказоустойчивых кластеров, и что требования для создания такого кластера удовлетворены.|[Предварительные условия и ограничения, связанные с использованием экземпляра отказоустойчивого кластера SQL Server для размещения реплики доступности](#FciArLimitations) (ранее в этом разделе)|  
  
###  <a name="SecurityAG"></a> Безопасность (группы доступности)  
  
-   Параметры безопасности наследуются от отказоустойчивой кластеризации WSFC. Кластер WSFC обеспечивает два уровня безопасности пользователей на уровне детализации всех API-интерфейсов кластера WSFC.  
  
    -   Доступ только для чтения.  
  
    -   Полный доступ  
  
         [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] должен обладать всеми возможностями управления, поэтому использование [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] в экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] дает ему полный контроль над кластером WSFC (через идентификатор безопасности службы).  
  
         Нельзя напрямую повышать или снижать уровень безопасности для экземпляра сервера средствами диспетчера отказоустойчивого кластера WSFC. Для управления сеансами безопасности WSFC следует использовать диспетчер конфигураций [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] или эквивалент WMI из [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].  
  
-   Каждый экземпляр [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] должен иметь разрешения для доступа к реестру, кластеру и т. д.  
  
-   Для подключений между экземплярами сервера, на которых размещаются реплики доступности [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] , рекомендуется использовать шифрование.  
  
#### <a name="permissions-availability-groups"></a>Разрешения (группы доступности)  
  
|Задача|Необходимые разрешения|  
|----------|--------------------------|  
|Создание группы доступности|Требуется членство в фиксированной роли сервера **sysadmin** и одно из разрешений: CREATE AVAILABILITY GROUP, ALTER ANY AVAILABILITY GROUP или CONTROL SERVER.|  
|Изменение группы доступности.|Необходимо разрешение ALTER AVAILABILITY GROUP для группы доступности, разрешение CONTROL AVAILABILITY GROUP, разрешение ALTER ANY AVAILABILITY GROUP или разрешение CONTROL SERVER.<br /><br /> Кроме того, для присоединения базы данных к группе доступности требуется членство в предопределенной роли базы данных **db_owner** .|  
|Удаление группы доступности|Необходимо разрешение ALTER AVAILABILITY GROUP для группы доступности, разрешение CONTROL AVAILABILITY GROUP, разрешение ALTER ANY AVAILABILITY GROUP или разрешение CONTROL SERVER. Для удаления группы доступности, которая не размещена в локальной реплике, необходимо разрешение CONTROL SERVER или разрешение CONTROL на эту группу доступности.|  
  
###  <a name="RelatedTasksAGs"></a> Связанные задачи (группы доступности)  
  
|Задача|Раздел|  
|----------|-----------|  
|Создание группы доступности|[Использование группы доступности (мастер создания группы доступности)](use-the-availability-group-wizard-sql-server-management-studio.md)<br /><br /> [Создание группы доступности (Transact-SQL)](create-an-availability-group-transact-sql.md)<br /><br /> [Создание группы доступности (SQL Server PowerShell)](../../../powershell/sql-server-powershell.md)<br /><br /> [Указание URL-адреса конечной точки при добавлении или изменении реплики доступности (SQL Server)](specify-endpoint-url-adding-or-modifying-availability-replica.md)|  
|Изменение числа реплик доступности|[Добавление вторичной реплики к группе доступности (SQL Server)](add-a-secondary-replica-to-an-availability-group-sql-server.md)<br /><br /> [Присоединение вторичной реплики к группе доступности (SQL Server)](join-a-secondary-replica-to-an-availability-group-sql-server.md)<br /><br /> [Удаление вторичной реплики из группы доступности (SQL Server)](remove-a-secondary-replica-from-an-availability-group-sql-server.md)|  
|Создание прослушивателя группы доступности|[Создание или настройка прослушивателя группы доступности (SQL Server)](create-or-configure-an-availability-group-listener-sql-server.md)|  
|Удаление группы доступности|[Удаление группы доступности (SQL Server)](remove-an-availability-group-sql-server.md)|  
  
##  <a name="PrerequisitesForDbs"></a> Обязательные условия и ограничения для базы данных доступности  
 Для добавления в группу доступности база данных должна соответствовать следующим предварительным условиям и ограничениям.  
  
 
  
###  <a name="RequirementsDb"></a> Контрольный список: требования (базы данных доступности)  
 Для добавления в группу доступности база данных должна соответствовать следующим требованиям.  
  
||Требования|Ссылка|  
|-|------------------|----------|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Быть пользовательской базой данных. Системные базы данных не могут принадлежать к группе доступности.||  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Находиться на экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , на котором создана группа доступности, и быть доступной для экземпляра сервера.||  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Быть базой, доступной для чтения и записи. Базы данных только для чтения не могут быть добавлены в группу доступности.|[sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) (**is_read_only** = 0)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Быть многопользовательской базой данных.|[sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) (**user_access** = 0)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Не использовать параметр AUTO_CLOSE.|[sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) (**is_auto_close_on** = 0)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Используйте модель полного восстановления (также известную как режим полного восстановления).|[sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) (**recovery_model** = 1)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Необходима по крайней мере одна полная резервная копия базы данных.<br /><br /> Примечание. После переключения базы данных в режим полного восстановления потребуется создать полную резервную копию для включения цепочки журналов полного восстановления.|[Создание полной резервной копии базы данных (SQL Server)](../../../relational-databases/backup-restore/create-a-full-database-backup-sql-server.md)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Не принадлежать ни к одной другой группе доступности.|[sys.databases](/sql/relational-databases/system-catalog-views/sys-databases-transact-sql) (**group_database_id** = NULL)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Не быть настроенной для зеркального отображения базы данных.|[sys.database_mirroring](/sql/relational-databases/system-catalog-views/sys-database-mirroring-transact-sql) (если база данных не участвует в зеркальном отображении, все столбцы с префиксом "mirroring_" имеют значение NULL)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Перед добавлением в группу доступности базы данных, в которой используется FILESTREAM, следует убедиться, что FILESTREAM поддерживается на всех экземплярах серверов, на которых размещены или будут размещены реплики доступности для группы доступности.|[Enable and Configure FILESTREAM](../../../relational-databases/blob/enable-and-configure-filestream.md)|  
|![Установка](../../media/checkboxemptycenterxtraspacetopandright.gif "Checkbox")|Перед добавлением автономной базы данных в группу доступности, убедитесь, что параметру сервера `contained database authentication` присвоено значение `1` на каждом экземпляре, на котором размещена или будет размещена реплика доступности.|[Параметр конфигурации сервера «contained database authentication»](../../configure-windows/contained-database-authentication-server-configuration-option.md)<br /><br /> [Параметры конфигурации сервера (SQL Server)](../../configure-windows/server-configuration-options-sql-server.md)|  
  
> [!NOTE]  
>  [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] работает с любым поддерживаемым уровнем совместимости базы данных.  
  
###  <a name="RestrictionsDb"></a> Ограничения (базы данных доступности)  
  
-   Если путь к файлу (в том числе буква диска) базы данных-получателя отличается от пути в соответствующей базе данных-источнике, применимы следующие ограничения.  
  
    -   **[!INCLUDE[ssAoNewAgWiz](../../../includes/ssaonewagwiz-md.md)]/[!INCLUDE[ssAoAddDbWiz](../../../includes/ssaoadddbwiz-md.md)]:**  Параметр **Полная** не поддерживается (на странице[Выбор начальной синхронизации данных](select-initial-data-synchronization-page-always-on-availability-group-wizards.md) ).  
  
    -   **RESTORE WITH MOVE:**  чтобы создать базы данных-получатели, файлы базы данных должны обладать атрибутом RESTORED WITH MOVE на каждом экземпляре [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , на котором размещена вторичная реплика.  
  
    -   **Воздействие на операции добавления файлов.**  Операция добавления файлов, выполняемая позднее в основной реплике, может завершиться неудачей в базах данных-получателях. Эта ошибка может вызвать приостановку работы баз данных-получателей. Это, в свою очередь, вызовет переход дополнительных реплик в состояние NOT SYNCHRONIZING.  
  
        > [!NOTE]  
        >  Дополнительные сведения об отсутствии отклика на неудачную операцию добавления файла см. в разделе [Устранение неполадок с операцией добавления файла, давшей сбой (группы доступности AlwaysOn)](troubleshoot-a-failed-add-file-operation-always-on-availability-groups.md).  
  
-   Нельзя удалить базу данных, которая принадлежит какой-либо группе доступности.  
  
###  <a name="TDEdbs"></a> Дальнейшие действия для баз данных, защищаемых прозрачным шифрованием  
 Если используется прозрачное шифрование данных (TDE), то сертификат или асимметричный ключ службы для создания и расшифровки других ключей должен быть одинаков на всех экземплярах сервера, где размещены реплики группы доступности. Дополнительные сведения см. в разделе [Перемещение базы данных, защищаемой прозрачным шифрованием, в другой экземпляр SQL Server](../../../relational-databases/security/encryption/move-a-tde-protected-database-to-another-sql-server.md).  
  
###  <a name="PermissionsDbs"></a> Разрешения (базы данных доступности)  
 Необходимо разрешение ALTER на базу данных.  
  
###  <a name="RelatedTasksADb"></a> Связанные задачи (базы данных доступности)  
  
|Задача|Раздел|  
|----------|-----------|  
|Подготовка базы данных-получателя (вручную)|[Подготовка базы данных-получателя для присоединения к группе доступности вручную (SQL Server)](manually-prepare-a-secondary-database-for-an-availability-group-sql-server.md)|  
|Присоединение базы данных-получателя к группе доступности (вручную)|[Присоединение базы данных-получателя к группе доступности (SQL Server)](join-a-secondary-database-to-an-availability-group-sql-server.md)|  
|Изменение числа баз данных доступности|[Добавление базы данных в группу доступности (SQL Server)](availability-group-add-a-database.md)<br /><br /> [Удаление базы данных-получателя из группы доступности (SQL Server)](remove-a-secondary-database-from-an-availability-group-sql-server.md)<br /><br /> [Удаление базы данных-источника из группы доступности (SQL Server)](remove-a-primary-database-from-an-availability-group-sql-server.md)|  
  
##  <a name="RelatedContent"></a> См. также  
  
-   [Microsoft SQL Server рекомендации по решениям AlwaysOn для обеспечения высокого уровня доступности и аварийного восстановления](https://go.microsoft.com/fwlink/?LinkId=227600)  
  
-   [Блог группы SQL Server AlwaysOn: Официальный блог группы SQL Server AlwaysOn](https://blogs.msdn.com/b/sqlalwayson/)  
  
-   [Учебные серии AlwaysON — HADRON. Использование пула рабочих ролей для баз данных с поддержкой HADRON](https://blogs.msdn.com/b/psssql/archive/2012/05/17/alwayson-hadron-learning-series-worker-pool-usage-for-hadron-enabled-databases.aspx)  
  
## <a name="see-also"></a>См. также статью  
 [Общие сведения о &#40;группы доступности AlwaysOn&#41; SQL Server](overview-of-always-on-availability-groups-sql-server.md)   
 [Отказоустойчивая кластеризация и &#40;группы доступности AlwaysOn&#41; SQL Server](failover-clustering-and-always-on-availability-groups-sql-server.md)   
 [Подключение клиента AlwaysOn (SQL Server)](always-on-client-connectivity-sql-server.md)  
  
  
