---
title: Адаптера для облака для SQL Server | Документация Майкрософт
ms.custom: ''
ms.date: 03/09/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: database-engine
ms.topic: conceptual
helpviewer_keywords:
- Cloud adapter
- Deploy to Windows Azure
ms.assetid: 82ed0d0f-952d-4d49-aa36-3855a3ca9877
author: mashamsft
ms.author: mathoma
manager: craigg
ms.openlocfilehash: a2ddaf87aa91e62cc422bf5a4558232f03339121
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "66065146"
---
# <a name="cloud-adapter-for-sql-server"></a>Адаптер для облака для SQL Server
  Служба Cloud Adapter создается в ходе провизионирования [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] на виртуальной машине Windows Azure. Служба адаптера для облака создает самозаверяющий SSL-сертификат в рамках своего первого запуска, а затем запускается от имени учетной записи **Local System** . Она создает файл конфигурации, который используется для ее настройки. Служба адаптера для облака также создает правило брандмауэра Windows для разрешения входящих TCP-подключений на стандартный порт 11435.  
  
 Служба Cloud Adapter — это синхронная служба без сохранения состояния, которая получает сообщения из локального экземпляра [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]. Когда служба адаптера для облака останавливается, она останавливает адаптер для облака удаленного доступа, отменяет привязку SSL-сертификата и отключает правило брандмауэра Windows.  
  
## <a name="cloud-adapter-requirements"></a>Требования для адаптера для облака  
 Обратите внимание на следующие требования для установки, включения и запуска Cloud Adapter для [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].  
  
-   Cloud Adapter поддерживается в [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012 и более поздних версиях. В [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012 службе Cloud Adapter для [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] требуются объекты SMO для [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 2012.  
  
-   Веб-служба адаптера для облака запускается в учетной записи **Local System** и проверяет учетные данные клиента до выполнения любой задачи. Предоставленные клиентом учетные данные должны принадлежать использовать учетную запись, которая является членом локальной группы **Администраторы** группы на удаленном компьютере.  
  
-   Служба Cloud Adapter поддерживает только проверку подлинности [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] .  
  
-   Cloud Adapter использует учетную запись администратора локальной виртуальной машины для выполнения команд на локальном компьютере, а не учетную запись sa.  
  
-   Адаптер для облака прослушивает порт TCP/IP. По умолчанию используется порт 11435.  
  
-   Адаптер для облака должен иметь разрешения на создание и изменение правил брандмауэра Windows.  
  
## <a name="cloud-adapter-configuration-settings"></a>Параметры конфигурации адаптера для облака  
 Используйте следующую конфигурацию, чтобы изменить параметры адаптера для облака.  
  
-   **Путь по умолчанию для файла конфигурации** — C:\Program Files\Microsoft SQL Server\120\Tools\CloudAdapter\  
  
-   **Параметры файла конфигурации** -  
  
    -   \<конфигурации >  
  
        -   \<appSettings >  
  
            -   \<add key="WebServicePort" value="" />  
  
            -   \<add key="WebServiceCertificate" value="GUID" />  
  
            -   \<add key="ExposeExceptionDetails" value="true" />  
  
        -   \</appSettings >  
  
    -   \</Configuration >  
  
-   **Данные сертификата** — сертификат имеет следующие значения:  
  
    -   Subject — «CN = CloudAdapter\<VMName >, DC = SQL Server, DC = Microsoft»  
  
    -   Для сертификата должно быть включено только расширенное использование ключей проверки подлинности на сервере.  
  
    -   Длина ключа сертификата — 2048.  
  
 **Значения файла конфигурации**:  
  
|Параметр|Значения|Значение по умолчанию|Комментарии|  
|-------------|------------|-------------|--------------|  
|WebServicePort|1-65535|11435|Если не указано, используется 11435.|  
|WebServiceCertificate|Thumbprint|Пустой|Если не указано, формируется новый самозаверяющий сертификат.|  
|ExposeExceptionDetails|True/False|False||  
  
## <a name="cloud-adapter-troubleshooting"></a>Устранение неполадок адаптера для облака  
 Используйте следующие сведения для устранения неполадок со службой Cloud Adapter для [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)].  
  
-   **Обработка ошибок и ведение журнала** -ошибки и сообщения о состоянии записываются в журнал событий приложений.  
  
-   **Трассировка, события** -все события записываются в журнал событий приложений.  
  
-   **Управление, конфигурация** — использовать файл конфигурации, расположенный в:  C:\Program Files\Microsoft SQL Server\120\Tools\CloudAdapter\\.  
  
|Ошибка|Идентификатор ошибки|Причина|Решение|  
|-----------|--------------|-----------|----------------|  
|Возникло исключение при добавлении сертификата в хранилище сертификатов. {Текст исключения}|45560|Разрешения на доступ к хранилищу сертификатов компьютера|Убедитесь, что служба Cloud Adapter имеет разрешения на добавление сертификатов в хранилище сертификатов компьютера.|  
|Возникло исключение при попытке настройки SSL-привязки для порта {номер порта} сертификата {отпечаток}. {Исключение}.|45561|Другое приложение уже использует порт или привязало к нему сертификат.|Удалите существующие привязки или измените порт адаптера для облака в файле конфигурации.|  
|Не удалось найти SSL-сертификат [{отпечаток}] в хранилище сертификатов.|45564|Отпечаток сертификата находится в файле конфигурации, но хранилище личных сертификатов для службы не содержит сертификат.<br /><br /> Недостаточно разрешений.|Убедитесь, что сертификат находится в хранилище личных сертификатов для службы.<br /><br /> Убедитесь, что служба имеет необходимые разрешения для хранилища.|  
|Не удалось запустить веб-службу. {Текст исключения}|45570|Описано в исключении.|Включите ExposeExceptionDetails и используйте расширенные сведения из исключения.|  
|Истек срок действия сертификата [{отпечаток}].|45565|У сертификата, указанного в файле конфигурации, истек срок действия.|Добавьте действительный сертификат и добавьте в файл конфигурации его отпечаток.|  
|Ошибка веб-службы: {0}.|45571|Описано в исключении.|Включите ExposeExceptionDetails и используйте расширенные сведения из исключения.|  
  
## <a name="see-also"></a>См. также  
 [Развертывание базы данных SQL Server на виртуальной машине Microsoft Azure](../relational-databases/databases/deploy-a-sql-server-database-to-a-microsoft-azure-virtual-machine.md)  
  
  
