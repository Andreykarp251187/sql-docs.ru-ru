---
title: Использование переменных в пакетах | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- user-defined variables [Integration Services]
- variables [Integration Services], use scenarios
- system variables [Integration Services]
ms.assetid: 7742e92d-46c5-4cc4-b9a3-45b688ddb787
author: janinezhang
ms.author: janinez
manager: craigg
ms.openlocfilehash: 96bfbf87789aa1d683b6368f210539a191f7ee95
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "66054692"
---
# <a name="use-variables-in-packages"></a>Использование переменных в пакетах
  Переменные — полезное и гибкое дополнение к пакетам служб [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] ; переменные могут обеспечивать взаимодействие между объектами в пакете и между родительскими и дочерними пакетами. Переменные также можно использовать в выражениях и скриптах.  
  
## <a name="user-defined-variables-and-system-variables"></a>Пользовательские и системные переменные  
 Службы [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] предоставляют системные переменные и поддерживают работу с пользовательскими. При создании нового пакета, добавлении в него контейнера или задачи или создании обработчика событий служб [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] включает в контейнер набор системных переменных. Системные переменные хранят полезную информацию о пакете, контейнере, задаче или обработчике событий. Например, во время выполнения системная переменная **MachineName** хранит имя компьютера, на котором запущен пакет, а переменная **StartTime** — время начала выполнения пакета. Системные переменные доступны только для чтения. Дополнительные сведения см. в статье [System Variables](system-variables.md).  
  
 Можно создавать пользовательские переменные и задействовать их в пакетах. Пользовательские переменные могут использоваться в службах [!INCLUDE[ssIS](../includes/ssis-md.md)]различными способами: в скриптах, в выражениях, использующих элементы управления очередностью, в контейнере "цикл по элементам", в преобразованиях "Производный столбец" и "Условное разбиение" и в выражениях, обновляющих значения свойств.  
  
 Например, пользовательскую переменную можно задействовать в вычислении условия для контейнера «цикл по элементам». Можно также сопоставить значение перечислителя коллекции в контейнере «цикл по каждому элементу» с переменной, а если задача «Выполнение SQL» содержит параметризованную инструкцию, то можно сопоставить параметры инструкции с переменными. Дополнительные сведения см. в разделе [Переменные служб Integration Services (SSIS)](integration-services-ssis-variables.md).  
  
## <a name="variables-usage-scenarios"></a>Сценарии использования переменных  
 Переменные в пакетах [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] используются различными способами. Возможно, что разработка пакетов будет затруднительна без добавления в пакет пользовательских переменных для реализации гибкости и управляемости решений. В зависимости от сценария также используются системные переменные.  
  
 **Выражения свойств** Переменные используются для предоставления значений в выражениях свойств, устанавливающих свойства пакетов и объектов пакетов. Например, выражение `SELECT * FROM @varTableName` включает переменную `varTableName` , которая обновляет инструкцию SQL, выполняемую задачей «Выполнение SQL». Выражение `DATEPART("d", GETDATE()) == 1? @[User::varPackageFirst]:@[User::varPackageOther]`обновляет пакет, выполняемый задачей «Выполнение пакета», запуская пакет, указанный в переменной `varPackageFirst` , в первый день месяца и пакет, указанный в переменной `varPackageOther` , в остальные дни. Дополнительные сведения см. в разделе [Использование выражений свойств в пакетах](expressions/use-property-expressions-in-packages.md).  
  
 **Выражения потока данных** Используйте переменные для предоставления значений в выражениях, используемых преобразованиями «производный столбец» и «условное разбиение» для заполнения столбцов или для направления строк данных к различным выходам преобразования. Например, выражение `@varSalutation + LastName`объединяет значение переменной `VarSalutation` и столбец `LastName` . Выражение `Income < @HighIncome`направляет на выход строки данных, в которых значение столбца `Income` меньше значения переменной `HighIncome` . Дополнительные сведения см. в разделах [Преобразование "Производный столбец"](data-flow/transformations/derived-column-transformation.md), [Преобразование "Условное разбиение"](data-flow/transformations/conditional-split-transformation.md) и [Выражения служб Integration Services (SSIS)](expressions/integration-services-ssis-expressions.md).  
  
 **Выражения управления очередностью** Укажите значения для использования в элементах управления очередностью, чтобы определить, выполняется ли исполняемый объект с ограничением. Эти выражения могут использоваться вместе с результатом выполнения (успех, ошибка, завершение) либо вместо результата выполнения. Например, если выражение `@varMax > @varMin` получает значение `true`, исполняемый объект запускается. Дополнительные сведения см. в статье [Добавление выражений к элементам управления очередностью](control-flow/precedence-constraints.md).  
  
 **Параметры и коды возврата** Укажите значения для входных параметров или сохраните значения выходных параметров и кодов возврата. Это можно сделать с помощью сопоставления переменных с параметрами и возвращаемыми значениями. Например, если переменная `varProductId` имеет значение 23 при выполнении инструкции SQL `SELECT * from Production.Product WHERE ProductID = ?`, запрос получит продукты с идентификатором `ProductID` , равным 23. Дополнительные сведения см. в разделах [Задача "Выполнение SQL"](control-flow/execute-sql-task.md) и [Параметры и коды возврата в задаче "Выполнение SQL"](../../2014/integration-services/parameters-and-return-codes-in-the-execute-sql-task.md).  
  
 **Выражения циклов for** Укажите значения для использования в выражениях инициализации, оценки и присваивания цикла for. Например, если переменная `varCount` имеет значение 2, а `varMaxCount` — 10, выражением инициализации является `@varCount`, выражением оценки —  `@varCount < @varMaxCount`, а выражением присваивания — `@varCount =@varCount +1`, цикл повторится 8 раз. Дополнительные сведения см. в статье [For Loop Container](control-flow/for-loop-container.md).  
  
 **Конфигурации переменных родительского пакета** Передача значений из родительских пакетов в дочерние пакеты. Дочерние пакеты могут получить доступ к переменным родительского пакета путем использования конфигураций переменных пакета. Например, если дочерний пакет должен использовать ту же дату, что и родительский пакет, он может определить конфигурацию переменной родительского пакета, которая определяет значение переменной, установленное с помощью функции GETDATE. Дополнительные сведения см. в разделах [Execute Package Task](control-flow/execute-package-task.md) и [Package Configurations](../../2014/integration-services/package-configurations.md).  
  
 **Задача "Скрипт" и компонент скрипта** Предоставьте список переменных только для чтения и чтения и записи для задачи «Скрипт» или компонента скрипта, обновите переменные для чтения и записи в скрипте, а затем используйте обновленные значения в или вне скрипта. Например, в коде `numberOfCars = CType(Dts.Variables("NumberOfCars").Value, Integer)`переменная скрипта `numberOfCars` обновлена значением переменной `NumberOfCars`. Дополнительные сведения см. в статье [Using Variables in the Script Task](control-flow/script-task.md).  
  
## <a name="configurations-and-variables"></a>Конфигурации и переменные  
 Чтобы динамически обновлять переменные, можно создавать конфигурации для переменных, развертывать их вместе с пакетами и обновлять значения переменных в файле конфигурации при развертывании пакета. Во время выполнения пакет будет использовать обновленные значения переменных. Дополнительные сведения см. в разделе [Создание конфигурации пакетов](../../2014/integration-services/create-package-configurations.md).  
  
### <a name="to-add-modify-and-delete-user-defined-variables"></a>Добавление, изменение или удаление пользовательских переменных  
  
-   [Добавление, удаление и изменение области определяемой пользователем переменной в пакете](../../2014/integration-services/add-delete-change-scope-of-user-defined-variable-in-a-package.md)  
  
-   [Установка свойств определяемой пользователем переменной](../../2014/integration-services/set-the-properties-of-a-user-defined-variable.md)  
  
  
