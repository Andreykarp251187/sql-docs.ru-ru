---
title: Настройка сохраненных учетных данных для обновления данных PowerPivot (PowerPivot для SharePoint) | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 987eff0f-bcfe-4bbd-81e0-9aca993a2a75
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: 23f35c8998b204182f25f85f8f7694fb60d042b4
ms.sourcegitcommit: f40fa47619512a9a9c3e3258fda3242c76c008e6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/23/2019
ms.locfileid: "66087457"
---
# <a name="configure-stored-credentials-for-powerpivot-data-refresh-powerpivot-for-sharepoint"></a>Настройка сохраненных учетных данных для обновления данных PowerPivot (PowerPivot для SharePoint)
  Задания обновления данных PowerPivot могут работать от любой учетной записи Windows, если в службе Secure Store создано целевое приложение для сохранения нужных учетных данных. Аналогичным образом, если нужно предоставить имя входа базы данных, отличное от указанного при первоначальном импорте данных в PowerPivot для Excel, то эти учетные данные можно сопоставить с целевым приложением службы Secure Store, а затем указать это целевое приложение в расписании обновления данных.  
  
 **[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010  
  
 Придерживаясь инструкций, приведенных в этом разделе, можно получить возможность использовать следующий вариант задания учетных данных на странице расписания обновления данных PowerPivot.  
  
 ![SSAS_PowerPivotDataRefreshCreds_Stored](media/ssas-powerpivotdatarefreshcreds-stored.gif "SSAS_PowerPivotDataRefreshCreds_Stored")  
  
 В этом разделе описано, как настроить имена пользователей и пароли, используемые при выполнении операции обновления данных PowerPivot в ферме SharePoint 2010. Прежде чем можно будет переходить к этим шагам, необходимо включить службу Secure Store и создать главный ключ. Дополнительные сведения см. в разделе [обновления данных PowerPivot с SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md)  
  
 Этот раздел состоит из следующих подразделов.  
  
 [Настройка любой учетной записи Windows для обновления данных](#configAny)  
  
 [Настройка стандартной учетной записи для доступа к источникам данных, внешних или сторонние](#config3rd)  
  
 Если у вас проблемы при настройке или использовании обновления данных, см. раздел [Устранение неполадок обновления данных PowerPivot](https://go.microsoft.com/fwlink/?LinkID=223279) страницы на вики-сайте TechNet возможные решения.  
  
##  <a name="configAny"></a> Настройка любой учетной записи Windows для обновления данных  
 Если пользователь SharePoint задает расписание обновления данных, он должен указать идентификатор пользователя, под которым выполняется обновление данных. Среди вариантов — выбор учетной записи автоматического обновления данных PowerPivot, ввод собственной учетной записи пользователя домена Windows или ввод другой учетной записи пользователя Windows, которая подходит для обновления данных. Шаги в этом разделе предназначены для последнего варианта: указания другой учетной записи Windows.  
  
 Этот способ можно выбрать, если нужна альтернатива использованию учетной записи автоматического обновления данных PowerPivot (доступно всем пользователям PowerPivot на SharePoint) или учетных данных владельца книги. Например, можно создать несколько учетных записей обновления данных, доступных для разных рабочих групп, что помогает управлять процессом обновления данных на уровне организации.  
  
> [!IMPORTANT]  
>  Пользователи и приложения, которые используют это целевое приложение (и хранящиеся в нем учетные данные) должны быть перечислены в списке членов этого приложения. В этот список должно быть добавлено удостоверение каждого приложения службы PowerPivot, которое будет использовать целевое приложение, ваша учетная запись Windows и группа учетных записей пользователей, которые будут указывать это целевое приложение в своих расписаниях обновления данных. Можно указать все эти учетные записи при создании целевого приложения. Если все пользователи и группы, которым потребуется доступ к этому приложению, заранее неизвестны, их можно будет добавить позже, после создания целевого приложения.  
  
 Настройка сохраненных учетных данных для обновления данных состоит из следующих четырех частей.  
  
-   Создание целевого приложения, которое сохраняет учетные данные.  
  
-   Предоставьте учетной записи разрешения «Участие».  
  
-   Предоставьте учетной записи разрешения на чтение для обеспечения доступа к внешним источникам данных при обновлении данных.  
  
-   Проверка того, работает ли обновление данных при указании этого целевого приложения в расписании обновления данных.  
  
### <a name="step-1-create-a-target-application"></a>Шаг 1. Создание целевого приложения  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.  
  
2.  Нажмите кнопку **защиты службы Store**.  
  
3.  В управление целевыми приложениями щелкните **New**.  
  
4.  В поле «Идентификатор целевого приложения» введите текстовую строку. Строка должна быть уникальной, но легко запоминающейся. Пользователи будут вводить эту строку на страницах расписания обновления данных, когда им потребуется использование учетных данных, хранящихся в этом приложении.  
  
5.  В поле «Отображаемое имя» введите описательное имя. Это имя используется только для отображения. Она не используется для указания целевого приложения в расписании обновления данных.  
  
6.  В поле «Адрес электронной почты» введите адрес.  
  
7.  В тип целевого приложения, выберите **группы**.  
  
    > [!IMPORTANT]  
    >  Выбор типа учетной записи «Групповой» является необходимым, поскольку такой выбор позволяет указать все учетные записи пользователей и служб, которым требуется доступ к этим учетным данным. Применительно к каждому запросу системная служба PowerPivot проверяет, является ли запрашивающий объект членом целевого приложения.  
  
8.  Пропустите URL-адрес страницы целевого приложения. Обновление данных PowerPivot не использует его.  
  
9. Нажмите кнопку **Далее**.  
  
10. В **укажите поля учетных данных для приложения Secure Store целевой** странице, примите значения по умолчанию. Имена полей и типы должны быть следующими: «Имя пользователя Windows» и «Пароль Windows».  
  
11. Нажмите кнопку Далее.  
  
12. В поле «Администраторы целевых приложений» укажите учетные записи пользователей домена Windows для пользователей SharePoint, которые должны иметь права администратора для доступа к настройкам целевого приложения (например, способность добавлять или удалять учетные записи в списке членов).  
  
13. В поле «Члены» добавьте следующие учетные записи пользователя и группы.  
  
    1.  В качестве создателя приложения добавьте в список свою учетную запись пользователя Windows.  
  
    2.  Добавьте удостоверение пула приложений для приложения службы PowerPivot, чтобы оно могло извлекать учетные данные в момент запланированного запуска обновления данных. Чтобы просмотреть идентификатор пула приложений, перейдите к **управление приложениями службы**, выберите приложение службы PowerPivot, щелкнув пустое место рядом с именем (будет выделена вся строка) и нажмите кнопку **свойства**. Учетная запись безопасности, отображаемая на этой странице, — это учетная запись, добавляемая в качестве члена целевого приложения.  
  
    3.  Добавьте учетные записи пользователей и групп Windows, которые будут входить в это целевое приложение в расписаниях обновления данных.  
  
14. Нажмите кнопку **ОК**.  
  
15. Выберите только что созданное целевое приложение, щелкните стрелку вниз и выберите **задать учетные данные.**  
  
16. Обратите внимание на то, что в разделе «Владелец учетных данных» список владельцев учетных данных предназначен только для чтения. Учетные записи, имеющие право владения этими учетными данными, являются членами целевого приложения. Для добавления или удаления владельцев учетных данных необходимо добавлять или удалять учетные записи в списке членов целевого приложения.  
  
     В полях «Имя пользователя Windows» и «Пароль Windows» введите учетные данные той учетной записи пользователя Windows, которая будет служить для запуска обновления данных.  
  
17. Нажмите кнопку **ОК**.  
  
###  <a name="bkmk_grant"></a> Шаг 2. Предоставьте разрешения «участие» учетной записи  
 Прежде чем появится возможность использовать сохраненные учетные данные, учетной записи необходимо назначить разрешения «Участие» во всех книгах PowerPivot, где она будет использоваться. Этот уровень разрешений необходим для открытия книги из библиотеки и сохранения книги в библиотеке после обновления данных.  
  
 Назначение разрешений выполняется администратором семейства веб-сайтов. Разрешения SharePoint можно назначать в корневом семействе сайтов или на любом уровне ниже, включая уровень отдельных документов и элементов. Порядок задания разрешений зависит от требуемой гранулярности разрешений. В следующих действиях показан один из способов предоставления разрешений.  
  
1.  На сайте SharePoint, в разделе действия узла щелкните **разрешения сайта**.  
  
2.  Нажмите кнопку **Предоставить разрешения**.  
  
3.  В поле «Выберите пользователей» введите имя учетной записи пользователя домена Windows, которая указана в целевом приложении.  
  
4.  На предоставление разрешений выберите **предоставить разрешение пользователям сразу**.  
  
5.  Выберите **Contribute**, а затем нажмите кнопку **ОК**.  
  
###  <a name="bkmk_dbread"></a> Шаг 3. Предоставление разрешений для доступа к внешним источникам данных при обновлении данных чтение  
 При импорте данных в книгу PowerPivot соединения с внешними данными часто основываются на доверенных соединениях или олицетворенных подключениях, использующих идентификатор текущего пользователя для подключения к источнику данных. Эти типы подключений работают только тогда, когда текущий пользователь имеет разрешение на чтение данных, которые импортирует.  
  
 В сценарии обновления данных для обновления данных повторно используется та же строка подключения, которая использовалась для импорта данных. Если строка подключения предполагает текущего пользователя (например, включает параметр Integrated_Security=SSPI), то системная служба PowerPivot передает идентификатор пользователя, указанный в целевом приложении в качестве текущего пользователя. Это соединение завершится успешно только в том случае, если учетная запись имеет разрешения на чтение для внешнего источника данных.  
  
 По этой причине необходимо предоставить учетной записи разрешения только на чтение для всех внешних источников данных, используемых при обновлении данных.  
  
 Администратор источников данных, используемых в организации, может создать имя входа и назначить необходимые разрешения. В противном случае необходимо обратиться к владельцам данных и получить сведения об учетной записи. Обязательно укажите учетную запись пользователя домена Windows, которая отображается на целевое приложение. Это учетная запись, указанная в «шаг 1: Создание целевого приложения» этого раздела.  
  
###  <a name="bkmk_verify"></a> Шаг 4. Проверка доступности учетной записи на страницах настройки обновления данных  
  
1.  Откройте страницу настройки обновления данных для опубликованной книги, которая содержит данные PowerPivot. Инструкции по открытию страницы см. в разделе [Планирование обновления данных &#40;PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).  
  
2.  Убедитесь, что **подключение с использованием учетных данных, сохраненных в службе Secure Store (SSS) для доступа к источнику данных** параметр включен в страницу конфигурации обновления данных, а затем введите имя целевого приложения.  
  
3.  Выберите **также обновлять как можно скорее** флажок, а затем нажмите кнопку **ОК**.  
  
4.  В библиотеке, которая содержит книгу, выберите книгу, щелкните стрелку вниз справа и выберите **Управление обновлением данных PowerPivot**. Может потребоваться подождать в течение нескольких минут, если задание обновления данных возвращает большой объем данных.  
  
 Если возникает ошибка, вы можете щелкнуть **Настройка расписания** в обновление данных страница "Журнал" попробовать другие учетные данные. Может также потребоваться проверка сведений о соединении с источником данных в исходной книге для просмотра строки подключения, которая используется во время обновления данных. Строка подключения предоставляет сведения о местонахождении сервера и базы данных, которые можно использовать для устранения проблемы.  
  
 Дополнительные сведения об устранении неполадок см. в разделе [Устранение неполадок обновления данных PowerPivot](https://go.microsoft.com/fwlink/p/?LinkID=223279) в TechNet Wiki.  
  
##  <a name="config3rd"></a> Настройка стандартной учетной записи для доступа к источникам данных, внешних или сторонние  
 У серверов баз данных часто имеются собственные способы проверки подлинности. При наличии книги PowerPivot, которой требуются учетные данные для доступа к внешнему источнику данных во время обновления данных, можно создать идентификатор целевого приложения для учетных данных, а затем указать его в разделе «Источники данных» на странице обновления данных по расписанию.  
  
 Это действие необходимо только в том случае, если требуется дать пользователям возможность переопределения учетных данных базы данных, которые уже встроены в книгу PowerPivot.  
  
 Этот шаг является применимым, только если строка подключения уже содержит имя пользователя и пароль. Следует учитывать, что обычно не принято указывать учетные данные в строке подключения, поэтому возможность использовать этот вариант является довольно ограниченной. В большинстве случаев идентификатор пользователя и пароль задаются в строке подключения, только если используется проверка подлинности базы данных для подключения к источнику данных. Дополнительные сведения о том, как проверить строку подключения, чтобы узнать, содержит ли имя пользователя и пароль, см. в разделе «Предоставление разрешений для создания расписаний и доступа к внешним данным», в [обновления данных PowerPivot с SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md).  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.  
  
2.  Нажмите кнопку **защиты службы Store**.  
  
3.  В управление целевыми приложениями щелкните **New**.  
  
4.  В поле «Идентификатор целевого приложения» введите текстовую строку. Строка должна быть уникальной, но легко запоминающейся. Пользователи будут вводить эту строку на страницах расписания обновления данных, когда им потребуется использование учетных данных, хранящихся в этом приложении.  
  
5.  В поле «Отображаемое имя» введите описательное имя. Это имя используется только для отображения. Она не используется для указания целевого приложения в расписании обновления данных.  
  
6.  В поле «Адрес электронной почты» введите адрес.  
  
7.  В тип целевого приложения, выберите **группы**.  
  
8.  Пропустите URL-адрес страницы целевого приложения. Обновление данных PowerPivot не использует его.  
  
9. Нажмите кнопку **Далее**.  
  
10. В **укажите поля учетных данных для приложения Secure Store целевой** странице, примите значения по умолчанию, только в том случае, если источник данных использует проверку подлинности Windows. В противном случае выберите типы полей, допустимые для вашего источника данных, затем измените имена полей в соответствии с типом.  
  
     Например, в качестве имен полей можно указать «Имя пользователя SQL Server» и «Пароль пользователя SQL Server», а затем выбрать «Имя пользователя» и «Пароль» в качестве типов полей.  
  
11. Нажмите кнопку Далее.  
  
12. В поле «Администраторы целевых приложений» укажите учетные записи пользователей домена Windows для пользователей SharePoint, которые должны иметь права администратора для доступа к настройкам приложения.  
  
13. В поле «Члены» добавьте следующие учетные записи пользователя и группы.  
  
    1.  В качестве создателя приложения добавьте в список свою учетную запись пользователя Windows.  
  
    2.  Добавьте удостоверение пула приложений для каждого приложения службы PowerPivot, которое будет использовать целевое приложение для доступа к сохраненным учетным данным. Чтобы просмотреть удостоверение, перейдите к **управление приложениями службы**, выберите приложение службы PowerPivot, щелкнув пустое место рядом с именем (будет выделена вся строка) и нажмите кнопку **свойства**. Учетная запись безопасности, отображаемая на этой странице, является учетной записью, которую необходимо добавить в качестве члена целевого приложения.  
  
    3.  Добавьте в разделе источников данных на странице расписания обновления данных учетные записи пользователей и групп Windows, которые будут входить в это целевое приложение.  
  
14. Нажмите кнопку **ОК**.  
  
15. Выберите только что созданное целевое приложение, щелкните стрелку вниз и выберите **задать учетные данные.**  
  
16. Введите учетные данные, которые будут использоваться для подключения к источнику данных (например, имя пользователя и пароль, которые соответствуют имени входа SQL Server).  
  
17. Нажмите кнопку **ОК**.  
  
## <a name="see-also"></a>См. также  
 [Планирование обновления данных &#40;PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md)   
 [Обновление данных PowerPivot с SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md)  
  
  
