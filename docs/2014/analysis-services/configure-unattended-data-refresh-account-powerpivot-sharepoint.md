---
title: Настройка PowerPivot (PowerPivot для SharePoint) учетной записи автоматического обновления | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology:
- analysis-services
ms.topic: conceptual
ms.assetid: 81401eac-c619-4fad-ad3e-599e7a6f8493
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: 51cc5f71c3a3e7515238aef08e97316e549c0e70
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62680566"
---
# <a name="configure-the-powerpivot-unattended-data-refresh-account-powerpivot-for-sharepoint"></a>Настройка учетной записи автоматического обновления данных PowerPivot (PowerPivot для SharePoint)
  Учетная запись автоматического обновления данных PowerPivot специально предназначена для выполнения заданий по обновлению данных PowerPivot на ферме SharePoint. Настроив его, как разрешить **использовать для обновления данных учетную запись, настроенную администратором** странице расписания обновления данных (см. ниже). Авторы книг, планирующие обновление данных, могут выбрать этот параметр, если желают использовать учетную запись автоматического обновления данных PowerPivot для выполнения задания по обновлению данных. Дополнительные сведения о том, как просматривать параметры учетных данных в расписании обновления данных см. в разделе [Планирование обновления данных &#40;PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).  
  
 ![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")  
  
 **[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010  
  
 В зависимости от параметров, выбранных при настройке сервера, учетная запись автоматического обновления данных может быть уже создана. В конфигурации по умолчанию в качестве идентификатора учетной записи автоматического обновления данных первоначально задается учетная запись фермы. Чтобы повысить безопасность среды, можно изменить учетную запись для выполнения от имени другого пользователя. Выполните эти инструкции, чтобы изменить учетную запись. [Обновить учетные данные, используемые существующий PowerPivot учетной записи автоматического обновления](#bkmk_editUA).  
  
 Для всех остальных сценариев установки эту учетную запись необходимо настраивать вручную с использованием приведенных ниже инструкций.  
  
 Этот раздел состоит из следующих подразделов.  
  
 [Предварительные требования](#bkmk_prereq)  
  
 [Шаг 1. Создание целевого приложения и задайте учетные данные](#bkmk_create)  
  
 [Шаг 2. Укажите автоматической учетной записи на страницах настройки сервера PowerPivot](#bkmk_specifyUA)  
  
 [Шаг 3. Предоставьте разрешения «участие» учетной записи](#bkmk_grant)  
  
 [Шаг 4. Предоставление разрешений для доступа к внешним источникам данных при обновлении данных чтение](#bkmk_dbread)  
  
 [Шаг 5. Проверка доступности учетной записи на страницах настройки обновления данных](#bkmk_verify)  
  
 [С помощью автоматического обновления данных PowerPivot в учетной записи](#bkmk_use)  
  
 [Обновить учетные данные, используемые существующий PowerPivot учетной записи автоматического обновления](#bkmk_editUA)  
  
##  <a name="bkmk_prereq"></a> Предварительные требования  
 Служба Secure Store должна быть включена и настроена, и должен быть создан главный ключ. Инструкции о том, как это сделать, см. в разделе [обновления данных PowerPivot с SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md)  
  
 Необходимо заранее определить, какая учетная запись пользователя домена Windows будет использоваться в качестве учетной записи автоматического обновления данных PowerPivot. Эта учетная запись должна специально создаваться для этой задачи, чтобы отслеживать ее использование.  
  
 Пользователю необходимо знать идентификатор приложения системной службы PowerPivot. Установите для этой учетной записи службы **полный контроль** учетной записи разрешения в отношении данных автоматического обновления при создании целевого приложения для него на шаге 1. Эти разрешения позволяют системной службе PowerPivot получить учетные данные учетной записи автоматического обновления данных во время обновления данных. Чтобы получить сведения об учетной записи необходимые службы, откройте **Настройка учетных записей служб** страницы в центре администрирования и выберите пул приложений служб, используемый приложением службы PowerPivot. По умолчанию, это **пул приложений службы — система веб-служб SharePoint**.  
  
## <a name="configure-the-unattended-powerpivot-data-refresh-account"></a>Настройка учетной записи автоматического обновления данных PowerPivot  
 Для каждого приложения службы PowerPivot можно настроить только одну учетную запись автоматического обновления данных PowerPivot. Сведения об учетной записи хранятся в службе Secure Store в целевом приложении, для которого задается готовая учетная запись пользователя домена Windows. После создания целевого приложения можно указать его в качестве учетной записи обновления данных PowerPivot на страницах конфигурации приложения службы PowerPivot.  
  
> [!NOTE]  
>  Если обновление данных выполняется с учетной записью автоматического обновления данных, то отчеты об использовании и журнал обновления данных записываются для учетной записи пользователя Windows, которая используется для автоматического обновления данных. Если требуется более точная регистрация пользователей, запрашивающих обновление данных или владеющих расписаниям, рекомендуется один из других вариантов обновления данных. В частности, пользователи могут указывать собственные учетные данные (режим по умолчанию). Также можно создавать дополнительные целевые приложения для хранения учетных данных Windows, используемых для обновления данных. Дополнительные сведения см. в разделе [Настройка сохраненных учетных данных для обновления данных PowerPivot &#40;PowerPivot для SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).  
  
 Создание учетной записи автоматического обновления данных включает пять этапов.  
  
-   В службах Secure Store создайте целевое приложение для учетной записи и укажите учетные данные.  
  
-   На странице настройки сервера PowerPivot укажите идентификатор целевого приложения для учетной записи автоматического обновления данных.  
  
-   Предоставьте учетной записи разрешения «Участие».  
  
-   Предоставьте учетной записи разрешения на чтение для обеспечения доступа к внешним источникам данных при обновлении данных.  
  
-   Убедитесь, что учетная запись появилась на странице «Управление расписанием обновления данных» для опубликованной книги PowerPivot.  
  
###  <a name="bkmk_create"></a> Шаг 1. Создание целевого приложения и задайте учетные данные  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.  
  
2.  Нажмите кнопку **защиты службы Store**.  
  
3.  В управление целевыми приложениями щелкните **New**.  
  
4.  В качестве идентификатора целевого приложения введите **PowerPivotDataRefresh**.  
  
5.  В отображаемом имени введите **обновления данных PowerPivot**.  
  
6.  В поле «Адрес электронной почты» введите адрес.  
  
7.  В тип целевого приложения, выберите **отдельных**.  
  
    > [!NOTE]  
    >  Для этого сценария является правильным определение типа учетной записи «Отдельный», поскольку лишь приложение службы PowerPivot будет запрашивать учетные данные учетной записи автоматического обновления данных PowerPivot. С точки зрения практики это приложение службы является единственным пользователем учетной записи автоматического обновления данных, поэтому применение типа учетной записи «Отдельный» является наилучшим выбором для этого целевого приложения.  
  
8.  Пропустите URL-адрес страницы целевого приложения. Обновление данных PowerPivot не использует его.  
  
9. Нажмите кнопку **Далее**.  
  
10. В **укажите поля учетных данных для приложения Secure Store целевой** странице, примите значения по умолчанию. Имена полей и типы должны быть следующими: «Имя пользователя Windows» и «Пароль Windows»  
  
11. Нажмите кнопку **Далее**.  
  
12. На странице «Администраторы целевого приложения» укажите идентификатор пула приложений, соответствующий приложению службы PowerPivot. Служба требует **полный контроль** разрешения, так что он может получать данные автоматической обновить сведения об учетной записи во время выполнения. Кроме того, задайте учетные записи пользователей домена Windows для любых других пользователей SharePoint, которые должны иметь права администратора для доступа к настройкам приложения.  
  
13. Нажмите кнопку **ОК**.  
  
14. Выберите только что созданное целевое приложение, щелкните стрелку вниз и выберите **задать учетные данные.**  
  
15. В **владельцы учетных данных**, введите учетную запись пользователя домена Windows, хотите нет разрешений на изменение учетных данных. Для действий по обновлению данных используются учетные данные и **владельцы учетных данных** разрешения на изменение учетных данных.  
  
16. Нажмите кнопку **ОК**.  
  
###  <a name="bkmk_specifyUA"></a> Шаг 2. Укажите автоматической учетной записи на страницах настройки сервера PowerPivot  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.  
  
2.  Найдите приложение службы PowerPivot. Определить приложение службы можно по его типу. Типом приложения службы PowerPivot является **Приложение службы PowerPivot**.  
  
3.  Щелкните имя приложения службы PowerPivot. Подождите, пока появится панель управления PowerPivot.  
  
4.  В действиях, в правом верхнем углу, щелкните **Настройка параметров приложения службы**.  
  
5.  В обновление данных в PowerPivot данные учетной записи автоматического обновления введите идентификатор целевого приложения, созданного на предыдущем шаге: **PowerPivotDataRefresh**.  
  
6.  Нажмите кнопку **ОК**.  
  
###  <a name="bkmk_grant"></a> Шаг 3. Предоставьте разрешения «участие» учетной записи  
 Перед использованием учетной записи автоматического обновления данных PowerPivot ей необходимо назначить разрешения «Участие» во всех книгах PowerPivot, где она будет использоваться. Этот уровень разрешений необходим для открытия книги из библиотеки и сохранения книги в библиотеке после обновления данных.  
  
 Назначение разрешений выполняется администратором семейства веб-сайтов. Разрешения SharePoint можно назначать в корневом семействе сайтов или на любом уровне ниже, включая уровень отдельных документов и элементов. Порядок задания разрешений зависит от требуемой гранулярности разрешений. В следующих действиях показан один из способов предоставления разрешений.  
  
1.  На сайте SharePoint, в разделе действия узла щелкните **разрешения сайта**.  
  
2.  Нажмите кнопку **Предоставить разрешения**.  
  
3.  В поле «Выберите пользователей» введите имя учетной записи пользователя домена Windows, выбранной в качестве учетной записи автоматического обновления PowerPivot. Это имя учетной записи пользователя домена Windows, указанной в целевом приложении в службе Secure Store.  
  
4.  На предоставление разрешений выберите **предоставить разрешение пользователям сразу**.  
  
5.  Выберите **Contribute**, а затем нажмите кнопку **ОК**.  
  
###  <a name="bkmk_dbread"></a> Шаг 4. Предоставление разрешений для доступа к внешним источникам данных при обновлении данных чтение  
 При импорте данных в книгу PowerPivot соединения с внешними данными часто основываются на доверенных соединениях или олицетворенных подключениях, использующих идентификатор текущего пользователя для подключения к источнику данных. Эти типы подключений работают только тогда, когда текущий пользователь имеет разрешение на чтение данных, которые импортирует.  
  
 В сценарии обновления данных для обновления данных повторно используется та же строка подключения, которая использовалась для импорта данных. Если строка подключения предполагает текущего пользователя (например, включает параметр Integrated_Security=SSPI), то системная служба PowerPivot передает идентификатор пользователя учетной записи автоматического обновления данных PowerPivot в качестве текущего пользователя. Это соединение завершится успешно только в том случае, если учетная запись автоматического обновления данных PowerPivot имеет разрешения на чтение для внешнего источника данных.  
  
 По этой причине необходимо предоставить учетной записи автоматического обновления данных PowerPivot разрешения только на чтение для всех внешних источников данных, используемых в операциях обновления данных, которые выполняются под этой автоматической учетной записью.  
  
 Администратор источников данных, используемых в организации, может создать имя входа и назначить необходимые разрешения. В противном случае необходимо обратиться к владельцам данных и получить сведения об учетной записи. Необходимо заранее определить, какая учетная запись пользователя домена Windows будет использоваться в качестве учетной записи автоматического обновления данных PowerPivot. Это учетная запись, указанная "(Step 1) на шаге 1: Создайте целевое приложение и задайте учетные данные» в этом разделе.  
  
###  <a name="bkmk_verify"></a> Шаг 5. Проверка доступности учетной записи на страницах настройки обновления данных  
  
1.  Откройте страницу настройки обновления данных для опубликованной книги, которая содержит данные PowerPivot. Инструкции по открытию страницы см. в разделе [Планирование обновления данных &#40;PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md).  
  
2.  Убедитесь, что **использовать для обновления данных учетную запись, настроенную администратором** параметр включен в страницу конфигурации обновления данных.  
  
3.  Выберите **также обновлять как можно скорее** флажок, а затем нажмите кнопку **ОК**.  
  
4.  В библиотеке, которая содержит книгу, выберите книгу, щелкните стрелку вниз справа и выберите **Управление обновлением данных PowerPivot**. Может потребоваться подождать в течение нескольких минут, если задание обновления данных возвращает большой объем данных.  
  
 Если возникает ошибка, вы можете щелкнуть **Настройка расписания** в обновление данных страница "Журнал" попробовать другие учетные данные. Может также потребоваться проверка сведений о соединении с источником данных в исходной книге для просмотра строки подключения, которая используется во время обновления данных. Строка подключения предоставляет сведения о местонахождении сервера и базы данных, которые можно использовать для устранения проблемы.  
  
 Дополнительные сведения об устранении неполадок см. в разделе [Устранение неполадок обновления данных PowerPivot](https://go.microsoft.com/fwlink/p/?LinkID=223279) в TechNet Wiki.  
  
##  <a name="bkmk_use"></a> С помощью автоматического обновления данных PowerPivot в учетной записи  
 На странице подготовки расписания обновления данных PowerPivot только первый вариант определения параметров учетных данных из трех соответствует учетной записи автоматического обновления данных. Обязательно выберите этот вариант при настройке расписания обновления данных.  
  
 ![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")  
  
 Не используйте третий вариант определения учетных данных (тот, который требует ввода идентификатора целевого приложения) для получения доступа к учетной записи автоматического обновления данных PowerPivot. При использовании этого варианта предусмотрена дополнительная проверка олицетворения, которая приводит к ошибке проверки при попытке выполнения ее по отношению к учетной записи автоматического обновления данных PowerPivot (или к любому целевому приложению, основанному на применении типа учетной записи «Отдельный»). Дополнительные сведения о том, как использовать третий вариант, см. в разделе [Настройка сохраненных учетных данных для обновления данных PowerPivot &#40;PowerPivot для SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md).  
  
##  <a name="bkmk_editUA"></a> Обновить учетные данные, используемые существующий PowerPivot учетной записи автоматического обновления  
 Если учетная запись автоматического обновления данных уже настроена в процессе установки или настроена администратором, можно обновить имя пользователя или пароль, внеся изменения в целевом приложении, где хранятся учетные данные. Следует учитывать, что при изменении учетных данных в службе Secure Store исходный идентификатор Windows, который был перед этим связан с учетной записью автоматического обновления данных PowerPivot, не будет видимым. В службе Secure Store необходимо всегда повторно вводить и имя пользователя, и пароль для данного целевого приложения, независимо от того, обновляется ли пароль с истекшим сроком действия или задается другая учетная запись.  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.  
  
2.  Нажмите кнопку **защиты службы Store**.  
  
3.  Установите флажок рядом с полем **PowerPivotDataRefresh**.  
  
4.  В учетных данных, нажмите кнопку **задать**.  
  
5.  В **владельцы учетных данных**, введите учетную запись пользователя домена Windows, хотите нет разрешений на изменение учетных данных. Для действий по обновлению данных используются учетные данные и **владельцы учетных данных** разрешения на изменение учетных данных.  
  
6.  В поле «Имя пользователя» введите учетную запись пользователя домена Windows, которая будет частью учетных данных автоматического обновления данных.  
  
7.  В поле «Пароль» ведите пароль для учетной записи и повторите ввод для подтверждения.  
  
8.  Нажмите кнопку **ОК**.  
  
 Если происходит смена не только пароля, но и имени пользователя учетной записи, то, по всей видимости, потребуется выполнение дополнительных шагов настройки, таких как предоставление разрешений на чтение для внешних источников данных и разрешений SharePoint на обновление книги PowerPivot. Инструкции перейдите к следующему шагу в конфигурации учетной записи для автоматического обновления PowerPivot: [Шаг 3. Предоставьте разрешения «участие» учетной записи](#bkmk_grant), а затем продолжите всех оставшихся шагов, проведя в завершение проверку учетная запись настроена правильно.  
  
## <a name="see-also"></a>См. также  
 [Обновление данных PowerPivot с SharePoint 2010](powerpivot-data-refresh-with-sharepoint-2010.md)   
 [Планирование обновления данных &#40;PowerPivot для SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md)   
 [Обновление данных PowerPivot](power-pivot-sharepoint/power-pivot-data-refresh.md)  
  
  
