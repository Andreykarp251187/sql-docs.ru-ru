---
title: Задача 14. Добавление задачи «Выполнение SQL» в поток управления для запуска хранимой процедуры MDS | Документация Майкрософт
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: data-quality-services
ms.topic: conceptual
ms.assetid: 9a5d1b52-d505-4e6f-8a89-569329c094e2
author: lrtoyou1223
ms.author: lle
manager: craigg
ms.openlocfilehash: 3fe1eb6032d9d550b36252e16eee51c98c5d2384
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "65477104"
---
# <a name="task-14-adding-execute-sql-task-to-control-flow-to-run-the-stored-procedure-for-mds"></a>Задача 14. Добавление задачи «Выполнение SQL» в поток управления для выполнения хранимых процедур для MDS
  После загрузки данных в промежуточные таблицы служб MDS вы выполняете хранимую процедуру, связанную с этой таблицей, для загрузки данных из промежуточных таблиц в соответствующие таблицы в базе данных MDS. У этой хранимой процедуры два обязательных параметра, которые нужно передать: LogFlag и VersionName. Параметр LogFlag определяет, записываются ли транзакции в журнал в ходе промежуточного процесса, а параметр VersionName представляет версию модели. Дополнительные сведения см. в разделе [Промежуточная хранимая процедура](https://msdn.microsoft.com/library/hh231028.aspx) .  
  
 В этой задаче вы добавляете задачу «Выполнение SQL» в поток управления для вызова хранимой процедуры и загрузки промежуточных данных в соответствующие таблицы базы данных MDS.  
  
1.  Теперь перейдите на вкладку **поток управления** .  
  
2.  Перетащите задачу « **Выполнение SQL** » с **панели элементов служб SSIS** на вкладку **поток управления** .  
  
3.  Щелкните правой кнопкой мыши **задача "Выполнение SQL** " на вкладке " **поток управления** " и выберите команду **Переименовать**. Введите **триггер хранимой процедуры для загрузки данных в MDS** и нажмите клавишу **Ввод**.  
  
4.  Соедините **данные о получении, очистке, совпадении и проверенных данных поставщика,** чтобы **активировать хранимую процедуру для загрузки данных** с помощью зеленого соединителя.  
  
     ![Соединение с задачей «Выполнение SQL»](../../2014/tutorials/media/et-addingesqltasktocftorunthespformds-01.jpg "Соединение с задачей «Выполнение SQL»")  
  
5.  С помощью окна **переменные** добавьте две новые переменные со следующими параметрами. Если окно **переменные** не отображается, щелкните **SSIS** в строке меню и выберите **переменные**.  
  
    |Имя|Тип данных|Значение|  
    |----------|---------------|-----------|  
    |LogFlag|Int32|1|  
    |VersionName|String|VERSION_1|  
  
     ![Окно переменных служб SSIS](../../2014/tutorials/media/et-addingesqltasktocftorunthespformds-02.jpg "Окно переменных служб SSIS")  
  
6.  Дважды щелкните **триггер хранимая процедура, чтобы загрузить данные в MDS**.  
  
7.  В диалоговом окне **Редактор задачи «Выполнение SQL** » выберите **(local). MDS** (или **localhost). MDS**) для **подключения**.  
  
8.  Введите **exec [STG]. [ udp_Supplier_Leaf]?,?,?** для **инструкции SQL**. Имя можно проверить с помощью среды SQL Server Management Studio.  
  
     ![Диалоговое окно редактора «Выполнение SQL» — общие параметры](../../2014/tutorials/media/et-addingesqltasktocftorunthespformds-03.jpg "Диалоговое окно редактора «Выполнение SQL» — общие параметры")  
  
9. Щелкните **Сопоставление параметров** в меню слева.  
  
10. На странице **Сопоставление параметров** нажмите кнопку **Добавить** , чтобы добавить сопоставление. Разверните окно и измените размер столбцов, чтобы можно было видеть значения в раскрывающемся списке.  
  
11. Выберите **User:: VersionName** из раскрывающегося списка для **имени переменной**.  
  
12. Выберите **nvarchar** для **типа данных**.  
  
13. Введите **0** (нуль) в качестве **имени параметра**.  
  
14. Повторите предыдущие четыре шага, чтобы добавить другие переменные.  
  
    |Имя переменной|Тип данных (важно)|Имя параметра|  
    |-------------------|-----------------------------|--------------------|  
    |User::LogFlag|LONG|1|  
    |User::BatchTag|NVARCHAR|2|  
  
     ![Редактор задачи «Выполнение SQL» — сопоставление параметров](../../2014/tutorials/media/et-addingesqltasktocftorunthespformds-04.jpg "Редактор задачи «Выполнение SQL» — сопоставление параметров")  
  
15. Нажмите кнопку **ОК** , чтобы закрыть диалоговое окно « **выполнение редактора SQL** ».  
  
## <a name="next-step"></a>Дальнейшее действие  
 [Задача 15. Построение и запуск проекта служб SSIS](../../2014/tutorials/task-15-building-and-running-the-ssis-project.md)  
  
  
