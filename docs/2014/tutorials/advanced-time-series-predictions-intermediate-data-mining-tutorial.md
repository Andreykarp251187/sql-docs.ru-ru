---
title: Расширенный прогноз временных рядов (Промежуточный учебник по интеллектуальному анализу данных) Документы Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: b614ebdb-07ca-44af-a0ff-893364bd4b71
author: minewiskan
ms.author: owend
manager: kfile
ms.openlocfilehash: ca144d1d473f7df49f73d5ed170052c61ce6107d
ms.sourcegitcommit: a3f5c3742d85d21f6bde7c6ae133060dcf1ddd44
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/15/2020
ms.locfileid: "68893691"
---
# <a name="advanced-time-series-predictions-intermediate-data-mining-tutorial"></a>Расширенные прогнозы временных рядов (учебник по интеллектуальному анализу данных — средний уровень)
  В ходе изучения модели прогнозирования было показано, что хотя продажи в большинстве регионов и следуют схожему шаблону, некоторые регионы и некоторые модели, например модель M200 в Тихоокеанском регионе, имеют очень разные тренды. Это не удивляет, поскольку различия между регионами не являются редкостью и могут быть вызваны многими факторами, включая маркетинговые акции, неточные отчеты или геополитические события.  
  
 Тем не менее, пользователям нужна модель, применимая к любым странам мира. Поэтому чтобы максимально снизить воздействие индивидуальных факторов на проекции, принимается решение создать модель, основанную на агрегатных вычислениях продаж по всему миру. Эту модель затем можно использовать для прогнозирования по каждому отдельному региону.  
  
 В этой задаче будут построены все источники данных, необходимые для выполнения расширенных задач прогнозирования. Будут созданы два представления источников данных, которые будут использоваться в качестве входных данных прогнозирующего запроса, и одно представление источника данных для построения новой модели.  
  
 **Шаги**  
  
1.  [Подготовка расширенных данных по продажам (для прогноза)](#bkmk_newExtendData)  
  
2.  [Подготовка статистических данных (для построения модели)](#bkmk_newReplaceData)  
  
3.  [Подготовка данных рядов (для перекрестного прогнозирования)](#bkmk_CrossData2)  
  
4.  [Прогноз с помощью EXTEND](../../2014/tutorials/time-series-predictions-using-updated-data-intermediate-data-mining-tutorial.md)  
  
5.  [Создание модели перекрестного прогнозирования](../../2014/tutorials/time-series-predictions-replacement-data-intermediate-data-mining.md)  
  
6.  [Прогноз с помощью REPLACE](../../2014/tutorials/time-series-predictions-replacement-data-intermediate-data-mining.md)  
  
7.  [Просмотр новых результатов прогноза](../../2014/tutorials/comparing-predictions-for-forecasting-models-intermediate-data-mining-tutorial.md)  
  
##  <a name="creating-the-new-extended-sales-data"></a><a name="bkmk_newExtendData"></a>Создание новых расширенных данных о продажах  
 Для обновления данных о продажах нужно будет получить последние цифры продаж. Особенно важными являются данные из Тихоокеанского региона, где была запущена региональная акция продаж для привлечения внимания к новым магазинам и информирования о продукции.  
  
 Для этого сценария мы предположим, что данные были импортированы из рабочей книги Excel, которая содержит всего три месяца новых данных для нескольких регионов. С помощью скрипта Transact-S'L вы создадите таблицу данных, а затем определите представление источника данных для использования для прогнозирования.  
  
#### <a name="create-the-table-with-new-sales-data"></a>Создание таблицы с новыми данными о продажах  
  
1.  В окне запросов Transact-SQL выполните следующую инструкцию, чтобы добавить данные о продажах в базу данных AdventureWorksDW (или в любую другую базу данных).  
  
    ```  
    USE [database name];  
    GO  
    IF OBJECT_ID ([dbo].[NewSalesData]) IS NOT NULL   
        DROP TABLE [dbo].[NewSalesData];  
    GO  
    CREATE TABLE [dbo].[NewSalesData]([Series] [nvarchar](255) NULL,  
    [NewDate] [datetime] NULL,  
    [NewQty] [float] NULL,  
    [NewAmount] [money] NULL) ON [PRIMARY]  
  
    GO  
    ```  
  
2.  Вставьте новые значения с помощью следующего скрипта.  
  
    ```  
    INSERT INTO [NewSalesData]  
    (Series,NewDate,NewQty,NewAmount)  
    VALUES('T1000 Pacific', '7/25/08', 55, '$130,170.22'),  
    ('T1000 Pacific', '8/25/08', 50, '$114,435.36 '),  
    ('T1000 Pacific', '9/25/08', 50, '$117,296.24 '),  
    ('T1000 Europe', '7/25/08', 37, '$88,210.00 '),  
    ('T1000 Europe', '8/25/08', 41, '$97,746.00 '),  
    ('T1000 Europe', '9/25/08', 37, '$88,210.00 '),  
    ('T1000 North America', '7/25/08', 69, '$164,500.00 '),  
    ('T1000 North America', '8/25/08', 66, '$157,348.00 '),  
    ('T1000 North America', '9/25/08', 58, '$138,276.00 '),  
    ('M200 Pacific', '7/25/08', 65, '$149,824.35'),  
    ('M200 Pacific', '8/25/08', 54,  '$124,619.46'),  
    ('M200 Pacific', '9/25/08', 61, '$141,143.39'),  
    ('M200 Europe', '7/25/08', 75, '$173,026.00'),  
    ('M200 Europe', '8/25/08', 76, '$175,212.00'),  
    ('M200 Europe', '9/25/08', 84, '$193,731.00'),  
    ('M200 North America', '7/25/08', 94, '$216,916.00'),  
    ('M200 North America', '8/25/08', 94, '$216,891.00'),  
    ('M200 North America', '9/25/08', 91,'$209,943.00');  
    ```  
  
    > [!WARNING]  
    >  Кавычки используются для значений валют, чтобы не возникало проблем с разделителем в виде запятой и символом валюты. Значения валют можно также передавать в следующем формате: `130170.22`  
    >   
    >  Обратите внимание, что даты, используемые в образце базы данных, изменены для этой версии. Если используется более раннее издание AdventureWorks, вставленные даты, возможно, потребуется соответствующим образом скорректировать.  
  
###  <a name="create-a-data-source-view-using-the-new-sales-data"></a><a name="bkmk_newReplaceData"></a>Создание представления источника данных с использованием новых данных о продажах  
  
1.  В **Solution Explorer**, правой кнопкой мыши **Посмотреть источник данных**, а затем выбрать **новый вид источника данных**.  
  
2.  В окне мастера представлений источников данных выберите указанные ниже элементы.  
  
     **Источник данных**:[!INCLUDE[ssAWDWsp](../includes/ssawdwsp-md.md)]  
  
     **Выберите таблицы и представления:** Выберите таблицу, которую вы только что создали, NewSalesData.  
  
3.  Нажмите кнопку **Готово**.  
  
4.  На поверхности представления исходного кода, нажмите правой кнопкой кнопку NewSalesData, а затем выберите **Исследуйте данные** для проверки данных.  
  
> [!WARNING]  
>  Эти данные будут использоваться только для прогноза, поэтому если они неполные, это не имеет значения.  
  
##  <a name="creating-the-data-for-the-cross-prediction-model"></a><a name="bkmk_CrossData2"></a>Создание данных для модели перекрестного прогнозирования  
 Данные, использованные в исходной модели прогнозирования, уже были сгруппированы с помощью представления vTimeSeries, которое разбивает несколько моделей велосипедов на более мелкие категории и сводит результаты из отдельных стран в регионы. Чтобы создать модель для проекций для стран всего мира, потребуется создать некоторые простые агрегатные функции напрямую в конструкторе представления источников данных. Новое представление источника данных будет содержать только сумму и среднее значение продаж всех продуктов для всех регионов.  
  
 После создания источника данных для модели следует создать новое представление источников данных для прогноза. Например, если нужно спрогнозировать продажи для Европы с помощью новой мировой модели, нужно передать данные только для Европы. Таким образом будет настроено новое представление источников данных, которое будет фильтровать исходные данные и изменит условие фильтра для каждого набора прогнозирующих запросов.  
  
#### <a name="to-create-the-model-data-using-a-custom-data-source-view"></a>Создание данных модели с помощью пользовательского представления источников данных  
  
1.  В **Solution Explorer**, правой кнопкой мыши **Посмотреть источник данных**, а затем выбрать **новый вид источника данных**.  
  
2.  На странице приветствия мастера нажмите кнопку **Далее**.  
  
3.  На странице **Выбор источника данных** выберите [!INCLUDE[ssAWDWsp](../includes/ssawdwsp-md.md)]и нажмите кнопку **Далее**.  
  
4.  На странице, **Выберите таблицы и представления**, не добавляйте таблицы просто нажмите **Далее**.  
  
5.  На странице, **Завершение мастера** `AllRegions`, введите имя , а затем нажмите **Закончить**.  
  
6.  Далее щелкните по пустой поверхности исходного представления исходного кода, а затем выберите **новый именованный запрос.**  
  
7.  В поле диалога **Create Named Named,** для `AllRegions` **name,** type, и для **описания,** типа **Sum и среднего количества продаж для всех моделей и регионов.**  
  
8.  В панели SQL-текста введи следующую инструкцию и нажмите кнопку «ОК»:  
  
    ```  
    SELECT ReportingDate,   
    SUM([Quantity]) as SumQty, AVG([Quantity]) as AvgQty,  
    SUM([Amount]) AS SumAmt, AVG([Amount]) AS AvgAmt,  
    'All Regions' as [Region]  
    FROM dbo.vTimeSeries   
    GROUP BY ReportingDate  
    ```  
  
9. Нажмите правой кнопкой мыши, `AllRegions` а затем выберите **Исследуйте данные.**  
  
###  <a name="to-create-the-series-data-for-cross-prediction"></a><a name="bkmk_CrossData"></a>Создание данных серий для перекрестного прогнозирования  
  
1.  В **Solution Explorer**, правой кнопкой мыши **Посмотреть источник данных**, а затем выбрать **новый вид источника данных**.  
  
2.  В окне мастера представлений источников данных выберите указанные ниже элементы.  
  
     **Источник данных**:[!INCLUDE[ssAWDWsp](../includes/ssawdwsp-md.md)]  
  
     **Выбор таблиц и представлений**: не выбирайте никаких таблиц.  
  
     **Имя**:`T1000 Pacific Region`  
  
3.  Нажмите кнопку **Готово**.  
  
4.  Право нажмите пустую поверхность дизайна для **T1000 Pacific Region.dsv**, а затем выберите **новый именованный запрос**.  
  
     Откроется диалоговое окно **Создание именованного запроса** . Снова введите имя и добавьте следующее описание:  
  
     **Имя**:`T1000 Pacific Region`  
  
     **Описание**: **Фильтр`vTimeSeries`по регионам и моделям**  
  
5.  В панели ввода текста введите следующий запрос и нажмите кнопку ОК:  
  
    ```  
    SELECT ReportingDate, ModelRegion, Quantity, Amount  
    FROM dbo.vTimeSeries  
    WHERE (ModelRegion = N'T1000 Pacific')  
    ```  
  
    > [!NOTE]  
    >  Поскольку для каждого ряда нужно создавать свой прогноз, текст запроса можно скопировать и сохранить в текстовый файл, чтобы использовать его повторно для других рядов данных.  
  
6.  На поверхности проектирования source Source View, справа щелкните T1000 Pacific, а затем выберите **Исследуйте данные,** чтобы проверить, правильно ли данные фильтруются.  
  
     Эти данные будут использоваться как входные данные для модели при запросах перекрестного прогнозирования.  
  
## <a name="next-task-in-lesson"></a>Следующая задача занятия  
 [Прогнозы временных рядов с использованием обновленных данных &#40;промежуточного учебника по интеллектуальному анализу данных&#41;](../../2014/tutorials/time-series-predictions-using-updated-data-intermediate-data-mining-tutorial.md)  
  
## <a name="see-also"></a>См. также:  
 [Алгоритм временных рядов Майкрософт](../../2014/analysis-services/data-mining/microsoft-time-series-algorithm.md)   
 [Техническая справка по алгоритму временных рядов Майкрософт](../../2014/analysis-services/data-mining/microsoft-time-series-algorithm-technical-reference.md)   
 [Представления источников данных в многомерных моделях](https://docs.microsoft.com/analysis-services/multidimensional-models/data-source-views-in-multidimensional-models)  
  
  
