---
title: Прогнозы временных рядов с заменой данных (учебника интеллектуальному анализу данных) | Документация Майкрософт
ms.custom: ''
ms.date: 04/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: a23a6e1d-1d49-41ea-8314-925dc8e4df5e
author: minewiskan
ms.author: owend
manager: kfile
ms.openlocfilehash: c96b70775105ea9446810ac3b064ae7cb07d4337
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63312883"
---
# <a name="time-series-predictions-using-replacement-data-intermediate-data-mining-tutorial"></a>Прогнозы временных рядов с заменой данных (учебник по интеллектуальному анализу данных — средний уровень)
  В этой задаче вы создадите новую модель на основе данных о продажах во всем мире. Затем вы создадите прогнозирующий запрос, в котором модель мировых продаж будет применена к одному из регионов  
  
## <a name="building-a-general-model"></a>Создание общей модели  
 Помните, что анализ результатов начальной модели интеллектуального анализа данных показал большие различия между регионами и линейками продуктов. Например, продажи модели M200 в Северной Америке были высоки, а продажи модели T1000 были не так успешны. Тем не менее анализ осложняется тот факт, что некоторым рядам имелось мало данных либо сбор данных начался в другой точки во времени. Кроме того, некоторые данные отсутствовали.  
  
 ![Прогнозируемые серии количества M200 и T1000](../../2014/tutorials/media/6series-defaultforecasting.gif "прогнозируемые серии количества M200 и T1000")  
  
 Для устранения некоторых проблем с качеством данных принимается решение слить воедино данные о продажах по всему миру и использовать этот набор общих трендов продаж для создания общей модели, которая позволит прогнозировать продажи в любом регионе.  
  
 Для прогнозирования вы будете использовать закономерность, полученную во время обучения модели с данными мировых продаж, но заменять исторические точки данных данными о продажах для каждого отдельного региона. Таким образом, форма тренда сохраняется, но спрогнозированные значения будут соответствовать историческим показателям продаж для каждого региона и модели.  
  
## <a name="performing-cross-prediction-with-a-time-series-model"></a>Перекрестное прогнозирование с помощью модели временных рядов  
 Процесс использования данных одного ряда для прогнозирования трендов в другом ряду называется перекрестным прогнозированием. Перекрестное прогнозирование можно использовать во многих сценариях: например, вы можете решить, что продажи телевизоров являются хорошим фактором для прогноза общей экономической деятельности и применить модель, обученная на продажи телевизоров, к общим экономическим данным.  
  
 В SQL Server Data Mining, выполнять перекрестные прогнозы с помощью параметра REPLACE_MODEL_CASES в аргументах функции, [PredictTimeSeries &#40;расширений интеллектуального анализа данных&#41;](/sql/dmx/predicttimeseries-dmx).  
  
 В следующей задаче вы узнаете, как использовать параметр REPLACE_MODEL_CASES. Вы используете объединенные данные о мировых продажах для создания модели, а затем создадите прогнозирующий запрос, сопоставляющий общую модель с данными для замены.  
  
 Предполагается, что вы уже знаете, как создавать модели интеллектуального анализа данных, поэтому инструкции по созданию модели упрощены.  
  
#### <a name="to-build-a-mining-structure-and-mining-model-using-the-aggregated-data"></a>Построение структуры и модели интеллектуального анализа данных с использованием агрегатных данных  
  
1.  В **обозревателе решений**, щелкните правой кнопкой мыши **структуры интеллектуального анализа данных**, а затем выберите **создать структуру интеллектуального анализа** запустить мастер интеллектуального анализа данных.  
  
2.  В окне мастера интеллектуального анализа данных выберите указанные ниже элементы.  
  
    -   Алгоритм: алгоритм временных рядов (Майкрософт)  
  
    -   В качестве источника данных для модели используйте источник данных, который уже создали ранее на этом уроке. См. в разделе [расширенные прогнозы временных рядов &#40;средний уровень учебник по интеллектуальному анализу данных&#41;](../../2014/tutorials/advanced-time-series-predictions-intermediate-data-mining-tutorial.md).  
  
         Представление источника данных: `AllRegions`  
  
    -   Выберите следующие столбцы для ключа ряда и временного ключа:  
  
         Ключевое время: ReportingDate  
  
         Ключ: Region  
  
    -   Выберите следующие столбцы для `Input` и `Predict`:  
  
         SumQty  
  
         SumAmt  
  
         AvgAmt  
  
         AvgQty  
  
    -   Для **имя структуры интеллектуального анализа данных**, тип: `All Regions`  
  
    -   Для **имя модели интеллектуального анализа данных**, тип: `All Regions`  
  
3.  Обработайте новую структуру и новую модель.  
  
#### <a name="to-build-the-prediction-query-and-map-the-replacement-data"></a>Создание прогнозирующего запроса и сопоставление данных для замены с моделью  
  
1.  Если модель не открыт, дважды щелкните структуру AllRegions и в конструкторе интеллектуального анализа данных щелкните **модель интеллектуального анализа данных** вкладки.  
  
2.  В **модель интеллектуального анализа данных** области, модель AllRegions уже должен быть выбран. Если он не установлен, нажмите кнопку **Выбор модели**, а затем выделите эту модель.  
  
3.  В **Выбор входных таблиц** панели щелкните **выбрать таблицу вариантов**.  
  
4.  В **Выбор таблицы** диалоговом окне измените источник данных на T1000 Pacific Region и нажмите кнопку **ОК**.  
  
5.  Щелкните правой кнопкой мыши соединительную линию между моделью интеллектуального анализа данных и входных данных и выберите **изменить соединения**. Сопоставьте данные в представлении источника данных с моделью следующим образом.  
  
    1.  Убедитесь, что столбец ReportingDate в модели интеллектуального анализа данных сопоставляется со столбцом ReportingDate во входных данных.  
  
    2.  В **изменение сопоставления** диалоговое окно, в строке для столбца модели AvgQty щелкните в разделе **столбец таблицы** и выберите пункт T1000 Pacific.Quantity. Нажмите кнопку **ОК**.  
  
         На этом шаге сопоставляется столбец, созданный в модели для прогнозирования среднего количества, с фактическими данными о количестве продаж продукта T1000.  
  
    3.  Не сопоставляются столбце Регион в модели ни один входной столбец.  
  
         Поскольку в модели объединены данные по всем рядам, для значений рядов, таких как T1000 Pacific, совпадений нет и при выполнении прогнозирующего запроса возникает ошибка.  
  
6.  Теперь вы создадите прогнозирующий запрос.  
  
     Сначала добавьте к результатам столбец, который выдает с прогнозами метку AllRegions из модели. Таким образом, вы знаете, что результаты были основаны на общей модели.  
  
    1.  В сетке щелкните первую пустую строку в столбце **источника**, а затем выберите модель интеллектуального анализа данных AllRegions.  
  
    2.  Для **поле**, выберите регион.  
  
    3.  Для **псевдоним**, тип **модель использовать**.  
  
7.  Теперь добавьте к результатам другую метку, чтобы видеть, к какому ряду относится прогноз.  
  
    1.  Щелкните пустую строку, а затем в разделе **источника**выберите **пользовательское выражение**.  
  
    2.  В **псевдоним** столбец, тип **ModelRegion**.  
  
    3.  В **критерий или аргумент** столбец, тип `'T1000 Pacific'`.  
  
8.  Теперь вы создадите функцию перекрестного прогнозирования.  
  
    1.  Щелкните пустую строку, а затем в разделе **источника**выберите **Прогнозирующая функция**.  
  
    2.  В **поле** столбец, выберите **PredictTimeSeries**.  
  
    3.  Для **псевдоним**, тип **прогнозируемые значения**.  
  
    4.  Перетащите поле AvgQty из **модель интеллектуального анализа данных** на панель **критерий или аргумент** столбца с помощью операции перетаскивания.  
  
    5.  В **критерий или аргумент** столбец, после имени поля введите следующий текст: `,5, REPLACE_MODEL_CASES`  
  
         Полный текст **критерий или аргумент** текстовое поле должно выглядеть следующим образом: `[AllRegions].[AvgQty],5,REPLACE_MODEL_CASES`  
  
9. Нажмите кнопку **результаты**.  
  
## <a name="creating-the-cross-prediction-query-in-dmx"></a>Создание запроса перекрестного прогнозирования в DMX  
 Вы могли заметить проблемы с перекрестным прогнозированием: то есть, чтобы применить общую модель к другому ряду данных, такие как модель продукта T1000 в Североамериканском регионе, необходимо создать другой запрос для каждого ряда, таким образом, вы можете сопоставить каждый набор Помещает в модель.  
  
 Но можно не создавать запрос в конструкторе, а перейти в представление DMX и отредактировать созданную инструкцию DMX. Например, следующая инструкция DMX представляет только что созданный запрос:  
  
```  
SELECT  
      ([All Regions].[Region]) as [Model Used],  
      ('T-1000 Pacific') as [ModelRegion],  
      (PredictTimeSeries([All Regions].[Avg Qty],5, REPLACE_MODEL_CASES)) as [Predicted Quantity]  
     FROM [All Regions]  
PREDICTION JOIN  
    OPENQUERY([Adventure Works DW2003R2], 'SELECT [ReportingDate] FROM  
      (  
       SELECT  ReportingDate, ModelRegion, Quantity, Amount   
       FROM dbo.vTimeSeries   
       WHERE (ModelRegion = N''T1000 Pacific'')  
       ) as [T1000 Pacific]    ')   
    AS t  
ON   
[All Regions].[Reporting Date] = t.[ReportingDate]   
AND   
[All Regions].[Avg Qty] = t.[Quantity]  
```  
  
 Чтобы применить ее к другой модели, достаточно изменить инструкцию запроса, заменив условие фильтра, и обновить метки для каждого результата.  
  
 Например, в случае изменения условий фильтра и меток столбцов путем замены «Pacific» на «North America» будут получены прогнозы для продукта T1000 в Северной Америке на основании шаблонов в общей модели.  
  
## <a name="next-task-in-lesson"></a>Следующая задача занятия  
 [Сравнение прогнозов моделей прогнозирования &#40;средний уровень учебник по интеллектуальному анализу данных&#41;](../../2014/tutorials/comparing-predictions-for-forecasting-models-intermediate-data-mining-tutorial.md)  
  
## <a name="see-also"></a>См. также  
 [Примеры запросов моделей временных рядов](../../2014/analysis-services/data-mining/time-series-model-query-examples.md)   
 [PredictTimeSeries (расширения интеллектуального анализа данных)](/sql/dmx/predicttimeseries-dmx)  
  
  
