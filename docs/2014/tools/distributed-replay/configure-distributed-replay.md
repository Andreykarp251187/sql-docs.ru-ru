---
title: Настройка распределенное воспроизведение | Документация Майкрософт
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: tools-other
ms.topic: conceptual
ms.assetid: aee11dde-daad-439b-b594-9f4aeac94335
author: stevestein
ms.author: sstein
manager: craigg
ms.openlocfilehash: c5e44910c72e5162b9acb74ebbf74cd19d7ce1bc
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "63149529"
---
# <a name="configure-distributed-replay"></a>Настройка распределенного воспроизведения
  [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Сведения о конфигурации распределенное воспроизведение указаны в XML-файлах на контроллере распределенное воспроизведение, в клиентах и в месте установки средства администрирования. Эти файлы включают в себя:  
  
-   [Файл конфигурации контроллера](#DReplayController)  
  
-   [Файл конфигурации клиента](#DReplayClient)  
  
-   [Файл конфигурации предварительной обработки](#PreprocessConfig)  
  
-   [Файл конфигурации воспроизведения](#ReplayConfig)  
  
##  <a name="DReplayController"></a>Файл конфигурации контроллера: DReplayController. config  
 При запуске службы контроллера распределенного воспроизведения [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] загружаются данные об уровне ведения журнала из файла конфигурации контроллера `DReplayController.config`. Этот файл находится в папке, в которую установлена служба контроллера распределенного воспроизведения:  
  
 **\<путь установки контроллера> \Дреплайконтроллер.конфиг**  
  
 Уровень ведения журнала, заданный в файле конфигурации контроллера, включает следующие параметры.  
  
|Параметр|XML-элемент|Description|Допустимые значения|Обязательно|  
|-------------|-----------------|-----------------|--------------------|--------------|  
|Уровень ведения журнала|`<LoggingLevel>`|Задает уровень ведения журнала для службы контроллера.|`INFORMATION`&#124; `WARNING` &#124;`CRITICAL`|Нет. Значение по умолчанию — `CRITICAL`.|  
  
### <a name="example"></a>Пример  
 В этом примере показан файл конфигурации контроллера, в котором подавляются записи журнала `INFORMATION` и `WARNING` .  
  
```  
<?xml version='1.0'?>  
<Options>  
<LoggingLevel>CRITICAL</LoggingLevel>  
</Options>  
```  
  
##  <a name="DReplayClient"></a>Файл конфигурации клиента: DReplayClient. config  
 При запуске служба клиента распределенного воспроизведения [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] загружает параметры конфигурации из файла конфигурации клиента `DReplayClient.config`. Этот файл находится на каждом клиентском компьютере в папке, где установлена служба клиента распределенного воспроизведения:  
  
 **\<путь установки клиента> \Дреплайклиент.конфиг**  
  
 В файле конфигурации клиента указываются следующие параметры:  
  
|Параметр|XML-элемент|Description|Допустимые значения|Обязательно|  
|-------------|-----------------|-----------------|--------------------|--------------|  
|Контроллер|`<Controller>`|Задает имя компьютера для контроллера. Клиент предпринимает попытку зарегистрироваться в среде распределенного воспроизведения, обращаясь к контроллеру.|Локальный компьютер можно указать как «`localhost`» или «`.`».|Нет. По умолчанию клиент пытается зарегистрироваться на экземпляре контроллера, работающего локально («`.`»), если таковой существует.|  
|Рабочий каталог клиента|`<WorkingDirectory>`|Локальный путь на клиенте, где сохраняются переданные файлы.<br /><br /> Файлы в этом каталоге при следующем воспроизведении перезаписываются.|Полное имя каталога, начиная с буквы диска.|Нет. Если значение не задано, то переданные файлы сохраняются в той же папке, где находится файл конфигурации клиента по умолчанию. Если значение указано, но папка не существует на клиенте, то служба клиента не будет запущена.|  
|Результирующий каталог клиента|`<ResultDirectory>`|Локальный путь на клиенте, где сохраняется файл результатов трассировки после воспроизведения (для клиента).<br /><br /> Файлы в этом каталоге при следующем воспроизведении перезаписываются.|Полное имя каталога, начиная с буквы диска.|Нет. Если значение не задано, то файл трассировки результатов сохраняется в той же папке, где находится файл конфигурации клиента по умолчанию. Если значение указано, но папка не существует на клиенте, то служба клиента не будет запущена.|  
|Уровень ведения журнала|`<LoggingLevel>`|Задает уровень ведения журнала для службы клиента.|`INFORMATION`&#124; `WARNING` &#124;`CRITICAL`|Нет. Значение по умолчанию — `CRITICAL`.|  
  
### <a name="example"></a>Пример  
 В этом примере показан измененный файл конфигурации клиента, в котором указано, что служба контроллера выполняется на другом компьютере с именем `Controller1`. Элементы `WorkingDirectory` и `ResultDirectory` настроены на использование папок `c:\ClientWorkingDir` и `c:\ResultTraceDir`соответственно. Уровень ведения журнала по умолчанию изменен, в нем подавлены записи журнала `INFORMATION` и `WARNING` .  
  
```  
<?xml version='1.0'?>  
<Options>  
    <Controller>Controller1</Controller>  
    <WorkingDirectory>c:\ClientWorkingDir</WorkingDirectory>  
    <ResultDirectory>c:\ResultTraceDir</ResultDirectory>  
    <LoggingLevel>CRITICAL</LoggingLevel>  
</Options>  
```  
  
##  <a name="PreprocessConfig"></a>Файл конфигурации предварительной обработки: DReplay. exe. Предварительная обработка. config  
 При использовании средства администрирования для запуска предварительной обработки оно загружает параметры из файла конфигурации предварительной обработки `DReplay.exe.preprocess.config`.  
  
 Расположение измененного файла конфигурации предварительной обработки можно указать в файле конфигурации по умолчанию или в параметре средства администрирования **-c**. Дополнительные сведения об использовании параметра предварительной обработки средства администрирования см. в разделе [Параметр предварительной обработки (средство администрирования распределенного воспроизведения)](preprocess-option-distributed-replay-administration-tool.md).  
  
 Файл конфигурации предварительной обработки по умолчанию расположен в папке установки средства администрирования.  
  
 **\<путь установки средства администрирования> \Дреплайадмин\дреплай.ЕКСЕ.препроцесс.конфиг**  
  
 Параметры конфигурации предварительной обработки указываются в дочерних XML-элементах элемента `<PreprocessModifiers>` в файле конфигурации предварительной обработки. К числу этих параметров относятся следующие:  
  
|Параметр|XML-элемент|Description|Допустимые значения|Обязательно|  
|-------------|-----------------|-----------------|--------------------|--------------|  
|Включить действия системного сеанса|`<IncSystemSession>`|Указывает, будут ли включены записанные действия системного сеанса при воспроизведении.|`Yes`&#124;`No`|Нет. Значение по умолчанию — `No`.|  
|Максимальное время простоя|`<MaxIdleTime>`|Время простоя в секундах.|Целое число, равное >=-1<br /><br /> 
  `-1` указывает, что значение в исходном файле трассировки не менялось.<br /><br /> `0`Указывает, что в любой момент времени происходит некоторое действие.|Нет. Значение по умолчанию — `-1`.|  
  
### <a name="example"></a>Пример  
 Файл конфигурации предварительной обработки по умолчанию.  
  
```  
<?xml version='1.0'?>  
<Options>  
    <PreprocessModifiers>  
        <IncSystemSession>No</IncSystemSession>  
        <MaxIdleTime>-1</MaxIdleTime>  
    </PreprocessModifiers>  
</Options>  
```  
  
##  <a name="ReplayConfig"></a>Файл конфигурации воспроизведения: DReplay. exe. Play. config  
 При использовании средства администрирования для запуска воспроизведения событий оно загружает параметры воспроизведения из файла конфигурации воспроизведения `DReplay.exe.replay.config`.  
  
 Расположение измененного файла конфигурации воспроизведения можно указать в файле конфигурации по умолчанию или в параметре средства администрирования **-c**. Дополнительные сведения об использовании параметра воспроизведения средства администрирования см. в разделе [Параметр воспроизведения (средство администрирования распределенного воспроизведения)](replay-option-distributed-replay-administration-tool.md).  
  
 Файл конфигурации воспроизведения по умолчанию расположен в папке установки средства администрирования.  
  
 **\<путь установки средства администрирования> \Дреплайадмин\дреплай.ЕКСЕ.реплай.конфиг**  
  
 Параметры конфигурации воспроизведения указываются в дочерних XML-элементах элементов `<ReplayOptions>` и `<OutputOptions>` в файле конфигурации воспроизведения.  
  
### <a name="replayoptions-element"></a>\<Элемент> ReplayOptions  
 В файле конфигурации воспроизведения в элементе `<ReplayOptions>` указываются следующие параметры.  
  
|Параметр|XML-элемент|Description|Допустимые значения|Обязательно|  
|-------------|-----------------|-----------------|--------------------|--------------|  
|Целевой экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] (тестовый сервер)|`<Server>`|Задает имя сервера и экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] для подключения.|*server_name*[\\*instance_name*]<br /><br /> Указывать «`localhost`» или «`.`» в качестве псевдонима локального узла нельзя.|Нет, если имя сервера уже задано с помощью параметра **-s**_целевого сервера_ с параметром **воспроизведения** средства администрирования.|  
|Режим последовательного выполнения|`<SequencingMode>`|Задает режим планирования событий.|`synchronization`&#124;`stress`|Нет. Значение по умолчанию — `stress`.|  
|Гранулярность масштабирования нагрузки|`<StressScaleGranularity>`|Указывает, должны ли все соединения с идентификатором SPID масштабироваться в режиме нагрузки совместно (SPID) или независимо (Connection).|SPID &#124; Connection|Да. Значение по умолчанию — `SPID`.|  
|Масштаб времени подключения|`<ConnectTimeScale>`|Используется для масштабирования времени подключения в режиме нагрузки.|Целое число от `1` до `100`.|Нет. Значение по умолчанию — `100`.|  
|Масштаб времени обработки|`<ThinkTimeScale>`|Используется для масштабирования времени обработки в режиме нагрузки.|Целое число от `0` до `100`.|Нет. Значение по умолчанию — `100`.|  
|Использование пула соединений|`<UseConnectionPooling>`|Указывает, будет ли использоваться пул соединений на каждом клиенте распределенного воспроизведения.|Да &#124; Нет|Да. Значение по умолчанию — `Yes`.|  
|Интервал опроса монитора исправности|`<HealthmonInterval>`|Указывает частоту запуска монитора исправности (в секундах).<br /><br /> Это значение используется только в режиме синхронизации.|Целое число >= 1<br /><br /> (`-1` для отключения)|Нет. Значение по умолчанию — `60`.|  
|Время ожидания запроса|`<QueryTimeout>`|Задает время ожидания запроса в секундах. Это значение действует только до возврата первой строки.|Целое число >= 1<br /><br /> (`-1` для отключения)|Нет. Значение по умолчанию — `3600`.|  
|Потоков на клиент|`<ThreadsPerClient>`|Задает число потоков воспроизведения для использования на каждом клиенте воспроизведения.|Целое число от `1` до `512`.|Нет. Если значение не указано, то для распределенного воспроизведения будет использоваться значение `255`.|  
  
### <a name="outputoptions-element"></a>\<Элемент> OutputOptions  
 В файле конфигурации воспроизведения в элементе `<OutputOptions>` указываются следующие параметры.  
  
|Параметр|XML-элемент|Description|Допустимые значения|Обязательно|  
|-------------|-----------------|-----------------|--------------------|--------------|  
|Запись числа строк|`<RecordRowCount>`|Указывает, следует ли записывать число строк для каждого результирующего набора.|`Yes`&#124;`No`|Нет. Значение по умолчанию — `Yes`.|  
|Запись результирующих наборов|`<RecordResultSet>`|Указывает, следует ли записывать содержимое всех результирующих наборов.|`Yes`&#124;`No`|Нет. Значение по умолчанию — `No`.|  
  
### <a name="example"></a>Пример  
 Файл конфигурации воспроизведения по умолчанию:  
  
```  
<?xml version='1.0'?>  
<Options>  
    <ReplayOptions>  
        <Server></Server>  
        <SequencingMode>stress</SequencingMode>  
        <ConnectTimeScale></ConnectTimeScale>  
        <ThinkTimeScale></ThinkTimeScale>  
        <HealthmonInterval>60</HealthmonInterval>  
        <QueryTimeout>3600</QueryTimeout>  
        <ThreadsPerClient></ThreadsPerClient>  
    </ReplayOptions>  
    <OutputOptions>  
        <ResultTrace>  
            <RecordRowCount>Yes</RecordRowCount>  
            <RecordResultSet>No</RecordResultSet>  
        </ResultTrace>  
    </OutputOptions>  
</Options>  
```  
  
## <a name="see-also"></a>См. также:  
 [Параметры командной строки средства администрирования &#40;распределенное воспроизведение служебной программы&#41;](administration-tool-command-line-options-distributed-replay-utility.md)   
 [SQL Server распределенное воспроизведение](sql-server-distributed-replay.md)   
 [Форум распределенное воспроизведение SQL Server](https://social.technet.microsoft.com/Forums/sl/sqldru/)   
 [Использование распределенное воспроизведение для нагрузочного тестирования SQL Server. часть 2](https://blogs.msdn.com/b/mspfe/archive/2012/11/14/using-distributed-replay-to-load-test-your-sql-server-part-2.aspx)   
 [Использование распределенное воспроизведение для нагрузочного тестирования SQL Server. часть 1](https://blogs.msdn.com/b/mspfe/archive/2012/11/08/using-distributed-replay-to-load-test-your-sql-server-part-1.aspx)  
  
  
