---
title: sp_addmergearticle (Transact-SQL) | Документация Майкрософт
ms.custom: ''
ms.date: 03/14/2017
ms.prod: sql
ms.prod_service: database-engine
ms.reviewer: ''
ms.technology: replication
ms.topic: language-reference
f1_keywords:
- sp_addmergearticle
- sp_addmergearticle_TSQL
helpviewer_keywords:
- sp_addmergearticle
ms.assetid: 0df654ea-24e2-4c61-a75a-ecaa7a140a6c
author: stevestein
ms.author: sstein
ms.openlocfilehash: e3741dde8d570ae6b404caf326e5dce607dc30f6
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "67947538"
---
# <a name="spaddmergearticle-transact-sql"></a>sp_addmergearticle (Transact-SQL)
[!INCLUDE[tsql-appliesto-ss2008-xxxx-xxxx-xxx-md](../../includes/tsql-appliesto-ss2008-xxxx-xxxx-xxx-md.md)]

  Добавляет статью к существующей публикации слиянием. Эта хранимая процедура выполняется на издателе в базе данных публикации.  
  
 ![Значок ссылки на раздел](../../database-engine/configure-windows/media/topic-link.gif "Значок ссылки на раздел") [Синтаксические обозначения в Transact-SQL](../../t-sql/language-elements/transact-sql-syntax-conventions-transact-sql.md)  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
sp_addmergearticle [ @publication = ] 'publication'   
        , [ @article = ] 'article'   
        , [ @source_object = ] 'source_object'   
    [ , [ @type = ] 'type' ]   
    [ , [ @description = ] 'description' ]   
    [ , [ @column_tracking = ] 'column_tracking' ]   
    [ , [ @status = ] 'status' ]   
    [ , [ @pre_creation_cmd = ] 'pre_creation_cmd' ]   
    [ , [ @creation_script = ] 'creation_script' ]   
    [ , [ @schema_option = ] schema_option ]   
    [ , [ @subset_filterclause = ] 'subset_filterclause' ]   
    [ , [ @article_resolver = ] 'article_resolver' ]   
    [ , [ @resolver_info = ] 'resolver_info' ]   
    [ , [ @source_owner = ] 'source_owner' ]   
    [ , [ @destination_owner = ] 'destination_owner' ]   
    [ , [ @vertical_partition = ] 'vertical_partition' ]   
    [ , [ @auto_identity_range = ] 'auto_identity_range' ]   
    [ , [ @pub_identity_range = ] pub_identity_range ]   
    [ , [ @identity_range = ] identity_range ]   
    [ , [ @threshold = ] threshold ]   
    [ , [ @verify_resolver_signature = ] verify_resolver_signature ]   
    [ , [ @destination_object = ] 'destination_object' ]   
    [ , [ @allow_interactive_resolver = ] 'allow_interactive_resolver' ]   
    [ , [ @fast_multicol_updateproc = ] 'fast_multicol_updateproc' ]   
    [ , [ @check_permissions = ] check_permissions ]   
    [ , [ @force_invalidate_snapshot = ] force_invalidate_snapshot ]  
    [ , [ @published_in_tran_pub = ] 'published_in_tran_pub' ]  
    [ , [ @force_reinit_subscription = ] force_reinit_subscription ]  
    [ , [ @logical_record_level_conflict_detection = ] 'logical_record_level_conflict_detection' ]  
    [ , [ @logical_record_level_conflict_resolution = ] 'logical_record_level_conflict_resolution' ]  
    [ , [ @partition_options = ] partition_options ]  
    [ , [ @processing_order = ] processing_order ]  
    [ , [ @subscriber_upload_options = ] subscriber_upload_options ]  
    [ , [ @identityrangemanagementoption = ] 'identityrangemanagementoption' ]  
    [ , [ @delete_tracking = ] delete_tracking ]  
    [ , [ @compensate_for_errors = ] 'compensate_for_errors' ]   
    [ , [ @stream_blob_columns = ] 'stream_blob_columns' ]  
```  
  
## <a name="arguments"></a>Аргументы  
`[ @publication = ] 'publication'` — Имя публикации, которая содержит статью. *Публикация* — **sysname**, не имеет значения по умолчанию.  
  
`[ @article = ] 'article'` — Имя статьи. Имя должно быть уникальным в пределах публикации. *статья* — **sysname**, не имеет значения по умолчанию. *статья* должна находиться на локальном компьютере, выполняющем [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]и должны соответствовать правилам для идентификаторов.  
  
`[ @source_object = ] 'source_object'` — Объект базы данных для публикации. *source_object* — **sysname**, не имеет значения по умолчанию. Дополнительные сведения о типах объектов, которые могут быть опубликованы при репликации слиянием, см. в разделе [публикация данных и объектов базы данных](../../relational-databases/replication/publish/publish-data-and-database-objects.md).  
  
`[ @type = ] 'type'` — Это тип статьи. *Тип* — **sysname**, значение по умолчанию **таблицы**, и может принимать одно из следующих значений.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**Таблица** (по умолчанию)|Таблица со схемой и данными. Репликация проверяет таблицу, определяя данные, которые должны реплицироваться.|  
|**только схема func**|Только функция со схемой.|  
|**Индексированное представление** **только схема**|Только индексированное представление со схемой.|  
|**только схема процедуры**|Только хранимая процедура со схемой.|  
|**только схема синонима**|Только синоним со схемой.|  
|**только схема представления**|Только представление со схемой.|  
  
`[ @description = ] 'description'` Представляет собой описание статьи. *Описание* — **nvarchar(255)** , значение по умолчанию NULL.  
  
`[ @column_tracking = ] 'column_tracking'` Это параметр отслеживания на уровне столбца. *column_tracking* — **nvarchar(10)** , значение по умолчанию FALSE. **значение true,** включается отслеживание столбцов. **false** выключает отслеживание столбцов, обнаружение конфликтов остается на уровне строк. Если таблица уже опубликована в других публикациях слиянием, необходимо использовать для параметра отслеживания столбца то же значение, что и для существующих статей, основанных на данной таблице. Этот параметр применим только для статей таблиц.  
  
> [!NOTE]  
>  Если для обнаружения конфликтов применяется трассировка на уровне строк (по умолчанию), базовая таблица может содержать не более 1 024 столбцов, однако столбцы из статьи должны быть отфильтрованы, чтобы было опубликовано не более 246 столбцов. Если применяется трассировка на уровне столбцов, базовая таблица может содержать не более 246 столбцов.  
  
`[ @status = ] 'status'` — Состояние статьи. *состояние* — **nvarchar(10)** , значение по умолчанию **unsynced**. Если **active**, скрипт начальной обработки для публикации таблицы запускается. Если **unsynced**, скрипт начальной обработки для публикации таблицы запускается при следующем запуске агента моментальных снимков.  
  
`[ @pre_creation_cmd = ] 'pre_creation_cmd'` Указывает, что система находится в случае, если таблица существует на подписчике при применении моментального снимка. *pre_creation_cmd* — **nvarchar(10)** , и может принимать одно из следующих значений.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**Нет**|Если таблица на подписчике уже существует, не выполняется никаких действий.|  
|**delete**|Выполняет удаление, используя предложение WHERE, указанное в фильтре подмножества.|  
|**DROP** (по умолчанию)|Удаляет таблицу перед ее повторным созданием. Требуется для поддержки [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssEW](../../includes/ssew-md.md)] подписчиков.|  
|**truncate**|Усекает целевую таблицу.|  
  
`[ @creation_script = ] 'creation_script'` — Путь и имя необязательного скрипта схемы статьи используется для создания статьи в базе данных подписки. *creation_script* — **nvarchar(255)** , значение по умолчанию NULL.  
  
> [!NOTE]  
>  Скрипты создания не запускаются на подписчиках [!INCLUDE[ssEW](../../includes/ssew-md.md)].  
  
`[ @schema_option = ] schema_option` — Это битовая карта параметра формирования схемы для данной статьи. *schema_option* — **binary(8)** и может быть [| (Побитовое или) ](../../t-sql/language-elements/bitwise-or-transact-sql.md) над одним или несколькими из следующих значений.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**0x00**|Запрещает выполнение скриптов агентом моментальных снимков и использует сценарий предварительного создания схемы, указанной в *creation_script*.|  
|**0x01**|Формирует создание объекта (CREATE TABLE, CREATE PROCEDURE и т.п.). Это значение по умолчанию для статей хранимых процедур.|  
|**0x10**|Создает соответствующий кластеризованный индекс. Даже если этот параметр не установлен, индексы, связанные с первичными ключами и ограничениями уникальности, создаются при условии, что они уже определены в опубликованной таблице.|  
|**0x20**|Преобразует определяемые пользователем типы данных (UDT) в базовые типы данных подписчика. Этот параметр не может использоваться, если на столбец UDT наложено ограничение CHECK или DEFAULT, если столбец UDT является частью первичного ключа или если вычисляемый столбец ссылается на столбец UDT.|  
|**0x40**|Создает соответствующие некластеризованные индексы. Даже если этот параметр не установлен, индексы, связанные с первичными ключами и ограничениями уникальности, создаются при условии, что они уже определены в опубликованной таблице.|  
|**0x80**|Реплицирует ограничения PRIMARY KEY. Любые индексы, связанные с ограничением, также реплицируются, даже если параметры **0x10** и **0x40** не включены.|  
|**0x100**|Реплицирует пользовательские триггеры для статьи таблицы, если заданы.|  
|**0x200**|Реплицирует ограничения FOREIGN KEY. Если таблица, к которой происходит обращение, не является частью публикации, все ограничения FOREIGN KEY в опубликованной таблице не реплицируются.|  
|**0x400**|Реплицирует ограничения CHECK.|  
|**0x800**|Реплицирует значения по умолчанию.|  
|**0x1000**|Реплицирует параметры сортировки на уровне столбцов.|  
|**0x2000**|Реплицирует расширенные свойства, связанные с исходным объектом опубликованной статьи.|  
|**0x4000**|Реплицирует ограничения UNIQUE. Любые индексы, связанные с ограничением, также реплицируются, даже если параметры **0x10** и **0x40** не включены.|  
|**0x8000**|Данный параметр недопустим для издателей, использующих [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] или более поздние версии.|  
|**0x10000**|Реплицирует ограничения CHECK как NOT FOR REPLICATION, чтобы они не применялись при синхронизации.|  
|**0x20000**|Реплицирует ограничения FOREIGN KEY как NOT FOR REPLICATION, чтобы они не применялись при синхронизации.|  
|**0x40000**|Реплицирует файловые группы, связанные с секционированной таблицей или индексом.|  
|**0x80 000**|Реплицирует схему секционирования для секционированной таблицы.|  
|**0x100000**|Реплицирует схему секционирования для секционированного индекса.|  
|**0x200000**|Реплицирует статистику таблицы.|  
|**0x400000**|Реплицирует привязки к значениям по умолчанию.|  
|**0x800000**|Реплицирует привязки к правилам.|  
|**0x1000000**|Реплицирует полнотекстовый индекс.|  
|**0x2000000**|Коллекции схем XML, привязанные к **xml** столбцы не реплицируются.|  
|**0x4000000**|Реплицирует индексы, основанные на **xml** столбцов.|  
|**0x8000000**|Создает любые схемы, кроме уже существующих на подписчике.|  
|**0x10000000**|Преобразует **xml** столбцы для **ntext** на подписчике.|  
|**0x20000000**|Преобразует типы данных больших объектов (**nvarchar(max)** , **varchar(max)** , и **varbinary(max)** ) в [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] в типы данных, которые поддерживаются в [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)].|  
|**0x40000000**|Реплицирует разрешения.|  
|**0x80000000**|Пытается удалять зависимости для всех объектов, не входящих в публикацию.|  
|**0x100000000**|Используйте этот параметр для репликации атрибута FILESTREAM, если он указан на **varbinary(max)** столбцов. Не указывайте этот параметр, если выполняется репликация таблиц на подписчики [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]. Репликация таблиц со столбцами FILESTREAM на [!INCLUDE[ssVersion2000](../../includes/ssversion2000-md.md)] подписчиков не поддерживается, независимо от того, как задается этот параметр схемы. См. связанный параметр **0x800000000**.|  
|**0x200000000**|Преобразует типы данных даты и времени (**даты**, **время**, **datetimeoffset**, и **datetime2**) в [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] к данным типы, которые поддерживаются в более ранних версиях [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].|  
|**0x400000000**|Проводит репликацию параметра сжатия для данных и индексов. Дополнительные сведения см. в разделе [Data Compression](../../relational-databases/data-compression/data-compression.md).|  
|**0x800000000**|Задайте этот параметр для сохранения данных атрибута FILESTREAM в его файловой группе на подписчике. Если этот параметр не задан, данные атрибута FILESTREAM сохраняются в файловой группе по умолчанию. Репликация не создает файловые группы, поэтому, если этот параметр задан, необходимо создать файловую группу до применения моментального снимка на подписчике. Дополнительные сведения о том, как создавать объекты, перед применением моментального снимка см. в разделе [выполнение скриптов до и после применения моментального снимка](../../relational-databases/replication/snapshot-options.md#execute-scripts-before-and-after-snapshot-is-applied).<br /><br /> См. связанный параметр **0x100000000**.|  
|**0x1000000000**|Преобразует типами среды CLR (CLR) пользовательских (данных UDT) в **varbinary(max)** , чтобы столбцы определяемого Пользователем типа могли реплицироваться на подписчики, работающие [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].|  
|**0x2000000000**|Преобразует **hierarchyid** тип данных для **varbinary(max)** таким образом, столбцы типа **hierarchyid** могли реплицироваться на подписчики, работающие [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]. Дополнительные сведения об использовании **hierarchyid** столбцов в реплицированных таблицах см. в разделе [hierarchyid &#40;Transact-SQL&#41;](../../t-sql/data-types/hierarchyid-data-type-method-reference.md).|  
|**0x4000000000**|Проводит репликацию всех фильтруемых индексов для таблицы. Дополнительные сведения об отфильтрованных индексах см. в разделе [Создание отфильтрованных индексов](../../relational-databases/indexes/create-filtered-indexes.md).|  
|**0x8000000000**|Преобразует **geography** и **geometry** типами данных **varbinary(max)** , чтобы столбцы этих типов могут реплицироваться на подписчики, работающие [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)].|  
|**0x10000000000**|Реплицирует индексы для столбцов типа **geography** и **geometry**.|  
  
 Если это значение равно NULL, система автоматически создает допустимый параметр схемы для данной статьи. **Параметры схемы по умолчанию** приведены в разделе "Примечания" значения, которые выбираются на основе типа статьи. Кроме того, не все *schema_option* значения допустимы для всех типов репликации и типа статьи. **Допустимые параметры схемы** таблице в разделе «примечания» показаны параметры, которые могут быть указаны для данного типа статьи.  
  
> [!NOTE]  
>  *Schema_option* параметр влияет только на параметры репликации исходного моментального снимка. Когда исходная схема будет сформирован агентом моментальных снимков и применена на подписчике, репликация изменений схемы публикации на подписчик происходит на основании правил репликации изменений схемы и *replicate_ddl* значения параметра, указанного в [sp_addmergepublication](../../relational-databases/system-stored-procedures/sp-addmergepublication-transact-sql.md). Дополнительные сведения см. в статье [Внесение изменений в схемы баз данных публикации](../../relational-databases/replication/publish/make-schema-changes-on-publication-databases.md).  
  
`[ @subset_filterclause = ] 'subset_filterclause'` Предложение WHERE задает горизонтальную фильтрацию статьи таблицы без слова там, ГДЕ включены. *subset_filterclause* имеет **nvarchar(1000)** , значение по умолчанию является пустая строка.  
  
> [!IMPORTANT]  
>  По соображениям производительности не рекомендуется применять функции к именам столбцов в предложениях параметризованных фильтров строк, например `LEFT([MyColumn]) = SUSER_SNAME()`. Если вы используете [HOST_NAME](../../t-sql/functions/host-name-transact-sql.md) в предложении фильтра и переопределении значения HOST_NAME, может потребоваться преобразование типов данных с помощью [преобразовать](../../t-sql/functions/cast-and-convert-transact-sql.md). Дополнительные сведения о рекомендациях по этому сценарию в подразделе «Переопределение значения HOST_NAME()» раздела [параметризованные фильтры строк](../../relational-databases/replication/merge/parameterized-filters-parameterized-row-filters.md).  
  
`[ @article_resolver = ] 'article_resolver'` — Арбитра конфликтов на основе COM, используемый для разрешения конфликтов статей таблиц или сборки .NET Framework, вызываемая для выполнения пользовательской бизнес-логики табличной статьи. *article_resolver* — **varchar(255)** , значение по умолчанию NULL. Доступные значения для этого параметра, перечислены в [!INCLUDE[msCoName](../../includes/msconame-md.md)] пользовательские сопоставители конфликтов Майкрософт. Если значение не является одним из [!INCLUDE[msCoName](../../includes/msconame-md.md)] сопоставителей, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] использует указанный Сопоставитель вместо предоставляемого системы. Используйте **sp_enumcustomresolvers** перечислить список имеющихся пользовательских сопоставителей. Дополнительные сведения см. в разделе [выполнение бизнес логики во время синхронизации слияния](../../relational-databases/replication/merge/execute-business-logic-during-merge-synchronization.md) и [Advanced Merge Replication Conflict Detection и разрешение](../../relational-databases/replication/merge/advanced-merge-replication-conflict-detection-and-resolution.md).  
  
`[ @resolver_info = ] 'resolver_info'` Используется для указания дополнительных сведений, необходимых пользовательскому сопоставителю. Некоторым из сопоставителей конфликтов [!INCLUDE[msCoName](../../includes/msconame-md.md)] в качестве входного параметра требуется столбец. *resolver_info* — **nvarchar(255)** , значение по умолчанию NULL. Дополнительные сведения см. в статье [Сопоставители на базе технологии Microsoft COM](../../relational-databases/replication/merge/advanced-merge-replication-conflict-com-based-resolvers.md).  
  
`[ @source_owner = ] 'source_owner'` Имя владельца *source_object*. *Этот аргумент* — **sysname**, значение по умолчанию NULL. Если значение равно NULL, то предполагается, что владельцем является текущий пользователь.  
  
`[ @destination_owner = ] 'destination_owner'` Является владельцем объекта в базе данных подписки, отличный от «dbo». *destination_owner* — **sysname**, значение по умолчанию NULL. Если значение аргумента равно NULL, то предполагается, что владельцем является dbo.  
  
`[ @vertical_partition = ] 'column_filter'` Включает и выключает фильтрацию столбцов в статье таблицы. *vertical_partition* — **nvarchar(5)** значение по умолчанию FALSE.  
  
 **false** указывает на отсутствие вертикальной фильтрации и публикацию всех столбцов.  
  
 **значение true,** очищает все столбцы, кроме объявленного первичного ключа и столбцов ROWGUID. Столбцы добавляются с помощью **sp_mergearticlecolumn**.  
  
`[ @auto_identity_range = ] 'automatic_identity_range'` Включает и выключает автоматическую обработку для данной табличной статьи публикации во время его создания диапазона идентификаторов. *auto_identity_range* — **nvarchar(5)** , значение по умолчанию FALSE. **значение true,** включает автоматический диапазон идентификаторов обработки, тогда как **false** отключает его.  
  
> [!NOTE]  
>  *auto_identity_range* является устаревшим и предоставляется только для обратной совместимости. Следует использовать *identityrangemanagementoption* для указания параметры управления диапазонами идентификаторов. Дополнительные сведения см. в статье [Репликация столбцов идентификаторов](../../relational-databases/replication/publish/replicate-identity-columns.md).  
  
`[ @pub_identity_range = ] pub_identity_range` Элементы управления размером диапазона идентификаторов, выделенного подписчику с серверной подпиской когда используется автоматическое управление диапазонами идентификаторов. Этот диапазон идентификаторов резервируется переиздающему подписчику для выделения собственным подписчикам. *pub_identity_range* — **bigint**, значение по умолчанию NULL. Этот параметр обязателен, если *identityrangemanagementoption* — **автоматически** или, если *auto_identity_range* — **true**.  
  
`[ @identity_range = ] identity_range` Элементы управления размером диапазона идентификаторов выделяемый к издателю и подписчику при используется автоматическое управление диапазонами идентификаторов. *Аргумент identity_range* — **bigint**, значение по умолчанию NULL. Этот параметр обязателен, если *identityrangemanagementoption* — **автоматически** или, если *auto_identity_range* — **true**.  
  
> [!NOTE]  
>  *Аргумент identity_range* управляет размером диапазона идентификаторов на переиздающих подписчиках, использующих предыдущие версии [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
`[ @threshold = ] threshold` Процентное значение, которое определяет, когда агент слияния назначает новый диапазон идентификаторов. При указании процентное отношение значений в *пороговое значение* будет использовано, агент слияния создает новый диапазон идентификаторов. *Пороговое значение* — **int**, значение по умолчанию NULL. Этот параметр обязателен, если *identityrangemanagementoption* — **автоматически** или, если *auto_identity_range* — **true**.  
  
`[ @verify_resolver_signature = ] verify_resolver_signature` Указывает, если цифровая подпись проверяется перед использованием сопоставителя в репликации слиянием. *verify_resolver_signature* — **int**, значение по умолчанию 1.  
  
 **0** указывает, что подпись не проверяется.  
  
 **1** указывает, что подпись будет проверяться, чтобы увидеть, что он получен из надежного источника.  
  
`[ @destination_object = ] 'destination_object'` — Имя объекта в базе данных подписки. *destination_object* — **sysname**, со значением по умолчанию новые **@source_object** . Этот аргумент может быть указан только для статей типа «только схема», например для статей хранимых процедур, представлений или пользовательских функций. Если статья определена является статьи таблицы, значение в *@source_object* переопределяет значение в *destination_object*.  
  
`[ @allow_interactive_resolver = ] 'allow_interactive_resolver'` Включает или отключает использование интерактивного арбитра конфликтов для статьи. *allow_interactive_resolver* — **nvarchar(5)** , значение по умолчанию FALSE. **значение true,** разрешает использование интерактивного арбитра конфликтов для данной статьи; **false** отключает его.  
  
> [!NOTE]  
>  Интерактивный сопоставитель конфликтов не поддерживается подписчиками [!INCLUDE[ssEW](../../includes/ssew-md.md)].  
  
`[ @fast_multicol_updateproc = ] 'fast_multicol_updateproc'` Этот параметр является устаревшим и сохраняется для обратной совместимости скриптов.  
  
`[ @check_permissions = ] check_permissions` — Это битовая карта разрешений уровня таблицы, которые проверяются, когда агент слияния применяет изменения на издатель. Если имя входа или пользовательская учетная запись на издателе, от имени которой выполняется процесс слияния, не обладает необходимыми разрешениями на таблицы, недопустимые изменения регистрируются в журнале как конфликты. *check_permissions* — **int**и может быть [| (Побитовое или) ](../../t-sql/language-elements/bitwise-or-transact-sql.md) продукта из одного или нескольких из следующих значений.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**0x00** (по умолчанию)|Разрешения не проверяются.|  
|**0x10**|Проверяет разрешения на издателе перед передачей операций вставки, выполняемых на подписчике.|  
|**0x20**|Проверяет разрешения на издателе перед передачей операций обновления, выполняемых на подписчике.|  
|**0x40**|Проверяет разрешения на издателе перед передачей операций удаления, выполняемых на подписчике.|  
  
`[ @force_invalidate_snapshot = ] force_invalidate_snapshot` Подтверждает, что действие, выполняемое данной хранимой процедурой, может сделать недействительным существующий моментальный снимок. *подписки потребуют* — **бит**, значение по умолчанию 0.  
  
 **0** указывает, что добавление статьи не приводит к недействительности моментального снимка. Если хранимая процедура определяет, что изменение требует создания нового моментального снимка, возникает ошибка и изменения не выполняются.  
  
 **1** указывает, что добавление статьи может привести к недействительности моментального снимка и если существующие подписки потребуют нового моментального снимка, дается разрешение существующий моментальный снимок помечается как устаревшего и создание нового моментального снимка. *подписки потребуют* присваивается **1** при добавлении статьи в публикацию с помощью существующего моментального снимка.  
  
`[ @published_in_tran_pub = ] 'published_in_tran_pub'` Указывает, что статьи в публикации слиянием также опубликована в публикации транзакций. *published_in_tran_pub* — **nvarchar(5)** , значение по умолчанию FALSE. **значение true,** указывает, что статья также опубликована в публикации транзакций.  
  
`[ @force_reinit_subscription = ] force_reinit_subscription` Подтверждает, что действие, выполняемое данной хранимой процедурой, может сделать необходимой повторную инициализацию текущих подписок. *Этот* — **бит**, значение по умолчанию 0.  
  
 **0** указывает, что добавление статьи не вызывает повторной инициализации подписки. Если хранимая процедура определяет, что изменения потребуют повторной инициализации подписок, возникает ошибка, и изменения не выполняются.  
  
 **1** означает, что изменения статьи слияния вызывают повторную инициализацию и дает разрешение произвести повторную инициализацию подписки. *Этот* присваивается **1** при *subset_filterclause* указывает параметризованного фильтра строк.  
  
`[ @logical_record_level_conflict_detection = ] 'logical_record_level_conflict_detection'` Указывает уровень обнаружения конфликтов для статьи, входящей в состав логической записи. *logical_record_level_conflict_detection* — **nvarchar(5)** , значение по умолчанию FALSE.  
  
 **значение true,** указывает, что конфликт будет отслеживаться, если были внесены изменения в любом месте в логической записи.  
  
 **false** означает, что используется обнаружение конфликтов по умолчанию, заданные *column_tracking*. Дополнительные сведения см. в статье [Группирование изменений в связанных строках с помощью логических записей](../../relational-databases/replication/merge/group-changes-to-related-rows-with-logical-records.md).  
  
> [!NOTE]  
>  Поскольку логические записи не поддерживаются [!INCLUDE[ssEW](../../includes/ssew-md.md)] подписчиков, необходимо указать значение **false** для *logical_record_level_conflict_detection* для поддержки этих подписчиков.  
  
`[ @logical_record_level_conflict_resolution = ] 'logical_record_level_conflict_resolution'` Указывает уровень устранения конфликтов для статьи, входящей в состав логической записи. *logical_record_level_conflict_resolution* — **nvarchar(5)** , значение по умолчанию FALSE.  
  
 **значение true,** указывает, что Выигравшая логическая запись целиком перезаписывает побежденную.  
  
 **false** указывает, что выигравшие строки не ограничиваются пределами логической записи. Если *logical_record_level_conflict_detection* — **true**, затем *logical_record_level_conflict_resolution* также должно быть присвоено **true**. Дополнительные сведения см. в статье [Группирование изменений в связанных строках с помощью логических записей](../../relational-databases/replication/merge/group-changes-to-related-rows-with-logical-records.md).  
  
> [!NOTE]  
>  Поскольку логические записи не поддерживаются [!INCLUDE[ssEW](../../includes/ssew-md.md)] подписчиков, необходимо указать значение **false** для *logical_record_level_conflict_resolution* для поддержки этих подписчиков.  
  
`[ @partition_options = ] partition_options` Определяет метод, при помощи которого производится секционирование статьи, что позволяет произвести оптимизацию производительности в том случае, когда все строки принадлежат только одной секции или только одной подписке. *partition_options* — **tinyint**, и может принимать одно из следующих значений.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**0** (по умолчанию)|Фильтрация для статьи либо статическая, либо не возвращает уникальное подмножество данных для каждой из секций, то есть перекрывающаяся секция.|  
|**1**|Секции перекрываются, и обновления языка обработки данных DML, выполняемые на подписчике, не могут изменить секцию, к которой принадлежит строка.|  
|**2**|Фильтрация для статьи дает неперекрывающиеся секции, но несколько подписчиков могут получить одну и ту же секцию.|  
|**3**|Фильтрация для статьи дает неперекрывающиеся секции, уникальные для каждой из подписок.|  
  
> [!NOTE]  
>  Если исходная таблица для статьи уже опубликована в другой публикации, то значение *partition_options* должно быть одинаковым для обеих статей.  
  
`[ @processing_order = ] processing_order` Показывает порядок обработки статей в публикации слиянием. *processing_order* — **int**, значение по умолчанию 0. **0** указывает, что статьи не упорядочены и любое другое значение представляет порядковый номер порядка обработки для данной статьи. Статьи обрабатываются по номерам, от меньших к большим. Если две статьи имеют то же значение, порядок обработки определяется порядком псевдонимами в [sysmergearticles](../../relational-databases/system-tables/sysmergearticles-transact-sql.md) системная таблица. Дополнительные сведения см. в разделе [Указание свойств репликации слиянием](../../relational-databases/replication/merge/specify-merge-replication-properties.md).  
  
`[ @subscriber_upload_options = ] subscriber_upload_options` Определяет ограничения на обновления, производимые на подписчике с клиентской подпиской. Дополнительные сведения см. в статье [Оптимизация производительности репликации слиянием при работе со статьями, доступными только для загрузки](../../relational-databases/replication/merge/optimize-merge-replication-performance-with-download-only-articles.md). *subscriber_upload_options* — **tinyint**, и может принимать одно из следующих значений.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**0** (по умолчанию)|Без ограничений. Изменения, произведенные на подписчике, передаются на издатель.|  
|**1**|Изменения на подписчике разрешены, но они не передаются на издатель.|  
|**2**|Изменения на подписчике не разрешены.|  
  
 Изменение *subscriber_upload_options* требует подписку для повторной инициализации, вызвав [sp_reinitmergepullsubscription &#40;Transact-SQL&#41;](../../relational-databases/system-stored-procedures/sp-reinitmergepullsubscription-transact-sql.md).  
  
> [!NOTE]  
>  Если исходная таблица для статьи уже опубликована в другой публикации, значение *subscriber_upload_options* должно быть одинаковым для обеих статей.  
  
`[ @identityrangemanagementoption = ] identityrangemanagementoption` Указывает, как обрабатывается управление диапазонами идентификаторов для статьи. *identityrangemanagementoption* — **nvarchar(10)** , и может принимать одно из следующих значений.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**Нет**|Запрещает управление диапазонами идентификаторов.|  
|**Вручную**|Помечает столбец идентификаторов как NOT FOR REPLICATION, чтобы разрешить ручное управление диапазонами идентификаторов.|  
|**Авто**|Задает автоматическое управление диапазонами идентификаторов.|  
|NULL(Default)|По умолчанию используется **none**при значение *auto_identity_range* не **true**.|  
  
 Для обеспечения обратной совместимости когда значение *identityrangemanagementoption* имеет значение NULL, значение *auto_identity_range* проверяется. Тем не менее, если значение *identityrangemanagementoption* не NULL, то значение *auto_identity_range* учитывается. Дополнительные сведения см. в статье [Репликация столбцов идентификаторов](../../relational-databases/replication/publish/replicate-identity-columns.md).  
  
`[ @delete_tracking = ] 'delete_tracking'` Указывает, являются ли удаления реплицируемыми. *delete_tracking* — **nvarchar(5)** , значение по умолчанию TRUE. **false** указывает, что операции удаления не реплицируются, и **true** указывает, что операции удаления реплицируются, что является обычным поведением для репликации слиянием. Когда *delete_tracking* присваивается **false**, строки, удаляемые на подписчике должны быть вручную удалены на издателе и строки, удаленные на издателе, должны быть вручную удалены на подписчике.  
  
> [!IMPORTANT]  
>  Установка *delete_tracking* для **false** приводит к потере конвергенции. Если исходная таблица для статьи уже опубликована в другой публикации, то значение *delete_tracking* должно быть одинаковым для обеих статей.  
  
> [!NOTE]  
>  *delete_tracking* параметры нельзя задать с помощью **мастера создания публикаций** или **свойства публикации** диалоговое окно.  
  
`[ @compensate_for_errors = ] 'compensate_for_errors'` Указывает, если корректирующие действия выполняются при возникновении ошибок во время синхронизации. *compensate_for_errors я*s **nvarchar(5)** , значение по умолчанию FALSE. Если задано значение **true**, изменения, не может использоваться на стороне подписчика или издателя во время синхронизации всегда вызывают корректирующие действия для отмены изменений; тем не менее, одно неправильно настроен подписчик, вызывающий ошибки может вызвать изменений на других подписчиках и издателях, подлежащих отмене. **false** отключает, по-прежнему компенсирующие действия, тем не менее, ошибки регистрируются, так как в случае компенсации и последующих слияний продолжает попытки применить изменения до успешной установки соединения.  
  
> [!IMPORTANT]  
>  Даже если в данных в измененных строках отсутствует конвергенция, то, если исправить все ошибки, изменения можно применить и добиться конвергенции данных. Если исходная таблица для статьи уже опубликована в другой публикации, то значение *compensate_for_errors* должно быть одинаковым для обеих статей.  
  
`[ @stream_blob_columns = ] 'stream_blob_columns'` Указывает, что оптимизация потока данных можно использовать при репликации столбцов больших двоичных объектов. *stream_blob_columns* — **nvarchar(5)** , значение по умолчанию FALSE. **значение true,** означает, что будет предприниматься попытка оптимизации. *stream_blob_columns* имеет значение true, если включен режим FILESTREAM. Это позволяет оптимально выполнять репликацию данных FILESTREAM и уменьшить использование памяти. Чтобы принудительно заставить статьи таблицы FILESTREAM не использовать потоковую передачу больших двоичных объектов, используйте **sp_changemergearticle** присвоить *stream_blob_columns* значение false.  
  
> [!IMPORTANT]  
>  Включение данного режима оптимизации памяти может уменьшить производительность агента слияния во время синхронизации. Этот параметр должен использоваться только при репликации столбцов, содержащих мегабайты данных.  
  
> [!NOTE]  
>  Некоторые возможности репликации слиянием, например логические записи, могут воспрепятствовать включению потоковой оптимизации при репликации больших двоичных объектов, даже с *stream_blob_columns* присвоено **true**.  
  
## <a name="return-code-values"></a>Значения кода возврата  
 0 (успешное завершение) или 1 (неуспешное завершение)  
  
## <a name="remarks"></a>Примечания  
 **sp_addmergearticle** используется в репликации слиянием.  
  
 При публикации объектов их определения копируются на подписчики. При публикации объекта базы данных, который зависит от одного или нескольких других объектов, обязательна публикация всех объектов, на которые он ссылается. Например, при публикации представления, зависящего от таблицы, необходимо также опубликовать и таблицу.  
  
 Если указать значение **3** для *partition_options*, может существовать только одна подписка для каждой секции данных в этой статье. Если создается вторая подписка, в которой условие фильтрации сводится к той же секции, что и в существующей подписке, то существующая подписка удаляется.  
  
 При указании значения 3 для *partition_options*, метаданные очищаются при каждом запуске агента слияния и действия секционированного снимка истекает быстрее. При использовании этого параметра следует разрешить запрошенный подписчиком секционированный снимок. Дополнительные сведения см. в статье [Snapshots for Merge Publications with Parameterized Filters](../../relational-databases/replication/create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).  
  
 Добавление статьи со статическим горизонтальным фильтром, используя *subset_filterclause*в существующую публикацию, содержащую статьи с параметризованными фильтрами необходима повторная инициализация подписок.  
  
 При указании *processing_order*, мы рекомендуем оставлять зазоры между порядковыми значениями статей, что упрощает задание новых значений в будущем. Например, если имеется три статьи: Статья1, Статья2 и Статья3, задать *processing_order* 10, 20 и 30, а не 1, 2 и 3. Дополнительные сведения см. в разделе [Указание свойств репликации слиянием](../../relational-databases/replication/merge/specify-merge-replication-properties.md).  
  
## <a name="default-schema-option-table"></a>Таблица «Параметры схемы по умолчанию»  
 Эта таблица описывает значение по умолчанию, который задается параметром хранимой процедуры, если указано значение NULL для *schema_option*, который зависит от типа статьи.  
  
|Тип статьи|Значение параметра схемы|  
|------------------|-------------------------|  
|**только схема func**|**0x01**|  
|**только схема индексированного представления**|**0x01**|  
|**только схема процедуры**|**0x01**|  
|**table**|**0x0C034FD1**  -  [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] и более поздними версиями публикации с собственным форматом моментального снимка.<br /><br /> **0x08034FF1**  -  [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)] и более поздними версиями публикации с символьным форматом моментального снимка.|  
|**только схема представления**|**0x01**|  
  
> [!NOTE]  
>  Если публикация поддерживает ранние выпуски [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], параметры схемы по умолчанию для **таблицы** — **0x30034FF1**.  
  
## <a name="valid-schema-option-table"></a>Таблица «Допустимые параметры схемы»  
 В следующей таблице описаны допустимые значения *schema_option* в зависимости от типа статьи.  
  
|Тип статьи|Значения параметра схемы|  
|------------------|--------------------------|  
|**только схема func**|**0x01** и **0x2000**|  
|**только схема индексированного представления**|**0x01**, **0x040**, **0x0100**, **0x2000**, **0x40000**, **0x1000000**и **0x200000**|  
|**только схема процедуры**|**0x01** и **0x2000**|  
|**table**|Все параметры.|  
|**только схема представления**|**0x01**, **0x040**, **0x0100**, **0x2000**, **0x40000**, **0x1000000**и **0x200000**|  
  
## <a name="example"></a>Пример  
 [!code-sql[HowTo#sp_AddMergeArticle](../../relational-databases/replication/codesnippet/tsql/sp-addmergearticle-trans_1.sql)]  
  
## <a name="permissions"></a>Разрешения  
 Необходимо быть членом предопределенной роли сервера **sysadmin** или предопределенной роли базы данных **db_owner** .  
  
## <a name="see-also"></a>См. также  
 [Define an Article](../../relational-databases/replication/publish/define-an-article.md)   
 [Публикация данных и объектов базы данных](../../relational-databases/replication/publish/publish-data-and-database-objects.md)   
 [Репликация столбцов идентификаторов](../../relational-databases/replication/publish/replicate-identity-columns.md)   
 [sp_changemergearticle (Transact-SQL)](../../relational-databases/system-stored-procedures/sp-changemergearticle-transact-sql.md)   
 [sp_dropmergearticle (Transact-SQL)](../../relational-databases/system-stored-procedures/sp-dropmergearticle-transact-sql.md)   
 [sp_helpmergearticle (Transact-SQL)](../../relational-databases/system-stored-procedures/sp-helpmergearticle-transact-sql.md)   
 [Хранимые процедуры репликации (Transact-SQL)](../../relational-databases/system-stored-procedures/replication-stored-procedures-transact-sql.md)  
  
  
