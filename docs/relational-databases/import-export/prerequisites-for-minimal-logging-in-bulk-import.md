---
title: Предварительные условия для минимального протоколирования массового импорта данных | Документация Майкрософт
ms.custom: ''
ms.date: 03/17/2017
ms.prod: sql
ms.prod_service: database-engine
ms.reviewer: ''
ms.technology: data-movement
ms.topic: conceptual
helpviewer_keywords:
- minimal logging [SQL Server]
- logged bulk copy [SQL Server]
- logs [SQL Server], minimal logging
- minimally logged operations [SQL Server]
- bulk importing [SQL Server], minimal logging
ms.assetid: bd1dac6b-6ef8-4735-ad4e-67bb42dc4f66
author: MashaMSFT
ms.author: mathoma
manager: craigg
ms.openlocfilehash: 48d62232c5d481ccbb6204f5ba14465dea75ca30
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "64946571"
---
# <a name="prerequisites-for-minimal-logging-in-bulk-import"></a>Prerequisites for Minimal Logging in Bulk Import
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)]

  В базе данных, использующей модель полного восстановления, все операции вставки строк, выполняющиеся при массовом импорте, полностью записываются в журнал транзакций. Если используется модель полного восстановления, импорт большого количества данных может привести к быстрому заполнению журнала транзакций. При использовании простой модели восстановления или модели восстановления с неполным протоколированием минимальное протоколирование операций массового импорта, напротив, снижает вероятность того, что операция массового импорта заполнит все пространство журнала. Минимальное протоколирование также более эффективно, чем полное.  
  
> [!NOTE]  
>  Модель восстановления с неполным протоколированием предназначена для временной замены модели полного восстановления на период проведения массовых операций.  
  
## <a name="table-requirements-for-minimally-logging-bulk-import-operations"></a>Требования к таблицам для минимального протоколирования операций массового импорта  
 Минимальное протоколирование требует, чтобы целевая таблица удовлетворяла следующим условиям.  
  
-   В данный момент таблица не реплицируется.  
  
-   Задана блокировка таблицы (с помощью TABLOCK). Для таблицы с кластеризованным индексом columnstore при минимальном протоколировании не требуется TABLOCK.  Кроме того, только загрузка данных в сжатые группы строк минимально протоколируется; для этого требуется размер пакета 102 400 или выше.  
  
    > [!NOTE]  
    >  Хотя операции вставки данных при минимальном ведении журнала операций массового импорта не регистрируются в журнале транзакций, компонент [!INCLUDE[ssDE](../../includes/ssde-md.md)] по-прежнему ведет журнал выделения всех экстентов для таблицы.  
  
-   Таблица не является оптимизированной для памяти.  
  
 Можно ли использовать минимальное протоколирование, также зависит от того, индексируется ли таблица и, если это так, пуста ли она.  
  
-   Если у таблицы нет индексов, ведется минимальный журнал страниц данных.  
  
-   Если у таблицы нет кластеризованного индекса, но есть один или более некластеризованных индексов, всегда ведется минимальный журнал страниц данных. Однако применяемый способ ведения журнала страниц индекса зависит от того, пуста ли таблица.  
  
    -   Если таблица пуста, ведется минимальный журнал страниц индекса.  
  
    -   Если таблица не пуста, ведется полный журнал страниц индекса.  
  
        > [!NOTE]  
        >  Если начать с пустой таблицы и выполнить массовый импорт данных несколькими пакетами, для первого пакета будет вестись минимальный журнал страниц как данных, так и индекса, но, начиная со второго пакета, минимальный журнал будет вестись только для страниц данных.  
  
-   Если у таблицы есть кластеризованный индекс, и он пуст, будет вестись минимальный журнал и страниц данных, и страниц индекса. И наоборот, если у таблицы есть кластеризованный индекс на основе сбалансированного дерева и она не является пустой, будет вестись полный журнал и страниц данных, и страниц индекса независимо от модели восстановления. Для таблиц с кластеризованным индексом columnstore загрузка данных в сжатую группу строк всегда минимально протоколируется независимо от того, является ли таблица пустой, если batchsize >= 102 400.  
  
    > [!NOTE]  
    >  Если начать с пустой таблицы rowstore и выполнить массовый импорт данных в нескольких пакетах, для первого пакета будет вестись минимальный журнал и страниц данных, и страниц индекса. Начиная со второго пакета, неполный журнал будет вестись только для страниц данных.  
  
> [!NOTE]  
>  Если включена репликация транзакций, операции BULK INSERT полностью протоколируются даже в модели с неполным протоколированием.  
  
##  <a name="RelatedTasks"></a> Связанные задачи  
  
-   [Просмотр или изменение модели восстановления базы данных (SQL Server)](../../relational-databases/backup-restore/view-or-change-the-recovery-model-of-a-database-sql-server.md)  
  
  
## <a name="see-also"></a>См. также:  
 [Модели восстановления (SQL Server)](../../relational-databases/backup-restore/recovery-models-sql-server.md)   
 [bcp Utility](../../tools/bcp-utility.md)   
 [BULK INSERT (Transact-SQL)](../../t-sql/statements/bulk-insert-transact-sql.md)   
 [OPENROWSET (Transact-SQL)](../../t-sql/functions/openrowset-transact-sql.md)   
 [BACKUP (Transact-SQL)](../../t-sql/statements/backup-transact-sql.md)   
 [ALTER DATABASE (Transact-SQL)](../../t-sql/statements/alter-database-transact-sql.md)   
 [Табличные указания (Transact-SQL)](../../t-sql/queries/hints-transact-sql-table.md)   
 [INSERT (Transact-SQL)](../../t-sql/statements/insert-transact-sql.md)  
  
  
