---
title: sys.dm_resource_governor_resource_pools_history_ex (Transact-SQL) | Документация Майкрософт
ms.custom: ''
ms.date: 03/27/2019
ms.prod: sql
ms.technology: system-objects
ms.prod_service: sql-database
ms.reviewer: ''
ms.topic: language-reference
f1_keywords:
- sys.resource_governor
- sys.resource_governor_TSQL
- resource_governor
- resource_governor_TSQL
dev_langs:
- TSQL
helpviewer_keywords:
- sys.resource_governor catalog view
ms.assetid: ''
author: joesackmsft
ms.author: josack
manager: craigg
monikerRange: =azuresqldb-current||=sqlallproducts-allversions
ms.openlocfilehash: 130c4f9c38e5eb7ee47d31377a224c5b602b5b35
ms.sourcegitcommit: 0a4879dad09c6c42ad1ff717e4512cfea46820e9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/27/2019
ms.locfileid: "67412948"
---
# <a name="sysdmresourcegovernorresourcepoolshistoryex-transact-sql"></a>sys.dm_resource_governor_resource_pools_history_ex (Transact-SQL)

[!INCLUDE[appliesto-xx-asdb-xxxx-xxx-md](../../includes/appliesto-xx-asdb-xxxx-xxx-md.md)]

Возвращает моментальный снимок с интервалом 15 секунд для ресурсов за последние 30 минут пулов статистики для базы данных SQL Azure.  
  
|Имя столбца|Тип данных|Описание|  
|-----------------|---------------|-----------------|  
|**pool_id**|ssNoversion|Идентификатор пула ресурсов. Не допускает значение NULL.
|**name**|sysname|Имя пула ресурсов. Не допускает значение NULL.|
|**snapshot_time**|datetime2|DateTime снимка статистики пула ресурсов, сделанного|
|**duration_ms**|ssNoversion|Интервал времени между текущим и предыдущим моментальных снимков|
|**statistics_start_time**|datetime2|Время, когда была очищена статистика для данного пула. Не допускает значение NULL.|
|**active_session_count**|ssNoversion|Всего активных сеансов в текущий моментальный снимок|
|**active_worker_count**|ssNoversion|Общее количество рабочих процессов в текущий моментальный снимок|
|**delta_cpu_usage_ms**|ssNoversion|Использование ЦП в миллисекундах с момента создания последнего моментального снимка. Не допускает значение NULL.|
|**delta_cpu_usage_preemptive_ms**|ssNoversion|Вызовы с вытеснением win32 не регулируются по SQL-RG ЦП, с момента последнего моментального снимка|
|**used_data_space_kb**|BIGINT|Общее пространство, используемое в пользовательской базе данных, связанных с пулом пользователя|
|**allocated_disk_space_kb**|BIGINT|Размер пользовательских баз данных файла данных в связанном с пулом пользователя|
|**target_memory_kb**|BIGINT|Целевой объем памяти, в килобайтах, который пытается заполучить пул ресурсов. Это основано на текущих настройках и состоянии сервера. Не допускает значение NULL.|
|**used_memory_kb**|BIGINT|Объем используемой памяти, в килобайтах, для пула ресурсов. Не допускает значение NULL.|
|**cache_memory_kb**|BIGINT|Текущее общее использование памяти кэша, в килобайтах. Не допускает значение NULL.|
|**compile_memory_kb**|BIGINT|Текущее общее использование заимствованной памяти, в килобайтах (КБ). Основная доля этого использования приходится на компиляцию и оптимизацию, но может также включать и других пользователей памяти. Не допускает значение NULL.|
|**active_memgrant_count**|BIGINT|Текущее количество операций предоставления памяти. Не допускает значение NULL.|
|**active_memgrant_kb**|BIGINT|Сумма, в килобайтах (КБ), предоставленной в настоящее время памяти. Не допускает значение NULL.|
|**used_memgrant_kb**|BIGINT|Текущий общий объем используемой (заимствованной) памяти, полученной в результате операций предоставления памяти. Не допускает значение NULL.|
|**delta_memgrant_timeout_count**|ssNoversion|Количество операций предоставления памяти значения времени ожидания в данном пуле ресурсов за этот период. Не допускает значение NULL.|
|**delta_memgrant_waiter_count**|ssNoversion|Количество запросов, в настоящий момент ожидающих предоставления памяти. Не допускает значение NULL.|
|**delta_out_of_memory_count**|ssNoversion|Количество неудачных операций выделения памяти в пуле с момента последнего моментального снимка. Не допускает значение NULL.|
|**delta_read_io_queued**|ssNoversion|Общего чтения, поставленных с момента последнего моментального снимка. Допускает значение NULL. NULL, если пул ресурсов не управляется в аспекте операций ввода-вывода.|
|**delta_read_io_issued**|ssNoversion|Общее чтение IOs со времени последнего моментального снимка. Допускает значение NULL. NULL, если пул ресурсов не управляется в аспекте операций ввода-вывода.|
|**delta_read_io_completed**|ssNoversion|Общее чтение IOs, выполненных с момента последнего моментального снимка. Не допускает значение NULL.|
|**delta_read_io_throttled**|ssNoversion|Общее число операций чтения с момента моментального снимка. Допускает значение NULL. NULL, если пул ресурсов не управляется в аспекте операций ввода-вывода.|
|**delta_read_bytes**|BIGINT|Общее число байтов, считанных с последнего моментального снимка. Не допускает значение NULL.|
|**delta_read_io_stall_ms**|ssNoversion|Общее время (в миллисекундах) между получением ввода-ВЫВОДА и завершением с момента последнего моментального снимка. Не допускает значение NULL.|
|**delta_read_io_stall_queued_ms**|ssNoversion|Общее время (в миллисекундах) между чтения получением ввода-ВЫВОДА и проблему с момента последнего моментального снимка. Допускает значение NULL. NULL, если пул ресурсов не управляется в аспекте операций ввода-вывода. Delta_read_io_stall_queued_ms ненулевое значение означает, что операции ввода-ВЫВОДА зависит от RG.|
|**delta_write_io_queued**|ssNoversion|Общая сумма записи вывода в очереди с момента последнего моментального снимка. Допускает значение NULL. NULL, если пул ресурсов не управляется в аспекте операций ввода-вывода.|
|**delta_write_io_issued**|ssNoversion|Общая сумма записи IOs со времени последнего моментального снимка. Допускает значение NULL. NULL, если пул ресурсов не управляется в аспекте операций ввода-вывода.|
|**delta_write_io_completed**|ssNoversion|Общая сумма вывода, выполненных с момента последнего моментального снимка записи. Не допускает значение NULL.|
|**delta_write_io_throttled**|ssNoversion|Общее записи, регулирование операций ввода-вывода с момента последнего моментального снимка. Не допускает значение NULL.|
|**delta_write_bytes**|BIGINT|Общее число байтов, записанных с момента последнего моментального снимка. Не допускает значение NULL.|
|**delta_write_io_stall_ms**|ssNoversion|Общее время (в миллисекундах) между получением ввода-ВЫВОДА при записи и завершением с момента последнего моментального снимка. Не допускает значение NULL.|
|**delta_write_io_stall_queued_ms**|ssNoversion|Общее время (в миллисекундах) между получением ввода-ВЫВОДА при записи и проблемой с момента последнего моментального снимка. Допускает значение NULL. NULL, если пул ресурсов не управляется в аспекте операций ввода-вывода.|
|**delta_io_issue_delay_ms**|ssNoversion|Общее время (в миллисекундах) между запланированной проблемой и фактической проблемой ввода-ВЫВОДА с момента последнего моментального снимка. Допускает значение NULL. NULL, если пул ресурсов не управляется в аспекте операций ввода-вывода.|
|**max_iops_per_volume**|ssNoversion|Максимальное ввода-ВЫВОДА в секунду (IOPS) в расчете на том диска для этого пула. Допускает значение NULL. NULL, если пул ресурсов не управляется в аспекте операций ввода-вывода.|
|**max_memory_kb**|BIGINT|Максимальный объем памяти, в килобайтах, который может быть получен пулом ресурсов. Это основано на текущих настройках и состоянии сервера. Не допускает значение NULL.
|**max_log_rate_kb**|BIGINT|Скорость максимального (килограмм байт / с) на уровне пула ресурсов.|
|**max_data_space_kb**|BIGINT|Ограничение хранилища эластичного пула для этого пула эластичных БД, в килобайтах.|
|**max_session**|ssNoversion|Ограничение сеансов для пула|
|**max_worker**|ssNoversion|Количества работников для пула|
|**min_cpu_percent**|ssNoversion|Текущая конфигурация гарантированной средней пропускной способности ЦП для всех запросов в пуле ресурсов при возникновении состязания использования ЦП. Не допускает значение NULL.|
|**max_cpu_percent**|ssNoversion|Текущая конфигурация максимальной средней пропускной способности ЦП, разрешенной для всех запросов в пуле ресурсов при возникновении состязания использования ЦП. Не допускает значение NULL.|
|**cap_cpu_percent**|ssNoversion|Жесткое ограничение пропускной способности ЦП, которая предоставляется всем запросам в пуле ресурсов. Ограничивает максимальный уровень пропускной способности ЦП заданным значением. Диапазон допустимых значений — от 1 до 100. Не допускает значение NULL.|
|**min_vcores**|Decimal(5,2)|Текущая конфигурация гарантированной средней пропускной способности ЦП для всех запросов в пуле ресурсов при возникновении состязания использования ЦП.  В единицах виртуальных ядер|
|**max_vcores**|Decimal(5,2)|Текущая конфигурация максимальной средней пропускной способности ЦП, разрешенной для всех запросов в пуле ресурсов при возникновении состязания использования ЦП.  В единице виртуальных ядер|
|**cap_vcores**|Decimal(5,2)|Жесткое ограничение пропускной способности ЦП, которая предоставляется всем запросам в пуле ресурсов.  В блок в виртуальных ядер|
|**instance_cpu_count**|ssNoversion|Число ЦП, настроенные для данного экземпляра|
|** instance_cpu_percent|Decimal(5,2)|Процент ЦП, настроенные для данного экземпляра|
|**instance_vcores**|Decimal(5,2)|Количество виртуальных ядер, настроенные для данного экземпляра|
|**delta_log_bytes_used**|Decimal(5,2)|Создание общего журнала (в байтах) на уровне пула с момента последнего моментального снимка|
|**avg_login_rate_percent**|Decimal(5,2)|Количество входов в систему с момента последнего моментального снимка, сравнивается с ограничение входа|
|**delta_vcores_used**|Decimal(5,2)|Использование вычислительной среды в число виртуальных ядер с момента последнего моментального снимка.|
|**cap_vcores_used_percent**|Decimal(5,2)|Среднее использование вычислительных ресурсов в процентах от предела пула.|
|**instance_vcores_used_percent**|Decimal(5,2)|Среднее использование вычислительных ресурсов в процентах от предела экземпляра SQL.|
|**avg_data_io_percent**|Decimal(5,2)|Среднее использование ввода-вывода в процентах от предела пула.|
|**avg_log_write_percent**|Decimal(5,2)|Среднее использование ресурсов записи в процентах от предела пула.|
|**avg_storage_percent**|Decimal(5,2)|Среднее использование хранилища в процентах от предела пула.|
|**avg_allocated_storage_percent**|Decimal(5,2)|Процент пространства данных, выделенной с помощью всех баз данных в эластичном пуле. Это отношение данных пространства, выделенного для данных максимальный размер для эластичного пула. Дополнительные сведения см.: Управление файлами места в базе данных SQL|
|**max_worker_percent**|Decimal(5,2)|Максимальное количество одновременных рабочих ролей (запросов) в процентах от предела пула.|
|**max_session_percent**|Decimal(5,2)|Максимальное число одновременных сеансов в процентах от предела пула.|
|||

## <a name="permissions"></a>Разрешения

В этом представлении требуется разрешение VIEW SERVER STATE.

## <a name="remarks"></a>Примечания

Пользователи могут обращаться к это динамическое административное представление для мониторинга практически в реальном времени о потреблении ресурсов пула рабочей нагрузки пользователей, а также внутренний пулы системных экземпляра базы данных SQL Azure.

> [!IMPORTANT]
> Большая часть данных, созданным это динамическое административное Представление предназначен для внутреннего использования и подлежит изменению.

## <a name="examples"></a>Примеры

В следующем примере возвращается максимальный объем данных журнала ставка и показатель потребления на каждый моментальный снимок пулом пользователя  

```sql
select snapshot_time, name, max_log_rate_kb, delta_log_bytes_used from sys.dm_resource_governor_resource_pools_history_ex where name like 'UserPool%' order by snapshot_time desc
```

В следующем примере возвращается аналогичный сведения как sys.elastic_pool_resource_stats без необходимости подключения к логической базе данных Master

```sql
select snapshot_time, name, cap_vcores_used_percent,
  avg_data_io_percent,  
  avg_log_write_percent,
  avg_storage_percent,
  avg_allocated_storage_percent,
  max_data_space_kb,
  max_worker_percent,
  max_session_percent
    from sys.dm_resource_governor_resource_pools_history_ex where name like 'UserPool%' order by snapshot_time desc
```

## <a name="see-also"></a>См. также

- [Перевод журнала скорость руководства](https://docs.microsoft.com/azure/sql-database/sql-database-resource-limits-database-server#transaction-log-rate-governance)
- [Ограничениями ресурсов эластичного пула DTU](https://docs.microsoft.com/azure/sql-database/sql-database-dtu-resource-limits-elastic-pools)
- [Ограничения ресурсов виртуальных ядер эластичного пула](https://docs.microsoft.com/azure/sql-database/sql-database-vcore-resource-limits-elastic-pools)
