---
title: Обработка графа
titleSuffix: SQL Server and Azure SQL Database
ms.date: 06/26/2019
ms.prod: sql
ms.prod_service: database-engine, sql-database
ms.reviewer: ''
ms.technology: ''
ms.topic: language-reference
helpviewer_keywords:
- SQL graph
- SQL graph, overview
ms.assetid: ''
author: shkale-msft
ms.author: shkale
ms.custom: seo-dt-2019
monikerRange: =azuresqldb-current||>=sql-server-2017||=sqlallproducts-allversions||>=sql-server-linux-2017||=azuresqldb-mi-current
ms.openlocfilehash: 3ca26af4738de25937b71e0c97c6272414a0957a
ms.sourcegitcommit: 15fe0bbba963d011472cfbbc06d954d9dbf2d655
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/14/2019
ms.locfileid: "74096087"
---
# <a name="graph-processing-with-sql-server-and-azure-sql-database"></a>Обработка графов с помощью SQL Server и базы данных SQL Azure
[!INCLUDE[tsql-appliesto-ss2017-asdb-xxxx-xxx-md](../../includes/tsql-appliesto-ss2017-asdb-xxxx-xxx-md.md)]

[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] предлагает возможности баз данных Graph для моделирования связей "многие ко многим". Связи графов интегрируются в [!INCLUDE[tsql-md](../../includes/tsql-md.md)] и получают преимущества использования [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в качестве системы управления базовыми базами данных.


## <a name="what-is-a-graph-database"></a>Что такое база данных Graph?  
База данных графа представляет собой коллекцию узлов (или вершин) и ребер (или связей). Узел представляет собой сущность (например, лицо или организацию), а ребро — связь между двумя узлами, которые оно соединяет (например, отметки "Нравится" или друзей). С этими узлами и краями могут быть связаны свойства. Ниже приведены некоторые функции, которые делают базу данных Graph уникальной.  
-   Границы или связи являются сущностями первого класса в базе данных Graph и могут иметь связанные с ними атрибуты или свойства. 
-   Одна сторона может гибко подключаться к нескольким узлам в базе данных Graph.
-   Можно легко выразить сопоставление шаблонов и запросов навигации с несколькими прыжками.
-   Можно легко выразить транзитивное замыкание и полиморфизм запросов.

## <a name="when-to-use-a-graph-database"></a>Когда следует использовать базу данных Graph

Нет ничего сложного с базой данных Graph, которую нельзя достичь с помощью реляционной базы данных. Однако база данных графа может упростить выражать запросы определенного типа. Кроме того, при определенных оптимизациях некоторые запросы могут работать лучше. Выбор одного из них может быть основан на следующих факторах:  
-   Приложение имеет иерархические данные. Тип данных HierarchyID можно использовать для реализации иерархий, но у него есть некоторые ограничения. Например, он не позволяет хранить несколько родителей для узла.
-   Приложение имеет сложные связи "многие ко многим". по мере развития приложения добавляются новые связи.
-   Необходимо проанализировать взаимосвязанные данные и связи.

## <a name="graph-features-introduced-in-includesssqlv14includessssqlv14-mdmd"></a>Функции Graph, появившиеся в [!INCLUDE[sssqlv14](../../includes/sssqlv14-md.md)] 
Мы начинаем добавлять расширения графа в SQL Server, чтобы упростить хранение и запрос данных графов. В первом выпуске представлены следующие функции. 


### <a name="create-graph-objects"></a>Создание объектов Graph
расширения [!INCLUDE[tsql-md](../../includes/tsql-md.md)] позволяют пользователям создавать таблицы node или ребра. С этими узлами и краями могут быть связаны свойства. Поскольку узлы и грани хранятся в виде таблиц, все операции, поддерживаемые реляционными таблицами, поддерживаются в таблице node или EDGE. Например:  

```   
CREATE TABLE Person (ID INTEGER PRIMARY KEY, Name VARCHAR(100), Age INT) AS NODE;
CREATE TABLE friends (StartDate date) AS EDGE;
```   

![Person-друзья — таблицы](../../relational-databases/graphs/media/person-friends-tables.png "Пограничные таблицы узлов Person и друзей")  
Узлы и грани хранятся в виде таблиц.  

### <a name="query-language-extensions"></a>Расширения языка запросов  
Для поддержки сопоставления шаблонов и навигации с несколькими прыжками в графе введено новое предложение `MATCH`. Функция `MATCH` использует синтаксис стиля ASCII для сопоставления шаблонов. Пример:  

```   
-- Find friends of John
SELECT Person2.Name 
FROM Person Person1, Friends, Person Person2
WHERE MATCH(Person1-(Friends)->Person2)
AND Person1.Name = 'John';
```   
 
### <a name="fully-integrated-in-includessnoversionincludesssnoversion-mdmd-engine"></a>Полностью интегрировано в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Engine 
Расширения Graph полностью интегрированы в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Engine. Используйте ту же подсистему хранилища, метаданные, обработчик запросов и т. д. для хранения данных графа и запросов к ним. Запрос по графу и реляционным данным в одном запросе. Объединение возможностей графа с другими [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] такими технологиями, как columnstore, HA, R Services и т. д. База данных SQL Graph также поддерживает все функции обеспечения безопасности и соответствия требованиям, доступные в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].
 
### <a name="tooling-and-ecosystem"></a>Инструментарий и экосистема

Преимущества существующих средств и экосистемы, которые [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] предложения. Такие средства, как резервное копирование и восстановление, импорт и экспорт, просто работают с программой BCP. Другие средства или службы, такие как SSIS, SSRS или Power BI, будут работать с таблицами графов так же, как они работают с реляционными таблицами.

## <a name="edge-constraints"></a>Ограничения ребер
Ограничение ребра определяется в краевой таблице графа и является парой таблиц узлов, к которым может подключаться данный тип ребра. Это позволяет пользователям лучше управлять схемой графа. С помощью ограничений границ пользователи могут ограничивать типы узлов, к которым может подключаться данная граница. 

Дополнительные сведения о создании и использовании ограничений границ см. в разделе [ограничения границ](../../relational-databases/tables/graph-edge-constraints.md) .

## <a name="merge-dml"></a>Слияние DML 
Инструкция [Merge](../../t-sql/statements/merge-transact-sql.md) выполняет операции вставки, обновления или удаления в целевой таблице на основе результатов объединения с исходной таблицей. Например, можно синхронизировать две таблицы путем вставки, обновления или удаления строк в целевой таблице на основе различий между целевой таблицей и исходной таблицей. Использование предикатов MATCH в инструкции MERGE теперь поддерживается в базе данных SQL Azure и SQL Server vNext. Это значит, что теперь можно объединить текущие данные графа (таблицы узлов или пограничных таблиц) с новыми данными, используя предикаты MATCH для указания связей графа в одной инструкции, а не отдельные инструкции INSERT, UPDATE и DELETE.

Дополнительные сведения о том, как сопоставление можно использовать при слиянии DML, см. в [инструкции MERGE](../../t-sql/statements/merge-transact-sql.md) .

## <a name="shortest-path"></a>Кратчайший путь
Функция [SHORTEST_PATH](./sql-graph-shortest-path.md) находит кратчайший путь между любыми двумя узлами в графе или начиная с заданного узла и до всех остальных узлов графа. Кратчайший путь можно также использовать для поиска транзитивное замыкания или для произвольного обхода длины в графе. 

 ## <a name="next-steps"></a>Следующие шаги  
Ознакомьтесь с [архитектурой базы данных SQL Graph](./sql-graph-architecture.md)
   

