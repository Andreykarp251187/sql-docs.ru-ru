---
title: Характеристики набора результатов (ODBC)
ms.custom: ''
ms.date: 03/14/2017
ms.prod: sql
ms.prod_service: database-engine, sql-database, sql-data-warehouse, pdw
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- result sets [ODBC], characteristics
- SQL Server Native Client ODBC driver, result sets
- ODBC applications, result sets
- SQLDescribeCol function
- metadata [ODBC]
- SQLColAttribute function
- SQLNumResultCols function
ms.assetid: 90be414c-04b3-46c0-906b-ae7537989b7d
author: markingmyname
ms.author: maghan
monikerRange: '>=aps-pdw-2016||=azuresqldb-current||=azure-sqldw-latest||>=sql-server-2016||=sqlallproducts-allversions||>=sql-server-linux-2017||=azuresqldb-mi-current'
ms.openlocfilehash: d83330105b86b131e4ac42390024a2adeee78617
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81304665"
---
# <a name="determining-the-characteristics-of-a-result-set-odbc"></a>Определение характеристик результирующего набора (ODBC)
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../../includes/appliesto-ss-asdb-asdw-pdw-md.md)]

  Метаданные — это данные, описывающие другие данные. Например, метаданные результирующего набора описывают такие характеристики результирующего набора, как количество столбцов, типы данных в этих столбцах, их имена, точность и допустимость значений NULL.  
  
 ODBC сообщает метаданные приложениям с помощью функций каталога API-интерфейса. Драйвер [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC реализует многие функции каталога ODBC [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] API в виде вызовов соответствующей процедуры каталога.  
  
 Метаданные требуются приложениям для большинства операций с результирующими наборами. Например, приложение использует тип данных столбца, чтобы определить, какую переменную привязывать к этому столбцу. Оно использует длину в байтах столбцов с символьными значениями, чтоб определить, сколько места потребуется для отображения данных из этого столбца. Способ определения метаданных для столбца зависит от типа приложения.  
  
 Вертикальные приложения обычно работают со стандартными таблицами и выполняют стандартные операции с этими таблицами. Поскольку метаданные результирующих наборов для таких приложений определяются даже до того, как приложение написано, и управляются разработчиком, они могут быть жестко запрограммированы в приложении. Например, если столбец идентификатора заказа определен в источник данных как 4-байтовое целое число, приложение может всегда привязывать 4-байтовые целые числа к этому столбцу. Если метаданные жестко запрограммированы в приложении, изменения в используемых приложением таблицах обычно подразумевают изменения в коде приложения.  
  
 В обычных приложениях, особенно приложениях, поддерживающих нерегламентируемые запросы, метаданные результирующих наборов обычно неизвестны до времени выполнения.  
  
 Чтобы определить характеристики результирующего набора, приложение может вызвать следующие функции.  
  
-   [Для](../../relational-databases/native-client-odbc-api/sqlnumresultcols.md) определения количества возвращенных столбцов возвращается количество столбцов запроса.  
  
-   [Для](../../relational-databases/native-client-odbc-api/sqlcolattribute.md) описания столбца в наборе результатов можно описать столбец. [SQLDescribeCol](../../relational-databases/native-client-odbc-api/sqldescribecol.md)  
  
 Хорошо спроектированные приложения пишутся с предположением, что результирующий набор неизвестен, и используют для привязки столбцов в результирующем наборе данные, возвращаемые этими функциями. Приложение может вызвать эти функции в любое время после подготовки или выполнения инструкции. Тем не менее, для оптимальной производительности, приложение должно вызвать **S'LColAttribute**, **S'LОрыстеркол**, и **S'LNumResultCols** после выполнения оператора.  
  
 Можно выполнять несколько одновременных вызовов метаданных. Эти процедуры системного каталога, лежащие в основе реализаций API-интерфейса каталога ODBC, могут вызываться драйвером ODBC во время использования им статических серверных курсоров. Это позволяет приложениям одновременно обрабатывать несколько вызовов функций каталога ODBC.  
  
 Если приложение использует определенный набор метаданных более одного раза, может быть полезно кэшировать данные в закрытых переменных после их первого получения. Этот предотвращает последующие вызовы функций каталога ODBC для получения тех же данных, ради которых драйверу приходится многократно обращаться к серверу.  
  
## <a name="see-also"></a>См. также:  
 [Результаты обработки &#40;ODBC&#41;](../../relational-databases/native-client-odbc-results/processing-results-odbc.md)  
  
  
