---
title: Виртуализация внешних данных в SQL Server 2019 CTP 2.0 | Документация Майкрософт
description: Эта страница описывает шаги по использованию мастера создания внешней таблицы для CSV-файла
author: Abiola
ms.author: aboke
ms.reviewer: jroth
manager: craigg
ms.date: 05/22/2019
ms.topic: conceptual
ms.prod: sql
ms.technology: polybase
monikerRange: '>= sql-server-ver15 || = sqlallproducts-allversions'
ms.openlocfilehash: dab04f5c544e84c5763b8101cb166741463d460a
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "65993933"
---
# <a name="use-the-external-table-wizard-with-csv-files"></a>Использование мастера внешней таблицы с CSV-файлами

SQL Server 2019 также дает возможность виртуализации данных из CSV-файла в файловой системе HDFS.  Благодаря этому процессу данные могут оставаться в исходном расположении, однако вы можете **виртуализировать** данные в экземпляре SQL Server таким образом, чтобы их можно было запрашивать так же, как любую другую таблицу в SQL Server. Это уменьшает потребность в процессах извлечения, преобразования и загрузки. Это можно сделать с помощью соединителей Polybase. Дополнительные сведения о виртуализации данных см. в документе [Руководство по PolyBase](polybase-guide.md).

## <a name="prerequisite"></a>Предварительные требования

Начиная с версии CTP 2.4 внешние источники данных пула данных и пула носителей больше не создаются по умолчанию в кластере больших данных. Перед тем как использовать мастер, создайте внешний источник данных по умолчанию **SqlStoragePool** в целевой базе данных с помощью приведенного ниже запроса Transact-SQL. Предварительно необходимо переключить контекст запроса на целевую базу данных.

```sql
  -- Create default data sources for SQL Big Data Cluster
  IF NOT EXISTS(SELECT * FROM sys.external_data_sources WHERE name = 'SqlDataPool')
      CREATE EXTERNAL DATA SOURCE SqlDataPool
      WITH (LOCATION = 'sqldatapool://controller-svc:8080/datapools/default');

  IF NOT EXISTS(SELECT * FROM sys.external_data_sources WHERE name = 'SqlStoragePool')
      CREATE EXTERNAL DATA SOURCE SqlStoragePool
      WITH (LOCATION = 'sqlhdfs://controller-svc:8080/default');
```

## <a name="launch-the-external-table-wizard"></a>Запуск мастера внешних таблиц

Подключитесь к корню HDFS с указанием IP-адреса. Разверните элементы в обозревателе объектов. Затем выберите один из CSV-файлов, откуда необходимо виртуализировать данные в существующем экземпляре SQL Server. Щелкните файл правой кнопкой мыши и выберите пункт **Создать внешнюю таблицу из CSV-файла** в контекстном меню. Вы также можете создавать внешние таблицы из CSV-файлов, используя папку в файловой системе HDFS, если такие файлы находятся в папке, по той же схеме. Это делает возможной виртуализацию данных на уровне папок без обработки отдельных файлов и получения объединенных результирующих наборов по объединенных данных. Будет запущен мастер виртуализации данных. Мастер виртуализации данных также можно запустить с помощью палитры команд, нажав клавиши CTRL+SHIFT+P (в Windows) и CMD+SHIFT+P (в Mac).

![Мастер виртуализации данных](media/data-virtualization/csv-virtualize-data-wizard.png)

## <a name="connect-to-a-sql-server-master-instance"></a>Подключение к главному экземпляру SQL Server

Здесь вы можете также указать экземпляр SQL Master, к которому вы будете подключаться, задав IP-адрес, порт и учетные данные. Ранее сохраненные подключения можно использовать через раскрывающийся список **Активные подключения SQL Server**. 
> [!NOTE]
>Если вы используете сохраненное подключение, остальные поля будут заблокированы


![Выбор источника данных](media/data-virtualization/csv-connect-to-master.png)

Щелкните "Далее", чтобы перейти к следующему шагу в мастере, на котором задается главный ключ базы данных.

## <a name="select-destination-database"></a>Выберите целевую базу данных

На этом шаге вы выберете целевую базу данных, в которой нужно виртуализировать данные. В раскрывающемся списке будут все допустимые базы данных экземпляра SQL Master, указанного на предыдущем экране. Здесь можно также указать имя новой внешней таблицы и увидеть схему, которую она будет использовать.

![Создание главного ключа базы данных](media/data-virtualization/csv-select-destination.png)


## <a name="preview-data"></a>Просмотр данных

В этом окне можно просмотреть первые 50 строк CSV-файла для проверки.

По окончании просмотра нажмите кнопку "Далее" для продолжения.

![Учетные данные внешнего источника данных](media/data-virtualization/csv-preview-data.png)

## <a name="modify-columns"></a>Изменение столбцов

В следующем окне можно изменить столбцы внешней таблицы, которую вы хотите создать. Имеется возможность изменить имя столбца, тип данных и разрешить для строк значение NULL. 

![Учетные данные внешнего источника данных](media/data-virtualization/csv-modify-columns.png)


## <a name="summary"></a>Сводка

На этом шаге предоставляется сводка выбранных значений. Здесь указывается экземпляр SQL Master и предлагаемая внешняя таблица. На этом шаге у вас есть возможность выбрать команду **Создать скрипт**, которая сформирует T-SQL-синтаксис для создания внешнего источника данных, или **Создать**, которая создаст объект внешнего источника данных.

![Экран сводки](media/data-virtualization/csv-virtualize-data-summary.png)

После нажатия кнопки "Создать" вы увидите объект внешней таблицы, созданный в целевой базе данных.

![Внешние источники данных](media/data-virtualization/csv-external-data-sources.png)

Если щелкнуть **Создать скрипт**, начнется формирование запроса T-SQL для создания объекта внешнего источника данных.

![Сформировать скрипт](media/data-virtualization/csv-generated-script.png)

> [!NOTE]
> Кнопка "Создать скрипт" должна отображаться только на последней странице мастера. Сейчас она отображается на всех страницах.

## <a name="next-steps"></a>Следующие шаги

Дополнительные сведения о кластерах больших данных SQL Server и связанных сценариях см. в [этой статье](../../big-data-cluster/big-data-cluster-overview.md).
