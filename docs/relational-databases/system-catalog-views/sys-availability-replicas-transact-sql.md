---
title: sys. availability_replicas (Transact-SQL) | Документация Майкрософт
ms.custom: ''
ms.date: 10/16/2017
ms.prod: sql
ms.prod_service: database-engine
ms.reviewer: ''
ms.technology: system-objects
ms.topic: language-reference
f1_keywords:
- availability_replicas_TSQL
- availability_replicas
- sys.availability_replicas
- sys.availability_replicas_TSQL
dev_langs:
- TSQL
helpviewer_keywords:
- Availability Groups [SQL Server], monitoring
- sys.availability_replicas catalog view
ms.assetid: 0a06e9b6-a1e4-4293-867b-5c3f5a8ff62c
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 6623d6b95dfe0ebd4e45b13d190d8176bcab1a3c
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "67942616"
---
# <a name="sysavailability_replicas-transact-sql"></a>sys.availability_replicas (Transact-SQL)
[!INCLUDE[tsql-appliesto-ss2012-xxxx-xxxx-xxx-md](../../includes/tsql-appliesto-ss2012-xxxx-xxxx-xxx-md.md)]

Возвращает по строке для каждой реплики доступности, принадлежащей любой группе доступности AlwaysOn в отказоустойчивом кластере WSFC.  
  
Если экземпляр локального сервера не может связаться с отказоустойчивым кластером, например, по причине останова кластера или потери кворума, то будут возвращены строки только для локальных реплик доступности. Эти строки будут содержать только столбцы данных, которые локально кэшируются в метаданные.  
  
 
|Имя столбца|Тип данных|Description|  
|-----------------|---------------|-----------------|  
|**replica_id**|**UNIQUEIDENTIFIER**|Уникальный идентификатор реплики.|  
|**group_id**|**UNIQUEIDENTIFIER**|Уникальный идентификатор группы доступности, к которой относится реплика.|  
|**replica_metadata_id**|**int**|Идентификатор локального объекта метаданных для реплик доступности в компоненте Database Engine.|  
|**replica_server_name**|**nvarchar(256)**|Имя сервера экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] , на котором размещена данная реплика, а также имя экземпляра, если экземпляр не является используемым по умолчанию.|  
|**owner_sid**|**varbinary (85)**|SID (идентификатор безопасности), зарегистрированный на данном экземпляре сервера для внешнего владельца реплики доступности.<br /><br /> Значение NULL для нелокальных реплик доступности.|  
|**endpoint_url**|**nvarchar(128**|Строковое представление определяемой пользователем конечной точки зеркального отображения базы данных, которое используется соединениями первичной реплики со вторичной для синхронизации данных. Сведения о синтаксисе конечной точки URL-адресов см. в разделе [Указание URL-адреса конечной точки при добавлении или изменении реплики доступности (SQL Server)](../../database-engine/availability-groups/windows/specify-endpoint-url-adding-or-modifying-availability-replica.md).<br /><br /> NULL = не удалось связаться с отказоустойчивым кластером WSFC.<br /><br /> Чтобы изменить эту конечную точку, используйте параметр ENDPOINT_URL инструкции [ALTER AVAILABILITY GROUP](../../t-sql/statements/alter-availability-group-transact-sql.md) [!INCLUDE[tsql](../../includes/tsql-md.md)] .|  
|**availability_mode**|**tinyint**|Режим доступности реплики может быть одним из следующих.<br /><br /> 0 &#124; асинхронную фиксацию. Первичная реплика может фиксировать транзакции, не ожидая, пока вторичная реплика запишет запись журнала транзакций на диск.<br /><br /> 1 &#124; синхронную фиксацию. Первичная реплика ожидает возможности выполнения фиксации транзакции, пока вторичная реплика записывает транзакцию на диск.<br /><br />4 &#124; только конфигурация. Первичная реплика в синхронном режиме отправляет метаданные конфигурации группы доступности в реплику. Пользовательские данные не передаются в реплику. Доступно в SQL Server 2017 CU1 и более поздних версиях.<br /><br /> Дополнительные сведения см. в разделе [Режимы доступности (группы доступности AlwaysOn)](../../database-engine/availability-groups/windows/availability-modes-always-on-availability-groups.md).|  
|**availability_mode_desc**|**nvarchar (60)**|Описание **режима доступности\_**, одно из следующих:<br /><br /> АСИНХРОНная\_фиксация<br /><br /> СИНХРОНная\_фиксация<br /><br /> только\_конфигурация<br /><br /> Чтобы изменить режим доступности для реплики доступности, используйте параметр AVAILABILITY_MODE инструкции [ALTER AVAILABILITY GROUP](../../t-sql/statements/alter-availability-group-transact-sql.md) [!INCLUDE[tsql](../../includes/tsql-md.md)] .<br/><br>Нельзя изменить режим доступности реплики на только конфигурацию\_. Нельзя изменить реплику только\_конфигурации на вторичную или первичную реплику. |  
|**режим\_отработки отказа**|**tinyint**|[Режим отработки отказа](../../database-engine/availability-groups/windows/failover-and-failover-modes-always-on-availability-groups.md) реплики доступности, один из следующих:<br /><br /> 0 &#124; автоматический переход на другой ресурс. Реплика является потенциальной целью для автоматического перехода на другой ресурс.  Автоматическая отработка отказа поддерживается, только если для режима доступности задано значение Синхронная фиксация (**режим доступности\_** = 1), а реплика доступности в настоящее время синхронизирована.<br /><br /> 1 &#124; отработку отказа вручную. Если переход на вторичную реплику установлен в режим отработки отказа вручную, то он должен быть инициирован вручную администратором базы данных. Тип выполняемой отработки отказа зависит от того, была ли синхронизирована вторичная реплика следующим образом:<br /><br /> Если реплика доступности не была синхронизирована или синхронизация еще выполняется, то может быть выполнена только принудительная отработка отказа (с возможной потерей данных).<br /><br /> Если для режима доступности задано значение Синхронная фиксация (**режим доступности\_** = 1), а реплика доступности в настоящее время синхронизирована, может произойти отработка отказа вручную без потери данных.<br /><br /> Чтобы просмотреть свертку состояния синхронизации базы данных для каждой базы данных доступности в реплике доступности, используйте столбцы " **работоспособность синхронизации\_** " и " **\_состояние\_синхронизации** " в динамическом административном представлении [sys. dm_hadr_availability_replica_states](../../relational-databases/system-dynamic-management-views/sys-dm-hadr-availability-replica-states-transact-sql.md) . Свертка проверяет состояние синхронизации для каждой базы данных доступности, а также режим доступности для ее реплики доступности.<br /><br /> **Примечание.** Чтобы просмотреть состояние синхронизации заданной базы данных доступности, запросите **столбцы\_состояния синхронизации** и состояния **синхронизации\_** динамического административного представления [sys. dm_hadr_database_replica_states](../../relational-databases/system-dynamic-management-views/sys-dm-hadr-database-replica-states-transact-sql.md) .|  
|**desc\_в\_режиме отработки отказа**|**nvarchar (60)**|Описание **режима отработки отказа\_**, одно из следующих:<br /><br /> MANUAL<br /><br /> AUTOMATIC<br /><br /> Чтобы изменить режим отработки отказа,\_используйте параметр режим отработки отказа инструкции [ALTER AVAILABILITY GROUP](../../t-sql/statements/alter-availability-group-transact-sql.md) [!INCLUDE[tsql](../../includes/tsql-md.md)] .|  
|**время\_ожидания сеанса**|**int**|Интервал времени ожидания в секундах. Интервал времени ожидания — это максимальное время, в течение которого реплика ожидает получения сообщения от другой реплики перед тем, как соединение между первичной и вторичной репликой будет признано несостоявшимся. Время ожидания сеанса определяет, связаны ли вторичные реплики с первичной.<br /><br /> При обнаружении сбоя соединения с вторичной репликой первичная реплика считает, что вторичная реплика\_не синхронизирована. При обнаружении ошибки соединения с первичной репликой вторичная реплика просто пытается установить соединение повторно.<br /><br /> **Примечание.** Время ожидания сеанса не вызывает автоматический переход на другой ресурс.<br /><br /> Чтобы изменить это значение, используйте параметр SESSION_TIMEOUT инструкции [ALTER AVAILABILITY GROUP](../../t-sql/statements/alter-availability-group-transact-sql.md) [!INCLUDE[tsql](../../includes/tsql-md.md)] .|  
|**\_первичная\_роль\_разрешает подключения**|**tinyint**|Допускается ли наличие всех соединений или только соединений для чтения и записи, одно из следующих значений:<br /><br /> 2 = все (по умолчанию)<br /><br /> 3 = чтение и запись|  
|**\_первичная\_роль\_разрешать соединения\_DESC**|**nvarchar (60)**|Описание **первичной\_роли\_\_разрешать подключения**, одно из следующих:<br /><br /> ALL<br /><br /> ЧТЕНИЕ\_и запись|  
|**\_вторичная\_роль\_разрешает подключения**|**tinyint**|Указывает, могут ли базы данных заданной реплики доступности, играющей роль вторичной (т. е. служащей вторичной репликой), принимать соединения от клиентов. Может принимать одно из следующих значений:<br /><br /> 0 = Нет. Не допускаются соединения к базам данных из вторичной реплики, к базам данных также невозможен доступ только для чтения. Это параметр по умолчанию.<br /><br /> 1 = только для чтения. К базам данных из вторичной реплики разрешаются соединения только для чтения. Для всех баз данных в реплике разрешен доступ для чтения.<br /><br /> 2= все. К базам данных во вторичной реплике разрешаются все соединения на доступ только для чтения.<br /><br /> Дополнительные сведения см. в разделе [Активные вторичные реплики: доступные только для чтения вторичные реплики (группы доступности AlwaysOn)](../../database-engine/availability-groups/windows/active-secondaries-readable-secondary-replicas-always-on-availability-groups.md).|  
|**secondary_role_allow_connections_desc**|**nvarchar (60)**|Описание **secondary_role_allow_connections**, одно из следующих:<br /><br /> НЕТ<br /><br /> READ_ONLY<br /><br /> ALL|  
|**create_date**|**datetime**|Дата создания реплики.<br /><br /> NULL = на данном экземпляре сервера реплика отсутствует.|  
|**modify_date**|**datetime**|Дата последнего изменения реплики.<br /><br /> NULL = на данном экземпляре сервера реплика отсутствует.|  
|**backup_priority**|**int**|Представляет определяемый пользователем приоритет выполнения резервного копирования на данной реплике по отношению к другим репликам в той же группе доступности. Значение представляет собой целое число в диапазоне от 0 до 100.<br /><br /> Дополнительные сведения см. в статье [Активные вторичные реплики: резервное копирование во вторичных репликах (группы доступности Always On)](../../database-engine/availability-groups/windows/active-secondaries-backup-on-secondary-replicas-always-on-availability-groups.md).|  
|**read_only_routing_url**|**nvarchar(256)**|Конечная точка подключения (URL-адрес) реплики доступности, доступной только для чтения. Дополнительные сведения см. в статье [Настройка маршрутизации только для чтения в группе доступности (SQL Server)](../../database-engine/availability-groups/windows/configure-read-only-routing-for-an-availability-group-sql-server.md).|  
  
## <a name="security"></a>безопасность  
  
### <a name="permissions"></a>Разрешения  
 Требует разрешения VIEW ANY DEFINITION на экземпляре сервера.  
  
## <a name="see-also"></a>См. также:  
 [sys. availability_groups &#40;Transact-SQL&#41;](../../relational-databases/system-catalog-views/sys-availability-groups-transact-sql.md)   
 [Обзор групп доступности AlwaysOn (SQL Server)](../../database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server.md)   
 [Always On группы доступности &#40;SQL Server&#41;](../../database-engine/availability-groups/windows/always-on-availability-groups-sql-server.md)   
 [Мониторинг групп доступности &#40;&#41;Transact-SQL](../../database-engine/availability-groups/windows/monitor-availability-groups-transact-sql.md)   
 [Мониторинг групп доступности &#40;&#41;Transact-SQL](../../database-engine/availability-groups/windows/monitor-availability-groups-transact-sql.md)  
  
  
