---
title: Сопоставители на базе технологии Microsoft COM | Документация Майкрософт
ms.custom: ''
ms.date: 03/14/2017
ms.prod: sql
ms.prod_service: database-engine
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- COM-based resolvers [SQL Server replication]
- custom resolvers [SQL Server replication]
ms.assetid: a6637e4b-4e6b-40aa-bee6-39d98cc507c8
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: ec508dbaf274816ecf32f8eaa0a8047baa60e2a8
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "68033395"
---
# <a name="advanced-merge-replication-conflict---com-based-resolvers"></a>Конфликт расширенной репликации слиянием: сопоставители на базе технологии COM
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../../../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)]
  Все сопоставители, основанные на технологии COM и поставляемые с [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , обрабатывают конфликты обновления, а там, где это оговорено специально, они также обрабатывают конфликты вставки и удаления. Все арбитры производят отслеживание столбцов; большинство из них также производят отслеживание строк. Эти и все другие основанные на технологии COM сопоставители объявляют типы конфликтов, которые они обрабатывают, а для всех остальных типов конфликтов агент слияния использует сопоставитель по умолчанию.  
  
 Сопоставители устанавливаются во время процесса установки [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. Выполните хранимую процедуру **sp_enumcustomresolvers** для просмотра всех сопоставителей, зарегистрированных на компьютере. При выполнении этой процедуры отображаются описание и глобальный уникальный идентификатор (GUID) для каждого сопоставителя в отдельном результирующем наборе.  
  
 Чтобы указать сопоставитель, см. [Specify a Merge Article Resolver](../../../relational-databases/replication/publish/specify-a-merge-article-resolver.md).  
  
 В следующей таблице описываются атрибуты конкретных сопоставителей.  
  
|Имя|Требуемые входные данные|Описание|Комментарии|  
|----------|--------------------|-----------------|--------------|  
|Арбитр конфликтов[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий суммирование|Имя суммируемого столбца. Столбец должен относиться к арифметическому типу данных (например, **int**, **smallint**, **numeric**и т. д.).|Победитель в конфликте определяется по значению приоритета. Указанные значения столбца устанавливаются равными сумме значений исходного столбца и целевого столбца. Если одно из значений — NULL, итоговое значение устанавливается равным значению другого столбца.|Поддерживает конфликты обновления, и только отслеживание столбцов.|  
|Арбитр конфликтов[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий усреднение|Имя усредняемого столбца. Столбец должен относиться к арифметическому типу данных (например, **int**, **smallint**, **numeric**и т. д.).|Победитель в конфликте определяется по значению приоритета. Значения результирующего столбца устанавливаются равными среднему значению от значений исходного и целевого столбца. Если одно из значений — NULL, итоговое значение устанавливается равным значению другого столбца.|Поддерживает конфликты обновления, и только отслеживание столбцов.|  
|Арбитр конфликтов[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий тип DATETIME (побеждает более раннее значение)|Имя столбца, применяемого для определения победителя конфликта. Столбец должен иметь тип данных **datetime** .|Конфликт разрешается в пользу столбца с более ранним значением **datetime** . Если одно из значений установлено равным NULL, победителем является строка, содержащая другое значение.|Поддерживает конфликты обновления, отслеживание строк и столбцов. Значения столбцов сравниваются напрямую, и поправка на разницу в часовых поясах не производится.|  
|Арбитр конфликтов[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий тип DATETIME (побеждает более позднее значение)|Имя столбца, применяемого для определения победителя конфликта. Столбец должен иметь тип данных **datetime** .|Конфликт разрешается в пользу столбца с более поздним значением **datetime** . Если одно из значений установлено равным NULL, победителем является строка, содержащая другое значение.|Поддерживает конфликты обновления, отслеживание строк и столбцов.|  
|Арбитр конфликтов[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий максимум|Имя столбца, применяемого для определения победителя конфликта. Столбец должен относиться к арифметическому типу данных (например, **int**, **smallint**, **numeric**и т. д.).|Столбец с большим числовым значением становится победителем в конфликте. Если одно из значений установлено равным NULL, победителем является строка, содержащая другое значение.|Поддерживает отслеживание строк и столбцов.|  
|Арбитр конфликтов[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий минимум|Имя столбца, применяемого для определения победителя конфликта. Столбец должен относиться к арифметическому типу данных (например, **int**, **smallint**, **numeric**и т. д.).|Столбец с меньшим числовым значением становится победителем в конфликте. Если одно из значений установлено равным NULL, победителем является строка, содержащая другое значение.|Поддерживает конфликты обновления, отслеживание строк и столбцов.|  
|Арбитр конфликтов[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий слияние текста|Имя текстового столбца и разделитель, например `@resolver_info = '[col1][===]'`.|Победитель в конфликте определяется по значению приоритета. Конфликтующие текстовые столбцы устанавливаются равными объединенному значению, состоящему из общего префикса, за которым следует уникальная часть от издателя, затем следует разделитель, а затем — уникальная часть от подписчика.|Поддерживает конфликты обновления, и только отслеживание столбцов.|  
|Арбитр конфликтов[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] с победой подписчика|Нет входных данных.|Конфликт разрешается в пользу подписчика, независимо от того является он источником или пунктом назначения.|Поддерживает все типы конфликтов.|  
|Сопоставитель[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий приоритетный столбец|Имя столбца, применяемого для определения победителя конфликта. Столбец должен относиться к арифметическому типу данных (например, **int**, **smallint**, **numeric**и т. д.).|Столбец с большим числовым значением становится победителем в конфликте. Если одно из значений установлено равным NULL, победителем является строка, содержащая другое значение.|Поддерживает конфликты обновления, отслеживание строк и столбцов.|  
|Арбитр конфликтов[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий только передачу|Нет входных данных.|Принимаются изменения, переданные на издатель; изменения не загружаются на подписчик.|Поддерживает все типы конфликтов.|  
|Арбитр конфликтов[!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] , использующий только загрузку|Нет входных данных.|Отклоняются изменения, переданные на издатель; изменения загружаются на подписчик.|Поддерживает все типы конфликтов.|  
|Арбитр конфликтов хранимых процедур[!INCLUDE[msCoName](../../../includes/msconame-md.md)] SQL Server|Имя хранимой процедуры, которую должен вызвать сопоставитель для разрешения конфликта.|Устранение конфликта зависит от логики указываемой хранимой процедуры.|Поддерживает конфликты обновления. Дополнительные сведения см. в статье [Реализация пользовательского арбитра конфликтов для статьи публикации слиянием](../../../relational-databases/replication/implement-a-custom-conflict-resolver-for-a-merge-article.md)|  
  
## <a name="see-also"></a>См. также:  
 [Advanced Merge Replication Conflict Detection and Resolution](../../../relational-databases/replication/merge/advanced-merge-replication-conflict-detection-and-resolution.md)   
 [sp_enumcustomresolvers (Transact-SQL)](../../../relational-databases/system-stored-procedures/sp-enumcustomresolvers-transact-sql.md)  
  
  
