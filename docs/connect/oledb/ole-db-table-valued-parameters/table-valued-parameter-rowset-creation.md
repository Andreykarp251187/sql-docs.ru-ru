---
title: Создание набора строк возвращающего табличное значение параметра | Документация Майкрософт
description: Создание набора строк со статическим и динамически возвращающим табличное значение параметром
ms.custom: ''
ms.date: 06/14/2018
ms.prod: sql
ms.prod_service: database-engine, sql-database, sql-data-warehouse, pdw
ms.reviewer: ''
ms.technology: connectivity
ms.topic: reference
helpviewer_keywords:
- table-valued parameters, rowset creation
author: pmasl
ms.author: pelopes
ms.openlocfilehash: c771d8bde657b464b29a109dadd7a4d6fa33fbdb
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MTE75
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "67994115"
---
# <a name="table-valued-parameter-rowset-creation"></a>Создание набора строк возвращающего табличное значение параметра
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../../../includes/appliesto-ss-asdb-asdw-pdw-md.md)]

[!INCLUDE[Driver_OLEDB_Download](../../../includes/driver_oledb_download.md)]

  Несмотря на то, что потребители могут предоставить для возвращающих табличные значения параметров любой объект набора строк, типичные объекты наборов строк реализуются для конечных хранилищ данных и таким образом предоставляют ограниченную производительность. По этой причине драйвер OLE DB для SQL Server разрешает потребителям создавать специализированный объект набора строк на основе данных в памяти. Этот специальный объект набора данных в памяти является новым COM-объектом, называемым набором строк возвращающего табличное значение параметра. Он предлагает функциональные возможности, аналогичные набору параметров.  
  
 Объекты набора строк возвращающего табличное значение параметра создаются явным образом поставщиком для входных параметров через несколько интерфейсов уровня сеанса. Для одного возвращающего табличное значение параметра существует один объект набора строк. Потребитель может создавать объекты набора строк возвращающего табличное значение параметра либо путем предоставления уже известных метаданных (статический сценарий), либо путем его обнаружения через интерфейсы поставщика (динамический сценарий). Эти два сценария описаны в следующих разделах.  
  
## <a name="static-scenario"></a>Статический сценарий  
 Когда сведения о типе известны, потребитель использует Итабледефинитионвисконстраинтс:: Креатетаблевисконстраинтс для создания экземпляра объекта набора строк возвращающего табличное значение параметра, соответствующего возвращающему табличное значение параметру.  
  
 Поле *GUID* (параметр*pTableID* ) содержит специальный идентификатор GUID (CLSID_ROWSET_TVP). Элемент *pwszName* содержит имя типа возвращающего табличное значение параметра, который потребитель хочет создать. Поле *eKind* будет установлено в значение DBKIND_GUID_NAME. Это имя требуется при использовании нерегламентированной инструкции SQL. При вызове процедуры имя является необязательным.  
  
 Для статистической обработки потребитель передает параметр *пункаутер* с помощью управляющего IUnknown.  
  
 Свойства объекта набора строк возвращающего табличное значение параметра доступны только для чтения, так что установка потребителем каких-либо свойств в *rgPropertySets* не предусмотрена.  
  
 Для элемента *rgPropertySets* каждой структуры DBCOLUMNDESC потребитель может указать дополнительные свойства для каждого столбца. Эти свойства принадлежат набору свойств DBPROPSET_SQLSERVERCOLUMN. Они позволяют указать для каждого столбца вычисляемые настройки и настройки по умолчанию. Также они поддерживают существующие свойства столбца, например допустимость значений NULL и идентификатор.  
  
 Для получения соответствующих сведений от объекта набора строк возвращающего табличные значения параметра потребитель использует метод IRowsetInfo::GetProperties.  
  
 Чтобы получить сведения об нулевом, уникальном, вычисляемом и обновленном состоянии каждого столбца, потребитель может использовать IColumnsRowset:: Жетколумнсровсет или IColumnsInfo:: GetColumnInfo. Эти методы предоставляют подробные сведения о каждом столбце набора строк возвращающего табличные значения параметра.  
  
 Потребитель указывает тип каждого столбца возвращающего табличные значения параметра. Это действие аналогично тому, как указываются столбцы при создании таблицы в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]. Потребитель получает объект набора строк возвращающего табличное значение параметра из драйвера OLE DB для SQL Server с помощью выходного параметра *ппровсет* .  
  
## <a name="dynamic-scenario"></a>Динамический сценарий  
 Если потребитель не имеет сведений о типе, он должен использовать IOpenRowset:: OpenRowset для создания экземпляров объектов набора строк возвращающего табличное значение параметра. Потребитель должен предоставить поставщику имя типа.  
  
 В этом сценарии поставщик получает сведения о типе объекта набора строк возвращающего табличные значения параметра из сервера от лица потребителя.  
  
 Параметры *pTableID* и *пункаутер* должны быть заданы как в статическом сценарии. После этого драйвер OLE DB для SQL Server получает от сервера сведения о типе (сведения о столбцах и ограничениях) и возвращает объект набора строк возвращающего табличные значения параметра через параметр *ppRowset*. Эта операция требует связи с сервером, поэтому выполняется не так быстро, как статический сценарий. Динамический сценарий работает только с параметризованными вызовами процедур.  
  
## <a name="see-also"></a>См. также:  
 [Возвращающие табличные значения параметры &#40;OLE DB&#41;](../../oledb/ole-db-table-valued-parameters/table-valued-parameters-ole-db.md)   
 [Использование возвращающих табличные значения параметров &#40;OLE DB&#41;](../../oledb/ole-db-how-to/use-table-valued-parameters-ole-db.md)  
  
  
