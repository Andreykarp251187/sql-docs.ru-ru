---
title: Обновление приложения с переходом от MDAC на драйвер OLE DB для SQL Server | Документация Майкрософт
description: Обновление приложения с переходом от MDAC на драйвер OLE DB для SQL Server
ms.custom: ''
ms.date: 06/12/2018
ms.prod: sql
ms.prod_service: database-engine, sql-database, sql-data-warehouse, pdw
ms.reviewer: ''
ms.technology: connectivity
ms.topic: reference
helpviewer_keywords:
- MDAC [SQL Server]
- MSOLEDBSQL, vs. MDAC
- OLE DB Driver for SQL Server, vs. MDAC
- data access [OLE DB Driver for SQL Server], vs. MDAC
- OLE DB Driver for SQL Server, updating applications
author: pmasl
ms.author: pelopes
manager: jroth
ms.openlocfilehash: 72f4406c4da07a1ddec422f09512dfe7cb28a028
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MTE75
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "66778086"
---
# <a name="updating-an-application-to-ole-db-driver-for-sql-server-from-mdac"></a>Обновление приложения с переходом от MDAC на драйвер OLE DB для SQL Server
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../../../includes/appliesto-ss-asdb-asdw-pdw-md.md)]

[!INCLUDE[Driver_OLEDB_Download](../../../includes/driver_oledb_download.md)]

  Между драйвером OLE DB для SQL Server и компонентами доступа к данным MDAC существует несколько различий; начиная с Windows Vista, компоненты доступа к данным стали называться компонентами доступа к данным Windows, или Windows DAC. Хотя оба варианта реализуют низкоуровневый доступ к базам данных [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], драйвер OLE DB для SQL Server предоставляет новые функции [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] особым образом, обеспечивая в то же время обратную совместимость с ранними версиями.   

 Кроме того несмотря на то, что компоненты MDAC входят компоненты для использования OLE DB, ODBC и объектов данных ActiveX (ADO), драйвер OLE DB для SQL Server реализует только OLE DB (хотя объекты ADO могут функциональные возможности драйвера OLE DB для SQL Server).  

 Драйвер OLE DB для SQL Server и компоненты MDAC различаются в следующих областях:  

-   Сотрудники, использующие ADO для доступа к драйверу OLE DB для SQL Server может оказаться меньше функций фильтрации, чем при доступе к поставщик SQL OLE DB.  

-   Если в приложении ADO используется драйвер OLE DB для SQL Server и пытается обновить вычисляемый столбец, будет сообщение об ошибке. При использовании компонентов MDAC обновление было бы принято, но пропущено.  

-   Драйвер OLE DB для SQL Server — это один автономный файл библиотеки динамической компоновки (DLL). Количество интерфейсов с открытым доступом сведено к минимуму, чтобы упростить распространение, а также повысить уровень безопасности.  

-   Поддерживаются только интерфейсы OLE DB.  

-   Драйвер OLE DB для SQL Server имена отличаются от имен, которые используются в компонентах MDAC.  

-   Доступные для пользователя функции, предоставляемые компонентами MDAC доступна при использовании драйвера OLE DB для SQL Server. К ним помимо прочего относится создание пулов соединений, поддержка ADO и поддержка клиентских курсоров. При использовании любой из этих функций драйвер OLE DB для SQL Server предоставляет только подключение к базе данных. Компоненты MDAC предоставляют такие функции, как трассировка, элементы управления в интерфейсе управления и счетчики производительности.  

-   Приложения могут использовать основные службы OLE DB в сочетании с драйвером OLD DB для SQL Server, но при использовании ядра курсора OLE DB в них должен быть установлен параметр совместимости типов данных во избежание потенциальных проблем, которые могут возникнуть в связи с тем, что в ядре курсора отсутствуют сведения о новых типах данных [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].  

-   Драйвер OLE DB для SQL Server поддерживает доступ к предыдущей [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] баз данных.  

-   Драйвер OLE DB для SQL Server не содержит интеграция XML. Драйвер OLE DB для SQL Server поддерживает SELECT... БОЛЕЕ XML, но не поддерживает другие функциональные возможности XML. Тем не менее, поддерживает ли драйвер OLE DB для SQL Server **xml** появился тип данных в [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].  

-   Драйвер OLE DB для SQL Server поддерживает настройку сетевых библиотек на стороне клиента с использованием только атрибутов строки соединения. Если требуется провести более сложную настройку сетевых библиотек, необходимо использовать диспетчер конфигурации [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].  

-   Подключения MDAC поддерживает логическое значение (**true**) для **Trusted_Connection** ключевое слово. Драйвер OLE DB для строки подключения SQL Server необходимо использовать **Да** или **не**.  

-   Незначительные изменения внесены в предупреждения и ошибки. Теперь в передаваемых драйверу OLE DB для SQL Server предупреждениях и ошибках, которые возвращаются сервером, степень серьезности сохраняется без изменений. Следует тщательно протестировать приложение, если его работа зависит от перехвата определенных предупреждений и ошибок.  

-   Проверка ошибок в драйвере OLE DB для SQL Server строже, чем в компонентах MDAC, а это означает, что некоторые приложения, которые не полностью соответствуют спецификациям OLE DB, могут работать по-разному. Например, в поставщике SQLOLEDB не предусмотрено принудительное применение правила, согласно которому имена результирующих параметров должны начинаться с символа \@, а в драйвере OLE DB для SQL Server такое правило соблюдается.  

-   Драйвер OLE DB для SQL Server ведет себя по-разному с компонентами MDAC о неудачных попыток соединения. Например, компоненты MDAC возвращают кэшированные значения свойств разорванного соединения, тогда как драйвер OLE DB для SQL Server сообщает вызывающему приложению об ошибке.  

-   Драйвер OLE DB для SQL Server не формирует события Visual Studio Analyzer; вместо них он формирует события трассировки Windows.  

-   Драйвер OLE DB для SQL Server не может использоваться с системным монитором. Системный монитор — это средство Windows, которое можно использовать только для файлов DSN, которые используют драйвер MDAC SQLODBC, входящий в Windows.  

-   Драйвер OLE DB для SQL Server при подключении к [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] и более поздних версиях ошибка сервера 16947 возвращается в виде SQL_ERROR. Эта ошибка возникает, если при выполнении позиционированного обновления или удаления не удается обновить или удалить строку. При использовании компонентов MDAC для соединения с любой версией [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ошибка сервера 16947 возвращается в виде предупреждения (SQL_SUCCESS_WITH_INFO).  

-   Драйвер OLE DB для SQL Server реализует интерфейс **IDBDataSourceAdmin**; это необязательный интерфейс OLE DB, который ранее не реализовывался. При этом реализуется только метод **CreateDataSource** этого интерфейса. [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]  

-   Драйвер OLE DB для SQL Server возвращает синонимы в наборах строк схемы TABLES и TABLE_INFO, при этом параметру TABLE_TYPE присваивается значение SYNONYM.  

-   Значения типов данных **varchar(max)** , **nvarchar(max)** , **varbinary(max)** , **xml**, **udt** или других типов больших объектов невозможно возвратить клиенту с версией ниже [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]. Если вы хотите использовать эти типы в качестве возвращаемых значений, необходимо использовать драйвер OLE DB для SQL Server.  

-   Компоненты MDAC позволяют выполнять следующие инструкции при запуске ручных или неявных транзакций, а драйвер OLE DB для SQL Server — нет. Они должны выполняться в режиме автоматической фиксации.  

    -   Все полнотекстовые операции (операции DDL с индексом и каталогом)  

    -   Все операции с базой данных (создание базы данных, изменение базы данных, удаление базы данных)  

    -   Повторная настройка  

    -   Shutdown  

    -   Удаление  

    -   Резервное копирование  

-   При подключении приложений MDAC к [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] типы данных, представленные в [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], будут отображаться как типы данных, совместимые с [!INCLUDE[ssVersion2000](../../../includes/ssversion2000-md.md)], как показано в следующей таблице.  

    |Тип SQL Server 2005|Тип SQL Server 2000|  
    |--------------------------|--------------------------|  
    |**varchar(max)**|**text**|  
    |**nvarchar(max)**|**ntext**|  
    |**varbinary(max)**|**image**|  
    |**udt**|**varbinary**|  
    |**xml**|**ntext**|  

     Это сопоставление типов затрагивает значения, возвращаемые для метаданных столбцов. Например **текст** столбец имеет максимальный размер 2 147 483 647, но драйвер OLE DB для SQL Server сообщает максимальный размер **varchar(max)** столбцы как 2 147 483 647 или -1, в зависимости от платформы.  

-   В драйвере OLE DB для SQL Server в целях обеспечения обратной совместимости допускается неоднозначность в строках соединений (например, некоторые ключевые слова могут быть указаны несколько раз, допускается также использование конфликтующих ключевых слов; при этом разрешение конфликтов происходит с учетом позиции или приоритета). Будущих версиях драйвер OLE DB для SQL Server не может разрешить неоднозначность в строках подключения. При изменении приложения для работы с драйвером OLE DB для SQL Server необходимо предусмотреть устранение любых зависимостей от неоднозначности строки соединения.  

-   Если вы используете OLE DB, вызывают запуск транзакций, имеется различие в поведении между драйвер OLE DB для SQL Server и MDAC; транзакции запускаются немедленно с драйвером OLE DB для SQL Server, но транзакции запускаются после первой базы данных доступ с помощью MDAC. Это может повлиять на поведение хранимых процедур и пакетов, так как в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] требуется, чтобы значение @@TRANCOUNT после выполнения хранимой процедуры или пакета было таким же, как при запуске пакета или хранимой процедуры.  

-   С помощью драйвер OLE DB для SQL Server ITransactionLocal::BeginTransaction вызовет немедленный запуск транзакции. При использовании компонентов MDAC запуск транзакции задерживается до выполнения приложением инструкции, которой требовалась транзакция в неявном режиме. Дополнительные сведения см. в разделе [SET IMPLICIT_TRANSACTIONS (Transact-SQL)](../../../t-sql/statements/set-implicit-transactions-transact-sql.md).  


 Оба драйвер OLE DB для SQL Server и MDAC поддерживают изоляции транзакций read committed с использованием управления версиями строк, но только драйвер OLE DB для изоляции транзакции моментальных снимков поддерживает SQL Server. (С точки зрения программирования уровень изоляции транзакций READ COMMITTED с управлением версиями строк представляет собой то же, что и транзакция READ COMMITTED.)  

## <a name="see-also"></a>См. также:  
 [Создание приложений с помощью драйвера OLE DB для SQL Server](../../oledb/applications/building-applications-with-oledb-driver-for-sql-server.md)  
