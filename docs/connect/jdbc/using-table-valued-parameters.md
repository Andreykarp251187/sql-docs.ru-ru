---
title: Использование возвращающих табличные значения параметров | Документация Майкрософт
ms.custom: ''
ms.date: 08/12/2019
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
ms.assetid: 3af61054-a886-4e1a-ad85-93f87c6d3584
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 98863afb5a47eddfd311563bd03a1c7c7120b161
ms.sourcegitcommit: 9348f79efbff8a6e88209bb5720bd016b2806346
ms.translationtype: MTE75
ms.contentlocale: ru-RU
ms.lasthandoff: 08/14/2019
ms.locfileid: "69025708"
---
# <a name="using-table-valued-parameters"></a>Использование параметров, возвращающих табличные значения

[!INCLUDE[Driver_JDBC_Download](../../includes/driver_jdbc_download.md)]

Параметры, возвращающие табличное значение, упрощают маршалинг нескольких строк данных из клиентского приложения в SQL Server, устраняя потребность в нескольких круговых путях или специальной серверной логике для обработки данных. Параметры, возвращающие табличное значение, можно использовать для инкапсуляции строк данных в клиентском приложении и их отправки на сервер единой параметризованной командой. Входящие строки данных хранятся в переменной таблицы, которой затем можно управлять с помощью Transact-SQL.  
  
Доступ к значениям столбцов в возвращающих табличное значение параметрах можно получить с помощью стандартных инструкций Transact-SQL SELECT. Возвращающие табличные значения параметры являются строго типизированными, и их структура проверяется автоматически. Размер возвращающих табличное значение параметров ограничен только объемом памяти сервера.  
  
> [!NOTE]  
> Поддержка возвращающих табличное значение параметров доступна начиная с Microsoft JDBC Driver 6,0 для SQL Server.
>
> Невозможно вернуть данные в параметре, возвращающем табличное значение. Возвращающие табличное значение параметры являются только входными. ключевое слово OUTPUT не поддерживается.  
  
 Дополнительные сведения о возвращающих табличное значение параметрах см. в следующих ресурсах.  
  
| Ресурс                                                                                                             | Описание                                                                         |
| -------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------- |
| Возвращающие табличное значение [Параметры (ядро СУБД)](https://go.microsoft.com/fwlink/?LinkId=98363) в Электронная документация на SQL Server | Описывает создание и использование возвращающих табличное значение параметров                             |
| [Определяемые пользователем табличные типы](https://go.microsoft.com/fwlink/?LinkId=98364) в Электронная документация на SQL Server                  | Описывает определяемые пользователем табличные типы, используемые для объявления возвращающих табличное значение параметров. |
| Раздел [ядро СУБД Microsoft SQL Server](https://go.microsoft.com/fwlink/?LinkId=120507) в CodePlex        | Содержит примеры, демонстрирующие использование функций и функций SQL Server  |
  
## <a name="passing-multiple-rows-in-previous-versions-of-sql-server"></a>Передача нескольких строк в предыдущих версиях SQL Server  

Перед тем как возвращающие табличное значение параметры были введены в SQL Server 2008, параметры передачи нескольких строк данных в хранимую процедуру или параметризованную команду SQL были ограничены. Разработчик может выбрать один из следующих вариантов передачи нескольких строк на сервер:  
  
- Используйте ряд отдельных параметров, чтобы представить значения в нескольких столбцах и строках данных. Объем данных, которые могут быть переданы с помощью этого метода, ограничено количеством допустимых параметров. SQL Server процедурах может иметь не более 2100 параметров. Логика на стороне сервера необходима для того, чтобы собрать эти отдельные значения в табличную переменную или временную таблицу для обработки.  
  
- Объединить несколько значений данных в строки с разделителями или документы XML, а затем передать эти текстовые значения в процедуру или инструкцию. Для этого необходимо, чтобы процедура или инструкция включала логику, необходимую для проверки структуры данных и отменяя объединение значений.  
  
- Создайте ряд отдельных инструкций SQL для изменений данных, влияющих на несколько строк. Изменения могут отправляться на сервер по отдельности или объединяться в группы. Однако даже при отправке в пакетах, содержащих несколько инструкций, каждая инструкция выполняется отдельно на сервере.  
  
- Используйте программу bcp или объект [SQLServerBulkCopy](https://msdn.microsoft.com/library/system.data.sqlclient.sqlbulkcopy(v=vs.110).aspx) для загрузки большого количества строк данных в таблицу. Хотя этот метод очень эффективен, он не поддерживает обработку на стороне сервера, если данные не загружаются во временную таблицу или табличную переменную.  
  
## <a name="creating-table-valued-parameter-types"></a>Создание типов параметров, возвращающих табличное значение  

Возвращающие табличные значения параметры основаны на строго типизированных табличных структурах, которые определены `CREATE TYPE` с помощью инструкций Transact-SQL. Необходимо создать табличный тип и определить структуру в SQL Server, прежде чем можно будет использовать возвращающие табличное значение параметры в клиентских приложениях. Дополнительные сведения о создании табличных типов см. в разделе [определяемые пользователем табличные типы](https://go.microsoft.com/fwlink/?LinkID=98364) в Электронная документация на SQL Server.  

```sql
CREATE TYPE dbo.CategoryTableType AS TABLE  
    ( CategoryID int, CategoryName nvarchar(50) )  
```

После создания табличного типа можно объявить возвращающие табличное значение параметры на основе этого типа. В следующем фрагменте Transact-SQL показано, как объявить возвращающий табличное значение параметр в определении хранимой процедуры. Обратите внимание `READONLY` , что для объявления возвращающего табличное значение параметра требуется ключевое слово.  

```sql
CREATE PROCEDURE usp_UpdateCategories
    (@tvpNewCategories dbo.CategoryTableType READONLY)  
```

## <a name="modifying-data-with-table-valued-parameters-transact-sql"></a>Изменение данных с помощью возвращающих табличное значение параметров (Transact-SQL)  

Возвращающие табличные значения параметры можно использовать в изменениях данных на основе наборов, которые влияют на несколько строк, выполняя одну инструкцию. Например, можно выбрать все строки в возвращающем табличное значение параметр и вставить их в таблицу базы данных. Кроме того, можно создать инструкцию UPDATE, присоединив возвращающий табличное значение параметр к таблице, которую необходимо обновить.  
  
Следующая инструкция Transact-SQL UPDATE показывает, как использовать возвращающий табличное значение параметр, присоединяя его к таблице Categories. При использовании возвращающего табличное значение параметра с СОЕДИНЕНИЕм в предложении FROM необходимо также присвоить ему псевдоним, как показано здесь, где параметр с табличным значением имеет псевдоним "EC":  

```sql
UPDATE dbo.Categories  
    SET Categories.CategoryName = ec.CategoryName  
    FROM dbo.Categories INNER JOIN @tvpEditedCategories AS ec  
    ON dbo.Categories.CategoryID = ec.CategoryID;  
```

В этом примере на языке Transact-SQL показано, как выбрать строки из возвращающего табличное значение параметра для выполнения вставки в одной операции на основе набора.

```sql
INSERT INTO dbo.Categories (CategoryID, CategoryName)  
    SELECT nc.CategoryID, nc.CategoryName FROM @tvpNewCategories AS nc;  
```

## <a name="limitations-of-table-valued-parameters"></a>Ограничения возвращающих табличное значение параметров

Существует несколько ограничений для возвращающих табличное значение параметров.  
  
- Невозможно передать возвращающие табличное значение параметры в определяемые пользователем функции.  
  
- Возвращающие табличные значения параметры могут индексироваться только для поддержки ограничений UNIQUE или PRIMARY KEY. SQL Server не ведет статистику возвращающих табличные значения параметров.  
  
- Возвращающие табличные значения параметры доступны только для чтения в коде Transact-SQL. Нельзя обновить значения столбцов в строках возвращающего табличное значение параметра, а также вставлять или удалять строки. Чтобы изменить данные, передаваемые в хранимую процедуру или параметризованную инструкцию в возвращающем табличное значение параметре, необходимо вставить данные во временную таблицу или в табличную переменную.  
  
- Нельзя использовать инструкции ALTER TABLE для изменения структуры возвращающих табличное значение параметров.

- Большие объекты можно потокировать в возвращающем табличное значение параметре.  
  
## <a name="configuring-a-table-valued-parameter"></a>Настройка параметра, возвращающего табличные значения

Начиная с Microsoft JDBC Driver 6,0 для SQL Server параметры, возвращающие табличное значение, поддерживаются с параметризованной инструкцией или параметризованной хранимой процедурой. Возвращающие табличное значение параметры могут быть заполнены из Склсервердататабле, из результирующего набора или из реализации интерфейса Исклсервердатарекорд, предоставленного пользователем. При задании возвращающего табличное значение параметра для подготовленного запроса необходимо указать имя типа, которое должно совпадать с именем совместимого типа, ранее созданного на сервере.  
  
В следующих двух фрагментах кода показано, как настроить возвращающий табличное значение параметр с помощью SQLServerPreparedStatement и SQLServerCallableStatement для вставки данных. Здесь Саурцетвпобжект может быть Склсервердататабле, результирующим набором или объектом Исклсервердатарекорд. В примерах предполагается, что соединение является активным объектом соединения.  

```java
// Using table-valued parameter with a SQLServerPreparedStatement.  
SQLServerPreparedStatement pStmt =
    (SQLServerPreparedStatement) connection.prepareStatement("INSERT INTO dbo.Categories SELECT * FROM ?");  
pStmt.setStructured(1, "dbo.CategoryTableType", sourceTVPObject);  
pStmt.execute();  
```

```java
// Using table-valued parameter with a SQLServerCallableStatement.  
SQLServerCallableStatement pStmt =
    (SQLServerCallableStatement) connection.prepareCall("exec usp_InsertCategories ?");
pStmt.setStructured(1, "dbo.CategoryTableType", sourceTVPObject);;  
pStmt.execute();  
```

> [!NOTE]  
> Полный список интерфейсов API, доступных для настройки возвращающего табличное значение параметра, см. в разделе API возвращающего табличное **значение параметра для драйвера JDBC** ниже.  
  
## <a name="passing-a-table-valued-parameter-as-a-sqlserverdatatable-object"></a>Передача возвращающего табличное значение параметра в виде объекта Склсервердататабле  

Начиная с Microsoft JDBC Driver 6,0 для SQL Server класс Склсервердататабле представляет таблицу реляционных данных в памяти. В этом примере показано, как создать возвращающий табличное значение параметр из данных в памяти с помощью объекта Склсервердататабле. Код сначала создает объект Склсервердататабле, определяет его схему и заполняет таблицу данными. Затем код настраивает SQLServerPreparedStatement, который передает эту таблицу данных в качестве возвращающего табличное значение параметра для SQL Server.  

```java
/* Assumes connection is an active Connection object. */

// Create an in-memory data table.  
SQLServerDataTable sourceDataTable = new SQLServerDataTable();
  
// Define metadata for the data table.  
sourceDataTable.addColumnMetadata("CategoryID" ,java.sql.Types.INTEGER);
sourceDataTable.addColumnMetadata("CategoryName" ,java.sql.Types.NVARCHAR);
  
// Populate the data table.  
sourceDataTable.addRow(1, "CategoryNameValue1");
sourceDataTable.addRow(2, "CategoryNameValue2");
  
// Pass the data table as a table-valued parameter using a prepared statement.  
SQLServerPreparedStatement pStmt =
        (SQLServerPreparedStatement) connection.prepareStatement(  
            "INSERT INTO dbo.Categories SELECT * FROM ?;");  
pStmt.setStructured(1, "dbo.CategoryTableType", sourceDataTable);  
pStmt.execute();  
```

> [!NOTE]  
> Полный список интерфейсов API, доступных для настройки возвращающего табличное значение параметра, см. в разделе API возвращающего табличное **значение параметра для драйвера JDBC** ниже.  
  
## <a name="passing-a-table-valued-parameter-as-a-resultset-object"></a>Передача возвращающего табличное значение параметра в виде объекта ResultSet  

В этом примере демонстрируется потоковая передача строк данных из результирующего набора в возвращающий табличное значение параметр. Код сначала извлекает данные из исходной таблицы в, создает объект Склсервердататабле, определяет его схему и заполняет таблицу данными. Затем код настраивает SQLServerPreparedStatement, который передает эту таблицу данных в качестве возвращающего табличное значение параметра для SQL Server.  

```java
/* Assumes connection is an active Connection object. */

// Create the source ResultSet object. Here SourceCategories is a table defined with the same schema as Categories table.
ResultSet sourceResultSet = connection.createStatement().executeQuery("SELECT * FROM SourceCategories");  

// Pass the source result set as a table-valued parameter using a prepared statement.  
SQLServerPreparedStatement pStmt =
        (SQLServerPreparedStatement) connection.prepareStatement(  
                "INSERT INTO dbo.Categories SELECT * FROM ?;");  
pStmt.setStructured(1, "dbo.CategoryTableType", sourceResultSet);  
pStmt.execute();  
```

> [!NOTE]  
> Полный список интерфейсов API, доступных для настройки возвращающего табличное значение параметра, см. в разделе API возвращающего табличное **значение параметра для драйвера JDBC** ниже.  

## <a name="passing-a-table-valued-parameter-as-an-isqlserverdatarecord-object"></a>Передача возвращающего табличное значение параметра в виде объекта Исклсервердатарекорд  

Начиная с Microsoft JDBC Driver 6,0 для SQL Server доступен новый интерфейс Исклсервердатарекорд для потоковой передачи данных (в зависимости от того, как пользователь предоставляет реализацию) с помощью возвращающего табличное значение параметра. В следующем примере показано, как реализовать интерфейс Исклсервердатарекорд и как передать его в качестве возвращающего табличное значение параметра. Для простоты в следующем примере в возвращающий табличное значение параметр передается только одна строка с жестко заданными значениями. В идеале пользователь будет реализовывать этот интерфейс для потоковой передачи строк из любого источника, например из текстовых файлов.  

```java
class MyRecords implements ISQLServerDataRecord  
{  
    int currentRow = 0;  
    Object[] row = new Object[2];  
  
    MyRecords(){  
        // Constructor. This implementation has just one row.
        row[0] = new Integer(1);  
        row[1] = "categoryName1";  
    }  
  
    public int getColumnCount(){  
        // Return the total number of columns, for this example it is 2.  
        return 2;  
    }  
  
    public SQLServerMetaData getColumnMetaData(int columnIndex) {  
        // Return the column metadata.  
        if (1 == columnIndex)  
            return new SQLServerMetaData("CategoryID", java.sql.Types.INTEGER);  
        else  
            return new SQLServerMetaData("CategoryName", java.sql.Types.NVARCHAR);  
    }  
  
    public Object[] getRowData(){  
        // Return the columns in the current row as an array of objects. This implementation has just one row.  
        return row;
    }  
  
    public boolean next(){  
        // Move to the next row. This implementation has just one row, after processing the first row, return false.  
        currentRow++;  
        if (1 == currentRow)  
            return true;  
        else  
            return false;  
    }
}

// Following code demonstrates how to pass MyRecords object as a table-valued parameter.  
MyRecords sourceRecords = new MyRecords();  
SQLServerPreparedStatement pStmt =
        (SQLServerPreparedStatement) connection.prepareStatement(  
                "INSERT INTO dbo.Categories SELECT * FROM ?;");  
pStmt.setStructured(1, "dbo.CategoryTableType", sourceRecords);  
pStmt.execute();  
```

> [!NOTE]  
> Полный список интерфейсов API, доступных для настройки возвращающего табличное значение параметра, см. в разделе API возвращающего табличное **значение параметра для драйвера JDBC** ниже.

## <a name="table-valued-parameter-api-for-the-jdbc-driver"></a>API возвращающего табличное значение параметра для драйвера JDBC

### <a name="sqlservermetadata"></a>склсерверметадата

Этот класс представляет метаданные для столбца. Он используется в интерфейсе Исклсервердатарекорд для передачи метаданных столбца в возвращающий табличное значение параметр. В этом классе используются следующие методы.  

| Имя                                                                                                                                                                             | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| открытые Склсерверметадата (String columnName, int sqlType, точность int, int Scale, Boolean Усесервердефаулт, Boolean Исуникуекэй, Склсерверсортордер sortOrder, int Сортординал) | Инициализирует новый экземпляр Склсерверметадата с указанным именем столбца, типом SQL, точностью, масштабом и сервером по умолчанию. Эта форма конструктора поддерживает возвращающие табличное значение параметры, позволяя указать, является ли столбец уникальным в возвращающем табличное значение параметре, порядок сортировки столбца и порядковый номер столбца сортировки. <br/><br/>Усесервердефаулт — указывает, должен ли в этом столбце использоваться значение сервера по умолчанию. Значение по умолчанию — false.<br>Исуникуекэй — указывает, является ли столбец в возвращающем табличное значение параметр уникальным; Значение по умолчанию — false.<br>sortOrder — указывает порядок сортировки для столбца; Значение по умолчанию — Склсерверсортордер. не указано.<br>Сортординал — указывает порядковый номер столбца сортировки; Сортординал начинается с 0; Значение по умолчанию —-1. |
| Public Склсерверметадата (строка columnName, int sqlType)                                                                                                                        | Инициализирует новый экземпляр Склсерверметадата, используя имя столбца и тип SQL.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Public Склсерверметадата (строка columnName, int sqlType, длина int)                                                                                                                        | Инициализирует новый экземпляр Склсерверметадата, используя имя столбца, тип SQL и длину (для строковых данных). Длина используется для различения больших строк из строк длиной менее 4000 символов. Представлено в версии 7,2 драйвера JDBC.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| открытая Склсерверметадата (String columnName, int sqlType, точность int, int Scale)                                                                                              | Инициализирует новый экземпляр Склсерверметадата, используя имя столбца, тип SQL, точность и масштаб.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Общедоступная Склсерверметадата (Склсерверметадата Склсерверметадата)                                                                                                                    | Инициализирует новый экземпляр класса Склсерверметадата из другого объекта Склсерверметадата.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| public String getColumName()                                                                                                                                                     | Возвращает имя столбца.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Открытый целочисленный Жетсклтипе ()                                                                                                                                                          | Извлекает тип Java SQL.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| открытая int-точность ()                                                                                                                                                        | Возвращает точность типа, переданного в столбец.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| открытая int-Scale ()                                                                                                                                                            | Возвращает масштаб типа, переданного в столбец.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| общедоступная Склсерверсортордер Жетсортордер ()                                                                                                                                         | Извлекает порядок сортировки.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Открытый целочисленный Жетсортординал ()                                                                                                                                                      | Возвращает порядковый номер сортировки.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Public Boolean Исуникуекэй ()                                                                                                                                                     | Возвращает значение, указывающее, является ли столбец уникальным.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Public Boolean Усесервердефаулт ()                                                                                                                                                | Возвращает, использует ли столбец значение сервера по умолчанию.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
  
### <a name="sqlserversortorder"></a>склсерверсортордер

Перечисление, определяющее порядок сортировки. Возможные значения: по возрастанию, по убыванию и не указаны.
  
### <a name="sqlserverdatatable"></a>склсервердататабле

Этот класс представляет таблицу данных в памяти для использования с параметрами, возвращающими табличное значение. В этом классе используются следующие методы.  

| Имя                                                          | Описание                                          |
| ------------------------------------------------------------- | ---------------------------------------------------- |
| Public SQLServerDataTable()                                   | Инициализирует новый экземпляр Склсервердататабле.    |
| Открытый итератор < запись\<целого числа, Object [] > >-iterator ()      | Извлекает итератор по строкам таблицы данных. |
| Public void Аддколумнметадата (строка columnName, int sqlType) | Добавляет метаданные для указанного столбца.              |
| Public void Аддколумнметадата (столбец Склсервердатаколумн)     | Добавляет метаданные для указанного столбца.              |
| Public void addRow (объект... данные                          | Добавляет одну строку данных в таблицу данных.              |
| общедоступная схема\<Integer, склсервердатаколумн > жетколумнметадата () | Получает метаданные столбца этой таблицы данных.       |
| Открытый Void Clear ()                                           | Очищает эту таблицу данных.                              |

### <a name="sqlserverdatacolumn"></a>склсервердатаколумн

Этот класс представляет столбец таблицы данных в памяти, представленной Склсервердататабле. В этом классе используются следующие методы.  

| Имя                                                       | Описание                                                                      |
| ---------------------------------------------------------- | -------------------------------------------------------------------------------- |
| Public Склсервердатаколумн (строка columnName, int sqlType) | Инициализирует новый экземпляр Склсервердатаколумн с именем и типом столбца. |
| public String getColumnName()                              | Возвращает имя столбца.                                                       |
| Открытый целочисленный Жетколумнтипе ()                                 | Возвращает тип столбца.                                                       |

### <a name="isqlserverdatarecord"></a>исклсервердатарекорд

Этот класс представляет интерфейс, который пользователи могут реализовать для потоковой передачи данных в возвращающий табличное значение параметр. В этом интерфейсе используются следующие методы.  
  
| Имя                                                    | Описание                                                                                             |
| ------------------------------------------------------- | ------------------------------------------------------------------------------------------------------- |
| Public Склсерверметадата Жетколумнметадата (столбец типа int); | Извлекает метаданные столбца заданного индекса столбца.                                               |
| public int getColumnCount();                            | Возвращает общее число столбцов.                                                                  |
| public Object[] getRowData();                           | Получает данные для текущей строки как массив объектов.                                          |
| Общее логическое значение Next ();                                  | Переходит к следующей строке. Возвращает значение true, если перемещение выполнено успешно и имеется следующая строка, в противном случае — значение false. |

### <a name="sqlserverpreparedstatement"></a>SQLServerPreparedStatement

Следующие методы были добавлены в этот класс для поддержки передачи возвращающих табличное значение параметров.  

| Имя                                                                                                    | Описание                                                                                                                                                                                                                                                                                                |
| ------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| открытая окончательная void Сетструктуред (int parameterIndex, String Твпнаме, Склсервердататабле Твпдататабле)    | Заполняет возвращающий табличное значение параметр таблицей данных. parameterIndex — это индекс параметра, Твпнаме — это имя возвращающего табличное значение параметра, а Твпдататабле — объект таблицы исходных данных.                                                                                                          |
| открытая окончательная void Сетструктуред (int parameterIndex, String Твпнаме, ResultSet Твпресултсет)             | Заполняет возвращающий табличное значение параметр ResultSet, полученным из другой таблицы. parameterIndex является индексом параметра, Твпнаме — именем возвращающего табличное значение параметра, а Твпресултсет — исходным результирующим объектом.                                                                               |
| открытая окончательная void Сетструктуред (int parameterIndex, String Твпнаме, Исклсервердатарекорд Твпдатарекорд) | Заполняет возвращающий табличное значение параметр объектом Исклсервердатарекорд. Исклсервердатарекорд используется для потоковой передачи данных, и пользователь решает, как его использовать. parameterIndex — это индекс параметра, Твпнаме — это имя возвращающего табличное значение параметра, а Твпдатарекорд — объект Исклсервердатарекорд. |
  
### <a name="sqlservercallablestatement"></a>SQLServerCallableStatement

Следующие методы были добавлены в этот класс для поддержки передачи возвращающих табличное значение параметров.  
  
| Имя                                                                                                        | Описание                                                                                                                                                                                                                                                                                                                      |
| ----------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| открытая окончательная void Сетструктуред (строка Паратеметернаме, строка Твпнаме, Склсервердататабле Твпдататабле)    | Заполняет возвращающий табличное значение параметр, передаваемый хранимой процедуре с таблицей данных. Паратеметернаме — имя параметра, Твпнаме — имя типа TVP, а Твпдататабле — объект таблицы данных.                                                                                                                 |
| открытая окончательная void Сетструктуред (строка Паратеметернаме, строка Твпнаме, ResultSet Твпресултсет)             | Заполняет возвращающий табличное значение параметр, передаваемый хранимой процедуре, с результирующим набором, полученным из другой таблицы. Паратеметернаме — имя параметра, Твпнаме — имя типа TVP, а Твпресултсет — исходный объект результирующего набора.                                                                              |
| открытая окончательная void Сетструктуред (строка Паратеметернаме, строка Твпнаме, Исклсервердатарекорд Твпдатарекорд) | Заполняет возвращающий табличное значение параметр, передаваемый хранимой процедуре с помощью объекта Исклсервердатарекорд. Исклсервердатарекорд используется для потоковой передачи данных, и пользователь решает, как его использовать. Паратеметернаме — это имя параметра, Твпнаме — имя типа TVP, а Твпдатарекорд — объект Исклсервердатарекорд. |

## <a name="see-also"></a>См. также раздел

[Общие сведения о JDBC Driver](../../connect/jdbc/overview-of-the-jdbc-driver.md)  
