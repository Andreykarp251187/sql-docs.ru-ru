---
title: Соединение с помощью программы sqlcmd | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- sqlcmd
ms.assetid: 61a2ec0d-1bcb-4231-bea0-cff866c21463
author: MightyPen
ms.author: genemi
manager: jroth
ms.openlocfilehash: 48e4771b8d538775ae2e2faec053f0263bd6d653
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MTE75
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "66789885"
---
# <a name="connecting-with-sqlcmd"></a>Соединение с помощью sqlcmd
[!INCLUDE[Driver_ODBC_Download](../../../includes/driver_odbc_download.md)]

Служебная программа [sqlcmd](https://go.microsoft.com/fwlink/?LinkID=154481) доступна в [!INCLUDE[msCoName](../../../includes/msconame_md.md)] ODBC Driver for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] на Linux и macOS.
  
Следующие команды демонстрируют использование проверки подлинности Windows (Kerberos) и [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] проверки подлинности, соответственно:
  
```  
sqlcmd -E -Sxxx.xxx.xxx.xxx  
sqlcmd -Sxxx.xxx.xxx.xxx -Uxxx -Pxxx  
```  
  
## <a name="available-options"></a>Доступные параметры

В текущем выпуске доступны следующие параметры:  
  
- -? Отображение `sqlcmd` использования.  
  
- -а — запросить размер пакета.  
  
- -b — завершить пакетное задание в случае ошибки.  
  
- -c *batch_terminator* указать признак конца пакета.  
  
- -C — доверять сертификату сервера.  

- -d *имя_базы_данных* проблема `USE` *имя_базы_данных* инструкции при запуске `sqlcmd`.  

- -D — интерпретировать значение, передаваемое параметру `sqlcmd` -S, как имя источника данных (DSN). Дополнительные сведения см. в разделе "Поддержка имени DSN в `sqlcmd` и `bcp`" в конце этой статьи.  
  
- -e — выводить входные скрипты на стандартное устройство вывода (stdout).

- Использует доверительное соединение, встроенную проверку подлинности. Дополнительные сведения о создании доверительных соединений, использующих встроенную проверку подлинности из клиента Linux или macOS, см. в разделе [с помощью встроенной проверки подлинности](../../../connect/odbc/linux-mac/using-integrated-authentication.md).

- -h *число_строк* — задать число строк, печатаемое между заголовками столбцов.  
  
- -H — указать имя рабочей станции.  
  
- -i *файл_ввода*[,*файл_ввода*[,…]] — указать файл, содержащий пакет инструкций или хранимых процедур SQL.  
  
- -I Set `SET QUOTED_IDENTIFIER` параметр соединения в значение ON.  
  
- -k — удалить или заменить символы управления.  
  
- **-K**_приложения\_намерение_  
Объявляет тип рабочей нагрузки приложения при соединении с сервером. Единственным поддерживаемым в данное время значением является **ReadOnly**. Если параметр **-K** не указан, `sqlcmd` не поддерживает подключение ко вторичной реплике в группе доступности AlwaysOn. См. подробнее об [обеспечении высокой доступности и аварийного восстановления с помощью драйвера ODBC для Linux и macOS](../../../connect/odbc/linux-mac/odbc-driver-on-linux-support-for-high-availability-disaster-recovery.md).  
  
> [!NOTE]  
> Параметр **-K** не поддерживается в CTP-версии для SUSE Linux. Однако вы можете указать ключевое слово **ApplicationIntent=ReadOnly** в файле DSN, передаваемом в `sqlcmd`. Дополнительные сведения см. в разделе "Поддержка имени DSN в `sqlcmd` и `bcp`" в конце этой статьи.  
  
- Параметр -l *timeout* задает время ожидания (в секундах) для входа в `sqlcmd` при попытке соединения с сервером.

- -m *уровень_ошибки* — выбрать сообщения об ошибках, отправляемые на stdout.  
  
- **-M**_нескольким подсетям\_отработки отказа_  
Всегда указывайте параметр **-M** при соединении с прослушивателем группы доступности [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] или экземпляром отказоустойчивого кластера [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)]. **-M** позволяет ускорить обнаружение обработок отказа и подключение к активному (в данный момент) серверу. Если параметр **-M** не указан, значит **-M** отключен. Дополнительные сведения о [!INCLUDE[ssHADR](../../../includes/sshadr_md.md)], см. в разделе [драйвер ODBC для Linux и macOS — высокий уровень доступности и аварийного восстановления](../../../connect/odbc/linux-mac/odbc-driver-on-linux-support-for-high-availability-disaster-recovery.md).  
  
> [!NOTE]  
> Параметр **-M** не поддерживается в CTP-версии для SUSE Linux. Однако вы можете указать ключевое слово **MultiSubnetFailover=Yes** в файле DSN, передаваемом в `sqlcmd`. Дополнительные сведения см. в разделе "Поддержка имени DSN в `sqlcmd` и `bcp`" в конце этой статьи.  
  
- -N — шифровать соединение.  
  
- -o *файл_вывода* — указать файл, получающий выходные данные от `sqlcmd`.  
  
- -p — напечатать статистику производительности для каждого результирующего набора.  
  
- -P — указать пароль пользователя.  
  
- -q *commandline_query* выполнение запроса при `sqlcmd` начинается, но не завершает работу при завершении его выполнения.  

- -Q *commandline_query* выполнение запроса при `sqlcmd` начинается. `sqlcmd` завершает работу после выполнения запроса.  

- -r — перенаправлять сообщения об ошибках на stderr.

- -R — преобразовывать дату, время и валюту в символьные данные в соответствии с настройками региона клиента. В настоящее время используется только форматирование en_US (Английский (США)).
  
- -s *column_separator_char* укажите знак-разделитель столбцов.  

- -S [*протокол*:] *сервер*[ **,** _порт_]  
Укажите экземпляр [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] подключения, либо если -D используется, имя источника данных. Драйвер ODBC для Linux и macOS требует -S. Обратите внимание, что **tcp** является единственным допустимым протоколом.  
  
- -t *время_ожидания_запроса* — указать время ожидания команды (или инструкции SQL) в секундах.  
  
- -u — указать, что <файл_вывода> хранится в формате Юникода вне зависимости от формата <файла_ввода>.  
  
- -U *login_id* укажите идентификатор имени входа пользователя.  
  
- -V *уровень_серьезности_ошибки* — задать уровень серьезности, используемый для переменной ERRORLEVEL.  
  
- -w *column_width* указать ширину экрана для вывода.  
  
- -W — удалить в столбце конечные пробелы.  
  
- -x — отключить подстановку переменных.  
  
- -X — отключить команды, сценарий запуска и переменные сред.  
  
- -y *variable_length_type_display_width* задать `sqlcmd` переменной скрипта `SQLCMDMAXFIXEDTYPEWIDTH`.
  
- -Y *fixed_length_type_display_width* задать `sqlcmd` переменной скрипта `SQLCMDMAXVARTYPEWIDTH`.


## <a name="available-commands"></a>Доступные команды

В текущем выпуске доступны следующие команды:  
  
-   [:]!!  
  
-   :Connect  
  
-   :Error  
  
-   [:]EXIT  
  
-   GO [*число*]  
  
-   :Help  
  
-   :List  
  
-   :Listvar  
  
-   :On Error  
  
-   :Out  
  
-   :Perftrace  
  
-   [:]QUIT  
  
-   :r  
  
-   :RESET  
  
-   :setvar  
  
## <a name="unavailable-options"></a>Недоступные параметры
В текущем выпуске следующие параметры недоступны:  

- -A — войти в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] с выделенным административным соединением. Сведения об использовании выделенного административного соединения см. в разделе [Указания по программированию](../../../connect/odbc/linux-mac/programming-guidelines.md).  
  
- -f *кодовая_страница* — задать кодовые страницы ввода и вывода.  
  
- -L — вывести список серверных компьютеров, настроенных локально, и имена серверных компьютеров, передающих данные в сеть.  
  
- -v — создать переменную скрипта `sqlcmd`, которую можно использовать в сценарии `sqlcmd`.  
  
Можно использовать следующий альтернативный метод: Поместите параметры в одном файле, который затем можно добавить в другой файл. Это позволит использовать файл параметров для замены значений. Например, создайте файл с именем `a.sql` (файл параметров) со следующим содержимым:
  
    :setvar ColumnName object_id  
    :setvar TableName sys.objects  
  
Затем создайте файл `b.sql` с параметрами для замены:  
  
    select $(ColumnName) from $(TableName)  

В командной строке, объединить `a.sql` и `b.sql` в `c.sql` с помощью следующих команд:  
  
    cat a.sql > c.sql 
  
    cat b.sql >> c.sql  
  
Запустите `sqlcmd` и использовать `c.sql` как входной файл:  
  
    slqcmd -S<...> -P<..> -U<..> -I c.sql  

- -z *пароль* изменить пароль.  
  
- -Z *пароль* сменить пароль и выйти.  

## <a name="unavailable-commands"></a>Недоступные команды

В текущем выпуске следующие команды недоступны:  
  
-   :ED  
  
-   :ServerList  
  
-   :XML  
  
## <a name="dsn-support-in-sqlcmd-and-bcp"></a>Поддержка имени DSN в sqlcmd и bcp

Вы можете указать имя источника данных (DSN) вместо имени сервера в **sqlcmd** или параметре **bcp** `-S` (или в команде **sqlcmd** :Connect), если зададите параметр -D. -D вызывает **sqlcmd** или **bcp** для подключения к серверу, указанному в имени DSN с помощью параметра -S.  
  
Системные имена DSN хранятся в `odbc.ini` файл в каталоге ODBC SysConfigDir (`/etc/odbc.ini` в стандартных установках). Пользовательские имена DSN хранятся в `.odbc.ini` в домашнем каталоге пользователя (`~/.odbc.ini`).
  
В имени DSN на Linux и macOS поддерживаются следующие записи:

-   **ApplicationIntent=ReadOnly**  

-   **Базы данных =** _базы данных\_имя_  
  
-   **Драйвер = ODBC Driver 11 для SQL Server** или **драйвер = драйвер ODBC 13 для SQL Server**
  
-   **MultiSubnetFailover=Yes**  
  
-   **Server =** _server\_имя\_или\_IP-адрес\_адрес_  
  
-   **Trusted_Connection=yes**|**no**  
  
В имени DSN только запись DRIVER является обязательной, но, чтобы подключиться к серверу, `sqlcmd` или `bcp` требуется значение в записи SERVER.  

Если указать один и тот же параметр и в имени DSN, и в командной строке `sqlcmd` или `bcp`, значение в командной строке имеет приоритет перед значением DSN. Например, если имя DSN содержит запись DATABASE, а командная строка `sqlcmd` включает параметр **-d**, используется значение, передаваемое в **-d**. Если в имени DSN указано **Trusted_Connection=yes**, используется проверка подлинности Kerberos, а имя пользователя ( **–U**) и пароль ( **–P**), если они заданы, игнорируются.

Существующие сценарии, вызывающие `isql`, можно изменить для использования `sqlcmd`, определив следующий псевдоним: `alias isql="sqlcmd -D"`.  

## <a name="see-also"></a>См. также:  
[Подключение с помощью **bcp**](../../../connect/odbc/linux-mac/connecting-with-bcp.md)  
 
