---
title: Подключение с помощью sqlcmd | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- sqlcmd
ms.assetid: 61a2ec0d-1bcb-4231-bea0-cff866c21463
author: MightyPen
ms.author: genemi
ms.openlocfilehash: a782db89033da42ebf17ed33565ec680fafa0d04
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MTE75
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "68005909"
---
# <a name="connecting-with-sqlcmd"></a>Соединение с помощью sqlcmd
[!INCLUDE[Driver_ODBC_Download](../../../includes/driver_odbc_download.md)]

Служебная программа [sqlcmd](https://go.microsoft.com/fwlink/?LinkID=154481) доступна в [!INCLUDE[msCoName](../../../includes/msconame_md.md)] ODBC Driver for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] на Linux и macOS.
  
Следующие команды показывают, как использовать проверку подлинности Windows (Kerberos [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ) и проверку подлинности соответственно:
  
```  
sqlcmd -E -Sxxx.xxx.xxx.xxx  
sqlcmd -Sxxx.xxx.xxx.xxx -Uxxx -Pxxx  
```  
  
## <a name="available-options"></a>Доступные параметры

В текущем выпуске доступны следующие параметры:  
  
- -? Отображение `sqlcmd` сведений об использовании.  
  
- -а — запросить размер пакета.  
  
- -b — завершить пакетное задание в случае ошибки.  
  
- -c *batch_terminator* укажите признак конца пакета.  
  
- -C — доверять сертификату сервера.  

- -d *имя_базы_данных* — `USE` выдача инструкции *database_name* при запуске `sqlcmd`.  

- -D — интерпретировать значение, передаваемое параметру `sqlcmd` -S, как имя источника данных (DSN). Дополнительные сведения см. в разделе "Поддержка имени DSN в `sqlcmd` и `bcp`" в конце этой статьи.  
  
- -e — выводить входные скрипты на стандартное устройство вывода (stdout).

- Использует доверительное соединение, встроенную проверку подлинности. Дополнительные сведения о создании доверенных подключений, использующих встроенную проверку подлинности для клиента Linux или macOS, см. в разделе [использование встроенной проверки](../../../connect/odbc/linux-mac/using-integrated-authentication.md)подлинности.

- -h *число_строк* — задать число строк, печатаемое между заголовками столбцов.  
  
- -H — указать имя рабочей станции.  
  
- -i *файл_ввода*[,*файл_ввода*[,…]] — указать файл, содержащий пакет инструкций или хранимых процедур SQL.  
  
- -Я установил `SET QUOTED_IDENTIFIER` параметр подключения в значение Вкл.  
  
- -k — удалить или заменить символы управления.  
  
- **-K** _назначение\_приложения_  
Объявляет тип рабочей нагрузки приложения при соединении с сервером. Единственным поддерживаемым в данное время значением является **ReadOnly**. Если параметр **-K** не указан, `sqlcmd` не поддерживает подключение ко вторичной реплике в группе доступности AlwaysOn. См. подробнее об [обеспечении высокой доступности и аварийного восстановления с помощью драйвера ODBC для Linux и macOS](../../../connect/odbc/linux-mac/odbc-driver-on-linux-support-for-high-availability-disaster-recovery.md).  
  
> [!NOTE]  
> Параметр **-K** не поддерживается в CTP-версии для SUSE Linux. Однако вы можете указать ключевое слово **ApplicationIntent=ReadOnly** в файле DSN, передаваемом в `sqlcmd`. Дополнительные сведения см. в разделе "Поддержка имени DSN в `sqlcmd` и `bcp`" в конце этой статьи.  
  
- Параметр -l *timeout* задает время ожидания (в секундах) для входа в `sqlcmd` при попытке соединения с сервером.

- -m *уровень_ошибки* — выбрать сообщения об ошибках, отправляемые на stdout.  
  
- **-M** _отказоустойчивая\_подсеть_  
Всегда указывайте параметр **-M** при соединении с прослушивателем группы доступности [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)] или экземпляром отказоустойчивого кластера [!INCLUDE[ssSQL11](../../../includes/sssql11-md.md)]. **-M** позволяет ускорить обнаружение обработок отказа и подключение к активному (в данный момент) серверу. Если параметр **-M** не указан, значит **-M** отключен. См. подробнее об [!INCLUDE[ssHADR](../../../includes/sshadr_md.md)] в руководстве по [обеспечению высокого уровня доступности и аварийного восстановления с помощью драйвера ODBC для Linux и macOS](../../../connect/odbc/linux-mac/odbc-driver-on-linux-support-for-high-availability-disaster-recovery.md).  
  
> [!NOTE]  
> Параметр **-M** не поддерживается в CTP-версии для SUSE Linux. Однако вы можете указать ключевое слово **MultiSubnetFailover=Yes** в файле DSN, передаваемом в `sqlcmd`. Дополнительные сведения см. в разделе "Поддержка имени DSN в `sqlcmd` и `bcp`" в конце этой статьи.  
  
- -N — шифровать соединение.  
  
- -o *файл_вывода* — указать файл, получающий выходные данные от `sqlcmd`.  
  
- -p — напечатать статистику производительности для каждого результирующего набора.  
  
- -P — указать пароль пользователя.  
  
- -q *commandline_query* выполняет запрос при `sqlcmd` запуске, но не завершает работу после завершения выполнения запроса.  

- -Q *commandline_query* . выполнение запроса при `sqlcmd` запуске. `sqlcmd` завершает работу после выполнения запроса.  

- -r — перенаправлять сообщения об ошибках на stderr.

- -R — преобразовывать дату, время и валюту в символьные данные в соответствии с настройками региона клиента. В настоящее время используется только форматирование en_US (Английский (США)).
  
- -s *column_separator_char* задает символ-разделитель столбцов.  

- -S [*протокол*:] *сервер*[ **,** _порт_]  
Укажите экземпляр [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] для соединения с или, если используется параметр-D, имя DSN. Для драйвера ODBC в Linux и macOS требуется-S. Обратите внимание, что единственным допустимым протоколом является **TCP** .  
  
- -t *время_ожидания_запроса* — указать время ожидания команды (или инструкции SQL) в секундах.  
  
- -u — указать, что <файл_вывода> хранится в формате Юникода вне зависимости от формата <файла_ввода>.  
  
- -U *login_ID* укажите идентификатор входа пользователя.  
  
- -V *уровень_серьезности_ошибки* — задать уровень серьезности, используемый для переменной ERRORLEVEL.  
  
- -w *column_width* задает ширину экрана для выходных данных.  
  
- -W — удалить в столбце конечные пробелы.  
  
- -x — отключить подстановку переменных.  
  
- -X — отключить команды, сценарий запуска и переменные сред.  
  
- -y *variable_length_type_display_width* задает `sqlcmd` переменную `SQLCMDMAXFIXEDTYPEWIDTH`скрипта.
  
- -Y *fixed_length_type_display_width* задает `sqlcmd` переменную `SQLCMDMAXVARTYPEWIDTH`скрипта.


## <a name="available-commands"></a>Доступные команды

В текущем выпуске доступны следующие команды:  
  
-   [:]!!  
  
-   :Connect  
  
-   :Error  
  
-   [:]EXIT  
  
-   GO [*число*]  
  
-   :Help  
  
-   :List  
  
-   :Listvar  
  
-   :On Error  
  
-   :Out  
  
-   :Perftrace  
  
-   [:]QUIT  
  
-   :r  
  
-   :RESET  
  
-   :setvar  
  
## <a name="unavailable-options"></a>Недоступные параметры
В текущем выпуске следующие параметры недоступны:  

- -A — войти в [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] с выделенным административным соединением. Сведения об использовании выделенного административного соединения см. в разделе [Указания по программированию](../../../connect/odbc/linux-mac/programming-guidelines.md).  
  
- -f *кодовая_страница* — задать кодовые страницы ввода и вывода.  
  
- -L — вывести список серверных компьютеров, настроенных локально, и имена серверных компьютеров, передающих данные в сеть.  
  
- -v — создать переменную скрипта `sqlcmd`, которую можно использовать в сценарии `sqlcmd`.  
  
Можно использовать следующий альтернативный метод: разместить параметры внутри одного файла, который затем можно добавить в другой файл. Это позволит использовать файл параметров для замены значений. Например, создайте файл с именем `a.sql` (файл параметров) со следующим содержимым:
  
    :setvar ColumnName object_id  
    :setvar TableName sys.objects  
  
Затем создайте файл `b.sql` с параметрами для замены:  
  
    select $(ColumnName) from $(TableName)  

В командной строке объедините `a.sql` `c.sql` и `b.sql` используйте следующие команды:  
  
    cat a.sql > c.sql 
  
    cat b.sql >> c.sql  
  
Запуск `sqlcmd` и использование `c.sql` в качестве входного файла:  
  
    slqcmd -S<...> -P<..> -U<..> -I c.sql  

- -z пароль смены *пароля* .  
  
- -Z пароль смены *пароля* и выход.  

## <a name="unavailable-commands"></a>Недоступные команды

В текущем выпуске следующие команды недоступны:  
  
-   :ED  
  
-   :ServerList  
  
-   :XML  
  
## <a name="dsn-support-in-sqlcmd-and-bcp"></a>Поддержка имени DSN в sqlcmd и bcp

Вы можете указать имя источника данных (DSN) вместо имени сервера в **sqlcmd** или параметре **bcp** `-S` (или в команде **sqlcmd** :Connect), если зададите параметр -D. -D заставляет **sqlcmd** или **bcp** подключаться к серверу, указанному в имени DSN, с помощью параметра-S.  
  
Системные имена DSN хранятся в `odbc.ini` файле в каталоге ODBC сисконфигдир (`/etc/odbc.ini` при стандартных установках). Пользовательские имена DSN хранятся `.odbc.ini` в домашнем каталоге пользователя (`~/.odbc.ini`).
  
В имени DSN на Linux и macOS поддерживаются следующие записи:

-   **ApplicationIntent=ReadOnly**  

-   **База данных =** _имя\_базы данных_  
  
-   **Драйвер = ODBC Driver 11 для SQL Server** или **Driver = драйвер odbc 13 для SQL Server**
  
-   **MultiSubnetFailover=Yes**  
  
-   **Сервер =** _имя\_или\_IP-адрес\_сервера\__  
  
-   **Trusted_Connection=yes**|**no**  
  
В имени DSN только запись DRIVER является обязательной, но, чтобы подключиться к серверу, `sqlcmd` или `bcp` требуется значение в записи SERVER.  

Если указать один и тот же параметр и в имени DSN, и в командной строке `sqlcmd` или `bcp`, значение в командной строке имеет приоритет перед значением DSN. Например, если имя DSN содержит запись DATABASE, а командная строка `sqlcmd` включает параметр **-d**, используется значение, передаваемое в **-d**. Если в имени DSN указано **Trusted_Connection=yes**, используется проверка подлинности Kerberos, а имя пользователя ( **–U**) и пароль ( **–P**), если они заданы, игнорируются.

Существующие сценарии, вызывающие `isql`, можно изменить для использования `sqlcmd`, определив следующий псевдоним: `alias isql="sqlcmd -D"`.  

## <a name="see-also"></a>См. также:  
[Подключение с помощью **bcp**](../../../connect/odbc/linux-mac/connecting-with-bcp.md)  
 
