---
title: Подключение к источнику данных ODBC (мастер импорта и экспорта SQL Server) | Документы Майкрософт
ms.custom: ''
ms.date: 03/16/2017
ms.prod: sql
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
ms.assetid: e6318776-a188-48a7-995d-9eafd7148ff2
author: chugugrace
ms.author: chugu
ms.openlocfilehash: cd4dbec9e08b19a0c06c991a7007b449dff02485
ms.sourcegitcommit: e8af8cfc0bb51f62a4f0fa794c784f1aed006c71
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/26/2019
ms.locfileid: "71285495"
---
# <a name="connect-to-an-odbc-data-source-sql-server-import-and-export-wizard"></a>Подключение к источнику данных ODBC (мастер импорта и экспорта SQL Server)

[!INCLUDE[ssis-appliesto](../../includes/ssis-appliesto-ssvrpluslinux-asdb-asdw-xxx.md)]


В этом разделе показано, как подключаться к источникам данных **ODBC** со страницы **Выбор источника данных** или **Выбор назначения** в мастере импорта и экспорта SQL Server.

Нужный драйвер ODBC может потребоваться скачать с веб-сайта корпорации Майкрософт или другого разработчика.

Кроме того, вам может потребоваться найти сведений о подключении, которые нужно будет предоставить. На этом стороннем сайте со [справочником по строкам подключения](https://www.connectionstrings.com/) представлены примеры строк подключения и дополнительные сведения о поставщиках данных и используемых ими данных подключений.

## <a name="make-sure-the-driver-you-want-is-installed"></a>Проверка на наличие установленного драйвера
1.  Найдите или выберите приложение **ODBC Data Sources (64-bit)** (Источники данных ODBC (64-разрядное)) в панели управления. Если у вас есть только 32-разрядный драйвер или вы знаете, что вам нужен именно 32-разрядный драйвер, найдите вместо этого приложение **ODBC Data Sources (32-bit)** (Источники данных ODBC (32-разрядное)).
2.  Запустите приложение. Открывается окно **Администратор источников данных ODBC**.
3.  На вкладке **Драйверы** приведен список драйверов ODBC, установленных на вашем компьютере. (Имена некоторых драйверов могут быть указаны на нескольких языках.)

    Ниже приведен пример списка установленных 64-разрядных драйверов.

    ![Установленные 64-разрядные драйверы ODBC](../../integration-services/import-export-data/media/installed-64-bit-odbc-drivers.png)

> [!TIP]
> Если вы знаете, что ваш драйвер установлен, но не видите его в 64-разрядном приложении, перейдите в 32-разрядное приложение. Все это также указывает, какую версию мастера импорта и экспорта SQL Server вам нужно запустить — 64- или 32-разрядную.
>
> Чтобы использовать 64-разрядную версию мастера экспорта и импорта SQL Server, нужно установить SQL Server. SQL Server Data Tools (SSDT) и SQL Server Management Studio (SSMS) являются 32-разрядными приложениями и устанавливают только 32-разрядные файлы, включая 32-разрядную версию мастера.
    
## <a name="step-1---select-the-data-source"></a>Шаг 1. Выбор источника данных
Установленные на компьютере драйверы ODBC не приводятся в раскрывающемся списке источников данных. Чтобы подключиться с помощью драйвера ODBC, сначала выберите **поставщик данных .NET Framework для ODBC** в качестве источника данных на странице **Выбор источника данных** или **Выбор назначения** мастера. Этот поставщик служит оболочкой для драйвера ODBC.

Ниже показан экран, который появляется сразу после выбора поставщика данных .NET Framework для ODBC.

![Подключение к SQL с помощью ODBC ранее](../../integration-services/import-export-data/media/connect-to-sql-with-odbc-before.jpg)

## <a name="step-2---provide-the-connection-info"></a>Шаг 2. Указание сведений о подключении
Следующим шагом является предоставление сведений о подключении для драйвера ODBC и источника данных. Имеются две возможности.
1.  Укажите **DSN** (имя источника данных), который уже существует или был создан вами в приложении **Администратор источников данных ODBC** панели управления. Имя DSN представляет собой коллекцию параметров, необходимых для подключения к источнику данных ODBC.

    Если вы уже знаете имя DSN или сумеете его создать, можете пропустить оставшуюся часть этой страницы. Введите имя DSN в поле **Dsn** на странице **Выбор источника данных** или **Выбор назначения**, а затем перейдите к следующему шагу в мастере.

    [Указание имени DSN](#odbc_dsn)
    
2.  Укажите **строку подключения**, которую можно узнать в сети или создать и протестировать на компьютере с помощью приложения **Администратор источников данных ODBC**.

    Если у вас уже есть строка подключения или вы знаете, как ее создать, можете пропустить оставшуюся часть этой страницы. Введите строку подключения в поле **ConnectionString** на странице **Выбор источника данных** или **Выбор назначения**, а затем перейдите к следующему шагу в мастере.

    [Указание строки подключения](#odbc_connstring)

Если вы указали строку подключения, на странице **Выбор источника данных** или **Выбор назначения** отображаются все сведения о подключении, которые мастер будет использовать для подключения к источнику данных, например имя сервера и базы данных, а также метод проверки подлинности. Если вы указали имя DSN, эта информация не отображается.

## <a name="odbc_dsn"></a> Вариант 1. Указание имени DSN
Если вы хотите предоставить сведения о подключении с помощью имени DSN, используйте приложение **Администратор источников данных ODBC** для поиска существующего или создания нового имени DSN.
1.  Найдите или выберите приложение **ODBC Data Sources (64-bit)** (Источники данных ODBC (64-разрядное)) в панели управления. Если у вас есть только 32-разрядный драйвер или вам нужен именно 32-разрядный драйвер, найдите вместо этого приложение **ODBC Data Sources (32-bit)** (Источники данных ODBC (32-разрядное)).
2.  Запустите приложение. Открывается окно **Администратор источников данных ODBC**. Вот как это приложение выглядит.

    ![Приложение "Администратор источников данных ODBC" на панели управления](../../integration-services/import-export-data/media/odbc-administrator-control-panel-applet.png)
    
3.  Если вы хотите **использовать существующее имя DSN** для источника данных, можете использовать любое имя DSN, отображаемое на вкладке **DSN пользователя**, **DSN системы** или **Файловый DSN**. Проверьте имя, а затем вернитесь в мастер и введите его в поле **Dsn** на странице **Выбор источника данных** или **Выбор назначения**. Пропустите оставшуюся часть этой страницы и перейдите к следующему шагу в мастере.
4.  Если вы хотите **создать имя DSN**, решите, должно ли оно быть видимым только вам ("DSN пользователя"), видимым всем пользователям компьютера, включая службы Windows ("DSN системы") или сохраненным в файле ("Файловый DSN"). Этот пример создает имя DSN системы.
5. На вкладке **DSN системы** нажмите кнопку **Добавить**.

    ![Добавление имени DSN ODBC системы](../../integration-services/import-export-data/media/add-a-new-odbc-system-dsn.png)
    
6.  В диалоговом окне **Создать новый источник данных** выберите драйвер для источника данных, а затем нажмите кнопку **Готово**.

    ![Выбор драйвера для нового имени DSN системы](../../integration-services/import-export-data/media/pick-driver-for-new-system-dsn.png)
    
7. Драйвер теперь отображает один или несколько экранов, где можно ввести сведения, необходимые для подключения к источнику данных. (Например, для драйвера SQL Server доступно четыре страницы настраиваемых параметров.) После завершения операции новое имя DSN системы появляется в списке.

    ![Новое имя DSN системы в списке](../../integration-services/import-export-data/media/new-system-dsn-in-list.png)
    
8.  Вернитесь в мастер и введите имя DSN в поле **Dsn** на странице **Выбор источника данных** или **Выбор назначения**. Перейдите к следующему шагу в мастере.

## <a name="odbc_connstring"></a> Вариант 2. Указание строки подключения
Если вы хотите предоставить сведения о подключении с помощью строки подключения, дочитайте оставшуюся часть раздела до конца.

В этом примере будет использоваться следующая строка подключения, которая подключается к Microsoft SQL Server.

    ```
    Driver={ODBC Driver 13 for SQL Server};server=localhost;database=WideWorldImporters;trusted_connection=Yes;
    ```

Введите строку подключения в поле **ConnectionString** на странице **Выбор источника данных** или **Выбор назначения**. После того как вы введете строку подключения, мастер проанализирует ее и отобразит отдельные свойства и их значения в списке.

Ниже показан экран, который появляется после ввода строки подключения.

![Подключение к SQL с помощью ODBC позднее](../../integration-services/import-export-data/media/connect-to-sql-with-odbc-after.jpg)

> [!NOTE]
> Параметры подключения для этого драйвера ODBC одинаковы независимо от того, настраиваете ли вы источник или назначение. Таким образом, на страницах **Выбор источника данных** и **Выбор назначения** мастера отображаются одинаковые параметры.

## <a name="get-the-connection-string-online"></a>Получение строки подключения в сети
Чтобы найти строки подключения для своего драйвера ODBC в сети, см. раздел [Справочник по строкам подключения](https://www.connectionstrings.com/). На этом стороннем сайте представлены примеры строк подключения и дополнительные сведения о поставщиках данных и используемых ими данных подключений.

## <a name="get-the-connection-string-with-an-app"></a>Получение строки подключения с помощью приложения
Чтобы собрать и проверить строку подключения для своего драйвера ODBC на локальном компьютере, вы можете использовать приложение **Администратор источников данных ODBC** на панели управления. Создайте файловое имя DSN для подключения, а затем скопируйте параметры из этого имени, чтобы использовать их при сборке строки подключения. Это требует выполнения нескольких действий, но позволяет проверить работоспособность строки подключения.

1.  Найдите или выберите приложение **ODBC Data Sources (64-bit)** (Источники данных ODBC (64-разрядное)) в панели управления. Если у вас есть только 32-разрядный драйвер или вам нужен именно 32-разрядный драйвер, найдите вместо этого приложение **ODBC Data Sources (32-bit)** (Источники данных ODBC (32-разрядное)).
2.  Запустите приложение. Открывается окно **Администратор источников данных ODBC**.
3.  Перейдите на вкладку **Файловый DSN** приложения. Нажмите кнопку **Добавить**.

    В рамках этого примера создайте файловое, а не пользовательское или системное имя DSN, так как файловое имя DSN сохраняет пары имя-значение в определенном формате, который подходит для строки подключения.

    ![Добавление файлового имени DSN ODBC](../../integration-services/import-export-data/media/add-a-new-odbc-file-dsn.png)

4.  В диалоговом окне **Создать новый источник данных** выберите драйвер в списке и нажмите кнопку **Далее**. В этом примере будет создано имя DSN, которое содержит аргументы строки подключения, необходимые для подключения к Microsoft SQL Server.

    ![Создание источника данных ODBC](../../integration-services/import-export-data/media/create-new-odbc-data-source.png)
    
5.  Выберите расположение и введите имя файла для нового файлового имени DSN, а затем нажмите кнопку **Далее**. Запомните, куда сохраняете файл, чтобы позднее вам было легче его найти.

    ![Сохранение нового файлового имени DSN](../../integration-services/import-export-data/media/save-new-file-dsn.png)

6.  Просмотрите сводные данные и нажмите кнопку **Готово**.

7.  После нажатия кнопки **Готово** выбранный вами драйвер отображает один или несколько собственных экранов, чтобы собрать необходимые для подключения сведения. Обычно эти сведения включают в себя сервер, учетные данные и базу данных для источников на основе серверов и файл, формат и версию для источников, на основе файлов.

8. После настройки источника данных нажмите кнопку **Готово**. После этого обычно отображаются сводные сведения о выбранных параметрах и предоставляется возможность протестировать их.

    ![Проверка нового файлового имени DSN](../../integration-services/import-export-data/media/test-new-file-dsn.png)

9. Проверив источник данных и закрыв диалоговые окна, найдите файловое имя DSN там, куда вы его сохранили. Если вы не изменяли расширение файла, по умолчанию используется расширение DSN.

10. Откройте этот файл в блокноте или другом текстовом редакторе. Ниже приведено содержимое нашего примера SQL Server.

    ```   
    [ODBC]  
    DRIVER=ODBC Driver 13 for SQL Server  
    TrustServerCertificate=No  
    DATABASE=WideWorldImporters    
    WSID=<local computer name>  
    APP=MicrosoftÂ® WindowsÂ® Operating System  
    Trusted_Connection=Yes  
    SERVER=localhost   
    ```
        
11. Скопируйте и вставьте необходимые значения в строку подключения, в которой пары имя-значение разделяются точкой с запятой.

    Собрав все необходимые значения из образца файлового имени DSN, вы получите следующую строку подключения.
    
        ```
        DRIVER=ODBC Driver 13 for SQL Server;SERVER=localhost;DATABASE=WideWorldImporters;Trusted_Connection=Yes
        ```

    Если вы используете приложение "Администратор источников данных ODBC", переносить все эти параметры в имени DSN для создания работающей строки подключения обычно не требуется.  
    -   Всегда нужно указывать драйвер ODBC.
    -   Для источника данных на основе сервера, такого как SQL Server, обычно требуются сведения о сервере, базе данных и сведения для входа. Поэтому в данном примере значения TrustServerCertificate, WSID и APP вам не нужны.
    -   Для источника данных на основе файла требуется по меньшей мере имя файла и расположение.
    
12. Введите строку подключения в поле **ConnectionString** на странице **Выбор источника данных** или **Выбор назначения** мастера. Мастер анализирует строку, после чего можно двигаться дальше.

    ![Подключение к SQL с помощью ODBC позднее](../../integration-services/import-export-data/media/connect-to-sql-with-odbc-after.jpg)

## <a name="see-also"></a>См. также раздел
[Выбор источника данных](../../integration-services/import-export-data/choose-a-data-source-sql-server-import-and-export-wizard.md)  
[Выбор назначения](../../integration-services/import-export-data/choose-a-destination-sql-server-import-and-export-wizard.md)


