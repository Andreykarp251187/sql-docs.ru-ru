---
title: Выбор копирования таблицы или запроса (мастер импорта и экспорта SQL Server) | Документы Майкрософт
ms.custom: ''
ms.date: 02/17/2017
ms.prod: sql
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql13.dts.impexpwizard.specifytablecopyorquery.f1
ms.assetid: 08aa7158-40e6-4ef3-84d3-1265a8ba194c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: f561fd0e5817ecc03e8d5fe4cc8c32661ebdca21
ms.sourcegitcommit: b2e81cb349eecacee91cd3766410ffb3677ad7e2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2020
ms.locfileid: "71296244"
---
# <a name="specify-table-copy-or-query-sql-server-import-and-export-wizard"></a>Выбор копирования таблицы или запроса (мастер импорта и экспорта SQL Server)

[!INCLUDE[ssis-appliesto](../../includes/ssis-appliesto-ssvrpluslinux-asdb-asdw-xxx.md)]


  После того как вы укажете сведения о назначении и о том, как к нему подключиться, в мастере импорта и экспорта [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] откроется страница **Выбор копирования таблицы или запроса**. На этой странице можно выбрать один из следующих вариантов действий.
-   **Скопировать данные из одной или нескольких таблиц или представлений**. Необходимо выбрать в списке одну или несколько таблиц.
-   **Написать запрос, указывающий данные для передачи**. Необходимо ввести или вставить текст SQL-запроса.
    
> [!TIP]
> Если вам нужно скопировать несколько баз данных или объекты базы данных, отличные от таблиц и представлений, вместо мастера импорта и экспорта используйте мастер копирования базы данных. Дополнительные сведения см. в разделе [Использование мастера копирования базы данных](../../relational-databases/databases/use-the-copy-database-wizard.md).     
 
## <a name="screen-shot-of-the-specify-table-copy-or-query-page"></a>Снимок экрана: страница "Выбор копирования таблицы или запроса"    
 На следующем снимке экрана показана страница мастера **Выбор копирования таблицы или запроса** .    
    
 ![Страница "Копия таблицы" в мастере импорта и экспорта](../../integration-services/import-export-data/media/table-copy-or-query.png "Страница "Копия таблицы" в мастере импорта и экспорта")    
    
## <a name="specify-whether-to-copy-an-entire-table-or-write-a-query"></a>Копирование всей таблицы или создание запроса 
 **Скопировать данные из одной или нескольких таблиц или представлений**    
 Используйте этот параметр, если нужно копировать данные из источника без фильтрации или сортировки записей.   

Выбрав параметр **Скопировать данные из одной или нескольких таблиц или представлений**, вы можете выполнить копирование из одной таблицы или представления в одну целевую таблицу либо из нескольких таблиц или представлений в несколько целевых таблиц.

 После нажатия кнопки **Далее**выберите таблицы для копирования на странице **Выбор исходных таблиц и представлений** . Дополнительные сведения см. в разделе [Выбор исходных таблиц и представлений](../../integration-services/import-export-data/select-source-tables-and-views-sql-server-import-and-export-wizard.md).   
    
 **Написать запрос, указывающий данные для передачи**    
 Выберите этот параметр, чтобы отфильтровать или отсортировать исходные данные перед их копированием в место назначения.    
    
При выборе параметра **Написать запрос, указывающий данные для передачи**вы можете скопировать результаты только одного запроса в одну целевую таблицу.  

После нажатия кнопки **Далее**укажите инструкцию SQL для определения столбцов и выбора строк в диалоговом окне **Определение исходного запроса** . Дополнительные сведения см. в разделе [Определение исходного запроса](../../integration-services/import-export-data/provide-a-source-query-sql-server-import-and-export-wizard.md).   
    
## <a name="why-isnt-the-copy-option-available"></a>Почему недоступен параметр "Копировать"?    
 Если для подключения к источнику данных используется поставщик **, параметр** Скопировать данные из одной или нескольких таблиц или представлений [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] может быть недоступен. Это происходит, когда мастер не располагает достаточными сведениями о поставщике данных, чтобы запросить список таблиц и представлений из источника данных. 
 
Даже если вы обычно не занимаетесь написанием SQL-запросов, вы можете использовать параметр **Написать запрос** при условии, что знаете имя таблицы, которую нужно экспортировать. В диалоговом окне **Определение исходного запроса**, которое появится после нажатия кнопки **Далее**, введите запрос в следующей форме: `SELECT * FROM <name of table>`. Если в имени таблицы есть пробелы или другие специальные символы, заключите его в квадратные скобки: `SELECT * FROM [<name of table>]`.

### <a name="more-info"></a>Дополнительные сведения
 Параметр **Скопировать данные из одной или нескольких таблиц или представлений** доступен только для поставщиков, у которых имеется раздел ProviderDescription в файле ProviderDescriptors.xml. (По умолчанию этот файл расположен в папке \<*диск*>:\Program Files\Microsoft SQL Server\130\DTS\ProviderDescriptors.) Каждый раздел ProviderDescription в этом файле содержит сведения, необходимые для получения метаданных от соответствующего поставщика.    
    
 По умолчанию файл ProviderDescriptors.xml содержит раздел ProviderDescription только для поставщиков из списка ниже.    
    
-   Поставщик данных .NET Framework для SQL Server (System.Data.SqlClient)    
    
-   Поставщик данных .NET Framework для Oracle (System.Data.OracleClient)    
    
-   Поставщик данных .NET Framework для ODBC (System.Data.Odbc)    
    
-    System.Data.OleDb (который применяется ко всем поставщикам OLE DB)    
    
-   Поставщик Майкрософт для DB2, установленный Microsoft Host Integration Server (Microsoft.HostIntegration.MsDb2Client.MsDb2Connection)    
    
 Чтобы сделать параметр **Скопировать данные из одной или нескольких таблиц или представлений** доступным для своих поставщиков, сторонние разработчики могут добавить в файл ProviderDescriptors.xml раздел ProviderDescriptor. Требования к разделу ProviderDescriptor см. в файле схемы ProviderDescriptors.xsd, который по умолчанию расположен в той же папке, что и файл ProviderDescriptors.xml.    
    
## <a name="whats-next"></a>Дальнейшие действия    
 После того как вы укажете, нужно ли копировать всю таблицу или создать запрос, следующая страница будет зависеть от параметра, выбранного на этой странице, а также от места назначения для данных.    
    
-   Если выбран параметр **Скопировать данные из одной или нескольких таблиц или представлений**, для большинства назначений откроется страница **Выбор исходных таблиц и представлений**. На этой странице выберите существующие таблицы и представления для копирования из источника данных в назначение. Дополнительные сведения см. в разделе [Выбор исходных таблиц и представлений](../../integration-services/import-export-data/select-source-tables-and-views-sql-server-import-and-export-wizard.md).    
    
-   Если выбран параметр **Скопировать данные из одной или нескольких таблиц или представлений** и назначением является неструктурированный файл, откроется страница **Настройка назначения "Неструктурированный файл"** . На этой странице можно задать параметры форматирования для назначения "Неструктурированный файл". (Затем после настройки неструктурированного файла откроется страница **Выбор исходных таблиц и представлений**.) Дополнительные сведения см. в разделе [Настройка назначения "Неструктурированный файл"](../../integration-services/import-export-data/configure-flat-file-destination-sql-server-import-and-export-wizard.md).    
    
-   Если выбран параметр **Написать запрос, указывающий данные для передачи**, откроется страница **Определение исходного запроса**. На этой странице выполняется написание и тестирование инструкции SQL, которая выбирает данные для копирования из источника данных в место назначения. (Затем после определения запроса откроется страница **Выбор исходных таблиц и представлений**.) Дополнительные сведения см. в разделе [Определение исходного запроса](../../integration-services/import-export-data/provide-a-source-query-sql-server-import-and-export-wizard.md).

## <a name="see-also"></a>См. также раздел
[Приступая к работе с простым примером мастера импорта и экспорта](../../integration-services/import-export-data/get-started-with-this-simple-example-of-the-import-and-export-wizard.md)


