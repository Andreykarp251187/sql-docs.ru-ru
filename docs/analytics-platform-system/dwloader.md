---
title: dwloader загрузчика командной строки - Parallel Data Warehouse | Документация Майкрософт
description: dwloader является средством командной строки Parallel Data Warehouse (PDW), который загружает строки таблицы в пакетном режиме в существующую таблицу.
author: mzaman1
ms.prod: sql
ms.technology: data-warehouse
ms.topic: conceptual
ms.date: 04/17/2018
ms.author: murshedz
ms.reviewer: martinle
ms.openlocfilehash: dd3f005346c5faae9e02513a144d04d80857b770
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "67961026"
---
# <a name="dwloader-command-line-loader-for-parallel-data-warehouse"></a>dwloader загрузчика командной строки для Parallel Data Warehouse
**dwloader** является средством командной строки Parallel Data Warehouse (PDW), который загружает строки таблицы в пакетном режиме в существующую таблицу. При загрузке строк, можно добавить все строки в конец таблицы (*режим добавления* или *режиме fastappend*), будет добавлена новая строка и обновлять существующие строки (*режиме upsert*), или удалить все существующие строки перед загрузкой и затем вставить все строки в пустую таблицу (*перезагрузить режим*).  
  
**Для загрузки данных**  
  
1.  Подготовка исходных данных.  
  
    Использование собственного процесса ETL для создания источника данных, который нужно загрузить. Исходные данные должны быть отформатированы в соответствии со схемой целевой таблицы. Store исходные данные в один или несколько текстовых файлов и скопируйте текстовые файлы в тот же каталог на сервере загрузки. Сведения о сервере загрузки, см. в разделе [приобретение и настройка сервера, загрузка](acquire-and-configure-loading-server.md)  
  
2.  Подготовка параметров загрузки.  
  
    Решите, какие параметры загрузки, будет использоваться. Параметры загрузки Store в файле конфигурации. Скопируйте файл конфигурации в локальной папке на сервере загрузки. **Dwloader** параметры конфигурации, описанные в этом разделе.  
  
3.  Подготовка загрузки параметров восстановления.  
  
    Выбор способа **dwloader** обработки строк, которые невозможно загрузить. Чтобы выполнить загрузку, **dwloader** сначала загружает данные в промежуточную таблицу и затем передает данные в целевую таблицу. Как загрузчик загружает данные в промежуточную таблицу, он отслеживает число строк, которые невозможно загрузить. Например строки, которые имеют некорректный будет невозможно загрузить. Отклоненных строк копируются в файл отклонения. По умолчанию нагрузки прерывает после первого отклонения, если не указать пороговое значение отклонения другой.  
  
4.  Установка **dwloader**.  
  
    Установите dwloader на сервер загрузки, если они еще не установлены. 

<!-- MISSING LINK
    See [Install dwloader Command-Line Loader &#40;SQL Server PDW&#41;](install-dwloader-command-line-loader-sql-server-pdw.md). 
--> 
  
5.  Запустите **dwloader**.  
  
    Войдите на сервер загрузки и запустите исполняемый файл **dwloader.exe** с соответствующими параметрами командной строки.  
  
6.  Проверьте результаты.  
  
    Чтобы узнать, выполнена строки см. в разделе, если все строки не удалось загрузить файл (указанный -R). Если этот файл пуст, все строки успешно загружен. **dwloader** является транзакционной, поэтому если любой шаг завершается ошибкой (кроме, отклоненных строк), выполнит откат всех шагов в изначальное состояние.  
  
<!-- 
![Topic link icon](media/topic-link.gif "Topic_Link")[Syntax Conventions](syntax-conventions-sql-server-pdw.md)  
-->  


## <a name="syntax"></a>Синтаксис  
  
```  
dwloader.exe { -h }  
  
dwloader.exe   
    {  
        { -U login_name  -P password  }  
        | -W  
    }  
    [ -f parameter_file ]  
    [ -S target_appliance ]  
    { -T target_database_name . [ schema ] . table_name }   
    { -i source_data_location } [ <source_data_options> ]  
    { -R load_failure_file_name } [ <load_failure_options> ]  
    [ <loading_options> ]  
}  
  
<source_data_options> ::=  
{  
    [ -fh number_header_rows ]  
    [ < variable_length_column_options > | < fixed_width_column_options > ]  
    [ -D { mdy | myd | ymd | ydm | dmy | dym | custom_date_format } ]  
    [ -dt datetime_format_file ]  
}  
  
<variable_length_column_options> ::=  
{  
    [ -e character_encoding ]  
    -r row_delimiter   
    [ -s string_delimiter ]  
    -t field_delimiter   
}  
  
<fixed_width_column_options> ::=  
{  
    -w fixed_width_config_file   
    [ -e character_encoding ]   
    -r row_delimiter   
}  
  
<load_failure_options> ::=  
{  
    [ -rt { value | percentage } ]  
    [ -rv reject_value ]  
    [ -rs reject_sample_value ]  
}  
  
<loading_options> ::=  
{  
    [ -d staging_database_name ]  
    [ -M { append | fastappend | upsert -K merge_column [ ,...n ] | reload } ]  
    [ -b batchsize ]   
    [ -c ]  
    [ -E ]  
    [ -m ]  
    [ -N ]  
    [ -se ]
    [ -l ]   
}  
```  
  
## <a name="arguments"></a>Аргументы  
**-h**  
Отображает простой справочные сведения об использовании загрузчик. Справка отображается только в том случае, если не задано никаких других аргументов командной строки.  
  
**-U** *login_name*  
Допустимое имя входа проверки подлинности SQL Server с соответствующими разрешениями для выполнения загрузки.  
  
**-P** *пароль*  
Пароль для проверки подлинности SQL Server *login_name*.  
  
**-W**  
Использовать проверку подлинности Windows. (Нет *login_name* или *пароль* требуется.) 

<!-- MISSING LINK
For information about configuring Windows Authentication, see [Security - Configure Domain Trusts](security-configure-domain-trusts.md).  
-->
  
**-f** *parameter_file_name*  
Использование файла параметров, *parameter_file_name*, вместо параметров командной строки. *parameter_file_name* может содержать любой параметр командной строки, за исключением *user_name* и *пароль*. Если параметр указан в командной строке и в файле параметров, в командной строке переопределяет параметр file.  
  
Файл параметров содержит один параметр без **-** префикс в каждой строке.  
  
Примеры:  
  
`rt=percentage`  
  
`rv=25`  
  
* *-S *** target_appliance*  
Указывает модуль SQL Server PDW, который получит загруженных данных.  
  
*Для соединения Infiniband*, *target_appliance* указывается как < имя устройства >-SQLCTL01. Чтобы настроить это подключение, см. в разделе [Настройка сетевых адаптеров InfiniBand](configure-infiniband-network-adapters.md).  
  
Для подключения Ethernet *target_appliance* IP-адрес для кластера узлов элемента управления.  
  
Если этот параметр опущен, dwloader по умолчанию значение, указанное при установке dwloader. 

<!-- MISSING LINK
For more information about this install option, see [Install dwloader Command-Line Loader](install-dwloader.md).  
-->
  
**-T** *target_database_name.* [*schema*].*table_name*  
Трехкомпонентное имя целевой таблицы.  
  
* *-I***source_data_location*  
Расположение исходных файлов для загрузки. Каждый исходный файл должен быть текстовый файл или текстовый файл, который сжимается с помощью gzip. Только один исходный файл могут быть сжаты в каждый файл gzip.  
  
Формат исходного файла:  
  
-   Исходный файл должен быть отформатирован в соответствии с параметры загрузки.  
  
-   Каждая строка в файле исходного кода содержит данные строки одной таблицы. Источник данных должен соответствовать схеме целевой таблицы. Также должно соответствовать столбцов порядок и типы данных. Каждое поле в строке представляет столбец в таблице назначения.  
  
-   По умолчанию поля имеют переменную длину и отделяется разделителем. Чтобы указать тип разделителя, используйте параметры командной строки < variable_length_column_options >. Чтобы задать фиксированную длину поля, используйте параметры командной строки < fixed_width_column_options >.  
  
Чтобы указать расположение исходных данных:  
  
-   Расположение источника данных может быть сетевой путь или локальный путь к каталогу на сервере загрузки.  
  
-   Чтобы указать все файлы в каталоге, введите путь к каталогу, за которым следует * подстановочный знак.  Загрузчик не загружает файлы из всех подкаталогах, которые находятся в расположении источника данных. Загрузчик ошибки, если каталог существует в файле gzip.  
  
-   Чтобы указать некоторые файлы в каталоге, используйте сочетание символов и * подстановочный знак.  
  
Загрузка нескольких файлов с помощью одной команды.  
  
-   Все файлы должны находиться в том же каталоге.  
  
-   Файлы должны быть все текстовые файлы, все файлы gzip или сочетание файлов gzip и текста.  
  
-   Ни один из файлов может содержать сведения о заголовке.  
  
-   Все файлы должны использовать один и тот же тип кодирования символ. См. параметр -e.  
  
-   Необходимо загрузить все файлы в той же таблице.  
  
-   Все файлы будут сцеплены и загружен, как если бы они один файл и отклоненных строк будет перейти к файлу единый отклонения.  
  
Примеры:  
  
-   -i \\\loadserver\loads\daily\\*.gz  
  
-   -i \\\loadserver\loads\daily\\*.txt  
  
-   -i \\\loadserver\loads\daily\monday.*  
  
-   -i \\\loadserver\loads\daily\monday.txt  
  
-   -i \\\loadserver\loads\daily\\*  
  
**-R** *load_failure_file_name*  
При наличии сбоев при загрузке, **dwloader** хранит строки с ошибкой и описание сбоя сведения об ошибках в файл с именем *load_failure_file_name*. Если этот файл уже существует, dwloader перезапишет существующий файл. *load_failure_file_name* создается при первом сбое. Если все строки успешно, загрузить *load_failure_file_name* не создается.  
  
**-fh** *number_header_rows*  
Количество строк, чтобы игнорировать в начале *source_data_file_name*. Значение по умолчанию равно 0.  
  
< variable_length_column_options >  
Параметры для *source_data_file_name* с символами столбцов переменной длины. По умолчанию *source_data_file_name* содержит символы ASCII в столбцы с переменной длиной.  
  
Для файлов, ASCII значения NULL, представляются последовательное размещение разделители. Например, в файл, разделенные символами вертикальной черты ("|»), указывается значение NULL «||». В файле с разделителями запятыми, указывается значение NULL «,,». Кроме того **-E** (--emptyStringAsNull) необходимо указать параметр. Дополнительные сведения об -E см. в разделе ниже.  
  
**-e** *character_encoding*  
Указывает тип кодировки символов для данных необходимо загрузить из файла данных. Параметры являются ASCII (по умолчанию), UTF8, UTF16 или UTF16BE, где UTF16 обратным порядком, а UTF16BE — с обратным порядком байтов. Эти параметры зависят от регистра символов.  
  
**-t** *field_delimiter*  
Разделитель для каждого поля (столбца) в строке. Разделителем поля является один или несколько из указанных ниже escape-символы ASCII или шестнадцатеричных значений ASCII.  
  
|Имя|Escape-символ|Шестнадцатеричный символьный|  
|--------|--------------------|-----------------|  
|Вкладка|\t|0x09|  
|Возврат каретки (CR)|\r|0x0d|  
|Перевод строки (LF)|\n|0x0A|  
|CRLF|\r\n|0x0d0x0a|  
|Запятая|','|0x2c|  
|двойная кавычка|\\"|0x22|  
|одинарная кавычка|\\'|0x27|  
  
Чтобы указать символ вертикальной черты, в командной строке, заключите его в двойные кавычки «|». Это позволит избежать напоминающие анализатором командной строки. Другие символы заключаются в одинарные кавычки.  
  
Примеры:  
  
-t «|»  
  
-t ""  
  
-t 0x0a  
  
\t -t  
  
-t "~ | ~"  
  
**-r** *row_delimiter*  
Разделитель для каждой строки исходного файла данных. Разделитель строк имеет одно или несколько значений ASCII.  
  
Для указания символа возврата каретки (CR), перевода строки (LF) или символ табуляции как разделитель, можно использовать escape-символы (\r, \n, \t) или их шестнадцатеричные значения (0 x, 0d, 09). Чтобы указать другие специальные символы в качестве разделителей, используйте их шестнадцатеричное значение.  
  
Примеры CR + LF:  
  
\r\n - r  
  
0x0d0x0a - r  
  
Примеры CR.  
  
\r - r  
  
-r 0x0d  
  
Примеры LF:  
  
\n - r  
  
-r 0x0a  
  
LF является обязательным для Unix. CR является обязательным для Windows.  
  
**-s** *string_delimiter*  
Разделитель для строковых данных типа поля с разделителями текста входного файла. Разделитель строк имеет одно или несколько значений ASCII.  Он может быть указан как символ (например, -s *) или в виде шестнадцатеричного значения (например, -s 0x22 для двойные кавычки).  
  
Примеры:  
  
-s *  
  
-s 0x22  
  
< fixed_width_column_options >  
Параметры для файла источника данных, имеющий столбцов фиксированной длины. По умолчанию *source_data_file_name* содержит символы ASCII в столбцы с переменной длиной.  
  
Фиксированная ширина столбцов не поддерживаются при -e — UTF8.  
  
**-w** *fixed_width_config_file*  
Путь и имя файла конфигурации, который указывает число символов в каждом столбце. Каждое поле должно быть указано.  
  
Этот файл должен находиться на сервере загрузки. Путь может быть UNC-пути, относительный или абсолютный путь. Каждая строка в *fixed_width_config_file* содержит имя одного столбца и количество символов для этого столбца. Имеется одна строка для каждого столбца, как показано ниже, и порядок, в файл должен соответствовать порядку в целевой таблице:  
  
*column_name*=*num_chars*  
  
*column_name*=*num_chars*  
  
Пример фиксированной ширины файла конфигурации.  
  
SalesCode = 3  
  
SalesID = 10  
  
Пример строки в *source_data_file_name*:  
  
230Shirts0056  
  
320Towels1356  
  
В предыдущем примере первый загруженной строки будет иметь SalesCode = "230" и SalesID = «Shirts0056». Во-вторых загруженной строки будет иметь SalesCode = "320" и SaleID = «Towels1356».  
  
Сведения о том, как обрабатывать начальные и конечные пробелы или преобразования типа данных в режиме фиксированную ширину, см. в разделе [правила преобразования для dwloader типов данных](dwloader-data-type-conversion-rules.md).  
  
**-e** *character_encoding*  
Указывает тип кодировки символов для данных необходимо загрузить из файла данных. Параметры являются ASCII (по умолчанию), UTF8, UTF16 или UTF16BE, где UTF16 обратным порядком, а UTF16BE — с обратным порядком байтов. Эти параметры зависят от регистра символов.  
  
Фиксированная ширина столбцов не поддерживаются при -e — UTF8.  
  
**-r** *row_delimiter*  
Разделитель для каждой строки исходного файла данных. Разделитель строк имеет одно или несколько значений ASCII.  
  
Для указания символа возврата каретки (CR), перевода строки (LF) или символ табуляции как разделитель, можно использовать escape-символы (\r, \n, \t) или их шестнадцатеричные значения (0 x, 0d, 09). Чтобы указать другие специальные символы в качестве разделителей, используйте их шестнадцатеричное значение.  
  
Примеры CR + LF:  
  
\r\n - r  
  
0x0d0x0a - r  
  
Примеры CR.  
  
\r - r  
  
-r 0x0d  
  
Примеры LF:  
  
\n - r  
  
-r 0x0a  
  
LF является обязательным для Unix. CR является обязательным для Windows.  
  
**-D** { **ymd** | ydm | mdy | myd |  dmy | dym | *custom_date_format* }  
Указывает порядок месяца (m), (d) дня и года (y) для всех полей даты и времени во входном файле. Порядок по умолчанию является «гмд». Чтобы указать несколько форматов заказа для этого же исходного файла, используйте параметр -dt.  
  
«гмд» | DMY  
ydm и ДМГ позволяют же форматы входных данных. Оба позволяют год, чтобы быть в начале или конце дату. Например, для обоих **ГДМ** и **ДМГ** Дата форматы, имеется 2013-02-03 или 02-03-2013 во входном файле.  
  
ydm  
Можно загружать только входные данные в формате ГДМ в столбцы типа данных datetime и smalldatetime. Не удается загрузить ГДМ значения в столбец datetime2, date то есть тип данных datetimeoffset.  
  
mdy  
MDY (МДГ) позволяет <month> <space> <day> <comma> <year>.  
  
Примеры MDY (МДГ) входные данные для 1 января 1975 г.:  
  
-   1 января 1975 г.  
  
-   01 января 75  
  
-   Jan/1/75  
  
-   01011975  
  
мгд  
Входной файл примеры для марта 04,2010: 03-2010-04, 3/2010/4  
  
дгм  
Примеры входного файла для 04 марта 2010 г: 04-2010-03, 4/2010/3  
  
*custom_date_format*  
*custom_date_format* является пользовательского формата даты (например, мм/дд/гггг) и включается только для обратной совместимости. dwloader не обеспечивает пользовательский формат даты. Вместо этого при указании пользовательского формата даты, **dwloader** преобразует его в соответствующий параметр ГМД, ГДМ, МДГ, МГД, ДГМ или dmy.  
  
Например если указано -D мм/дд/гггг, dwloader ожидает, что все даты, входные данные располагаются в месяц, во-первых, а затем день и затем год (МДГ). Не реализуется 2 символов месяцев, дней, цифрой 2 и 4-значный номер года в соответствии с пользовательский формат даты. Ниже приведены некоторые примеры способов, которые можно форматировать даты во входном файле, когда формат даты не -D мм/дд/гггг. 01/02/2013, Jan.02.2013, 1/2/2013  
  
Более подробную информацию форматирования, см. в разделе [правила преобразования для dwloader типов данных](dwloader-data-type-conversion-rules.md).  
  
**-dt** *datetime_format_file*  
Каждый формат даты и времени, указывается в файл с именем *datetime_format_file*. В отличие от параметров командной строки файл параметров, которые включают пробелы не должны заключаться в двойные кавычки. Невозможно изменить формат даты и времени, при загрузке данных. Исходный файл данных и соответствующего столбца в целевой таблице, должны иметь тот же формат.  
  
Каждая строка содержит имя столбца в таблице назначения и формат даты и времени.  
  
Примеры:  
  
`LastReceiptDate=ymd`  
  
`ModifiedDate=dym`  
  
**-d** *staging_database_name*  
Имя базы данных, который будет содержать промежуточной таблицы. Значение по умолчанию — база данных, указанных с помощью параметра -T, который является базой данных в целевую таблицу. Дополнительные сведения об использовании промежуточной базы данных см. в разделе [создать базу данных промежуточного хранения](staging-database.md).  
  
**-M** *load_mode_option*  
Указывает, следует ли добавить, upsert, или перезагрузить данные. Режим по умолчанию append.  
  
добавить  
Загрузчик вставляет строки в конце существующих строк в таблице назначения.  
  
fastappend  
Загрузчик вставляет строки напрямую, без использования временной таблицы, в конец существующих строк в таблице назначения. fastappend требует множественных транзакций (-m) параметр. При использовании fastappend, промежуточную базу данных нельзя. Нет никакого отката с fastappend, это означает, что восстановление после сбоя или прерванных нагрузки должен обрабатывать свои собственные процесса загрузки.  
  
Вставка **-K***merge_column* [,...*n* ]  
Загрузчик использует инструкцию SQL Server Merge для обновления существующих строк и вставлять новые строки.  
  
Параметр -K указывает столбец или столбцы для слияния на. Эти столбцы формируют ключ слияния, который должен представлять уникальную строку. Если ключ слияния существует в целевой таблице, строка обновляется. Если ключ объединения не существует в целевой таблице, добавляются строки.  
  
Для хэш распределенные таблицы ключ объединения должен быть или включать столбец распределения.  
  
Для реплицированных таблиц слияния ключ представляет собой сочетание одного или нескольких столбцов. Эти столбцы задаются в соответствии с потребностями приложения.  
  
Несколько столбцов должно быть с разделителями запятыми без пробелов, или с разделителями запятыми с пробелами и заключены в одинарные кавычки.  
  
Если две строки в исходной таблице имеют совпадающие значения ключа слияния, их соответствующие строки должны совпадать.  
  
Перезагрузить  
Загрузчик Усекает целевую таблицу, прежде чем вставлять исходных данных.  
  
**-b** *batchsize*  
Рекомендуется только для использования службой поддержки Майкрософт, *batchsize* является размер пакета SQL Server для массового копирования, которая выполняет DMS в экземпляры SQL Server на вычислительных узлах.  Когда *batchsize* указано, SQL Server PDW переопределит нагрузки размер пакетов, который динамически вычисляется для каждой загрузки.  
  
Начиная с SQL Server 2012 PDW, управляющий узел динамически вычисляет размер пакета для каждой загрузки по умолчанию. Это автоматическое вычисление основано на несколько параметров, таких как объем памяти, тип целевой таблицы, схемы целевой таблицы, тип загрузки, размер файла и класс ресурсов пользователя.  
  
Например, если режим загрузки FASTAPPEND, а таблица имеет кластеризованный индекс columnstore, SQL Server PDW будет, по умолчанию попытки использовать размер пакета 1 048 576, таким образом, чтобы группы строк будет ЗАКРЫТО и нагрузки непосредственно в columnstore без перечисления дельта-хранилище. Если память не поддерживает размер пакета, 1 048 576, dwloader выберет меньший размер пакета.  
  
Если тип загрузки FASTAPPEND, *batchsize* применяется к загрузке данных в таблице, в противном случае *batchsize* применяется к загрузке данных в промежуточную таблицу.  
  
< reject_options >  
Указывает параметры для определения количества сбоев при загрузке, с помощью которых загрузчик. Если сбои загрузки, которые превышают пороговое значение, загрузчик halt и фиксирует все строки.  
  
**-rt** { **значение** | процент}  
Указывает ли*reject_value* в **-rv** *reject_value* вариант — литерал несколько строк (значение) или частоту сбоев (в процентах). По умолчанию используется значение.  
  
Параметр процента — вычисление в режиме реального времени, которое происходит через интервалы в соответствии с параметром - rs.  
  
Например если загрузчик пытается загрузить 100 строк и 25 сбой и успешно 75, частота сбоев составляет 25%.  
  
**-rv** *reject_value*  
Указывает количество или процент строк отклонений перед остановка нагрузки. **-Rt** определяет параметр, если *reject_value* ссылается на число строк или процент строк.  
  
Значение по умолчанию *reject_value* равно 0.  
  
При использовании значения -rt, загрузчик останавливает нагрузки, если число отклоненных строк превышает reject_value.  
  
Когда использовать с процентом -rt, загрузчик вычисляет процент с интервалами (-rs параметр). Таким образом, процент отклоненных строк может превысить *reject_value*.  
  
**-rs** *reject_sample_size*  
Используется с `-rt percentage` параметр, чтобы указать процент добавочных проверок. Например если reject_sample_size 1000, загрузчик рассчитает процент отклоненных строк после попытки загрузить 1000 строк. Он пересчитает процент отклоненных строк после пытается загрузить каждой 1000 строк.  
  
**-c**  
Удаляет пробелы из левой и правой части char, nchar, varchar и nvarchar поля. Преобразует каждого поля, которое содержит только символы пробела в пустую строку.  
  
Примеры:  
  
"" возвращает округленное до ''  
  
Возвращает округленное 'abc' до 'abc'  
  
При использовании с параметром -E, -c -E операция происходит сначала. Поля, содержащие только пробелы, преобразуются в пустую строку, а не значение NULL.  
  
**-E**  
Преобразует пустые строки в значение NULL. По умолчанию используется не выполнять эти преобразования.  
  
**-m**  
Использовать режим множественных транзакций для второго этапа загрузки; При загрузке данных из промежуточной таблицы в распределенную таблицу.  
  
С помощью **-m**, SQL Server PDW выполняет и фиксирует загружает в параллельном режиме. Это выполняется гораздо быстрее, чем режим загрузки по умолчанию, но не является безопасным в транзакции.  
  
Без **-m**, SQL Server PDW выполняет и фиксирует загружает последовательно распределения в каждом вычислительном узле и одновременно в разных вычислительных узлов. Этот метод выполняется медленнее, чем режим нескольких транзакций, но транзакции с точки зрения.  
  
**-m** является необязательным для *append*, *перезагрузить*, и *upsert*.  
  
**-m** необходим для fastappend.  
  
**-m** не может использоваться с реплицированными таблицами.  
  
**-m** применяется только ко второму этапу загрузки. Он не относится к первой фазы загрузки; Загрузка данных в промежуточную таблицу.  
  
Нет никакого отката с режимом множественных транзакций, это означает, что восстановление после сбоя или прерванных нагрузки должен обрабатывать свои собственные процесса загрузки.  
  
Мы рекомендуем использовать **-m** только в том случае, при загрузке данных в пустую таблицу, чтобы его можно было восстановить без потери данных. Для восстановления после сбоя загрузки: удалить целевую таблицу, устраните проблему нагрузки, создать повторно целевую таблицу и снова запустите загрузку.  
  
**-N**  
Убедитесь, что целевое устройство имеет действительный сертификат SQL Server PDW из доверенного центра сертификации. Используется для обеспечения данных не выполняется злоумышленником и отправляются в несанкционированного расположение. Сертификат уже должен быть установлен на устройстве. Единственный способ установки сертификата — для администратора устройства, чтобы установить его с помощью средства Configuration Manager. Обратитесь к администратору устройства, если вы не уверены ли модуль установлен доверенный сертификат.  
  
**-se**  
Пропустить загрузку пустые файлы. Это также пропускает Распаковка сжатых файлов gzip пустой.

**-l**  
Доступно обновление CU7.4 указывает максимально длину (в байтах), могут быть загружены. Допустимые значения: целые числа в диапазоне от 32768 до 33554432. Используйте только при необходимости загрузить больших строк (больше 32 КБ), как это будет выделять больше памяти на клиенте и сервере.
  
## <a name="return-code-values"></a>Значения кода возврата  
0 (успешное завершение) или другие целочисленное значение (неуспешное завершение)  
  
В командном файле окна или пакета, используйте `errorlevel` для отображения кода возврата. Пример:  
  
```  
dwloader  
echo ReturnCode=%errorlevel%  
if not %errorlevel%==0 echo Fail  
if %errorlevel%==0 echo Success  
```  
  
Если вы используете PowerShell, используйте `$LastExitCode`.  
  
## <a name="permissions"></a>Разрешения  
Требуется разрешение НАГРУЗКИ и применимые разрешения (INSERT, UPDATE, DELETE) в целевой таблице. Требуется разрешение CREATE (для создания временной таблицы) в промежуточной базе данных. Если не используется промежуточную базу данных, разрешение CREATE необходим для целевой базы данных. 

<!-- MISSING LINK
For more information, see [Grant permissions to load data](grant-permissions-to-load-data.md).  
-->
  
## <a name="general-remarks"></a>Общие замечания  
Сведения о преобразовании типов данных при загрузке с помощью dwloader см. в разделе [правила преобразования для dwloader типов данных](dwloader-data-type-conversion-rules.md).  
  
Если параметр содержит один или несколько пробелов, заключите параметр в двойные кавычки.  
  
Загрузчик следует запускать из папки установки. Dwloader исполняемый предварительно устанавливается с устройством и находится в каталоге C:\Program Files\Microsoft SQL Server данных Warehouse\DWLoader.  
  
Можно переопределить параметр, который указан в файле параметров (-f-параметр), указав его в качестве параметра командной строки.  
  
Можно одновременно запустить несколько экземпляров загрузчика. Максимальное число экземпляров загрузчика предварительно настроена и не может быть изменено. 

<!-- MISSING LINK
For the maximum number of loads per appliance, see [Minimum and Maximum Values](minimum-maximum-values.md)  
-->
  
Загруженных данных может потребовать больше или меньше места на устройстве, чем в исходном расположении. Вы можете выполнить imports теста с подмножествами данных, чтобы оценить объем занятого на диске.  
  
Несмотря на то что **dwloader** — это процесс, транзакции и выполнит откат корректно при сбое, его невозможно откатить назад в том случае, когда Массовая загрузка выполнена успешно. Чтобы отменить активный **dwloader** обработки, введите CTRL + C.  
  
## <a name="limitations-and-restrictions"></a>Ограничения  
Общий размер всех загрузок, выполняются одновременно, должно быть меньше, чем LOG_SIZE для базы данных и рекомендуется, чтобы общий размер всех параллельных загрузок — меньше 50% LOG_SIZE. Для достижения этого ограничения размера, можно разделить большой нагрузки на несколько пакетов. Дополнительные сведения о LOG_SIZE, см. в разделе [CREATE DATABASE](../t-sql/statements/create-database-parallel-data-warehouse.md)  
  
При загрузке нескольких файлов с помощью команды один нагрузки, всех отклоненных строк записываются в один и тот же файл отклонения. Файл отклонения не отображаются какие входной файл содержит каждый отклоненных строк.  
  
Пустая строка не должна использоваться как разделитель. Если пустая строка используется как разделитель строк, произойдет сбой загрузки. При использовании в качестве разделителя столбцов, нагрузки игнорирует разделителя, которая продолжает использовать значение по умолчанию «|» как разделитель столбцов. При использовании в качестве разделителей строк, пустая строка учитывается и применяется поведение по умолчанию.  
  
## <a name="locking-behavior"></a>Режим блокировки  
**dwloader** режим блокировки изменяется в зависимости от *load_mode_option*.  
  
-   **Добавление** -Append — это рекомендуемое и наиболее распространена. Добавление загружает данные в промежуточную таблицу. Блокировка подробно описан ниже.  
  
-   **Быстрое добавление** -Fast append загружает непосредственно в итоговую таблицу, используя таблицы осуществляет блокировку ExclusiveUpdate и является единственным режимом, использует ли промежуточную таблицу.  
  
-   **перезагрузить** -перезагрузить загружает данные в промежуточную таблицу и требует монопольной блокировки на промежуточную таблицу и итоговую таблицу. Перезагрузка не рекомендуется для параллельных операций.  
  
-   **Upsert** -Upsert загружает данные в промежуточную таблицу и затем выполняет операцию слияния из промежуточной таблицы в итоговую таблицу. Upsert не требует монопольных блокировок на итоговую таблицу. Производительность может меняться при использовании операции upsert. Тестирование поведения в вашей среде.  
  
### <a name="locking-behavior"></a>Режим блокировки  
**Добавление режим блокировки**  
  
Добавление может выполняться в транзакции с несколькими режиме (с помощью аргумента -m), но это не безопасно транзакции. Поэтому добавьте следует использовать в качестве транзакционной операцией (без использования аргумента -m). К сожалению во время последняя операция INSERT-SELECT, транзакционный режим в настоящее время примерно в шесть раз медленнее, чем несколькими транзакционный режим.  
  
В режиме append загружает данные в два этапа. Первый этап загружает данные из исходного файла в промежуточную таблицу одновременно (фрагментации может произойти). Этап 2 загружает данные из промежуточной таблицы в итоговую таблицу. На второй стадии выполняется **INSERT INTO... ВЫБЕРИТЕ параметр WITH (TABLOCK)** операции. Следующей таблице показано поведение блокировки на итоговую таблицу и режим записи в журнал при использовании режим добавления:  
  
|Тип таблицы|Множественных транзакций<br />Режим (-m)|Таблица пуста.|Поддерживается параллелизма|Ведение журнала|  
|--------------|-----------------------------------|------------------|-------------------------|-----------|  
|Куча|Да|Да|Да|Минимальный|  
|Куча|Да|Нет|Да|Минимальный|  
|Куча|Нет|Да|Нет|Минимальный|  
|Куча|Нет|Нет|Нет|Минимальный|  
|CL|Да|Да|Нет|Минимальный|  
|CL|Да|Нет|Да|Полное|  
|CL|Нет|Да|Нет|Минимальный|  
|CL|Нет|Нет|Да|Полное|  
  
Выше показано в таблице **dwloader** с помощью режима append загрузки в кучу и таблицу с кластеризованным индексом (CI), с или без транзакций с несколькими флага и загрузить в пустую таблицу или непустую таблицу. Блокировка и ведением каждой такой комбинации загрузки отображается в таблице. Например (2-й) этапе в режиме append загрузки в кластеризованный индекс без транзакций с несколькими режиме и в пустой таблице будет иметь PDW создайте монопольную блокировку для таблицы и сводится к минимуму ведения журнала. Это означает, что клиент не сможет загрузить (2-й) этапа и запросов одновременно в пустую таблицу. Тем не менее при загрузке с одинаковой конфигурацией в непустую таблицу PDW не выдаст монопольную блокировку для таблицы и параллелизма возможно. К сожалению полное протоколирование происходит, замедляет работу процесса.  
  
## <a name="examples"></a>Примеры  
  
### <a name="a-simple-dwloader-example"></a>A. Пример простого dwloader  
В следующем примере показан запуск **загрузчика** с только необходимые выбранными параметрами. Другие параметры, взяты из файла глобальной конфигурации, *loadparamfile.txt*.  
  
Пример использования проверки подлинности SQL Server.  
  
```  
--Load over Ethernet  
dwloader.exe -S 10.192.63.148 -U mylogin -P 123jkl -f /configfiles/loadparamfile.txt  
  
--Load over InfiniBand to appliance named MyPDW  
dwloader.exe -S MyPDW-SQLCTL01 -U mylogin -P 123jkl -f /configfiles/loadparamfile.txt  
```  
  
Тот же пример с использованием проверки подлинности Windows.  
  
```  
--Load over Ethernet  
dwloader.exe -S 10.192.63.148 -W -f /configfiles/loadparamfile.txt  
  
--Load over InfiniBand to appliance named MyPDW  
dwloader.exe -S MyPDW-SQLCTL01 -W -f /configfiles/loadparamfile.txt  
```  
  
Пример использования аргументов для исходного файла и файл ошибок.  
  
```  
--Load over Ethernet  
dwloader.exe -U mylogin -P 123jkl -S 10.192.63.148  -i C:\SQLData\AWDimEmployees.csv -T AdventureWorksPDW2012.dbo.DimEmployees -R C:\SQLData\LoadErrors  
```  
  
### <a name="b-load-data-into-an-adventureworks-table"></a>Б. Загрузка данных в таблицу AdventureWorks  
Следующий пример является частью пакетный скрипт, который загружает данные в **AdventureWorksPDW2012**.  Чтобы просмотреть полный скрипт, откройте файл aw_create.bat, который поставляется с **AdventureWorksPDW2012** пакет установки. 

<!-- Missing link
For more information, see [Install AdventureWorksPDW2012](install-adventureworkspdw2012.md).  
-->

Следующий фрагмент сценария использует dwloader для загрузки данных в таблицы в DimAccount и DimCurrency. Этот скрипт использует Ethernet-адрес. Если он использовал InfiniBand, сервер будет *< appliance_name >* `-SQLCTL01`.  
  
```  
set server=10.193.63.134  
set user=<MyUser>  
set password=<MyPassword>  
  
set schema=AdventureWorksPDW2012.dbo  
set load="C:\Program Files\Microsoft SQL Server Parallel Data Warehouse\100\dwloader.exe"  
set mode=reload  
  
--Loads data into the AdventureWorksPDW2012.dbo.DimAccount table  
--Source data is stored in the file DimAccount.txt,   
--which is in the current directory.  
  
set t1=DimAccount  
%load% -S %server% -E -M %mode% -e Utf16 -i .\%t1%.txt -T %schema%.%t1% -R %t1%.bad -t "|" -r \r\n -U %user% -P %password%   
  
--Loads data from the DimCurrency.txt file into  
--AdventureWorksPDW2012.dbo.DimCurrency  
set t1=DimCurrency  
%load% -S %server% -E -M %mode% -e Utf16 -i .\%t1%.txt -T %schema%.%t1% -R %t1%.bad -t "|" -r \r\n -U %user% -P %password%  
```  
  
Ниже приведен код DDL для таблиц в DimAccount.  
  
```  
CREATE TABLE DimAccount(  
AccountKey int NOT NULL,  
ParentAccountKey int,  
AccountCodeAlternateKey int,  
ParentAccountCodeAlternateKey int,  
AccountDescription nvarchar(50),  
AccountType nvarchar(50),  
Operator nvarchar(50),  
CustomMembers nvarchar(300),  
ValueType nvarchar(50),  
CustomMemberOptions nvarchar(200))  
with (CLUSTERED INDEX(AccountKey),  
DISTRIBUTION = REPLICATE);  
```  
  
Ниже приведен пример файла данных, DimAccount.txt, который содержит данные для загрузки в таблицу в DimAccount.  
  
```  
--Sample of data in the DimAccount.txt load file.  
  
1||1||Balance Sheet||~||Currency|  
2|1|10|1|Assets|Assets|+||Currency|  
3|2|110|10|Current Assets|Assets|+||Currency|  
4|3|1110|110|Cash|Assets|+||Currency|  
5|3|1120|110|Receivables|Assets|+||Currency|  
6|5|1130|1120|Trade Receivables|Assets|+||Currency|  
7|5|1140|1120|Other Receivables|Assets|+||Currency|  
8|3|1150|110|Allowance for Bad Debt|Assets|+||Currency|  
9|3|1160|110|Inventory|Assets|+||Currency|  
10|9|1162|1160|Raw Materials|Assets|+||Currency|  
11|9|1164|1160|Work in Process|Assets|+||Currency|  
12|9|1166|1160|Finished Goods|Assets|+||Currency|  
13|3|1170|110|Deferred Taxes|Assets|+||Currency|  
```  
  
### <a name="c-load-data-from-the-command-line"></a>В. Загрузка данных из командной строки  
Можно заменить сценарий в примере Б, введя в командной строке, все параметры, как показано в следующем примере.  
  
```  
C:\Program Files\Microsoft SQL Server Parallel Data Warehouse\100\dwloader.exe -S <Control node IP> -E -M reload -e UTF16 -i .\DimAccount.txt -T AdventureWorksPDW2012.dbo.DimAccount -R DimAccount.bad -t "|" -r \r\n -U <login> -P <password>  
```  
  
Описание параметров командной строки:  
  
-   *C:\Program Files\Microsoft SQL Server Parallel Data Warehouse\100\dwloader.exe* установленных расположение dwloader.exe.  
  
-   *-S* сопровождается IP-адрес узла управления.  
  
-   *-E* указывает загрузку пустые строки как NULL.  
  
-   *-M перезагрузить* Указывает усекаемое в целевую таблицу, прежде чем вставлять исходных данных.  
  
-   *-e UTF16* указывает исходный файл использует прямым порядком байтов типа кодировки символов.  
  
-   *-i.\DimAccount.txt* указывает данные в файл с именем DimAccount.txt, который существует в текущем каталоге.  
  
-   *-T AdventureWorksPDW2012.dbo.DimAccount* трехкомпонентного имя таблицы для получения данных.  
  
-   *-R DimAccount.bad* указывает строк, которые не удалось загрузить будет записываться в файл с именем DimAccount.bad.  
  
-   *-t «|»*  указывает поля во входном файле, DimAccount.txt, разделены символом вертикальной черты.  
  
-   *-r \r\n* указывает каждой строки в DimAccount.txt заканчивается символом возврата каретки и символ перевода строки.  
  
-   *-U < login_name > -P <password>*  указывает имя входа и пароль для имени входа с разрешениями для выполнения загрузки.  
  

<!-- MISSING LINK

## See Also  
[Common Metadata Query Examples](metadata-query-examples.md)  

-->
  
