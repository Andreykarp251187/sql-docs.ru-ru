---
title: Авто статистики (Analytics Platform System)
description: Описывается функция автоматической статистики, представленная в AU7 системы платформы аналитики.
author: mzaman1
manager: craigg
ms.prod: sql
ms.technology: data-warehouse
ms.topic: conceptual
ms.date: 06/27/2018
ms.author: murshedz
ms.reviewer: martinle
monikerRange: '>= aps-pdw-2016-au7 || = sqlallproducts-allversions'
ms.openlocfilehash: e48d40d78c25431fd6e5592dacfa410723b31f82
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63057067"
---
# <a name="configure-auto-statistics"></a>Настроить автоматическое статистики

Сведения о настройке параллельного хранилища данных, чтобы использовать автоматическое статистики для создания и обновления статистики автоматически.  Использовать эту возможность для усовершенствования планов запросов и тем самым повысить производительность запросов.

**Применимо к:** APS (начиная с 2016 AU7)

## <a name="what-are-statistics"></a>Что такое Статистика?
Статистика для оптимизации запросов — объекты, содержащие статистические сведения о распределении значений в один или несколько столбцов таблицы. Оптимизатор запросов использует эти статистические данные для оценки количества элементов или количество строк в запросе к. Эти оценки количества элементов позволяет оптимизатору запросов для создания плана запроса высокого качества. Например, в точках доступа использует оптимизатор запросов MPP, оценки количества элементов для выбора или в случайном порядке реплицировать меньшее из двух таблиц, используемых в предложении join и благодаря этому повысить производительность запросов.  Дополнительные сведения см. в разделе [статистики](../relational-databases/statistics/statistics.md) и [DBCC SHOW_STATISTICS](../t-sql/database-console-commands/dbcc-show-statistics-transact-sql.md)

## <a name="what-are-auto-statistics"></a>Что такое статистика автоматически?
Автоматическая статистика входит статистика, оптимизатор запросов создает и обновляет автоматически, чтобы улучшить план запроса. Статистика может устареть – после загрузки, операций вставки, обновления и удаляет операции. Без автоматической статистики необходимо выполнить анализ понять, какие столбцы должны статистики и когда нужно обновить статистику.

Автоматическая статистика включает в себя следующие три параметра: 

### <a name="autocreatestatistics"></a>AUTO_CREATE_STATISTICS
Если включен параметр AUTO_CREATE_STATISTICS, оптимизатор запросов при необходимости создает статистику по отдельным столбцам в предикате запроса, чтобы улучшить оценку кратности для плана запроса. Такая статистика по отдельным столбцам создается для столбцов, у которых отсутствует гистограмма в существующем объекте статистики.

### <a name="autoupdatestatistics"></a>AUTO_UPDATE_STATISTICS 
Если включен параметр AUTO_UPDATE_STATISTICS (автоматическое обновление статистики), то оптимизатор запросов определяет, когда статистика может оказаться устаревшей, и обновляет ее, если она используется в запросе. Статистика становится устаревшей, если операции вставки, обновления, удаления или слияния изменяют распределение данных в таблице или индексированном представлении. Оптимизатор запросов определяет, когда статистика может оказаться устаревшей, подсчитывая операции изменения данных с момента последнего обновления статистики и сравнивая количество изменений с пороговым значением. Пороговое значение основано на количестве строк в таблице или индексированном представлении.

### <a name="autoupdatestatisticsasync"></a>AUTO_UPDATE_STATISTICS_ASYNC
Параметр AUTO_UPDATE_STATISTICS_ASYNC, который управляет асинхронным обновлением статистики, определяет, какой режим обновления статистики (синхронный или асинхронный) использует оптимизатор запросов. ТД по умолчанию параметр асинхронного обновления статистики равен ON, и оптимизатор запросов обновляет статистику асинхронно. Параметр AUTO_UPDATE_STATISTICS_ASYNC применяется к объектам статистики, создаваемым для индексов, отдельных столбцов в предикатах запросов, и к статистике, создаваемой инструкцией CREATE STATISTICS.

## <a name="configuration-settings-for-system-administrators"></a>Параметры конфигурации для системных администраторов
После обновления до APS AU7, автоматическая статистика включена по умолчанию. Системный администратор может включить или отключить автоматическое статистики с [переключатель](appliance-feature-switch.md) параметр устройства Configuration Manager.  После включения пользователи могут изменять параметры статистики на базу данных.
Изменение значения параметра функция потребуется перезапустить службу на точках доступа.

## <a name="change-auto-statistics-settings-on-a-database"></a>Изменить параметры автоматической статистики в базе данных
При включении автоматической статистики системным администратором, можно использовать [ALTER DATABASE (Parallel Data Warehouse)](../t-sql/statements/alter-database-transact-sql.md?tabs=sqlpdw) для изменения параметров статистики в базе данных. Если параметр компонента автоматической статистики включено системным администратором, все новые базы данных, созданные после обновления до AU7 будет включена автоматическая статистика. Все базы данных, которые существовали до обновления до AU7 имеют автоматическое статистики отключен. В следующем примере включается автоматическое статистики в существующих myPDW базы данных.

```sql
ALTER DATABASE myPDW SET AUTO_CREATE_STATISTICS ON
ALTER DATABASE myPDW SET AUTO_UPDATE_STATISTICS ON 
ALTER DATABASE myPDW SET AUTO_UPDATE_STATISTICS_ASYNC ON
```
 
Параметр AUTO_UPDATE STATISTICS_ASYNC работает только в том случае, если параметр AUTO_UPDATE_STATISTICS установлен в ON.  Таким образом, что статистика не обновляется при включенном параметре AUTO_UPDATE_STATISTICS OFF и AUTO_UPDATE_STATISTICS_ASYNC имеет значение ON. 

### <a name="error-messages"></a>Сообщения об ошибках
Может появиться сообщение об ошибке «этот параметр не поддерживается в PDW».  Эта ошибка возникает, когда системный администратор не включил автоматическое статистики, и попытке задайте автоматического параметров статистики в инструкции ALTER DATABASE. 

### <a name="limitations-and-restrictions"></a>Ограничения
Автоматическая статистика не работает во внешних таблицах. 

### <a name="check-the-current-values"></a>Проверьте текущие значения
Следующий запрос возвращает текущие значения параметров автоматической статистики для всех баз данных.

```sql
SELECT NAME
    , IS_AUTO_CREATE_STATS_ON 
    , IS_AUTO_UPDATE_STATS_ON
    , IS_AUTO_UPDATE_STATS_ASYNC_ON
FROM
    sys.databases;
```

Возвращаемое значение 1 означает, что этот параметр включен, а 0 означает, что параметр выключен. 

## <a name="next-steps"></a>Следующие шаги
Выполнение запросов, см. в разделе [мониторинг активных запросов](monitoring-active-queries.md)
