---
title: С помощью промежуточной базы данных - Parallel Data Warehouse | Документация Майкрософт
description: SQL Server Parallel Data хранилища (PDW) использует промежуточной базы данных для хранения данных временно в процессе загрузки.
author: mzaman1
manager: craigg
ms.prod: sql
ms.technology: data-warehouse
ms.topic: conceptual
ms.date: 04/17/2018
ms.author: murshedz
ms.reviewer: martinle
ms.openlocfilehash: 52ede16185515c3df00ff21ece784d62eec984ef
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "63157690"
---
# <a name="using-a-staging-database-in-parallel-data-warehouse-pdw"></a>В Parallel Data Warehouse (PDW) с помощью промежуточной базы данных
SQL Server Parallel Data хранилища (PDW) использует промежуточной базы данных для хранения данных временно в процессе загрузки. По умолчанию SQL Server PDW использует целевую базу данных как промежуточную базу данных, что может привести к фрагментации таблицы. Чтобы снизить уровень фрагментации таблицы, можно создать промежуточную базу данных на определяемые пользователем. Или, при откат после сбоя загрузки не имеет значения, fastappend, в режиме загрузки можно использовать для улучшения производительности путем пропуска временной таблицы и загрузки непосредственно в целевую таблицу.  
  
## <a name="StagingDatabase"></a>Основы баз данных промежуточного хранения  
Объект *промежуточной базы данных* является базой PDW созданные пользователем, который хранит данные, время их загрузки в модуль. При указании промежуточной базы данных для загрузки устройства сначала копирует данные в промежуточной базе данных и затем копирует данные из временных таблиц в базе данных промежуточной постоянных таблиц в базе данных назначения.  
  
При промежуточной базы данных не указан для загрузки, SQL ServerPDW создает временные таблицы в целевой базе данных и использует их для хранения загруженных данных, прежде чем вставлять загруженные данные в постоянное целевые таблицы.  
  
При загрузке используется *режиме fastappend*, SQL ServerPDW пропускает использованию временных таблиц полностью и добавляет данные в целевой таблице. В режиме fastappend повышает производительность нагрузки ELT ситуациях, где данные загружаются в таблицу, которая является временной таблицы с точки зрения приложения. Например ELT-процесса может загрузить данные во временную таблицу, обработки данных, очистка и Отмена duping и затем вставьте данные в целевую таблицу фактов. В этом случае необязательно для PDW сначала загрузите данные во внутреннюю таблицу временный перед вставкой данных во временную таблицу для приложения. В режиме fastappend позволяет избежать шаг дополнительную нагрузку, что значительно повышает производительность загрузки. Для использования в режиме fastappend, необходимо использовать режим множественных транзакций, это означает, что восстановление после сбоя или прерванных нагрузки должен обрабатывать свои собственные процесса загрузки.  
  
**Преимущества промежуточной базы данных**  
  
Основное преимущество промежуточной базы данных — снизить уровень фрагментации таблицы. Если не используется промежуточной базы данных, данные загружается в временные таблицы в целевой базе данных. Когда временные таблицы получить создаются и удаляются в целевой базе данных, страницы временные таблицы и постоянных таблиц становятся с чередованием. Со временем фрагментация таблицы происходит и снижает производительность. Напротив промежуточную базу данных гарантирует, что временные таблицы создаются и удаляются в отдельном файле места, чем постоянных таблиц.  
  
**Структуры таблиц базы данных промежуточного хранения**  
  
Структуры хранения для каждой таблицы базы данных зависит от целевой таблицы.  
  
-   Для загрузки в кучу или кластеризованный индекс columnstore Промежуточная таблица является кучей.  
  
-   Для загрузки в кластеризованный индекс rowstore промежуточной таблицы является кластеризованным индексом rowstore.  
  
## <a name="Permissions"></a>Permissions  
Требуется разрешение CREATE (для создания временной таблицы) в промежуточной базе данных. 

<!-- MISSING LINKS

For more information, see [Grant Permissions to load data](grant-permissions-to-load-data.md).  

-->
  
## <a name="CreatingStagingDatabase"></a>Рекомендации по созданию промежуточной базы данных  
  
1.  Должно существовать только один промежуточную базу данных на устройство. Промежуточная база данных может совместно использоваться все задания нагрузки по всем базам данных назначения.  
  
2.  Размер промежуточной базы данных зависит от конкретного клиента. Изначально при первом заполнении устройства, промежуточной базы данных должен быть достаточно велик для хранения начальной загрузки заданий. Эти загрузить задания, как правило, чтобы быть большим, так как одновременно выполняются несколько загрузок. После завершения начальной загрузки заданий и система находится в рабочей среде, скорее всего уменьшить размер каждого задания нагрузки. При загрузке невелики, можно уменьшить размер промежуточной базы данных для размещения небольшого размера нагрузки. Чтобы уменьшить размер, можно удалить промежуточную базу данных и создать его заново с помощью выделения меньший размер, или воспользоваться [ALTER DATABASE](../t-sql/statements/alter-database-transact-sql.md?tabs=sqlpdw) инструкции.  
  
    При создании промежуточной базе данных, следуйте приведенным ниже рекомендациям.  
  
    -   Размер реплицированной таблицы должен быть предполагаемый размер, на каждом вычислительном узле, всех реплицированных таблиц, которые будут загружаться одновременно. Размер обычно составляет 25-30 ГБ.  
  
    -   Распределенная таблица размер должен быть предполагаемый размер, на устройство, распределенных таблиц, которые будут загружаться одновременно.  
  
    -   Размер журнала обычно похоже на размер реплицированной таблицы.  
  
## <a name="Examples"></a>Примеры  
  
### <a name="a-create-a-staging-database"></a>A. Создание промежуточной базы данных 
В следующем примере создается промежуточную базу данных Stagedb, для использования с все загрузки на устройстве. Предположим, что можно оценить, что пять реплицированные таблицы размером 5 ГБ будет загружаться одновременно. Этот параллелизма приводит выделение для реплицированных размер менее 25 ГБ. Предположим, что вам оценить, что шесть распределенных таблицах размеров 100, 200, 400, 500, 500 и 550 ГБ будет загружаться одновременно. Этот параллелизма приводит выделение по крайней мере 2250 ГБ для размера распределенную таблицу.  
  
```sql  
CREATE DATABASE Stagedb  
WITH (  
  
    AUTOGROW = ON,  
  
    REPLICATED_SIZE = 25 GB,  
  
    DISTRIBUTED_SIZE = 2250 GB,  
  
    LOG_SIZE = 25 GB  
  
);  
```  

<!-- MISSING LINKS
 
## See Also  
[Common metadata query examples](metadata-query-examples.md)  

-->
  
