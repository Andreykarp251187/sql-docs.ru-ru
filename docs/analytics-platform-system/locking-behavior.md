---
title: Режим блокировки - Parallel Data Warehouse | Документация Майкрософт
description: Узнайте, как Parallel Data Warehouse использует блокировки для обеспечения целостности транзакций и поддержания согласованности баз данных, когда несколько пользователей получают доступ к данным в то же время.
author: mzaman1
ms.prod: sql
ms.technology: data-warehouse
ms.topic: conceptual
ms.date: 04/17/2018
ms.author: murshedz
ms.reviewer: martinle
ms.openlocfilehash: d93743c83d6315e6ab9484445f344b06f80be845
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "67960645"
---
# <a name="locking-behavior-in-parallel-data-warehouse"></a>Режим блокировки в Parallel Data Warehouse
Узнайте, как Parallel Data Warehouse использует блокировки для обеспечения целостности транзакций и поддержания согласованности баз данных, когда несколько пользователей получают доступ к данным в то же время.  
  
## <a name="Basics"></a>Основы блокировки  
**Режимы**  
  
SQL Server PDW поддерживает четыре режима блокировки:  
  
Монопольно  
Монопольная блокировка запрещает запись или чтение из заблокированного объекта до транзакции, удерживающий завершения монопольная блокировка. Другие блокировки любой режима не разрешены, пока действует монопольная блокировка. Например DROP TABLE или CREATE DATABASE использовать монопольную блокировку.  
  
Shared  
Используется совмещаемая блокировка запрещает запуск монопольную блокировку того или иного объекта, но позволяет всеми другими режимами блокировки. Например инструкция SELECT инициирует совмещаемой блокировки и таким образом позволяет выполнять несколько запросов в параллельный доступ к выбранные данные, но предотвращает обновления для записи, чтения, до завершения инструкции SELECT.  
  
ExclusiveUpdate  
Осуществляет блокировку ExclusiveUpdate запрещает запись в объект с блокировкой, но разрешить чтение с помощью совмещаемой блокировки. Другие блокировки не разрешены, пока действует блокировку ExclusiveUpdate. Например резервное копирование и ВОССТАНОВЛЕНИЕ базы данных используйте блокировки монопольного обновления.  
  
SharedUpdate  
Блокировка SharedUpdate запрещает монопольное и ExclusiveUpdate режимов блокировки и позволяет Shared и sharedupdate для режимов блокировки объекта. SharedUpdate изменяет объект, но не ограничивает доступ для чтения к его во время изменения. Например, вставка и обновление использовать блокировка sharedupdate для.  
  
**Классы ресурсов**  
  
Блокировки удерживаются на следующие классы объектов: Базы данных, СХЕМЫ, ОБЪЕКТА (таблицы, представления или процедуры), приложение (для внутреннего использования), EXTERNALDATASOURCE EXTERNALFILEFORMAT и SCHEMARESOLUTION (Блокировка базы данных уровня выполненные при создание, изменение или удаление объектов схемы и пользователи базы данных). Эти классы объектов могут отображаться в столбце object_type [sys.dm_pdw_waits](../relational-databases/system-dynamic-management-views/sys-dm-pdw-waits-transact-sql.md).  
  
## <a name="Remarks"></a>Общие замечания  
Блокировки могут применяться для баз данных, таблиц или представлений.  
  
SQL Server PDW не реализует все уровни изоляции можно настроить. Он поддерживает уровень изоляции READ_UNCOMMITTED, как определено в стандарте ANSI. Тем не менее с момента считывания операции выполняются под READ_UNCOMMITTED, очень мало блокирующие операции фактически происходить или привести к конкуренции в системе.  
  
SQL Server PDW зависит от базовой системой SQL Server для реализации элемента управления блокировки и параллелизма. Если операции привести к базовой взаимоблокировки SQL Server на одном узле, SQL Server PDW использует возможности обнаружения взаимоблокировок SQL Server и завершается одной из инструкций блокировки.  
  
> [!NOTE]  
> SQL Server не поддерживает инструкции, которые ожидают блокировки, блокировка, новые запросы на блокировку. SQL Server PDW не полностью реализован этот процесс. В SQL Server PDW непрерывные запросы для новых общих блокировок иногда может блокировать предыдущего (но ожидающих) запрос монопольная блокировка. Например **обновление** инструкции (требуется монопольная блокировка) заблокированы из-за совмещаемые блокировки, которые предоставляются для ряда **ВЫБЕРИТЕ** инструкций. Чтобы устранить заблокированного процесса (определить, просмотрев [sys.dm_pdw_waits](../relational-databases/system-dynamic-management-views/sys-dm-pdw-waits-transact-sql.md) DVM), дальнейшая Отправка новых запросов, пока выполняется монопольная блокировка.  
  
## <a name="lock-definition-table"></a>Таблица определения блокировки  
SQL Server поддерживает следующие типы блокировок. Не все типы блокировки доступны на узле управления, но могут возникнуть на вычислительных узлах.  
  
-   Sch-S (стабильность схемы). Заверяет, что элемент схемы, такой как таблица или индекс, не будет удален до тех пор, пока сеанс связи удерживает блокировку стабильности схемы на данный элемент схемы.  
  
-   Sch-M (изменение схемы). Должен поддерживаться любым сеансом связи, во время которого предполагается изменить схему данного ресурса. Заверяет, что другие сеансы не имеют ссылок на обозначенный объект.  
  
-   S (общая). Удерживающему сеансу предоставлен коллективный доступ к ресурсу.  
  
-   U (обновления). Указывает блокировку обновления, полученную на ресурсы, которые со временем могут быть обновлены. Используется для предотвращения распространенной формы взаимоблокировки, которая происходит, если несколько сеансов блокируют ресурсы для возможного обновления в будущем.  
  
-   X (монопольная). Удерживающему сеансу предоставлен исключительный доступ к ресурсу.  
  
-   (С намерением совмещаемого доступа). Указывает намерение поместить блокировки типа S на некоторые подчиненные ресурсы в иерархии блокировок.  
  
-   IU (с намерением обновления). Указывает намерение поместить блокировки типа U на некоторые подчиненные ресурсы в иерархии блокировок.  
  
-   IX (с намерением монопольного доступа). Указывает намерение поместить блокировки типа X на некоторые подчиненные ресурсы в иерархии блокировок.  
  
-   SIU (общий с намерением обновления). Указывает коллективный доступ к ресурсу с намерением получения блокировок обновления на подчиненные ресурсы в иерархии блокировок.  
  
-   ШЕСТЬ (совместно используемые с намерением монопольного доступа). Указывает коллективный доступ к ресурсу с намерением получения монопольных блокировок на подчиненные ресурсы в иерархии блокировок.  
  
-   UIX (обновления с намерением монопольного доступа). Указывает блокировку обновления ресурса с намерением получения монопольных блокировок на подчиненные ресурсы в иерархии блокировок.  
  
-   BU. Используется для массовых операций.  
  
-   RangeS_S (Блокировка разделяемого диапазона ключей и разделяемых ресурсов). Указывает на последовательный просмотр диапазона.  
  
-   RangeS_U (Блокировка разделяемого диапазона ключей и обновляемых ресурсов). Указывает на последовательное сканирование обновления.  
  
-   RangeI_N (Блокировка вставляемого диапазона ключей и Null-ресурсов). Используется для проверки диапазонов, перед тем как вставить новый ключ в индекс.  
  
-   RangeI_S. Блокировка преобразования ключевого диапазона, созданная перекрытием блокировок RangeI_N и S.  
  
-   RangeI_U. Блокировка преобразования ключевого диапазона, созданная перекрытием блокировок RangeI_N и U.  
  
-   RangeI_X. Блокировка преобразования ключевого диапазона, созданная перекрытием блокировок RangeI_N и X.  
  
-   RangeX_S. Блокировка преобразования ключевого диапазона, созданная перекрытием блокировок RangeI_N и RangeS_S.  
  
-   RangeX_U. Блокировка преобразования ключевого диапазона, созданная перекрытием блокировок RangeI_N и RangeS_U.  
  
-   RangeX_X (исключающий ключевой диапазон и монопольных ресурсов блокировка). Блокировка диалога, используемая во время обновления ключа в диапазоне.  
  
## <a name="see-also"></a>См. также  
<!-- MISSING LINKS 
[Common Metadata Query Examples &#40;SQL Server PDW&#41;](../sqlpdw/common-metadata-query-examples-sql-server-pdw.md)  
-->
[sys.dm_pdw_waits](../relational-databases/system-dynamic-management-views/sys-dm-pdw-waits-transact-sql.md)  
  
