---
title: Управление рабочими нагрузками в Analytics Platform System | Документация Майкрософт
description: Управление рабочими нагрузками в Analytics Platform System.
author: mzaman1
manager: craigg
ms.prod: sql
ms.technology: data-warehouse
ms.topic: conceptual
ms.date: 04/17/2018
ms.author: murshedz
ms.reviewer: martinle
ms.openlocfilehash: 2281262c086f4d8dcab27debc8bb735ea5e8e1ba
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63157469"
---
# <a name="workload-management-in-analytics-platform-system"></a>Управление рабочими нагрузками в Analytics Platform System

Возможности управления рабочими нагрузками SQL Server PDW позволяют пользователям и администраторам для распределения запросов, чтобы предварительно задать конфигурация памяти и параллелизма. Используйте Управление рабочими нагрузками для повышения производительности рабочей нагрузки, согласованный или mixed, разрешив запросы на соответствующие ресурсы без навсегда замедляют выполнение любых запросов.  
  
Например с помощью методик управления рабочей нагрузки в SQL Server PDW, можно выполнить следующее.  
  
-   Выделения большого числа ресурсов, чтобы задание загрузки.  
  
-   Укажите дополнительные ресурсы для построения индекса columnstore.  
  
-   Устранение неполадок хэш-соединение медленно выполняющихся ли он требует большего объема памяти и предоставьте ему больше памяти.  
  
## <a name="Basics"></a>Основы управления рабочей нагрузки  
  
### <a name="key-terms"></a>Основные понятия  
Управление рабочими нагрузками  
*Управление рабочими нагрузками* является возможность и договориться загрузка ресурсов, чтобы обеспечить наилучшую производительность для параллельных запросов.  
  
Класс ресурсов  
В SQL Server PDW *класс ресурсов* является встроенной ролью сервера, имеет назначенный ограничения для параллелизма и памяти. SQL Server PDW выделяет ресурсы для запросов в соответствии с ресурсов класса членства в роли сервера входа, которое отправляет запросы.  
  
На вычислительных узлах в реализации классов ресурсов используется функция регулятора ресурсов в SQL Server. Дополнительные сведения о регуляторе ресурсов, см. в разделе [регулятора ресурсов](../relational-databases/resource-governor/resource-governor.md) на сайте MSDN.  
  
### <a name="understand-current-resource-utilization"></a>Понять, фактически используемых ресурсов  
Чтобы понять использование ресурсов системы для текущих запросов, используйте динамические административные представления SQL Server PDW. Например можно использовать динамические административные представления для понимания ли медленные большой хэш-соединение преимущество за счет большего объема памяти.  
  
<!-- MISSING LINKS
For examples, see [Common Metadata Query Examples &#40;SQL Server PDW&#41;](../sqlpdw/common-metadata-query-examples-sql-server-pdw.md).  
-->
  
### <a name="adjust-resource-allocations"></a>Настройка выделения ресурсов  
Чтобы настроить использование ресурсов, измените членство входа, которое Отправка запроса в классе ресурсов. Роли сервера класс ресурсов именуются **mediumrc**, **largerc**, и **xlargerc**. Средний, большой и очень крупный выделений они представляют соответственно.  
  
Например, чтобы выделить большой объем системных ресурсов для запроса, добавьте имя входа отправляет запрос на **largerc** роли сервера. Инструкцию ALTER SERVER ROLE добавляет Анна имени входа к роли сервера largerc.  
  
```sql  
ALTER SERVER ROLE largerc ADD MEMBER Anna;  
```  
  
## <a name="RC"></a>Описания класса ресурсов  
Ниже перечислены классы ресурсов и выделения ресурсов системы.  
  
|Класс ресурсов|Важность запроса|Максимальный объем памяти использования *|Слоты выдачи (максимальное = 32)|Описание|  
|------------------|----------------------|--------------------------|---------------------------------------|---------------|  
|значение по умолчанию|Средний|400 МБ|1|По умолчанию каждого имени входа разрешен небольшой объем памяти и параллелизма ресурсов для запросов.<br /><br />Когда имя входа добавляется в класс ресурсов, новый класс имеет приоритет. При удалении имени входа из всех классов ресурсов, имя входа возвращается выделение ресурсов по умолчанию.|  
|MediumRC|Средний|1200 МБ|3|Примеры запросов, которые могут понадобиться класса средних ресурсов:<br /><br />CTAS операций, которые имеют большие хэш-соединения.<br /><br />ВЫБЕРИТЕ операции, которые требуется больше памяти, чтобы избежать кэширования на диск.<br /><br />Загрузка данных в кластеризованных индексах columnstore.<br /><br />Сборки, перестроения и реорганизации кластеризованные индексы columnstore для небольших таблиц, содержащих столбцы 10 – 15.|  
|Largerc|Высокий|2,8 ГБ|7|Примеры запросов, которые могут понадобиться большой класс ресурсов:<br /><br />Очень большие операции CTAS, огромный хэш-соединения, или содержит больших статистических выражений, таких как большие предложения ORDER BY или GROUP BY.<br /><br />ВЫБЕРИТЕ операции, которые требуются большие объемы памяти для операций, таких как хэш-соединения или агрегатов, таких как предложения ORDER BY или GROUP BY<br /><br />Загрузка данных в кластеризованных индексах columnstore.<br /><br />Сборки, перестроения и реорганизации кластеризованные индексы columnstore для небольших таблиц, содержащих столбцы 10 – 15.|  
|xlargerc|Высокий|8.4 ГБ|22|Класс очень больших ресурсов предназначен для запросов, которые могут потребовать использования очень больших ресурсов во время выполнения.|  
  
<sup>*</sup>Максимальный объем памяти является приблизительным.  
  
### <a name="request-importance"></a>Важность запроса  
Важность запроса сопоставляет количество времени ЦП, что SQL Server, на вычислительных узлах, даст на запросы.  Запросы с высоким приоритетом получать больше времени центрального Процессора.  
  
### <a name="maximum-memory-usage"></a>Максимальный объем памяти  
Максимальный объем памяти — это максимальный объем доступной памяти, которые может использовать запрос в каждом пространстве обработки. Например mediumrc запрос можно использовать до 1200 МБ для обработки в пределах каждого распределения. По-прежнему важно убедиться, что данные распределены неравномерно не Чтобы избежать необходимости выполнять большую часть работы некоторых дистрибутивов.  
  
### <a name="concurrency-slots"></a>Слоты выдачи  
Цель распределения 1, 3, 7 и 22 слоты выдачи — разрешить больших и маленьких выполнение в то же время, без блокировки небольших процесс, пока выполняется большой процесс процессов.  Например SQL Server PDW можно выделить не более 32 слотов для запуска 1 запрос очень крупный (22 слоты), 1 большой запрос (7 слоты) и 1 средних запрос (3 слоты), в то же время.  
  
Примеры выделение до 32 слотов для параллельных запросов:  
  
-   28 слотов = 4 больших  
  
-   30 слотов = 10 средний  
  
-   Слоты 32 = 32 по умолчанию  
  
-   Слоты 32 = очень крупный 1 + 1 средний, большой + 1  
  
-   Слоты 32 = 2-средний больших + 4 + 6 по умолчанию  
  
Предположим, что 6 большие запросы отправляются к SQL Server PDW, а затем отправляются 10 запросов по умолчанию. SQL Server PDW будет обрабатывать запросы в порядке приоритета следующим образом:  
  
-   Выделить 28 слотов для запуска обработки 4 больших запросов, как память становится доступной и сохраните 2 больших запросов в очереди.  
  
-   Выделить 4 слота для запуска обработки 4 запроса по умолчанию и храните 6 запросов по умолчанию в очереди ожидания.  
  
Как завершить запросов и слотов становятся доступными, SQL Server PDW выделит оставшихся запросов в соответствии с доступными ресурсами и приоритетом. Например при наличии 7 откройте слотов параллелизма, ожидания больших запросов будет иметь более высокий приоритет для 7 слотов не дожидаться, пока средних запросов.  Если открыть 6 слотов, SQL Server PDW выделит 6 больше запросов, размером по умолчанию. Тем не менее слотов параллелизма и памяти должны все быть доступны до SQL Server PDW позволяет запрос на запуск.  
  
В каждом классе ресурсов запросы выполняются в первым в порядке ФИФО (FIFO).  
  
## <a name="GeneralRemarks"></a>Общие замечания  
Если имя входа является членом более одного класса ресурсов, класс с больше всего ресурсов имеет приоритет.  
  
При добавлении имени входа или удалены из класса ресурсов, изменения вступят в силу немедленно для всех будущих запросах; текущие запросы, которые беготни или ожидания не затрагиваются. Имя входа не требуется отключиться и подключиться выполнился изменение должно происходить.  
  
Для каждого имени входа параметры класса ресурсов применяются для отдельных инструкций и операций, а не к сеансу.  
  
Перед выполнением инструкции SQL Server PDW, он пытается получить слотов, необходимые для запроса. Если он не может получить достаточное число слотов, SQL Server PDW переводит запрос в состояние ожидания выполнения. Все системные ресурсы, уже были выделены на запрос возвращаются обратно в систему.  
  
Большинство инструкций SQL, которые всегда требуют распределения ресурсов по умолчанию и таким образом не управляются классами ресурсов. Например CREATE LOGIN только необходимо небольшое ресурсов и выделяется ресурсы по умолчанию, даже если вызова CREATE LOGIN имя входа является членом класса ресурсов.  Например если Кирилл является членом класса ресурсов largerc и она отправляет инструкцию CREATE LOGIN, инструкции CREATE LOGIN, запускаются с по умолчанию количество ресурсов.  
  
Инструкции SQL и операции, регулируемые классами ресурсов:  
  
-   ALTER INDEX REBUILD  
  
-   ALTER INDEX REORGANIZE  
  
-   ВОССТАНОВЛЕНИЕ ТАБЛИЦЫ ALTER  
  
-   СОЗДАНИЕ КЛАСТЕРИЗОВАННОГО ИНДЕКСА  
  
-   СОЗДАНИЕ КЛАСТЕРИЗОВАННОГО ИНДЕКСА COLUMNSTORE  
  
-   CREATE TABLE AS SELECT  
  
-   CREATE REMOTE TABLE AS SELECT  
  
-   Загрузка данных с помощью **dwloader**.  
  
-   INSERT-SELECT  
  
-   UPDATE  
  
-   DELETE  
  
-   ВОССТАНОВЛЕНИЕ базы данных при восстановлении в на устройство с больше вычислительных узлов.  
  
-   ВЫБЕРИТЕ, за исключением запросов только на динамическое административное Представление  
  
## <a name="Limits"></a>Ограничения  
Классы ресурсов управляют выделений памяти и параллелизма.  Они не определяют операции ввода вывода.  
  
## <a name="Metadata"></a>Метаданные  
Динамические административные представления, содержащие сведения о классах ресурсов и члены классов ресурсов.  
  
-   [sys.server_role_members](../relational-databases/system-catalog-views/sys-server-role-members-transact-sql.md)  
  
-   [sys.server_principals](../relational-databases/system-catalog-views/sys-server-principals-transact-sql.md)  
  
Динамические административные представления, которые содержат сведения о состоянии запросов и необходимые им ресурсы:  
  
-   [sys.dm_pdw_lock_waits](../relational-databases/system-dynamic-management-views/sys-dm-pdw-lock-waits-transact-sql.md)  
  
-   [sys.dm_pdw_resource_waits](../relational-databases/system-dynamic-management-views/sys-dm-pdw-resource-waits-transact-sql.md)  
  
Связанные системные представления из динамических административных представлений SQL Server на вычислительных узлах. См. в разделе [динамические административные представления SQL Server](../relational-databases/system-dynamic-management-views/system-dynamic-management-views.md) ссылки на эти динамические административные представления на сайте MSDN.  
  
-   sys.dm_pdw_nodes_resource_governor_resource_pools  
  
-   sys.dm_pdw_nodes_resource_governor_workload_groups  
  
-   sys.dm_pdw_nodes_resource_governor_resource_pools  
  
-   sys.dm_pdw_nodws_resource_governor_workload_groups  
  
-   sys.dm_pdw_nodes_exec_sessions  
  
-   sys.dm_pdw_nodes_exec_requests  
  
-   sys.dm_pdw_nodes_exec_query_memory_grants  
  
-   sys.dm_pdw_nodes_exec_query_resource_semaphores  
  
-   sys.dm_pdw_nodes_os_memory_brokers  
  
-   sys.dm_pdw_nodes_os_memory_cache_entries  
  
-   sys.dm_pdw_nodes_exec_cached_plans  
  
## <a name="RelatedTasks"></a>Связанные задачи  
[Задача управления рабочими нагрузками](workload-management-tasks.md)  
  
<!-- MISSING LINKS
See the Workload Management section of [Common Metadata Query Examples &#40;SQL Server PDW&#41;](../sqlpdw/common-metadata-query-examples-sql-server-pdw.md) for the following tasks:  
  
1.  Find the number of active requests for each resource group.  
  
2.  Determine if my requests need more memory  
  
3.  Determine if there are a high number of query optimizations or suboptimal plan generations.  
  
4.  Determine Average CPU time per request in each resource pool to date  
  
## See Also  
[Common Metadata Query Examples &#40;SQL Server PDW&#41;](../sqlpdw/common-metadata-query-examples-sql-server-pdw.md)  
-->
  
