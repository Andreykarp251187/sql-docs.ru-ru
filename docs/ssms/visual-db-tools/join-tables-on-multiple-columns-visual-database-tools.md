---
title: Соединение таблиц по нескольким столбцам (визуальные инструменты для баз данных) | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: sql-tools
ms.reviewer: ''
ms.technology: ssms
ms.topic: conceptual
helpviewer_keywords:
- multiple column joins
- joins [SQL Server], multiple columns
ms.assetid: 56a158bc-a42a-4b78-baad-4721d2d22cd3
author: markingmyname
ms.author: maghan
manager: craigg
ms.openlocfilehash: 88208446cbdde6643d65ec804ccddbd125dc1e5b
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "65096869"
---
# <a name="join-tables-on-multiple-columns-visual-database-tools"></a>Соединение таблиц по нескольким столбцам (визуальные инструменты для баз данных)
[!INCLUDE[appliesto-ss-asdb-asdw-pdw-md](../../includes/appliesto-ss-asdb-asdw-pdw-md.md)]
Таблицы можно соединять по нескольким столбцам. То есть можно создать запрос, который будет сопоставлять строки из двух таблиц, только если они удовлетворяют нескольким условиям. Если база данных содержит связь, которая сопоставляет несколько столбцов с внешними ключами в одной таблице первичному ключу из нескольких столбцов в другой, эту связь можно использовать для соединения по нескольким столбцам. Дополнительные сведения см. в статье [Автоматическое соединение таблиц (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/join-tables-automatically-visual-database-tools.md).  
  
Даже если база данных не содержит связь с несколькими внешними ключами, соединение можно создать вручную.  
  
### <a name="to-manually-create-a-multicolumn-join"></a>Самостоятельное создание соединения по нескольким столбцам  
  
1.  Добавьте на [панель диаграммы](../../ssms/visual-db-tools/diagram-pane-visual-database-tools.md) таблицы, которые нужно соединить.  
  
2.  Перетащите имя первого столбца соединения из окна первой таблицы на соответствующий столбец в окне второй таблицы. Соединение нельзя основывать на столбцах типа text, ntext или image.  
  
    > [!NOTE]  
    > Обычно столбцы соединения должны быть одного типа данных (или совместимых типов). Например, если столбец соединения в первой таблице содержит дату, его нужно связать со столбцом второй таблицы, также содержащем дату. С другой стороны, если первый столбец соединения содержит целые числа, связываемый с ним столбец также должен относиться к целочисленному типу данных, однако размер у него может быть другим. Однако могут быть случаи, когда благодаря неявному преобразованию типов можно соединить внешне несовместимые столбцы.  
    >   
    > [Конструктор запросов и представлений](../../ssms/visual-db-tools/query-and-view-designer-tools-visual-database-tools.md) не будет проверять типы данных соединяемых столбцов, но при выполнении запроса база данных отобразит ошибку, если типы данных несовместимы.  
  
3.  Перетащите имя второго столбца соединения из окна первой таблицы на соответствующий столбец в окне второй таблицы.  
  
4.  Повторите шаг 3 для всех пар соединяемых столбцов в таблицах.  
  
5.  Выполните запрос.  
  
## <a name="see-also"></a>См. также:  
[Запросы с соединениями (визуальные инструменты для баз данных)](../../ssms/visual-db-tools/query-with-joins-visual-database-tools.md)  
  
