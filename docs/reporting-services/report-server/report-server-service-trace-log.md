---
title: Журнал трассировки службы сервера отчетов
ms.prod: reporting-services
ms.prod_service: reporting-services-native
ms.technology: report-server
ms.topic: conceptual
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.reviewer: ''
ms.custom: ''
ms.date: 04/23/2019
ms.openlocfilehash: d1efc5b57191ec17f610206115743b656d58d4b3
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MTE75
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "65581389"
---
# <a name="report-server-service-trace-log"></a>Журнал трассировки службы сервера отчетов

Журналы трассировки сервера отчетов [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] представляют собой текстовый ASCII-файл, содержащий подробные сведения об операциях служб сервера отчетов.  Эти файлы включают сведения об операциях, выполняемых веб-службой сервера отчетов, веб-порталом и в процессе фоновой обработки. Файл журнала трассировки содержит избыточные сведения, которые записываются в другие файлы журналов, а также дополнительные сведения, недоступные иным способом. Данные журнала трассировки могут оказаться полезными при отладке приложения, содержащего сервер отчетов, либо при изучении конкретной проблемы, зафиксированной в журнале событий или журнале выполнения. Например, при устранении неполадок с подписками.  

## <a name="bkmk_view_log"></a> Где находятся файлы журналов сервера отчетов?

Файлы журнала трассировки `ReportServerService_<timestamp>.log` и `Microsoft.ReportingServices.Portal.WebHost_<timestamp>.log` находятся в следующей папке:

`C:\Program Files\Microsoft SQL Server\MSRS13.MSSQLSERVER\Reporting Services\LogFiles` 

Журналы трассировки создаются ежедневно. При этом первая запись создается после полуночи (по местному времени) и каждый раз при перезапуске службы. Отметки времени создаются на основе времени по Гринвичу (UTC). Этот файл имеет формат EN-US. По умолчанию размер журналов трассировки ограничен 32 МБ, а срок их хранения — 14 дней.  

## <a name="bkmk_trace_configuration_settings"></a> Параметры конфигурации трассировки

Поведение журнала трассировки настраивается в файле конфигурации **ReportingServicesService.exe.config**. Файл конфигурации расположен в следующей папке:  
  
 `\Program Files\Microsoft SQL Server\MSRS13.<instance name>\Reporting Services\ReportServer\bin`.  
  
 Следующий пример иллюстрирует XML-структуру параметров **RStrace** . Значение параметра **DefaultTraceSwitch** определяет тип информации, добавляемой в журнал. За исключением атрибута **Components** , значения для настройки **RStrace** одни и те же в разных файлах конфигурации.  
  
```
  \<system.diagnostics>
    <switches>
      <add name="DefaultTraceSwitch" value="3" />
    </switches>
  \</system.diagnostics>
  <RStrace>
    <add name="FileName" value="ReportServerService_" />
    <add name="FileSizeLimitMb" value="32" />
    <add name="KeepFilesForDays" value="14" />
    <add name="Prefix" value="appdomain, tid, time" />
    <add name="TraceListeners" value="file" />
    <add name="TraceFileMode" value="unique" />
    <add name="Components" value="all:3" />
  </RStrace>
```  
  
 Сведения об отдельных настройках приведены в следующей таблице.  
  
|Настройка|Описание|Значения|  
|-------------|-----------------|------------|  
|**RStrace**|Задает пространства имен для ошибок и трассировки.||  
|**DefaultTraceSwitch**|Задает уровень данных, записываемых в журнал трассировки ReportServerService. Каждый уровень содержит данные, передаваемые более низкими уровнями. Отключать трассировку не рекомендуется.|Допустимые значения:<br /><br /> <br /><br /> 0 = Отключить трассировку Файл журнала ReportServerService.exe включен по умолчанию. Чтобы отключить его, установите уровень трассировки равным 0.<br /><br /> 1 = Исключения и перезапуски<br /><br /> 2 = Исключения, перезапуски, предупреждения<br /><br /> 3 = Исключения, перезапуски, предупреждения, сообщения о состоянии (по умолчанию)<br /><br /> 4 = Подробный режим|  
|**FileName**|Задает первую часть имени файла журнала. Вторую часть имени определяет значение, заданное в аргументе **Prefix** .||  
|**FileSizeLimitMb**|Задает максимальный размер журнала трассировки. Размер измеряется в мегабайтах.<br /><br /> Размером файла можно управлять, устанавливая уровни трассировки (от 0 до 4), чтобы управлять объемом записываемого содержимого. Можно также указать, какие компоненты отслеживать. Если размер файла журнала достигнет максимума до истечения 14 дней срока действия, старые записи будут перезаписываться новыми.|Допустимые значения: от 0 до максимально допустимого целого числа. Значение по умолчанию: 32. При указании значения 0 или отрицательного числа сервер отчетов воспримет их как 1.|  
|**KeepFilesForDays**|Определяет, через сколько дней журнал трассировки будет удален.|Допустимые значения: от 0 до максимально допустимого целого числа. Значение по умолчанию: 14. При указании значения 0 или отрицательного числа сервер отчетов воспримет их как 1.|  
|**Prefix**|Задает формируемое значение, позволяющее отличить один экземпляр журнала от другого.|По умолчанию к именам файлов журнала трассировки добавляются значения отметок времени. Значение этой величины — "appdomain, tid, time". Не изменяйте этот параметр.|  
|**TraceListeners**|Задает, куда будет выводиться содержимое журнала трассировки. Можно через запятую задать несколько расположений.|Допустимые значения:<br /><br /> <br /><br /> DebugWindow<br /><br /> File (по умолчанию)<br /><br /> StdOut|  
|**TraceFileMode**|Определяет, содержат ли журналы трассировки данные за 24-часовой период. Необходимо, чтобы каждому компоненту за каждый день соответствовал один уникальный журнал трассировки.|Значение этой величины — Unique (по умолчанию). Не изменяйте это значение.|  
|**Категории компонентов**|Указывает компоненты, для которых формируется информация журнала трассировки, и уровень трассировки в следующем формате:<br /><br /> \<категория компонентов>:\<уровень_трассировки><br /><br /> Можно указать все или некоторые компоненты (**all**, **RunningJobs**, **SemanticQueryEngine**, **SemanticModelGenerator**). Если нежелательно формировать информацию для конкретного компонента, можно отключить его трассировку (например, «SemanticModelGenerator:0»). Не отключайте трассировку для компонента **all**.<br /><br /> Можно установить «SemanticQueryEngine:4», если желательно видеть инструкции Transact-SQL, формируемые для каждого семантического запроса. Инструкции Transact-SQL записываются в журнал трассировки. Следующий пример иллюстрирует настройку конфигурации, которая добавляет в журнал инструкции Transact-SQL:<br /><br /> \<add name="Components" value="all,SemanticQueryEngine:4" />|Категории компонентов можно задать следующим образом:<br /><br /> <br /><br /> Параметр**All** используется для трассировки общей активности сервера отчетов для всех процессов, которые не разбиваются на конкретные категории.<br /><br /> Параметр**RunningJobs** применяется для трассировки формирования отчета или операции подписки.<br /><br /> Параметр**SemanticQueryEngine** используется для трассировки семантических запросов, которые обрабатываются, когда пользователь проводит нерегламентированный просмотр данных отчета на основе моделей.<br /><br /> Параметр**SemanticModelGenerator** применяется для трассировки формирования модели.<br /><br /> Параметр**http** используется для включения файла журнала HTTP сервера отчетов. Дополнительные сведения см. в разделе [Report Server HTTP Log](../../reporting-services/report-server/report-server-http-log.md).|  
|Значение **уровня трассировки** для категорий компонентов|\<категория компонентов>:\<уровень_трассировки><br /><br /> <br /><br /> Если уровень трассировки компонента не указан, используется значение, указанное для параметра **DefaultTraceSwitch** . Например, если указать «all,RunningJobs,SemanticQueryEngine,SemanticModelGenerator», то для всех компонентов будет использоваться уровень трассировки по умолчанию.|Допустимыми значениями уровня трассировки являются следующие.<br /><br /> <br /><br /> 0 = Отключить трассировку<br /><br /> 1 = Исключения и перезапуски<br /><br /> 2 = Исключения, перезапуски, предупреждения<br /><br /> 3 = Исключения, перезапуски, предупреждения, сообщения о состоянии (по умолчанию)<br /><br /> 4 = Подробный режим<br /><br /> Значение по умолчанию для сервера отчетов: "all:3".|  
  
## <a name="bkmk_add_custom"></a> Добавление настроек пользовательской конфигурации для указания местоположения файла дампа  
Можно добавить пользовательскую настройку для задания местоположения, которое программа «Доктор Ватсон" для Windows использует для хранения файлов дампа. Пользовательское значение равно **Directory**. Следующий пример иллюстрирует, как эта настройка конфигурации указывается в разделе **RStrace** :  

```
<add name="Directory" value="U:\logs\" />  
```  
  
Дополнительные сведения см. в статье [913046 базы знаний](https://support.microsoft.com/?kbid=913046) на сайте [!INCLUDE[msCoName](../../includes/msconame-md.md)] .  
  
##  <a name="bkmk_log_file_fields"></a> Поля файла журнала

В журнале трассировки содержатся следующие данные:  
  
- сведения о системе, в том числе операционной системе, ее версии, числе процессоров и памяти;  
  
- [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] ;  
  
- события, регистрируемые в журнале приложений;  
  
- исключения, формируемые сервером отчетов;  
  
- предупреждения о нехватке ресурсов, регистрируемые сервером отчетов;  
  
- входящие пакеты SOAP и сводные исходящие пакеты SOAP;  
  
- сведения о заголовке HTTP, трассировке стека и трассировки при отладке.  
  
 Можно просмотреть сведения в журнале трассировки, чтобы определить, была ли выполнена доставка отчета, кто его получил, и сколько попыток доставки было сделано. Журналы трассировки также фиксируют операции при выполнении отчетов и переменные окружения, действующие при обработке отчетов. Ошибки и исключения также записываются в журналы трассировки. Например, можно узнать об ошибках превышения времени ожидания (отображаемых как записи **ThreadAbortExceptions** ).  

## <a name="previous-versions"></a>Предыдущие версии

В предыдущих версиях [!INCLUDE[ssRSnoversion_md](../../includes/ssrsnoversion-md.md)]имелось несколько журналов трассировки, по одному на каждое приложение. Следующие файлы устарели и больше не создаются в [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] и последующих версиях:
+ ReportServerWebApp_ *\<метка_времени>* .log
+ ReportServer_ *\<метка_времени>* .log
+ ReportServerService_main_ *\<метка_времени>* .log
  
## <a name="see-also"></a>См. также раздел

- [Файлы и источники журналов Reporting Services](../../reporting-services/report-server/reporting-services-log-files-and-sources.md)   
- [Справочник по ошибкам и событиям (службы Reporting Services)](../../reporting-services/troubleshooting/errors-and-events-reference-reporting-services.md)  

Остались вопросы? [Посетите форум служб Reporting Services](https://go.microsoft.com/fwlink/?LinkId=620231)