---
title: Ссылки на коллекцию ReportItems (построитель отчетов) | Документация Майкрософт
ms.date: 03/01/2017
ms.prod: reporting-services
ms.prod_service: reporting-services-native
ms.technology: report-design
ms.topic: conceptual
ms.assetid: edc0c75f-0530-4e6d-85aa-3385301bfd00
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: e8819e97cbece0ab9682252c3afdedee7d671428
ms.sourcegitcommit: ff82f3260ff79ed860a7a58f54ff7f0594851e6b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/29/2020
ms.locfileid: "77081888"
---
# <a name="built-in-collections---reportitems-collection-references-report-builder"></a>Встроенные коллекции — ссылки на коллекцию ReportItems (построитель отчетов)
  Встроенная коллекция **ReportItems** является набором текстовых полей из элементов отчета, например строк области данных или текстовых полей в области конструктора отчетов. Коллекция **ReportItems** включает текстовые поля, находящиеся в текущей области верхнего колонтитула, нижнего колонтитула или текста отчета. Эта коллекция определяется во время выполнения обработчика отчетов и модуля подготовки отчетов. Текущая область изменяется после успешного объединения обработчиком отчетов данных отчета и элементов макета элементов отчета, когда пользователь просматривает страницы отчета. Встроенная коллекция **ReportItems** может использоваться для формирования верхних колонтитулов страницы в стиле словаря, отображающих первый и последний элемент на каждой странице.  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
## <a name="using-the-reportitems-value-property"></a>Использования свойства значения ReportItems  
 Элементы коллекции **ReportItems** имеют только одно свойство: Value. Значение элемента **ReportItems** может использоваться для отображения или вычисления данных из другого поля отчета. Чтобы получить доступ к значению текущего текстового поля, можно использовать встроенное в [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] глобальное выражение Me.Value или просто Value. Однако в функциях отчета, таких как First и агрегатных функциях, необходимо использовать полный синтаксис.  
  
 Пример:  
  
-   Это выражение, помещенное в текстовое поле, отображает значение текстового поля **ReportItem** с именем `Textbox1`:  
  
     `=ReportItems!Textbox1.Value`  
  
-   Это выражение, помещенное в текстовое поле **ReportItem** свойства Color, отображает текст черным цветом, если значение > 0, в противном случае — красным:  
  
     `=IIF(Me.Value > 0,"Black","Red")`  
  
-   Это выражение, помещенное в текстовое поле верхнего или нижнего колонтитула, отображает на каждой странице отчета, готового для просмотра, первое значение текстового поля `LastName`:  
  
     `=First(ReportItems("LastName").Value)`  
  
## <a name="dictionary-style-page-header-expressions"></a>Выражения колонтитулов в стиле словаря  
 Можно создать верхний колонтитул, который будет отображать на странице первого и последнего клиентов. Так как текстовое поле в верхнем колонтитуле может ссылаться на встроенную коллекцию **ReportItems** только один раз в выражении, необходимо добавить в верхний колонтитул два текстовых поля: одно для имени первого клиента (`=First(ReportItems!textboxLastName.Value`), второе для имени последнего клиента (`=Last(ReportItems!textboxLastName.Value`).  
  
 В разделе верхнего или нижнего колонтитула только текстовые поля текущей страницы доступны как члены коллекции **ReportItems** . Например, если выражение `ReportItems!textboxLastName.Value` ссылается на текстовое поле, которое появляется только на первой странице многостраничной области данных, значение видно для первой страницы, но на всех других страницах отображается **#Ошибка** , показывая, что выражение не может быть оценено в том виде, в каком оно записано.  
  
## <a name="scope-for-the-reportitems-collection"></a>Область коллекции ReportItems  
 При выполнении отчета каждое текстовое поле в теле отчета или в области данных оценивается в контексте его набора данных, области данных и взаимосвязей групп. Областью для ссылки на коллекцию **ReportItems** является текущая область или любая точка, находящаяся выше текущей области.  
  
 Например, текстовое поле в строке, находящейся в родительской группе, не должно содержать выражение, ссылающееся на имя текстового поля в строке дочерней группы. Результат вычисления такого выражения отличается от значения в отчете, т. к. текстовое поле дочерней строки расположено вне этой области. Дополнительные сведения см. в разделах [Справочник по агрегатным функциям (построитель отчетов и службы SSRS)](../../reporting-services/report-design/report-builder-functions-aggregate-functions-reference.md).  
  
## <a name="see-also"></a>См. также:  
 [Встроенные коллекции в выражениях (построитель отчетов и службы SSRS)](../../reporting-services/report-design/built-in-collections-in-expressions-report-builder.md)   
 [Примеры выражений (построитель отчетов и службы SSRS)](../../reporting-services/report-design/expression-examples-report-builder-and-ssrs.md)   
 [Разбиение на страницы в службах Reporting Services (построитель отчетов и службы SSRS)](../../reporting-services/report-design/pagination-in-reporting-services-report-builder-and-ssrs.md)   
 [Фильтрация, группирование и сортировка данных (построитель отчетов и службы SSRS)](../../reporting-services/report-design/filter-group-and-sort-data-report-builder-and-ssrs.md)  
  
  
