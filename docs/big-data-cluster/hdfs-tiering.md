---
title: Настройка уровней HDFS
titleSuffix: SQL Server big data clusters
description: В этой статье объясняется, как настроить уровни HDFS для подключения внешней Azure Data Lake Storage файловой системы к HDFS в кластере SQL Server 2019 больших данных (Предварительная версия).
author: nelgson
ms.author: negust
ms.reviewer: mikeray
ms.date: 07/24/2019
ms.topic: conceptual
ms.prod: sql
ms.technology: big-data-cluster
ms.openlocfilehash: 17eedf9f0797a0adb5eda6ca8ee090fc762e1491
ms.sourcegitcommit: 1f222ef903e6aa0bd1b14d3df031eb04ce775154
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/23/2019
ms.locfileid: "68419375"
---
# <a name="configure-hdfs-tiering-on-sql-server-big-data-clusters"></a>Настройка уровней HDFS на SQL Server кластерах больших данных

[!INCLUDE[tsql-appliesto-ssver15-xxxx-xxxx-xxx](../includes/tsql-appliesto-ssver15-xxxx-xxxx-xxx.md)]

Распределение по уровням HDFS обеспечивает возможность подключения внешней, HDFS-совместимой файловой системы в HDFS. В этой статье объясняется, как настроить распределение по уровням HDFS для кластеров больших данных SQL Server 2019 (Предварительная версия). В настоящее время мы поддерживаем подключение к Azure Data Lake Storage 2-го поколения и Amazon S3. 

## <a name="hdfs-tiering-overview"></a>Обзор уровней HDFS

Благодаря распределению по уровням приложения могут легко получать доступ к данным во множестве внешних хранилищ, как будто данные находятся в локальной системе HDFS. Подключение — это операция с метаданными, в которой метаданные, описывающие пространство имен во внешней файловой системе, копируются в локальный HDFS. Эти метаданные содержат сведения о внешних каталогах и файлах вместе с их разрешениями и ACL. Соответствующие данные копируются по требованию, когда доступ к данным осуществляется через, например, с помощью запроса. Теперь доступ к внешним данным файловой системы можно получить из SQL Server кластера больших данных. Вы можете выполнять задания Spark и SQL-запросы к этим данным так же, как и при работе с любыми локальными данными, хранящимися в HDFS в кластере.

### <a name="caching"></a>Caching
Сегодня по умолчанию 1% общего хранилища HDFS будет зарезервировано для кэширования подключенных данных. Кэширование является глобальным параметром для подключений.

> [!NOTE]
> Распределение по уровням HDFS — это функция, разработанная корпорацией Майкрософт, и более ранняя версия этой платформы была выпущена как часть Apache Hadoop 3,1. Дополнительные сведения см. в [https://issues.apache.org/jira/browse/HDFS-9806](https://issues.apache.org/jira/browse/HDFS-9806) разделе для получения дополнительных сведений.

В следующих разделах приводится пример настройки уровня HDFS с помощью Azure Data Lake Storage 2-го поколения источника данных.

## <a name="refresh"></a>Обновить

Распределение по уровням HDFS поддерживает обновление. Обновление существующего подключения для последнего моментального снимка удаленных данных.

## <a name="prerequisites"></a>предварительные требования

- [Развернутый кластер больших данных](deployment-guidance.md)
- [Инструменты для обработки больших данных](deploy-big-data-tools.md)
  - **аздата**
  - **kubectl**

## <a name="mounting-instructions"></a>Инструкции по подключению

Мы поддерживаем подключение к Azure Data Lake Storage 2-го поколения и Amazon S3. Инструкции по подключению к этим типам хранилищ можно найти в следующих статьях:

- [Как подключить ADLS 2-го поколения для уровней HDFS в кластере больших данных](hdfs-tiering-mount-adlsgen2.md)
- [Как подключить S3 для уровней HDFS в кластере больших данных](hdfs-tiering-mount-s3.md)

## <a id="issues"></a>Известные проблемы и ограничения

В следующем списке приведены известные проблемы и текущие ограничения при использовании уровней HDFS в SQL Server кластерах больших данных.

- Если подключение находится в `CREATING` состоянии в течение длительного времени, оно, скорее всего, завершилось сбоем. В этом случае отмените команду и при необходимости удалите подключение. Перед повторным выполнением Проверьте правильность параметров и учетных данных.

- Невозможно создать подключения для существующих каталогов.

- Невозможно создать подключения в существующих подключениях.

- Если какой-либо из предков точки подключения не существует, они будут созданы с разрешениями, установленными по умолчанию на r-XR-XR-x (555).

- Создание подключения может занять некоторое время в зависимости от числа и размера смонтированных файлов. Во время этого процесса файлы в подключении не видны пользователям. При создании подключения все файлы будут добавляться во временный путь, который по умолчанию имеет `/_temporary/_mounts/<mount-location>`значение.

- Команда для создания подключения является асинхронной. После выполнения команды состояние подключения можно проверить, чтобы понять состояние подключения.

- При создании подключения аргумент, используемый для параметра **--Mount-Path** , по сути является уникальным идентификатором подключения. Одна и та же строка (включая "/" в конце, если она есть) должна использоваться в последующих командах.

- Подключения доступны только для чтения. Нельзя создавать каталоги или файлы при подключении.

- Не рекомендуется подключать каталоги и файлы, которые могут быть изменены. После создания подключения любые изменения или обновления в удаленном расположении не будут отражены в подключении к HDFS. Если изменения происходят в удаленном расположении, можно удалить и повторно создать подключение, чтобы отразить обновленное состояние.

## <a name="next-steps"></a>Следующие шаги

Дополнительные сведения о кластерах больших данных SQL Server 2019 см. в статье [что такое кластеры больших данных SQL Server 2019?](big-data-cluster-overview.md).
