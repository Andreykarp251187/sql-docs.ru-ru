---
title: Новые возможности в ядре СУБД SQL Server 2017 | Документация Майкрософт
ms.custom: ''
ms.date: 10/24/2017
ms.prod: sql
ms.reviewer: ''
ms.technology: release-landing
ms.topic: conceptual
ms.assetid: 42f45b23-6509-45e8-8ee7-76a78f99a920
author: rothja
ms.author: jroth
manager: jroth
monikerRange: '>=sql-server-2017||=sqlallproducts-allversions||>=sql-server-linux-2017'
ms.openlocfilehash: 9832f71c9a898d1d0f5a1ddc6b6c6ef047b95869
ms.sourcegitcommit: ad2e98972a0e739c0fd2038ef4a030265f0ee788
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/07/2019
ms.locfileid: "66794505"
---
# <a name="whats-new-in-database-engine---sql-server-2017"></a>Новые возможности в ядре СУБД SQL Server 2017
[!INCLUDE[tsql-appliesto-ss2017-xxxx-xxxx-xxx-md](../includes/tsql-appliesto-ss2017-xxxx-xxxx-xxx-md.md)]

В этом разделе описаны усовершенствования, внесенные в [!INCLUDE[ssdenoversion-md](../includes/ssdenoversion-md.md)] для [!INCLUDE[sssqlv14-md](../includes/sssqlv14-md.md)]. Для перехода к дополнительным сведениям по каждому элементу щелкайте ссылки.

> [!NOTE]  
> SQL Server 2017 также включает функции, добавленные в пакеты обновления SQL Server 2016. Описание этих элементов см. в статье [Новые возможности в SQL Server 2016 (ядро СУБД)](../database-engine/configure-windows/what-s-new-in-sql-server-2016-database-engine.md).

**Усовершенствования**  

- Среда CLR использует управление доступом для кода (CAS) в .NET Framework, которое больше не поддерживается в качестве границы безопасности. Сборки среды CLR, созданные с помощью `PERMISSION_SET = SAFE`, могут получать доступ к внешним системным ресурсам, вызывать неуправляемый код и получать права системного администратора. Начиная с [!INCLUDE[sssqlv14-md](../includes/sssqlv14-md.md)], появился параметр `sp_configure`, называемый `clr strict security`, для повышения безопасности сборок среды CLR. `clr strict security` включен по умолчанию и рассматривает сборки `SAFE` и `EXTERNAL_ACCESS`, как если бы они были помечены `UNSAFE`. Параметр `clr strict security` можно отключить для обеспечения обратной совместимости, но это делать не рекомендуется. Корпорация Майкрософт рекомендует подписывать все сборки с помощью сертификата или асимметричного ключа с соответствующим именем входа, которому предоставлено разрешение `UNSAFE ASSEMBLY` в базе данных master. Сборки CLR можно добавлять в список разрешенных в качестве обходного пути для функции `clr strict security`. Для поддержки списка разрешений доверенных сборок добавлены функции [sp_add_trusted_assembly](../relational-databases/system-stored-procedures/sys-sp-add-trusted-assembly-transact-sql.md), [sp_drop_trusted_assembly](../relational-databases/system-stored-procedures/sys-sp-drop-trusted-assembly-transact-sql.md) и [sys.trusted_assemblies](../relational-databases/system-catalog-views/sys-trusted-assemblies-transact-sql.md). Дополнительные сведения см. в статье о параметре [clr strict security](configure-windows/clr-strict-security.md).  
- Новая функция DMF [sys.dm_db_log_stats](../relational-databases/system-dynamic-management-views/sys-dm-db-log-stats-transact-sql.md) предоставляет сводку атрибутов и сведения о файлах журналов транзакций, которые помогают контролировать работоспособность журнала транзакций.  
- Возобновляемое перестроение индексов в подключенном режиме. Возобновляемое перестроение индексов в подключенном режиме позволяет возобновить эту операцию с момента остановки после сбоя (например, при отработке отказа в реплику или нехватке места на диске). Ее можно также приостановить и возобновить позже. Например, может потребоваться временно высвободить ресурсы системы с целью выполнения задачи высоким приоритетом или выполнить перестроение индекса в другом периоде обслуживания, если доступные периоды недостаточны для обработки большой таблицы. И, наконец, для возобновляемого перестроения индексов в подключенном режиме не требуется значительное пространство журнала, что позволяет выполнять усечение журнала во время работы операции возобновляемого перестроения. В разделе [ALTER INDEX](../t-sql/statements/alter-index-transact-sql.md) и [руководящие принципы для операций с индексами в сети](../relational-databases/indexes/guidelines-for-online-index-operations.md).
- **Параметр IDENTITY_CACHE для ALTER DATABASE SCOPED CONFIGURATION**. Новый параметр IDENTITY_CACHE был добавлен в инструкцию T-SQL `ALTER DATABASE SCOPED CONFIGURATION`. Если этому параметру задано значение `OFF`, он позволяет ядру СУБД избежать пропусков в значениях столбцов удостоверений при непредвиденной перезагрузке или отработке отказа сервера на вторичный сервер. В разделе [ALTER DATABASE SCOPED CONFIGURATION](../t-sql/statements/alter-database-scoped-configuration-transact-sql.md).   
-  [!INCLUDE[ssnoversion](../includes/ssnoversion-md.md)] теперь предоставляет возможности диаграммы базы данных для моделирования более значимых данных, ориентированных на связи. Сюда входят новый синтаксис [CREATE TABLE](../t-sql/statements/create-table-sql-graph.md) для создания таблиц узлов и граничных таблиц и ключевое слово [MATCH](../t-sql/queries/match-sql-graph.md) для запросов. Дополнительные сведения см. в разделе [Graph Processing with SQL Server 2017](../relational-databases/graphs/sql-graph-overview.md) (Работа с графами в SQL Server 2017).   
- Новое поколение функций обработки запросов, использующих стратегии оптимизации для адаптации к среде выполнения рабочих нагрузок ваших приложений. В первую версию семейства функций для **адаптивной обработки запросов** мы включили три улучшения: **адаптивные соединения в пакетном режиме**, **обратная связь по временно предоставляемому буферу памяти в пакетном режиме** и **выполнение с чередованием** для многооператорных функций с табличными значениями.  См. статью [Интеллектуальная обработка запросов в базах данных SQL](../relational-databases/performance/intelligent-query-processing.md).
- Функция автоматической настройки базы данных предоставляет сведения о возможных проблемах с обработкой запросов и рекомендуемые решения. Она также может автоматически исправлять выявленные проблемы. Автоматическая настройка в [!INCLUDE[ssnoversion](../includes/ssnoversion-md.md)] уведомляет об обнаружении потенциальных проблем производительности, а также дает возможность применять корректирующие действия или позволяет [!INCLUDE[ssde-md](../includes/ssde-md.md)] автоматически устранять проблемы с производительностью. Дополнительные сведения см. в разделе [Automatic tuning](../relational-databases/automatic-tuning/automatic-tuning.md) (Автоматическая настройка).
- Повышение производительности для сборки некластеризованных индексов в таблицах, оптимизированных для памяти. Значительно оптимизирована производительность (некластеризованного) перестроения индекса в таблицах MEMORY_OPTIMIZED во время восстановления базы данных. Это усовершенствование значительно сокращает время восстановления базы данных при использовании некластеризованных индексов.  
- [sys.dm_os_sys_info](../relational-databases/system-dynamic-management-views/sys-dm-os-sys-info-transact-sql.md) содержит три новых столбца: socket_count cores_per_socket, numa_node_count. Это полезно при запуске сервера в виртуальной машине, так как превышение NUMA может привести к перегрузке узлов и последующим проблемам с производительностью.
- Новый столбец modified_extent_page_count\,, представленный в [sys.dm_db_file_space_usage](../relational-databases/system-dynamic-management-views/sys-dm-db-file-space-usage-transact-sql.md), отслеживает разностные изменения в каждом файле базы данных. Новый столбец modified_extent_page_count позволяет использовать интеллектуальные решения для полного или разностного резервного копирования, основываясь на проценте измененных страниц базы данных. Если процент ниже порогового значения (например, 70–80 %), выполняется полное резервное копирование базы данных.
- SELECT INTO ... ON в файловой группе Синтаксис [SELECT INTO](../t-sql/queries/select-into-clause-transact-sql.md) теперь поддерживает загрузку таблицы в файловую группу, отличную от файловой группы по умолчанию для пользователя, с помощью ключевого слова **ON**, добавленного в синтаксис SELECT INTO TSQL.
- Усовершенствования установки базы данных tempdb. Программа установки позволяет указать размер файла начальной базы данных tempdb до **256 ГБ (262 144 МБ)** каждого файла с выводом предупреждения для клиентов, если для размера файла задано значение больше 1 ГБ и если IFI не включена. Очень важно понять суть невключения мгновенной инициализации файлов (IFI), где время установки может увеличиваться экспоненциально в зависимости от исходного размера указанного файла данных tempdb. IFI неприменима к размеру журнала транзакций, поэтому при указании большего значения для журнала транзакций неизменно может увеличить время установки во время запуска базы данных tempdb независимо от параметра IFI для учетной записи службы SQL Server.
- Новое динамическое административное представление [sys.dm_tran_version_store_space_usage](../relational-databases/system-dynamic-management-views/sys-dm-tran-version-store-space-usage.md) отслеживает использование хранилища версии для каждой базы данных. Это новое динамическое административное представление полезно для наблюдения за базой данных tempdb в отношении использования хранилища версий, так как оно позволяет заранее планировать изменения размера базы данных tempdb согласно требованиям к использованию хранилища версии каждой базы данных без снижения производительности и расходов на ее работу на производственных серверах.
- Новая функция динамического управления [sys.dm_db_log_info](../relational-databases/system-dynamic-management-views/sys-dm-db-log-info-transact-sql.md) предоставляет сведения о виртуальных файлах журнала (аналогично DBCC LOGINFO) для отслеживания возможных проблем с журналами транзакций, оповещения об этих проблемах и их предотвращения. Эти проблемы возникают из-за количества файлов VLF, размеров файлов VLF или ошибок shrinkfile.
- Улучшенная производительность резервного копирования для небольших баз данных на высокопроизводительных серверах. При выполнении резервного копирования баз данных в SQL Server требуется несколько итераций буферного пула для очистки операций ввода-вывода. В результате время резервного копирования является не просто функцией размера базы данных, но и функцией размера активного буферного пула. В SQL Server 2017 резервное копирование оптимизировано во избежание возникновения нескольких итераций буферного пула, что способствует значительному повышению производительности процесса резервного копирования для небольших и средних баз данных. Высокая производительность снижается по мере увеличения размера базы данных, так как резервное копирование страниц и операции ввода-вывода для резервного копирования занимают больше времени по сравнению с итерацией буферного пула.  
- Хранилище запросов теперь отслеживает сводные данные по статистике ожидания. Отслеживание категорий статистики ожидания для каждого запроса в хранилище запросов открывает следующий уровень устранения неполадок в области производительности, предоставляя еще больше сведений о производительности рабочих нагрузок, узких местах, сохраняя при этом основные преимущества хранилища запросов.  
- Темпоральные таблицы с системным управлением версиями теперь поддерживают каскадное удаление и каскадное обновление.  
- Повышена производительность косвенных контрольных точек.
- Добавлена поддержка групп доступности без кластеризации.
- Добавлен параметр групп доступности для фиксации минимальных реплик.
- Теперь группы доступности могут работать как в Windows, так и в Linux, что обеспечивает возможность кроссплатформенной миграции и тестирования.
- Добавлена поддержка политики хранения темпоральных таблиц.
- Реализовано новое динамическое административное представление SYS.DM_DB_STATS_HISTOGRAM.
- Добавлена поддержка сборки и перестройки некластеризованного индекса columnstore в Интернете.
- Добавлено представление[sys.dm_db_stats_histogram (Transact-SQL)](../relational-databases/system-dynamic-management-views/sys-dm-db-stats-histogram-transact-sql.md) для проверки статистики.
- В помощнике по настройке ядра СУБД (DTA) выпущенном в составе SQL Server Management Studio версии 16.4, реализованы дополнительные возможности для анализа SQL Server 2016 и более поздних версий.    
   - Повышенная производительность. Дополнительные сведения см. в статье [Performance Improvements using Database Engine Tuning Advisor (DTA) recommendations](../relational-databases/performance/performance-improvements-using-dta-recommendations.md) (Повышение производительности с помощью рекомендаций помощника по настройке ядра СУБД (DTA)).
   - Параметр `-fc` , с помощью которого можно разрешить рекомендации индексов columnstore. Дополнительные сведения см. в статьях [dta, программа](../tools/dta/dta-utility.md) и [Columnstore index recommendations in Database Engine Tuning Advisor (DTA)](../relational-databases/performance/columnstore-index-recommendations-in-database-engine-tuning-advisor-dta.md) (Рекомендации по индексам сolumnstore в помощнике по настройке ядра СУБД (DTA)).  
   - Параметр `-iq` , с помощью которого можно разрешить DTA просматривать рабочую нагрузку хранилища запросов. Дополнительные сведения см. в статье [Tuning Database Using Workload from Query Store](../relational-databases/performance/tuning-database-using-workload-from-query-store.md)(Настройка базы данных с помощью рабочей нагрузки из хранилища запросов).  
- Далее перечислены дополнительные улучшения оптимизированных для памяти таблиц и функций, скомпилированных в машинном коде, которые необходимы для работы в памяти. Примеры кода, иллюстрирующие эти улучшения, см. в статье [Оптимизация обработки JSON с помощью выполняющейся в памяти OLTP](../relational-databases/json/optimize-json-processing-with-in-memory-oltp.md).
    - Добавлена поддержка вычисляемых столбцов в таблицы, оптимизированные для работы памяти, включая индексы в вычисляемых столбцах.
    - Добавлена полная поддержка JSON-функций в модули, скомпилированные в машинном коде, и проверочные ограничения.  
    - В модули, скомпилированные в машинном коде, добавлен оператор`CROSS APPLY` .   
- Добавлены новые строковые функции [CONCAT_WS](../t-sql/functions/concat-ws-transact-sql.md), [TRANSLATE](../t-sql/functions/translate-transact-sql.md) и [TRIM](../t-sql/functions/trim-transact-sql.md).   
- Предложение `WITHIN GROUP` теперь поддерживается для функции [STRING_AGG](../t-sql/functions/string-agg-transact-sql.md).
- Добавлены два новых семейства параметров сортировки для японского языка (Japanese_Bushu_Kakusu_140 и Japanese_XJIS_140). Для использования в новых японских параметрах сортировки добавлен параметр Variation-selector-sensitive (_VSS). Кроме того, все новые параметры сортировки автоматически поддерживают дополнительные символы без необходимости указания параметра _SC. Подробные сведения см. в разделе [Поддержка параметров сортировки и Юникода](../relational-databases/collations/collation-and-unicode-support.md).   
- Новые параметры группового доступа ([BULK INSERT](../t-sql/statements/bulk-insert-transact-sql.md) и [OPENROWSET(BULK...)](../t-sql/functions/openrowset-transact-sql.md)) обеспечивают доступ к данным непосредственно из CSV-файлов и из файлов в хранилище BLOB-объектов Azure посредством нового параметра `BLOB_STORAGE` [EXTERNAL DATA SOURCE](../t-sql/statements/create-external-data-source-transact-sql.md).
- Добавлен уровень совместимости базы данных **COMPATIBILITY_LEVEL** 140.   Клиенты, использующие его, получат доступ к самым новым возможностям языков и режимам оптимизатора запросов. Сюда входят изменения, вносимые корпорацией Майкрософт в каждую предварительную версию.
- Улучшен способ вычисления пороговых значений для обновления добавочной статистики (требуется режим совместимости 140).
- Добавлен[sys.dm_exec_query_statistics_xml](../relational-databases/system-dynamic-management-views/sys-dm-exec-query-statistics-xml-transact-sql.md) .
- Мы внесли несколько улучшений производительности и языка для оптимизированных для памяти объектов.
    - `sp_spaceused` теперь поддерживается для таблиц, оптимизированных для памяти.
    - `sp_rename` теперь поддерживается для таблиц, оптимизированных для памяти и скомпилированных в собственном коде модулей T-SQL.
    - Для модулей, скомпилированных в собственном коде T-SQL, поддерживаются выражения `CASE`.
    - Удалено ограничение в 8 индексов для таблиц, оптимизированных для памяти.
    - `TOP (N) WITH TIES` теперь поддерживается в модулях, скомпилированных в собственном коде T-SQL.
    - `ALTER TABLE` для таблиц, оптимизированных для памяти, теперь намного быстрее.
    - Повтор журнала транзакций для оптимизированных для памяти таблиц теперь выполняется параллельно. Это повышает скорость восстановления и значительно увеличивает долговременную пропускную способность конфигурации группы доступности AlwaysOn.
    - Файлы файловой группы, оптимизированные для памяти, теперь можно хранить в хранилище Azure. Теперь также доступно резервное копирование и восстановление файлов, оптимизированных для памяти, в хранилище Azure.
- Кластеризованные индексы Columnstore теперь поддерживают столбцы типа LOB (nvarchar(max), varchar(max), varbinary(max)).
- Добавлена агрегатная функция [STRING_AGG](../t-sql/functions/string-agg-transact-sql.md).  
- Новые разрешения: `DATABASE SCOPED CREDENTIAL` теперь является классом защищаемого объекта, поддерживающим разрешения `CONTROL`, `ALTER`, `REFERENCES`, `TAKE OWNERSHIP`и `VIEW DEFINITION` . `ADMINISTER DATABASE BULK OPERATIONS`, который ограничен базой данных SQL, теперь отображается в `sys.fn_builtin_permissions`.   
- Добавлено динамическое административное представление [sys.dm_os_host_info](../relational-databases/system-dynamic-management-views/sys-dm-os-host-info-transact-sql.md) , предоставляющее сведения об операционной системе как для Windows, так и для Linux.   
- Роли базы данных создаются с помощью служб R Services для управления разрешениями, связанными с пакетами. Дополнительные сведения см. в разделе [Управление пакетами R для SQL Server](../advanced-analytics/r-services/r-package-management-for-sql-server-r-services.md).

