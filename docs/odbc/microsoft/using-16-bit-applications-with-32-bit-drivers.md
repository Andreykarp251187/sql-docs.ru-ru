---
title: Использование 16-битных приложений с 32-bit драйверами (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- ODBC drivers [ODBC], 16-bit applications
- 16-bit applications with 32-bit drivers [ODBC]
ms.assetid: 68feb3b7-c01a-4f42-8df9-f9c182d89325
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: c919ed8c3f3791720d67ebdcbf5cfbdbea2a0455
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81307635"
---
# <a name="using-16-bit-applications-with-32-bit-drivers"></a>Использование 16-разрядных приложений с 32-разрядными драйверами
> [!IMPORTANT]  
>  Эта функция будет удалена в будущей версии Windows. Избегайте использования этой функции в новых разработках и планируйте модифицировать приложения, использующие эту функцию в настоящее время. Вместо этого используйте 32-битный или 64-разрядный менеджер драйвера.  
  
 Вы можете запускать 16-разрядные приложения с 32-битными драйверами в вашей системе на базе Windows, если 32-разрядный драйвер явно не вызывает функции Win32 API, которые создают потоки. Подсистема Windows на Windows (WOW) запускает приложения в 16-битном режиме и разрешает 16-битные вызовы в операционную систему. ODBC thunking DLLs разрешает 16-битные звонки из приложения 32-битным драйверам. 16-разрядные приложения используют API Windows, а 32-битные драйверы используют API Win32.  
  
## <a name="architecture"></a>Architecture  
 На следующей иллюстрации показано, как 16-битные приложения взаимодействуют с 32-битными драйверами. Между 16-битным менеджером драйверов и 32-битными драйверами являются общими DLL, которые преобразуют 16-разрядные вызовы ODBC в 32-разрядные вызовы ODBC.  
  
 ![Как 16&#45;битприложений общаются с 32&#45;драйверами бита](../../odbc/microsoft/media/sdka2.gif "sdka2")  
  
> [!NOTE]  
>  В любое время, когда 16-разрядное приложение взаимодействует с 32-разрядным драйвером, 32-разрядный driver Manager всегда возвращает "2.0" в качестве версии ODBC, поддерживаемой водителем.  
  
## <a name="administration"></a>Администрирование  
 Управлять источниками данных для 32-битных драйверов можно с помощью администратора ODBC Data Source. Чтобы открыть администраторODБ на компьютерах под управлением Microsoft® Windows® 2000, откройте панель управления Windows, дважды щелкните **административные инструменты,** а затем дважды щелкните **источники данных (ODBC).** На компьютерах, работающих в предыдущих версиях Microsoft Windows, значок называется **32-битный ODBC** или просто **ODBC**.  
  
 На следующей иллюстрации показано, как 16-разрядное приложение вызывает 32-битную установку драйвера DLL. Между 16-разрядным установщиком DLL и 32-битной установкой драйвера DLL является универсальным thunking DLL, который преобразует 16-разрядный установщик DLL звонки на 32-битный установщик DLL звонки.  
  
 ![Как 16&#45;бит приложение вызывает 32&#45;бит драйвера установки DLL](../../odbc/microsoft/media/sdka3.gif "sdka3")  
  
 В Windows на Windows (16-битный до 32-битный thunking), дополнительный thunking DLL имени Ds32gt.dll преобразует 16-битный аргумент значения прошли через 32-битной установки DLL обратно в 16-битный.  
  
## <a name="components"></a>Components  
 Компонент ODBC MDAC 2.8 SP1 SDK включает в себя следующие файлы для запуска 16-битных приложений с 32-битными драйверами. Эти компоненты находятся в каталоге «Redist».  
  
|Имя файла|Описание|  
|---------------|-----------------|  
|Odbc16gt.dll|16-битный ODBC общий thunking DLL|  
|Odbc32gt.dll|32-разрядный ODBC общий thunking DLL|  
|Odbccp32.dll|32-разрядный установщик DLL|  
|Odbcad32.exe|32-битная программа администратора|  
|Odbcinst.hlp|Файл справки установки|  
|Ds16gt.dll|16-битная установка драйвера общего thunking DLL|  
|Ctl3d32.dll|32-разрядная трехмерная библиотека стиля окон|  
  
 Кроме того, следующие файлы вместе с 16-разрядным менеджером драйверов ODBC 2.10, которые не являются частью ODBC 3.51, требуются и должны быть установлены с 16-битным приложением.  
  
|Имя файла|Описание|  
|---------------|-----------------|  
|Odbc.dll|16-разрядный менеджер драйвера|  
|Odbcinst.dll|16-битный установщик DLL|  
|Odbcadm.exe|16-битная программа администратора ODBC|
