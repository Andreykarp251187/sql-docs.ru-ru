---
title: Использование 16-разрядных приложений с 32-разрядными драйверами | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- ODBC drivers [ODBC], 16-bit applications
- 16-bit applications with 32-bit drivers [ODBC]
ms.assetid: 68feb3b7-c01a-4f42-8df9-f9c182d89325
author: MightyPen
ms.author: genemi
ms.openlocfilehash: d4be5d2cacaeca7cf53caa330a126284370ec80f
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68088194"
---
# <a name="using-16-bit-applications-with-32-bit-drivers"></a>Использование 16-разрядных приложений с 32-разрядными драйверами
> [!IMPORTANT]  
>  Эта функция будет удалена в следующей версии Windows. Избегайте использования этой функции в новых разработках и запланируйте изменение приложений, которые в настоящее время используют эту функцию. Используйте вместо него 32-разрядный или 64-разрядный диспетчер драйверов.  
  
 Вы можете запускать 16-разрядные приложения с 32-разрядными драйверами в системе Windows, если 32-разрядный драйвер не вызывает явно функции API Win32, которые создают потоки. Подсистема Windows в Windows (WOW) запускает приложения в 16-разрядном режиме и разрешает 16-разрядные вызовы операционной системы. Библиотеки DLL преобразователя ODBC разрешают 16-разрядные вызовы из приложения в 32-разрядные драйверы. 16-разрядные приложения используют API Windows, а 32-разрядные драйверы используют API Win32.  
  
## <a name="architecture"></a>Architecture  
 На следующем рисунке показано, как 16-разрядные приложения взаимодействуют с 32-разрядными драйверами. Между 16-разрядным диспетчером драйверов и 32-разрядными драйверами представлены универсальные библиотеки DLL для преобразования 16-разрядных вызовов ODBC в 32-разрядные вызовы ODBC.  
  
 ![Как 16&#45;разрядных приложений взаимодействуют с 32&#45;разрядными драйверами](../../odbc/microsoft/media/sdka2.gif "sdka2")  
  
> [!NOTE]  
>  Когда 16-разрядное приложение взаимодействует с 32-разрядным драйвером, 32-разрядный диспетчер драйверов всегда возвращает "2,0" в качестве версии ODBC, поддерживаемой драйвером.  
  
## <a name="administration"></a>Администрирование  
 Управлять источниками данных для 32-разрядных драйверов можно с помощью администратора источников данных ODBC. Чтобы открыть администратор ODBC на компьютерах под управлением Microsoft® Windows® 2000, откройте панель управления Windows, дважды щелкните **Администрирование**, а затем дважды щелкните **Источники данных (ODBC)**. На компьютерах с предыдущими версиями Microsoft Windows значок имеет имя **32-разрядный ODBC** или просто **ODBC**.  
  
 На следующем рисунке показано, как 16-разрядное приложение вызывает библиотеку DLL установки драйвера для 32-разрядного приложения. Между 16-разрядной библиотекой DLL установщика и библиотекой DLL установки 32-разрядного драйвера является универсальная библиотека DLL для преобразования, преобразующая 16-разрядные вызовы DLL установщика в вызовы DLL-библиотек установщика 32.  
  
 ![Как 16-&#45;разрядное приложение вызывает библиотеку DLL установки драйвера 32&#45;разрядной версии](../../odbc/microsoft/media/sdka3.gif "sdka3")  
  
 В Windows в Windows (16-разрядный для 32-разрядный), дополнительная библиотека DLL для преобразования с именем Ds32gt. dll Преобразует 16-битные значения аргументов, передаваемые через 32-разрядную библиотеку DLL, обратно в 16-разрядную.  
  
## <a name="components"></a>Components  
 Компонент ODBC пакета SDK для MDAC 2,8 с пакетом обновления 1 (SP1) содержит следующие файлы для запуска 16-разрядных приложений с 32-разрядными драйверами. Эти компоненты находятся в каталоге \Redist.  
  
|Имя файла|Description|  
|---------------|-----------------|  
|Odbc16gt. dll|16-разрядная библиотека DLL универсального преобразователя ODBC|  
|Odbc32gt. dll|32-разрядная библиотека DLL универсального преобразователя ODBC|  
|Odbccp32. dll|32-разрядная библиотека DLL установщика|  
|Файла odbcad32. exe|32-разрядная программа администратора|  
|Odbcinst. hlp|Файл справки установщика|  
|Ds16gt. dll|16-разрядный драйвер Установка универсального преобразователя библиотеки DLL|  
|Ctl3d32. dll|32-разрядная библиотека в стиле трехмерного окна|  
  
 Кроме того, следующие файлы вместе с 16-битным диспетчером драйверов ODBC 2,10, которые не являются частью ODBC 3,51, являются обязательными для и должны устанавливаться вместе с 16-разрядным приложением.  
  
|Имя файла|Description|  
|---------------|-----------------|  
|Библиотека ODBC. dll|16-разрядный диспетчер драйверов|  
|Odbcinst. dll|16-разрядная библиотека DLL установщика|  
|Одбкадм. exe|16-разрядная программа администрирования ODBC|
