---
title: Файл Schema. ini (драйвер для текстовых файлов) | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- schema.ini file [ODBC]
- text file driver [ODBC], schema.ini file
ms.assetid: 0c4625c4-c730-4984-b430-9051b7bc0451
author: MightyPen
ms.author: genemi
ms.openlocfilehash: dd95329c91c69af38b1ffc7951191498fcc40479
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "67987946"
---
# <a name="schemaini-file-text-file-driver"></a>Файл Schema.ini (драйвер для текстовых файлов)
При использовании драйвера текста формат текстового файла определяется с помощью файла сведений о схеме. Файл сведений о схеме всегда называется Schema. ini и всегда хранится в том же каталоге, что и источник текстовых данных. Файл сведений о схеме предоставляет IISAM сведения о общем формате файла, имя столбца и сведения о типе данных, а также несколько других характеристик данных. Для доступа к данным фиксированной длины всегда требуется файл Schema. ini. Файл Schema. ini следует использовать, если в текстовой таблице содержатся данные типа DateTime, Currency или decimal или каждый раз, когда требуется больший контроль над обработкой данных в таблице.  
  
> [!NOTE]  
>  Текст ISAM получит исходные значения из реестра, а не из Schema. ini. Тот же формат файла по умолчанию применяется ко всем новым таблицам текстовых данных. Все файлы, созданные с помощью инструкции CREATE TABLE, наследуют те же значения формата по умолчанию, которые задаются путем выбора значений формат файла в диалоговом окне \< **Определение формата текста** с> по умолчанию, выбранным в списке **таблицы** . Если значения в реестре отличаются от значений в файле Schema. ini, то значения в реестре будут перезаписаны значениями из Schema. ini.  
  
## <a name="understanding-schemaini-files"></a>Основные сведения о файлах Schema. ini  
 Файлы Schema. ini предоставляют сведения о схеме записей в текстовом файле. Каждая запись Schema. ini задает одну из пяти характеристик таблицы:  
  
-   Имя текстового файла  
  
-   Формат файла  
  
-   Имена, ширина и типы полей  
  
-   Кодировка  
  
-   Специальные преобразования типов данных  
  
 Эти характеристики рассматриваются в следующих разделах.  
  
## <a name="specifying-the-file-name"></a>Указание имени файла  
 Первая запись в файле Schema. ini всегда является именем исходного текстового файла, заключенного в квадратные скобки. В следующем примере показана запись для файла Sample. txt:  
  
```  
[Sample.txt]  
```  
  
## <a name="specifying-the-file-format"></a>Указание формата файла  
 Параметр **Format** в файле Schema. ini определяет формат текстового файла. Текст IISAM может автоматически считывать формат из большинства файлов с разделителями символов. Можно использовать любой отдельный символ в качестве разделителя в файле, за исключением двойных кавычек ("). Параметр **Format** в файле Schema. ini переопределяет параметр в реестре Windows File by File. В следующей таблице перечислены допустимые значения параметра **Format** .  
  
|Спецификатор формата|Формат таблицы|Format. ini, инструкция|  
|----------------------|------------------|---------------------------------|  
|**Разделители Tab**|Поля в файле разделяются символами табуляции.|Format = Табделимитед|  
|**Разделители CSV**|Поля в файле разделяются запятыми (значения, разделенные запятыми).|Format = CSVDelimited|  
|**Пользовательские разделители**|Поля в файле разделяются любым символом, выбранным для ввода в диалоговое окно. Допускаются только двойные кавычки ("), включая пустые.|Format = с разделителями (*пользовательский символ*)<br /><br /> -или-<br /><br /> Без указания разделителя:<br /><br /> Format = с разделителями ()|  
|**Фиксированная длина**|Поля в файле имеют фиксированную длину.|Format = FixedLength|  
  
## <a name="specifying-the-fields"></a>Указание полей  
 Имена полей можно указать в текстовом файле с разделителями-символами двумя способами:  
  
-   Включите имена полей в первую строку таблицы и задайте для **колнамехеадер** значение **true.**  
  
-   Укажите каждый столбец по номеру и назначьте имя столбца и тип данных.  
  
 Необходимо указать каждый столбец по номеру и указать имя столбца, тип данных и ширину для файлов фиксированной длины.  
  
> [!NOTE]  
>  Параметр **колнамехеадер** в файле Schema. ini переопределяет параметр **фирстровхаснамес** в реестре Windows File by File.  
  
 Также можно определить типы данных полей. Используйте параметр **макссканровс** , чтобы указать, сколько строк должно быть проверено при определении типов столбцов. Если задать для **макссканровс** значение 0, сканируется весь файл. Параметр **макссканровс** в файле Schema. ini переопределяет параметр в реестре Windows File by File.  
  
 Следующая запись указывает, что Microsoft Jet должна использовать данные из первой строки таблицы, чтобы определить имена полей и проверить весь файл для определения используемых типов данных:  
  
```  
ColNameHeader=True  
MaxScanRows=0  
```  
  
 Следующая запись обозначает поля в таблице с помощью параметра номер столбца (**Col**_n_), который является необязательным для файлов с разделителями символов и требуется для файлов фиксированной длины. В примере показаны записи Schema. ini для двух полей — Кустомернумбер текстового поля с 10 символами и 30-символьного CustomerName текстового поля:  
  
```  
Col1=CustomerNumber Text Width 10  
Col2=CustomerName Text Width 30  
```  
  
 Синтаксис **столбца**_n_ :  
  
```  
  
n=ColumnNametype [#]  
```  
  
## <a name="remarks"></a>Remarks  
 В следующей таблице описывается каждая часть записи **Col**_n_ .  
  
|Параметр|Description|  
|---------------|-----------------|  
|*ColumnName*|Текстовое имя столбца. Если имя столбца содержит пробелы, его необходимо заключить в двойные кавычки.|  
|*type*|Ниже приведены типы данных.<br /><br /> **Типы данных Microsoft Jet**<br /><br /> bit<br /><br /> Byte<br /><br /> Сокращение<br /><br /> Long<br /><br /> Валюта<br /><br /> Single<br /><br /> Double<br /><br /> DateTime<br /><br /> текст<br /><br /> Получена<br /><br /> **Типы данных ODBC** Char (то же, что и текст)<br /><br /> Float (то же, что и Double)<br /><br /> Целое число (то же, что и короткий)<br /><br /> Лонгчар (то же, что и МЕМО)<br /><br /> *Формат* даты и времени|  
|**Ширина**|Литеральное строковое `Width`значение. Указывает, что следующее число задает ширину столбца (необязательно для файлов с разделителями-символами; требуется для файлов с фиксированной длиной).|  
|*#*|Целочисленное значение, обозначающее ширину столбца (требуется, если указана **Ширина** ).|  
  
## <a name="selecting-a-character-set"></a>Выбор кодировки  
 Можно выбрать из двух наборов символов: ANSI и OEM. Параметр « **Кодировка** » в файле Schema. ini переопределяет параметр в реестре Windows «File by File». В следующем примере показана запись Schema. ini, которая задает кодировку ANSI:  
  
```  
CharacterSet=ANSI  
```  
  
## <a name="specifying-data-type-formats-and-conversions"></a>Указание форматов и преобразований типов данных  
 Файл Schema. ini содержит несколько параметров, которые можно использовать для указания способа преобразования или отображения данных. В следующей таблице перечислены все эти параметры.  
  
|Параметр|Description|  
|------------|-----------------|  
|**DateTimeFormat**|Можно задать строку формата, которая указывает даты и время. Эту запись следует указывать, если все поля даты и времени в импорте и экспорте обрабатываются с тем же форматом. Все форматы Microsoft Jet, кроме A.M. и после полудня . Если строка формата отсутствует, используются краткие даты и параметры времени на панели управления Windows.|  
|**деЦималсимбол**|Можно задать любой символ, используемый для отделения целого числа от дробной части числа.|  
|**нумбердигитс**|Указывает число десятичных цифр в дробной части числа.|  
|**нумберлеадингзерос**|Указывает, должно ли десятичное значение меньше 1 и больше-1 содержать ведущие нули; Это значение может быть либо false (без начальных нулей), либо true.|  
|**CurrencySymbol**|Указывает символ валюты, который может использоваться для денежных значений в текстовом файле. К примерам относятся знак доллара ($) и DM.|  
|**курренципосформат**|Можно задать любое из следующих значений:<br /><br /> — Префикс символа валюты без разделения ($1)<br />— Суффикс символа валюты без разделения ($1)<br />— Префикс символа валюты с одним разделением символов ($1)<br />— Суффикс символа валюты с одним разделением символов ($1)|  
|**курренцидигитс**|Указывает количество цифр, используемых для дробной части суммы валюты.|  
|**курренцинегформат**|Принимается одно из следующих значений:<br /><br /> -($1)<br />--$1<br />-$-1<br />-$1-<br />-($1)<br />--$1<br />-1-$<br />-$1-<br />--$1<br />--$1<br />-$1-<br />-$1-<br />-$-1<br />-1-$<br />-($1)<br />-($1)<br /><br /> В этом примере показан знак доллара, но его следует заменить соответствующим значением **CurrencySymbol** в реальной программе.|  
|**курренцисаусандсимбол**|Указывает односимвольный символ, который можно использовать для разделения значений денежных единиц в текстовом файле на тысячи.|  
|**курренцидеЦималсимбол**|Можно задать любой символ, который используется для отделения всего от дробной части суммы валюты.|  
  
> [!NOTE]  
>  Если опустить запись, то используется значение по умолчанию на панели управления Windows.
