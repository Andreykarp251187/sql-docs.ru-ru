---
title: Файл Schema.ini (Драйвер текстовых файлов) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- schema.ini file [ODBC]
- text file driver [ODBC], schema.ini file
ms.assetid: 0c4625c4-c730-4984-b430-9051b7bc0451
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 365351724f27205e7d460c757f1268d042cefc76
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81305515"
---
# <a name="schemaini-file-text-file-driver"></a>Файл Schema.ini (драйвер для текстовых файлов)
При использовании драйвера текста формат текстового файла определяется с помощью информационного файла схемы. Файл информации о схеме всегда называется Schema.ini и всегда хранится в том же каталоге, что и источник текстовых данных. Файл информации о схеме предоставляет IISAM информацию об общем формате файла, названии столбца и информации о типе данных, а также о нескольких других характеристиках данных. Файл Schema.ini всегда необходим для доступа к данным с фиксированной длиной. Вы должны использовать файл Schema.ini, когда текстовая таблица содержит данные DateTime, Currency или Десятичные данные, или в любое время, когда вы хотите получить больший контроль над обработкой данных в таблице.  
  
> [!NOTE]  
>  Текст ISAM будет получать первоначальные значения из реестра, а не от Schema.ini. Тот же формат файла по умолчанию применяется ко всем новым таблицам текстовых данных. Все файлы, созданные заявлением CREATE TABLE, наследуют те же значения формата по умолчанию, которые \<устанавливаются путем выбора значений формата файлов в диалоговом поле **Формата определения текста** с>, выбранными в списке **таблиц.** Если значения в реестре отличаются от значений в Schema.ini, значения в реестре будут перезаписаны значениями от Schema.ini.  
  
## <a name="understanding-schemaini-files"></a>Понимание Schema.ini Файлы  
 Файлы Schema.ini предоставляют информацию о схемах записей в текстовом файле. Каждая запись Schema.ini определяет одну из пяти характеристик таблицы:  
  
-   Имя текстового файла  
  
-   Формат файла  
  
-   Названия полей, ширины и типы  
  
-   Набор символов  
  
-   Специальные преобразования типа данных  
  
 В следующих разделах обсуждаются эти характеристики.  
  
## <a name="specifying-the-file-name"></a>Указание имени файла  
 Первая запись в Schema.ini всегда является названием файла исходного текста, заключенного в квадратные скобки. Следующий пример иллюстрирует запись для файла Sample.txt:  
  
```  
[Sample.txt]  
```  
  
## <a name="specifying-the-file-format"></a>Определение формата файла  
 Вариант **Формата** в Schema.ini определяет формат текстового файла. Текст IISAM может автоматически читать формат из большинства файлов, делоцированных символами. Вы можете использовать любой один символ в качестве делимитера в файле, за исключением двойной отметки цитаты (). Настройка **формата** в Schema.ini переопределяет настройки в реестре Windows, файл за файлом. В следующей таблице перечислены допустимые значения для опции **«Формат».**  
  
|Описатель формата|Формат таблицы|Заявление Schema.ini Format|  
|----------------------|------------------|---------------------------------|  
|**Tab Делимитированое**|Поля в файле разграничены вкладками.|Формат-TabDelimited|  
|**CSV Делели**|Поля в файле разграничены запятыми (смежные значения).|Формат-CSVDelimited|  
|**Пользовательские делимитированных**|Поля в файле разграничены любым символом, который вы выбираете для ввода в диалоговую будку. Разрешается все, кроме двойных кавычек (), включая пустые.|Формат-Лимитированный *(пользовательский символ)*<br /><br /> -или-<br /><br /> Без делимитера указаны:<br /><br /> Формат-Лимитированный ()|  
|**Фиксированная длина**|Поля в файле имеют фиксированную длину.|Формат-Фикд-Длина|  
  
## <a name="specifying-the-fields"></a>Определение полей  
 Имена полей можно указать в файле текста, делемых символами, двумя способами:  
  
-   Включите имена полей в первый ряд таблицы и **установите ColNameHeader** в **True.**  
  
-   Укажите каждый столбец по номеру и обозначьте имя столбца и тип данных.  
  
 Необходимо указать каждый столбец по номеру и обозначить имя столбца, тип данных и ширину файлов с фиксированной длиной.  
  
> [!NOTE]  
>  Настройка **ColNameHeader** в Schema.ini переопределяет настройки **FirstRowHasNames** в реестре Windows, файл за файлом.  
  
 Также можно определить типы данных полей. Используйте опцию **MaxScanRows,** чтобы указать, сколько строк следует сканировать при определении типов столбцов. Если вы **установите MaxScanRows** до 0, весь файл сканируется. Настройка **MaxScanRows** в Schema.ini переопределяет настройки в реестре Windows, файл за файлом.  
  
 Следующая запись указывает на то, что Microsoft Jet должен использовать данные в первом ряду таблицы для определения названий полей и изучить весь файл для определения используемых типов данных:  
  
```  
ColNameHeader=True  
MaxScanRows=0  
```  
  
 Следующая запись обозначает поля в таблице, используя номер столбца **(Col**_n_) вариант, который не является обязательным для файлов, делолагаемых символами, и требуется для файлов с фиксированной длиной. На примере показаны записи Schema.ini для двух полей, текстовое поле customerNumber размером 10 символов и текстовое поле CustomerName с 30 символами:  
  
```  
Col1=CustomerNumber Text Width 10  
Col2=CustomerName Text Width 30  
```  
  
 Синтаксис **Col**_n:_  
  
```  
  
n=ColumnNametype [#]  
```  
  
## <a name="remarks"></a>Remarks  
 В следующей таблице описывается каждая часть ввода **Col**_n._  
  
|Параметр|Описание|  
|---------------|-----------------|  
|*ColumnName*|Текстовое название столбца. Если имя столбца содержит встроенные пробелы, его следует приложить в двойные кавычки.|  
|*тип*|Типы данных являются следующими:<br /><br /> **Типы данных Microsoft Jet**<br /><br /> bit<br /><br /> Byte<br /><br /> Short<br /><br /> Long<br /><br /> Валюта<br /><br /> Один<br /><br /> Double<br /><br /> Дата и время<br /><br /> Text<br /><br /> Memo<br /><br /> **Типы данных ODBC** Чар (так же, как текст)<br /><br /> Поплавок (так же, как двойной)<br /><br /> Целый (так же, как короткий)<br /><br /> LongChar (так же, как памятка)<br /><br /> *Формат даты*|  
|**Ширина**|Буквальное значение `Width`строки . Указывается, что следующее число обозначает ширину столбца (необязательно для файлов, деляющихся символами; требуется для файлов с фиксированной длиной).|  
|*#*|Значение рядового значения, обозначавакоторое шириной столбца (требуется, если **указана ширина).**|  
  
## <a name="selecting-a-character-set"></a>Выбор набора символов  
 Вы можете выбрать из двух наборов символов: ANSI и OEM. Настройка **CharacterSet** в Schema.ini переопределяет настройки в реестре Windows, файл за файлом. В следующем примере показана запись Schema.ini, которая устанавливает набор символов в ANSI:  
  
```  
CharacterSet=ANSI  
```  
  
## <a name="specifying-data-type-formats-and-conversions"></a>Определение форматов и конверсий типа данных  
 Файл Schema.ini содержит несколько вариантов, которые можно использовать для указания того, как данные преобразуются или отображаются. В следующей таблице перечислены каждый из этих вариантов.  
  
|Параметр|Описание|  
|------------|-----------------|  
|**DateTimeFormat**|Можно установить строку формата, указывают даты и время. Вы должны указать эту запись, если все поля даты/времени в импорте/экспорте обрабатываются в одном формате. Все форматы Microsoft Jet, кроме A.M. и после полудня . Если нет строки формата, используется короткая картинка даты и временные варианты панели управления Windows.|  
|**Десятималыйсимвол**|Может быть установлен на любой отдельный символ, который используется для отделения целых числа от фракционной части числа.|  
|**ЧислоДигит**|Указывает количество десятичных цифр в дробной части числа.|  
|**ЧислоЛидингов**|Определяет, должно ли десятичное значение менее 1 и более -1 содержать ведущие нули; это значение может быть либо ложным (без ведущих нулей), либо True.|  
|**CurrencySymbol**|Указывает символ валюты, который может быть использован для валютных значений в текстовом файле. Примеры включают знак доллара ($) и Dm.|  
|**ВалютаПосФормат**|Может быть установлен на любое из следующих значений:<br /><br /> - Приставка символа валюты без разделения ($1)<br />- Валютный символ суффикс без разделения (1$)<br />- Приставка символа валюты с разделением одного символа ($ 1)<br />- Валютный символ суффикс с одним разделением символов (1 $)|  
|**ВалютныеДидоги**|Определяет число цифр, используемых для дробной части суммы валюты.|  
|**ВалютаНеформат**|Может использоваться одно из следующих значений:<br /><br /> - ($1)<br />- -$1<br />- $-1<br />- $1-<br />- (1$)<br />- -1$<br />- 1-$<br />- 1$-<br />- -1 $<br />- -$ 1<br />- 1 $-<br />- $ 1-<br />- $ -1<br />- 1 - $<br />- ($ 1)<br />- (1 $)<br /><br /> Этот пример показывает знак доллара, но вы должны заменить его соответствующим значением **CurrencySymbol** в фактической программе.|  
|**ВалютаТысячеСимвол**|Указывает символ одного символа, который может быть использован для разделения валютных значений в текстовом файле тысячами.|  
|**ВалютаДецималСимвол**|Может быть установлен на любой отдельный символ, который используется для отделения целого от дробной части суммы валюты.|  
  
> [!NOTE]  
>  При опускании записи используется значение по умолчанию в панели управления Windows.
