---
title: ALTER TABLE - команда SQL | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- alter table [ODBC]
ms.assetid: 3a01a291-f4d9-43bc-a725-5a95546ff364
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 5f656396455a8d5669debc158c3edc866491fcb5
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "63457626"
---
# <a name="alter-table---sql-command"></a>ALTER TABLE (команда SQL)
Программно изменяет структуру таблицы.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
ALTER TABLE TableName1  
   ADD | ALTER [COLUMN] FieldName1  
      FieldType [(nFieldWidth [, nPrecision])]  
      [NULL | NOT NULL]  
      [CHECK lExpression1 [ERROR cMessageText1]]  
      [DEFAULT eExpression1]  
      [PRIMARY KEY | UNIQUE]  
      [REFERENCES TableName2 [TAG TagName1]]  
      [NOCPTRANS]  
 - Or -  
ALTER TABLE TableName1  
   ALTER [COLUMN] FieldName2  
      [NULL | NOT NULL]  
      [SET DEFAULT eExpression2]  
      [SET CHECK lExpression2 [ERROR cMessageText2]]  
      [DROP DEFAULT]  
      [DROP CHECK]  
 - Or -  
ALTER TABLE TableName1  
   [DROP [COLUMN] FieldName3]  
   [SET CHECK lExpression3 [ERROR cMessageText3]]  
   [DROP CHECK]  
   [ADD PRIMARY KEY eExpression3 TAG TagName2]  
   [DROP PRIMARY KEY]  
   [ADD UNIQUE eExpression4 [TAG TagName3]]  
   [DROP UNIQUE TAG TagName4]  
   [ADD FOREIGN KEY [eExpression5] TAG TagName4  
      REFERENCES TableName2 [TAG TagName5]]  
   [DROP FOREIGN KEY TAG TagName6 [SAVE]]  
   [RENAME COLUMN FieldName4 TO FieldName5]  
   [NOVALIDATE]  
```  
  
## <a name="arguments"></a>Аргументы  
 *TableName1*  
 Указывает имя таблицы, структура которого изменяется.  
  
 Установка [столбец] *FieldName1*  
 Указывает имя поля для добавления.  
  
 ALTER [столбец] *FieldName1*  
 Указывает имя существующего поля для изменения.  
  
 *FieldType* [( *nFieldWidth* [, *nPrecision*]])  
 Указывает тип поля, ширины поля и поля, точность (количество знаков после запятой) для нового или измененного поля.  
  
 *FieldType* представляет одну букву, указывающее поля [тип данных](../../odbc/microsoft/visual-foxpro-field-data-types.md). Некоторые типы данных полей необходимо указать *nFieldWidth* или *nPrecision* или оба.  
  
 *nFieldWidth* и *nPrecision* для D, G, я, L, M, P, T и Y игнорируются типов. По умолчанию *nPrecision* является ноль (без десятичных разрядов), если *nPrecision* не входит в состав типов B "," F "или" N.  
  
 NULL | NOT NULL  
 Разрешает или запрещает значения null в поле.  
  
 Если опустить NULL и NOT NULL, текущее значение параметра SET NULL определяет, допустимы ли значения null в поле. Однако если опустить NULL и NOT NULL и содержит первичный ключ или УНИКАЛЬНЫЙ предложение, пропускается текущее значение параметра SET NULL и поле не будет значение NULL по умолчанию.  
  
 ПРОВЕРЬТЕ *lExpression1*  
 Указывает правило проверки для поля. *lExpression1* должно возвращать логическое выражение и может быть определяемой пользователем функции или хранимой процедуры. Каждый раз, когда добавляется пустую запись, проверяются правила проверки. Если правило проверки не допускает наличии пустых значений в записи о присоединенных, формируется ошибка.  
  
 ERROR *cMessageText1*  
 Указывает, отображается сообщение об ошибке при правила проверки поля приводит к ошибке.  
  
 По умолчанию *eExpression1*  
 Задает значение по умолчанию для поля. Тип данных *eExpression1* должны совпадать с типом данных поля.  
  
 PRIMARY KEY  
 Создает тег первичного индекса. Тег индекс имеет имя, что и поле.  
  
 UNIQUE  
 Создает тег кандидата индекс с тем же именем, что и поле.  
  
> [!NOTE]  
>  Кандидат индексов (создания, включив УНИКАЛЬНЫЕ возможности, предоставляемые для совместимости с ANSI в инструкции ALTER TABLE или CREATE TABLE) отличаются от индексов, созданных с помощью параметра УНИКАЛЬНЫМ в команде ИНДЕКСА. Индекс, созданный с помощью UNIQUE в команде индекс допускает повторяющиеся ключи индекса; повторяющиеся ключи индекса не позволяют возможных кандидатур индексов.  
  
 В поле, которое используется для индекса первичные или потенциальные не разрешены значения NULL и повторяющиеся записи.  
  
 При создании нового поля с помощью Добавления СТОЛБЦА, Visual FoxPro не приведет к ошибке, если при создании индекса первичные или потенциальные для поля, поддерживающего значения null. Тем не менее Visual FoxPro приведет к ошибке при попытке ввести значение null или повторяющиеся в поле, которое используется для первичные или потенциальные индекса.  
  
 Если вы изменяете существующее поле и основного или кандидата индексное выражение состоит из полей в таблице, Visual FoxPro проверяет поля, см. в разделе, содержат ли они значения null или повторяющиеся записи. Если это так, Visual FoxPro выдает ошибку и не изменении таблицы.  
  
 Ссылки на *TableName2* ТЕГА *TagName1*  
 Указывает родительской таблицы, к которому устанавливается постоянных связь. ТЕГ *TagName1* указывает тег индекс родительской таблицы, на котором основывается связь. Имена тегов индекс может содержать до 10 символов.  
  
 NOCPTRANS  
 Запрещает преобразование в другую кодовую страницу для символов и типа memo полей. Если таблицы преобразуется в другой кодовой страницы, поля, для которых был указан NOCPTRANS не переводятся. NOCPTRANS можно указать только для полей символов и типа memo.  
  
 Следующий пример создает таблицу с именем mytable, содержащий два символьных полей и два поля типа memo. Во втором поле символа, char2 и второе поле типа memo memo2, включают NOCPTRANS для предотвращения перевода.  
  
```  
CREATE TABLE mytable (char1 C(10), char2 C(10) NOCPTRANS,;  
   memo1 M, memo2 M NOCPTRANS)  
```  
  
 ALTER [столбец] *FieldName2*  
 Указывает имя существующего поля для изменения.  
  
 ЗАДАТЬ по умолчанию *eExpression2*  
 Указывает новое значение по умолчанию для существующего поля. Тип данных *eExpression2* должны совпадать с типом данных поля.  
  
 Проверка НАБОРА *lExpression2*  
 Указывает новое правило проверки для существующего поля. *lExpression2* должно возвращать логическое выражение и может быть определяемой пользователем функции или хранимой процедуры.  
  
 ERROR *cMessageText2*  
 Указывает, отображается сообщение об ошибке при правила проверки поля приводит к ошибке. Сообщение отображается только в том случае, когда данные изменяются в окне просмотра или редактирования.  
  
 DROP DEFAULT  
 Удаляет значение по умолчанию для существующего поля.  
  
 УДАЛИТЕ ФЛАЖОК  
 Удаляет правила проверки для существующего поля.  
  
 DROP [столбец] *FieldName3*  
 Указывает поле, чтобы удалить из таблицы. При удалении поля из таблицы также удаляется значение по умолчанию поля и правила проверки поля.  
  
 Если индекс ключа или триггер выражения ссылаются на поля, выражения становятся недействительными при удалении поля. В этом случае ошибка не появляется, если поле удаляется, но недопустимый индекс ключа или триггер выражения будет создавать ошибки во время выполнения.  
  
 Проверка НАБОРА *lExpression3*  
 Указывает правило проверки таблицы. *lExpression3* должно возвращать логическое выражение и может быть определяемой пользователем функции или хранимой процедуры.  
  
 ERROR *cMessageText3*  
 Указывает сообщение об ошибке отображается, если правило проверки таблицы создает ошибку. Сообщение отображается только в том случае, когда данные изменяются в окне просмотра или редактирования.  
  
 УДАЛИТЕ ФЛАЖОК  
 Удаляет правило проверки таблицы.  
  
 Добавить первичный ключ *eExpression3*ТЕГА *TagName2*  
 Добавляет в таблицу первичного индекса. *eExpression3* указывает выражение индекс первичного ключа, и *TagName2* указывает имя первичного индекса тега. Имена тегов индекс может содержать до 10 символов. Если ТЕГ *TagName2* опущен и *eExpression3* — это единственное поле тега первичный индекс имеет то же имя, как поля, указанного в *eExpression3*.  
  
 УДАЛЕНИЕ ПЕРВИЧНОГО КЛЮЧА  
 Удаление первичного индекса и его тег индекса. Поскольку таблица может иметь только один первичный ключ, не требуется указывать имя первичного ключа. Удаление первичного индекса будут также удалены все постоянные связей на основе первичного ключа.  
  
 ADD UNIQUE *eExpression4*[TAG *TagName3*]  
 Добавляет в таблицу с индексом кандидатов. *eExpression4* указывает выражение потенциальных ключей индекса, и *TagName3* указывает имя тега индекс кандидатов. Имена тегов индекс может содержать до 10 символов. Если опустить ТЕГ *TagName3* и если *eExpression4* — это единственное поле тега кандидата индекс имеет то же имя, как поля, указанного в *eExpression4*.  
  
 УНИКАЛЬНЫЙ МАРКЕР ПЕРЕТАСКИВАНИЯ *TagName4*  
 Удаляет кандидата индекс и его тег индекса. Поскольку таблица может содержать несколько потенциальных ключей, необходимо указать имя тега индекс кандидатов.  
  
 Добавить внешний ключ [ *eExpression5*] ТЕГ *TagName4*  
 Добавляет внешний (непервичных) индекс для таблицы. *eExpression5* указывает внешний индекс ключевое выражение и *TagName4* указывает имя тега внешнего индекса. Имена тегов индекс может содержать до 10 символов.  
  
 Ссылки на *TableName2*[ТЕГ *TagName5*]  
 Указывает родительской таблицы, к которому устанавливается постоянных связь. Следует включить ТЕГ *TagName5* для установления отношения, в зависимости от существующей метки индекса для родительской таблицы. Имена тегов индекс может содержать до 10 символов. Если опустить ТЕГ *TagName5*, связь устанавливается с помощью тега первичный индекс родительской таблицы.  
  
 DROP ВНЕШНЕГО ключа ТЕГА *TagName6*[Сохранить]  
 Удаляет тег которой индекс является внешним ключом *TagName6*. Если опустить сохранить тега индекс удаляется из структуры индекса. Включить сохранить для предотвращения удаления индекса тега из структуры индекса.  
  
 ПЕРЕИМЕНОВАНИЕ СТОЛБЦА *FieldName4*TO *FieldName5*  
 Позволяет изменить имя поля в таблице. *FieldName4* указывает имя поля, которое будет переименован. *FieldName5* новое имя поля.  
  
> [!CAUTION]  
>  Соблюдайте осторожность при переименовании поля таблицы, так как выражения индекса, правила проверки для полей и таблиц, команды и функции могут ссылаться на исходные имена полей.  
  
 NOVALIDATE  
 Указывает, что Visual FoxPro разрешает вносить изменения в структуру таблицы. Эти изменения могут нарушить целостность данных в таблице. По умолчанию Visual FoxPro предотвращает внесение изменений, которые нарушают целостность данных в таблице ALTER TABLE. Включить NOVALIDATE, чтобы переопределить это поведение по умолчанию.  
  
## <a name="remarks"></a>Примечания  
 ALTER TABLE может использоваться для изменения структуры таблицы, которая не была добавлена в базу данных. Тем не менее Visual FoxPro выдает ошибку, если включают по умолчанию, FOREIGN KEY, PRIMARY KEY, ссылки, или ЗАДАТЬ предложения при изменении свободного таблицы.  
  
 ALTER TABLE может перестроить таблицы, создав новый заголовок таблицы и добавлении записей в заголовке таблицы. Например изменение типа или ширины поля может привести к таблице создаются заново.  
  
 После перестройка таблицы, поля правила проверки выполняются для всех полей, тип и ширина изменяется. Если изменить тип или ширину любое поле в таблице, выполняется правило таблицы.  
  
 При изменении поля или таблицы правила проверки для таблицы, имеющей записей, Visual FoxPro проверяет новые поля или таблицы Проверка правила относительно существующих данных и выдает предупреждение при первом возникновении правила проверки поля или таблицы, или о нарушении триггера.  
  
 Если таблица, изменяемых в базе данных, ALTER TABLE - SQL требует монопольного использования базы данных. Чтобы открыть базу данных для монопольного использования, включающий ИСКЛЮЧАЮЩИЙ в базе данных, ОТКРОЙТЕ.  
  
## <a name="see-also"></a>См. также  
 [Создание таблицы - команда SQL](../../odbc/microsoft/create-table-sql-command.md)   
 [Команда INDEX](../../odbc/microsoft/index-command.md)
