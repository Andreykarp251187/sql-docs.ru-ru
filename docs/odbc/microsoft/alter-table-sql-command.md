---
title: ALTER TABLE - Командование СЗЛ (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- alter table [ODBC]
ms.assetid: 3a01a291-f4d9-43bc-a725-5a95546ff364
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 587d721522503f9b392bb8be7433850fd7449efb
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81304715"
---
# <a name="alter-table---sql-command"></a>ALTER TABLE (команда SQL)
Программно изменяет структуру таблицы.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
ALTER TABLE TableName1  
   ADD | ALTER [COLUMN] FieldName1  
      FieldType [(nFieldWidth [, nPrecision])]  
      [NULL | NOT NULL]  
      [CHECK lExpression1 [ERROR cMessageText1]]  
      [DEFAULT eExpression1]  
      [PRIMARY KEY | UNIQUE]  
      [REFERENCES TableName2 [TAG TagName1]]  
      [NOCPTRANS]  
 - Or -  
ALTER TABLE TableName1  
   ALTER [COLUMN] FieldName2  
      [NULL | NOT NULL]  
      [SET DEFAULT eExpression2]  
      [SET CHECK lExpression2 [ERROR cMessageText2]]  
      [DROP DEFAULT]  
      [DROP CHECK]  
 - Or -  
ALTER TABLE TableName1  
   [DROP [COLUMN] FieldName3]  
   [SET CHECK lExpression3 [ERROR cMessageText3]]  
   [DROP CHECK]  
   [ADD PRIMARY KEY eExpression3 TAG TagName2]  
   [DROP PRIMARY KEY]  
   [ADD UNIQUE eExpression4 [TAG TagName3]]  
   [DROP UNIQUE TAG TagName4]  
   [ADD FOREIGN KEY [eExpression5] TAG TagName4  
      REFERENCES TableName2 [TAG TagName5]]  
   [DROP FOREIGN KEY TAG TagName6 [SAVE]]  
   [RENAME COLUMN FieldName4 TO FieldName5]  
   [NOVALIDATE]  
```  
  
## <a name="arguments"></a>Аргументы  
 *ТаблицаНай1*  
 Определяется название таблицы, структура которой изменена.  
  
 ДОБАВЛЕНИЕ «COLUMN» *FieldName1*  
 Уотражайте название поля для добавления.  
  
 ALTER (КОЛАК) *FieldName1*  
 Определяет сяочку названия существующего поля для изменения.  
  
 *ФилдТип* *(nFieldWidth,* *nPrecision)*  
 Определяет тип поля, ширину поля и точность поля (количество десятичных мест) для нового или измененного поля.  
  
 *FieldType* — это единая буква, указывающетип [данных](../../odbc/microsoft/visual-foxpro-field-data-types.md)поля. Некоторые типы полевых данных требуют, чтобы вы указали *nFieldWidth* или *nPrecision* или оба.  
  
 *nFieldWidth* и *nPrecision* игнорируются для типов D, G, I, L, M, P, T и Y. По умолчанию *nPrecision* равен нулю (нет десятичных мест), если *nPrecision* не включен для типов B, F или N.  
  
 NULL &#124; NOT NULL  
 Позволяет или предотвращает нулевые значения в поле.  
  
 Если вы не опускаете NULL и NOT NULL, текущая настройка SET NULL определяет, разрешены ли нулевые значения в поле. Однако, если вы опускаете NULL и NOT NULL и включаете положение PRIMARY KEY или УНИУГВЕ, текущая настройка SET NULL игнорируется, и поле не является НУЛЕК по умолчанию.  
  
 CHECK *lExpression1*  
 Определяет правило проверки для поля. *lExpression1* должен оценить логическое выражение и может быть пользователь-определенной функцией или сохраненной процедурой. Всякий раз, когда придатится к пустой записи, правило проверки проверяется. Ошибка генерируется, если правило проверки не допускает значение пустого поля в приложеной записи.  
  
 ERROR *cMessageText1*  
 Определяет сообщение об ошибке, отображаемый при появлении ошибки правилом проверки поля.  
  
 ПО *УМОЛЧАНИЯ eExpression1*  
 Определяет значение по умолчанию для поля. Тип данных *eExpression1* должен быть таким же, как и тип данных для поля.  
  
 PRIMARY KEY  
 Создает основной тег индекса. Тег индекса имеет то же имя, что и поле.  
  
 UNIQUE  
 Создает тег индекса кандидата с тем же именем, что и поле.  
  
> [!NOTE]  
>  Кандидатские индексы (созданные путем включения опции УНИУТИЭ, предусмотренной для совместимости ANSI в ALTER TABLE или CREATE TABLE) отличаются от индексов, созданных с помощью опции УНИКУЕ в команде INDEX. Индекс, созданный с помощью УНИКУЕ в команде INDEX, позволяет дублировать клавиши индекса; индексы кандидатов не позволяют дублировать клавиши индекса.  
  
 Значения null и дубликаты записей не допускаются в поле, которое используется для первичного или кандидата индекса.  
  
 Если вы создаете новое поле с помощью ADD COLUMN, Visual FoxPro не будет генерировать ошибку, если вы создаете первичный или кандидатский индекс для поля, поддерживающего нулевые значения. Тем не менее, Visual FoxPro будет генерировать ошибку, если вы попытаетесь ввести нулевую или дублирующую значение в поле, которое используется для первичного или кандидата индекса.  
  
 Если вы изменяете существующее поле и выражение первичного или индексного индекса состоит из полей в таблице, Visual FoxPro проверяет поля, содержат ли они нулевые значения или дублируют записи. Если они делают, Visual FoxPro генерирует ошибку и таблица не изменяется.  
  
 СПРАВКА *ТаблицаИмя2* TAG *TagName1*  
 Определяет таблицу родителей, к которой устанавливается постоянные отношения. TAG *TagName1* определяет тег индекса родительской таблицы, на котором основано отношение. Имена индексных тегов могут содержать до 10 символов.  
  
 НОКПТРАНС  
 Предотвращает перевод на другую страницу кода для полей символов и памяток. Если таблица преобразуется в другую страницу кода, поля, для которых указан NOCPTRANS, не переводятся. NOCPTRANS может быть указан только для символов и памятки полей.  
  
 Следующий пример создает таблицу под названием mytable, которая содержит два поля символов и два поля памятки. Второе поле символов, char2, и второе поле памятки, memo2, включают NOCPTRANS для предотвращения перевода.  
  
```  
CREATE TABLE mytable (char1 C(10), char2 C(10) NOCPTRANS,;  
   memo1 M, memo2 M NOCPTRANS)  
```  
  
 ALTER (КОЛАК) *FieldName2*  
 Определяет сяочку названия существующего поля для изменения.  
  
 SET DEFAULT *eExpression2*  
 Определяет новое значение по умолчанию для существующего поля. Тип данных *eExpression2* должен быть таким же, как и тип данных для поля.  
  
 SET CHECK *lExpression2*  
 Определяет новое правило проверки для существующего поля. *lExpression2* должен оценить логическое выражение и может быть пользователь-определенной функцией или сохраненной процедурой.  
  
 ERROR *cMessageText2*  
 Определяет сообщение об ошибке, отображаемый при появлении ошибки правилом проверки поля. Сообщение отображается только при изменении данных в окне просмотра или отсвачения.  
  
 DROP DEFAULT  
 Удаляет значение по умолчанию для существующего поля.  
  
 ПРОВЕРКА ВЫПАДЕНИЯ  
 Удаляет правило проверки для существующего поля.  
  
 DROP (COLUMN) *FieldName3*  
 Определяет поле для удаления со стола. Удаление поля из таблицы также удаляет настройку значения по умолчанию и правило проверки поля.  
  
 Если ключевые выражения индекса или триггерные выражения ссылаются на поле, выражения становятся недействительными при удалении поля. В этом случае ошибка не генерируется при удалении поля, но недействительный ключ индекса или триггерные выражения будут генерировать ошибки во время выполнения.  
  
 SET CHECK *lExpression3*  
 Опознавательный упор на правило проверки таблицы. *lExpression3* должен оценить логическое выражение и может быть пользователь-определенной функцией или сохраненной процедурой.  
  
 ERROR *cMessageText3*  
 Упогоняет сообщение об ошибке, отображаемое при появлении ошибки правилом проверки таблицы. Сообщение отображается только при изменении данных в окне просмотра или отсвачения.  
  
 ПРОВЕРКА ВЫПАДЕНИЯ  
 Удаляет правило проверки таблицы.  
  
 ADD PRIMARY *KEY eExpression3*TAG *TagName2*  
 Добавляет основной индекс в таблицу. *eExpression3* определяет основное выражение ключа индекса, а *TagName2* — название тега первичного индекса. Имена индексных тегов могут содержать до 10 символов. Если TAG *TagName2* опущен и *eExpression3* является единым полем, основной тег индекса имеет то же имя, что и поле, указанное в *eExpression3.*  
  
 ПАДЕНИЕ ПЕРВИЧНОГО КЛЮЧА  
 Удаляет первичный индекс и его тег индекса. Поскольку таблица может иметь только один основной ключ, нет необходимости указывать имя основного ключа. Удаление основного индекса также удаляет любые постоянные отношения, основанные на первичном ключе.  
  
 АДГ УНИКУКЕ *eExpression4*»TAG *TagName3*»  
 Добавляет индекс кандидата в таблицу. *eExpression4* определяет выражение ключа индекса кандидата, а *TagName3* — имя тега индекса кандидата. Имена индексных тегов могут содержать до 10 символов. Если вы не опускаете TAG *TagName3* и если *eExpression4* является единым полем, тег индекса кандидата имеет то же имя, что и поле, указанное в *eExpression4.*  
  
 DROP УНИКУЕ TAG *TagName4*  
 Удаляет индекс кандидата и его тег индекса. Поскольку таблица может иметь несколько ключей кандидата, необходимо указать имя тега индекса кандидата.  
  
 ДОБАВЛЕНИЕ FOREIGN KEY - *eExpression5*TAG *TagName4*  
 Добавляет иностранный (непервичный) индекс в таблицу. *eExpression5* указывает иностранное выражение ключа индекса, а *TagName4* указывает название тега иностранного индекса. Имена индексных тегов могут содержать до 10 символов.  
  
 СПРАВКА *ТаблицаНай2*»TAG *TagName5»*  
 Определяет таблицу родителей, к которой устанавливается постоянные отношения. Включите TAG *TagName5* для установления отношения, основанного на существующем теге индекса для родительской таблицы. Имена индексных тегов могут содержать до 10 символов. Если вы не упускаете TAG *TagName5,* отношение устанавливается с помощью основного индексного тега родительской таблицы.  
  
 DROP FOREIGN KEY *TAGName6*(СЭйв)  
 Удаляет иностранный ключ, индексным тегом которого является *TagName6.* Если вы не удалите SAVE, тег индекса удаляется из структурного индекса. Включите SAVE, чтобы предотвратить удаление тега индекса из структурного индекса.  
  
 КОЛОНКа RENAME *FieldName4*TO *FieldName5*  
 Позволяет изменить название поля в таблице. *FieldName4* определяет название месторождения, которое переименовано. *FieldName5* определяет новое название поля.  
  
> [!CAUTION]  
>  Проявляйтесь внимательности при переименовании полей таблицы, поскольку выражения индексов, правила проверки полей и таблицы, команды и функции могут ссылаться на исходные имена полей.  
  
 НЕТНЕЛИВЕР  
 Уточняется, что Visual FoxPro позволяет вносить изменения в структуру таблицы; эти изменения могут нарушить целостность данных в таблице. По умолчанию Visual FoxPro предотвращает изменения ALTER TABLE, нарушающие целостность данных в таблице. Включите NOVALIDATE, чтобы переопределить это поведение по умолчанию.  
  
## <a name="remarks"></a>Remarks  
 ALTER TABLE можно использовать для изменения структуры таблицы, которая не была добавлена в базу данных. Тем не менее, Visual FoxPro генерирует ошибку, если вы включаете ПО УМОЛЧАНИЯ, FOREIGN KEY, PRIMARY KEY, REFERENCES, или SET положения при изменении свободной таблицы.  
  
 ALTER TABLE может восстановить таблицу, создав новый заголовок таблицы и приложив записи к заголовку таблицы. Например, изменение типа или ширины поля может привести к перестроению таблицы.  
  
 После перестроения таблицы правила проверки полей выполняются для любых полей, тип или ширина которых изменены. При изменении типа или ширины любого поля в таблице выполняется правило таблицы.  
  
 Если вы измените правила проверки поля или таблицы для таблицы с записями, Visual FoxPro тестирует новые правила проверки поля или таблицы на существующие данные и выдает предупреждение о первом возникновении правила проверки поля или таблицы или нарушения триггера.  
  
 Если изовергаемая таблица находится в базе данных, ALTER TABLE - S'L требует исключительного использования базы данных. Чтобы открыть базу данных для эксклюзивного использования, включите EXCLUSIVE в OPEN DATABASE.  
  
## <a name="see-also"></a>См. также:  
 [CREATE TABLE - Командование СЗЛ](../../odbc/microsoft/create-table-sql-command.md)   
 [Команда INDEX](../../odbc/microsoft/index-command.md)
