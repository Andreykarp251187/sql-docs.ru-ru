---
title: Определение формата текста (драйвер для текстовых файлов) | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- text format [ODBC]
- text file driver [ODBC], text format
ms.assetid: 3af46dad-52cc-4d5c-a27e-6315d65a74e6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 29dc46525f3c81e5abffe5076988716a01df06df
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "81307665"
---
# <a name="defining-text-format-text-file-driver"></a>Определение формата текста (драйвер для текстовых файлов)
При использовании текстового драйвера диалоговое окно **Определение формата текста** можно использовать для определения формата столбцов в выбранном файле. Это диалоговое окно позволяет указать схему для каждой таблицы данных. Эти сведения записываются в файл Schema. ini в каталоге источника данных. Для каждого исходного каталога текстовых данных создается отдельный файл Schema. ini.  
  
> [!NOTE]  
>  Тот же формат файла по умолчанию применяется ко всем новым таблицам текстовых данных. Все файлы, созданные инструкцией CREATE TABLE, наследуют те же значения формата по умолчанию, которые задаются путем выбора значений формат файла в диалоговом \<окне **Определение формата текста** с> по умолчанию, выбранным в списке **таблицы** . Текстовый драйвер не изменяет формат существующего текстового файла так, чтобы он соответствовал формату, определенному в этом диалоговом окне, но возвращает ошибку при использовании формата, например при попытке получить данные из текстового файла.  
  
 В диалоговом окне **Определение формата текста** доступны следующие параметры.  
  
|Параметр|Сведения|  
|------------|-----------------|  
|**Добавление**|Добавляет столбец, используя значения в поле **тип данных**, **имя**и **Ширина** в диалоговом окне и, если применимо, значение разделителя даты из Schema. ini.|  
|**Буквы**|**ANSI** или **OEM**. Изготовитель оборудования задает кодировку, отличную от ANSI. По умолчанию принимает значение OEM, если формат элемента, выбранного в списке **таблицы** , не был ранее определен этим диалоговым окном.|  
|**Заголовок имени столбца**|Указывает, следует ли использовать столбцы первой строки выбранной таблицы в качестве имен столбцов. Либо **true** , либо **false**. Значение по умолчанию — FALSE, если формат элемента, выбранного в списке **таблицы** , не был ранее определен этим диалоговым окном.|  
|**Столбцы**|Перечисляет имена столбцов для каждого столбца в выбранной таблице. Порядок столбцов отражает порядок столбцов в таблице. Этот список включается, если файл был выбран в списке **таблицы** .|  
|**Тип данных**|Может принимать значения BIT, BYTE, CHAR, CURRENCY, DATE, FLOAT, INTEGER, ЛОНГЧАР, SHORT или SINGLE. Типы данных даты могут быть в следующих форматах: "дд-ммм-гг", "mm-дд-гг", "МММ-дд-гг", "гггг-мм-дд" или "гггг-МММ-дд". "mm" обозначает числа месяцев; "MMM" обозначает буквы в месяцах.|  
|**Разделитель**|Указывает настраиваемый символ разделителя, используемый для разделения столбцов. Включается при выборе формата с **пользовательскими разделителями** . Разделитель может иметь длину только один символ, и в качестве символа-разделителя нельзя использовать двойные кавычки ("). (Разделитель не может быть указан в шестнадцатеричном или десятичном формате.)|  
|**Формат**|Либо с разделителями, либо с фиксированной длиной. Если используется разделитель, указывает тип используемого разделителя: запятая (CSV), TAB или специальный символ (настраиваемый). Значение по умолчанию — **CSV** , если формат элемента, выбранного в списке **таблицы** , не был ранее определен этим диалоговым окном.<br /><br /> Если **Формат** имеет фиксированную длину, а **заголовок имени столбца** имеет значение true, то первая строка должна быть разделена запятыми.|  
|**Угадать**|Автоматически создает значения типа данных столбца, имени и ширины столбцов в выбранной таблице, проверяя содержимое таблицы в соответствии с выбором поля **Формат** . Включается, если формат таблицы разделен. Все ранее определенные столбцы в списке **столбцы** очищаются и заменяются новыми записями. Если не выбран **заголовок «имя столбца** », имена столбцов создаются автоматически как «F1», «F2» и т. д. В поле **тип данных** не отображается значение по умолчанию.<br /><br /> Эта функция работает только со столбцами размером менее 64 513 байт.|  
|**Изменение**|Изменяет выбранный столбец, используя значения в поле **тип данных**, **имя**и **Ширина**.|  
|**имя**;|Отображает имя выбранного столбца. Можно использовать для указания нового имени столбца либо для существующего столбца, либо для нового столбца.<br /><br /> Если **заголовок column name** имеет значение true, отображаемое имя столбца игнорируется.|  
|**Удалить**|Удаляет выбранный столбец.|  
|**Строки для проверки**|Число строк, которые программа установки или драйвер проверит при задании типов данных столбцов и столбцов на основе существующих данных.<br /><br /> Число строк для просмотра можно ввести от 1 до 32767. По умолчанию используется значение 25, если формат элемента, выбранного в списке **таблицы** , не был ранее определен этим диалоговым окном. (Число за пределами ограничения будет возвращать ошибку.)|  
|**Таблицы**|Содержит список всех файлов в каталоге, выбранном в диалоговом окне " **Настройка текста** ", который соответствует указанному списку расширений.<br /><br /> Если \<выбрано> по умолчанию и одно из следующих значений имеет значение true, значения атрибутов таблицы в группе **таблиц** записываются в Schema. ini (не затрагиваются другие записи в файле Schema. ini):<br /><br /> — В указанном каталоге отсутствует Schema. ini.<br />— Файл Schema. ini существует, но в файле Schema. ini нет раздела для одного из текстовых файлов (с указанным расширением) в каталоге.<br />— Раздел для текстового файла существует в файле Schema. ini, но сам текст пуст.<br /><br /> Если \<выбран параметр> по умолчанию, группа **столбцы** отключена.|  
|**Ширина**|Ширину столбца можно изменить для столбцов типа CHAR или ЛОНГЧАР. Ширина по умолчанию равна 1, если формат элемента, выбранного в списке **таблицы** , не был ранее определен этим диалоговым окном.<br /><br /> Для других типов данных элемент управления "ширина" отключается, и значение не отображается.|
