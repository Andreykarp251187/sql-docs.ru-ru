---
title: Командование ИНДЕКС (англ.) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- index command [ODBC]
ms.assetid: 694e8cf5-2f69-4001-9c1e-b735a4da3aff
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: bcb30a49cb9f11ddd4c61621116aa4bd8ddcf186
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81300034"
---
# <a name="index-command"></a>Команда INDEX
Создает файл индекса для отображения и доступа к записям таблиц в логическом порядке.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
INDEX ON eExpression TO IDXFileName | TAG TagName [OF CDXFileName]  
   [FOR lExpression]  
   [COMPACT]  
   [ASCENDING | DESCENDING]  
   [UNIQUE | CANDIDATE]  
   [ADDITIVE]  
```  
  
## <a name="arguments"></a>Аргументы  
 *eExpression*  
 Определяет выражение индекса, которое может включать имя поля или полей из текущей таблицы. Ключ индекса, основанный на выражении индекса, создается в файле индекса для каждой записи в таблице. Visual FoxPro использует эти ключи для отображения и доступа к записям в таблице.  
  
> [!NOTE]  
>  Хотя eExpression не рекомендуется, *eExpression* также может быть переменной памяти, элементом массива или выражением поля или поля из таблицы в другой рабочей области. Поля памятки не могут использоваться в одиночку в выражениях индексных файлов; они должны сочетаться с другими выражениями символов. Если вы получаете доступ к индексу, содержащему переменную или поле, которое больше не существует или не может быть расположено, Visual FoxPro генерирует сообщение об ошибке.  
  
 Если вы попытаетесь построить индекс с ключом, который изменяется в длину, ключ будет проложен пробелами. Клавиши индекса переменной длины не поддерживаются в Visual FoxPro.  
  
 Можно создать ключ индекса с нулевой длиной. Например, ключ индекса нулевой длины создается, когда выражение индекса является подстрокой пустого поля памятки. Ключ индекса нулевой длины генерирует сообщение об ошибке. Когда Visual FoxPro создает индекс, он оценивает поля в первой записи в таблице. Если поле пусто, возможно, потребуется ввести некоторые временные данные в поле в первой записи, чтобы предотвратить ключ индекса 0 длины.  
  
 ДЛЯ *IDXFileName*  
 Создает индексный файл .idx. Файл индекса получает расширение по умолчанию .idx.  
  
 TAG *TagName*(OF *CDXFileName)*  
 Создает составной индексный файл. Файл составных индексов представляет собой единый индексный файл, состоящий из любого количества отдельных тегов (индексных записей). Каждый тег идентифицируется по его уникальному имени тега. Имена тегов должны начинаться с буквы или подчеркивания и могут состоять из любой комбинации до 10 букв, цифр или подчеркиваев. Количество тегов в файле индекса соединения ограничено только доступным пространством памяти и диска.  
  
 Файлы индекса соединения с несколькими входами всегда компактны. Не обязательно включать COMPACT при создании файла сажа. Названия сложных индексных файлов даются расширением .cdx.  
  
 Можно создать два типа сложных индексных файлов: структурный и неструктурный.  
  
 **Файлы индекса структурных соединений** Вы можете создать файл индекса структурного соединения с *TAGName,* исключив необязательный пункт *CDXFileName.* Файл индекса структурного соединения всегда имеет то же базовое имя, что и таблица, и автоматически открывается при открытии таблицы.  
  
 **Файлы индекса неструктурных соединений** Вы можете создать неструктурные соединения индексный файл, включив *CDXFileName* после TAG *TagName*. В отличие от индексного файла структурного соединения, файл индекса неструктурных соединений должен быть явно открыт с оговоркой ИНДЕКС а в USE.  
  
 Если файл индекса соединения уже создан и открыт, выдача ИНДЕКСа с TAG *TagName* добавляет тег в файл индекса соединения.  
  
 ДЛЯ *lExpression*  
 Освеольм условие, при котором для отображения и доступа доступны только записи, удовлетворяющие экспрессии фильтра *lExpression;* индексные ключи создаются в файле индекса только для тех записей, которые соответствуют выражению фильтра.  
  
 Визуальный FoxPro Рашмор технология оптимизирует ИНДЕКС ... ДЛЯ *команды lExpression,* если *lExpression* является оптимизируемым выражением. Для наилучшей производительности используйте оптимизируемое выражение в оговорке FOR.  
  
 Компактный  
 Создает компактный файл .idx.  
  
 По возрастанию  
 Укажите возрастающий порядок для файла .cdx. По умолчанию теги .cdx создаются в порядке возрастания. (Вы можете включить ASCENDING в качестве напоминания о порядке индексного файла.) Таблица может быть проиндексирована в обратном порядке путем включения DESCENDING.  
  
 По убыванию  
 Укажите порядок убывания для файла .cdx. Вы не можете включить DESCENDING при создании файлов индекса .idx.  
  
 UNIQUE  
 Уточняется, что только первая запись, встречаемых с определенным значением ключа индекса, включена в файл .idx или тег .cdx. УНИКЕ может быть использован для предотвращения отображения или доступа к дублирующим записям. Все записи, добавленные с дубликатами индексных ключей, исключаются из индексного файла. Использование опции УНИУАлиСИИ INDEX идентично для выполнения SET УНИКУЭ НА перед выдачей INDEX или REINDEX.  
  
 Когда индекс или индексный тег УНИКУЕ активен и дубликатная запись изменяется таким образом, чтобы изменять его ключ индекса, индекс или тег индекса обновляется. Однако следующая запись дубликата с исходным ключом индекса не доступна или отображается до тех пор, пока вы не переиндексируете файл с помощью REINDEX.  
  
 Кандидат  
 Создает тег структурного индекса кандидата. Ключевое слово CANDIDATE может быть включено только при создании структурного тега индекса; в противном случае Visual FoxPro генерирует сообщение об ошибке.  
  
 Тег индекса кандидата предотвращает дублирование значений в поле или комбинацию полей, указанных в *экспрессии индекса eExpression.* Термин *«кандидат»* относится к типу индекса; поскольку индексы кандидатов предотвращают дублирование значений, они квалифицируются как "кандидат" как основной индекс.  
  
 Visual FoxPro генерирует ошибку, если вы создаете тег индекса кандидата для поля или комбинации полей, которые уже содержат дубликаты значений.  
  
 Добавка  
 Сохраняет открытыми все ранее открытые файлы индекса. Если вы не упускаете пункт ADDITIVE при создании индексного файла или файлов для таблицы с INDEX, все ранее открытые файлы индекса (кроме индекса структурного соединения) закрываются.  
  
## <a name="remarks"></a>Remarks  
 Записи в таблице с индексным файлом отображаются и доступны в порядке, указанном выражением индекса. Физический порядок записей в таблице не изменяется файлом индекса.  
  
## <a name="index-types"></a>Типы индексов  
 Visual FoxPro позволяет создавать два типа индексных файлов:  
  
-   Соедините файлы индекса .cdx, содержащие несколько записей индекса, называемых тегами  
  
-   Индексные файлы .idx, содержащие одну запись индекса  
  
 Можно также создать файл индекса структурного соединения, который автоматически открывается таблицей.  
  
> [!NOTE]  
>  Поскольку файлы индекса структурных соединений автоматически открываются при открытии таблицы, они являются предпочтительным типом индекса.  
  
 Включите COMPACT для создания компактных индексных файлов .idx. Файлы индекса соединения всегда компактны.  
  
## <a name="index-order-and-updating"></a>Порядок индекса и обновление  
 Только один файл индекса (файл основного индекса) или тег (мастер-тег) контролирует порядок, в котором отображается или к нему находится доступ таблица. Некоторые команды (SEEK, например) используют файл основного индекса или тег для поиска записей. Однако все открытые файлы индекса .idx и .cdx обновляются по мере внесения изменений в таблицу.  
  
## <a name="user-defined-functions"></a>Определяемые пользователем функции  
 Хотя выражение индекса может содержать функцию, определяемую пользователем, не следует использовать функции, определяемые пользователем, в выражении индекса. Функции, определяемые пользователем в выражении индекса, увеличивают время, необходимое для создания или обновления индекса. Кроме того, обновления индекса могут не происходить, когда функция, определяемая пользователем, используется для выражения индекса.  
  
 Если вы используете функцию, определяемую пользователем, в выражении индекса, Visual FoxPro должен быть в состоянии найти функцию, определяемую пользователем. Когда Visual FoxPro создает индекс, выражение индекса сохраняется в файле индекса, но в выражение индекса включена только ссылка на функцию, определяемую пользователем.  
  
## <a name="see-also"></a>См. также:  
 [ALTER TABLE - Командование СЗЛ](../../odbc/microsoft/alter-table-sql-command.md)   
 [Командование DELETE TAG](../../odbc/microsoft/delete-tag-command.md)   
 [Команда SET COLLATE](../../odbc/microsoft/set-collate-command.md)   
 [Команда SET UNIQUE](../../odbc/microsoft/set-unique-command.md)
