---
title: Архитектура драйверов настольных баз данных (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- Jet-based ODBC drivers [ODBC], architecture
- ODBC desktop database drivers [ODBC], architecture
- desktop database drivers [ODBC], architecture
ms.assetid: 8b4d13f7-ab37-40b4-a9c6-145e7385352f
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: ae6fb72bb3ed0a9bca1571eb572bbfbd20fe9995
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81288744"
---
# <a name="desktop-database-drivers-architecture"></a>Архитектура драйверов для баз данных на настольном компьютере
Эти драйверы предназначены для использования на Microsoft Windows 95 или позже, или Windows NT 4.0 и Windows 2000. Только 32-разрядные приложения поддерживаются на Windows 95 или позже; 16-битные и 32-разрядные приложения поддерживаются на Windows NT 4.0 и Windows 2000.  
  
> [!NOTE]  
>  Для получения информации о версии ODBC, которая будет использоваться с этими драйверами, обратитесь к *справке программиста ODBC,* а также к прошлым и текущим примечаниям к выпуску. За исключением отмеченных областей, эти драйверы соответствуют *справке программиста ODBC.*  
  
 Драйверы настольной базы данных ODBC включают 32-разрядные драйверы для Microsoft Access, dBASE, Microsoft Excel, Paradox и Text. Нет 16-битных драйверов включены. (Драйвер для Microsoft FoxPro доступен отдельно.)  
  
 Архитектура приложения/драйвера на Windows 95 или позже:  
  
 ![Архитектура драйверов&#47;приложения: Windows 95 и более поздние](../../odbc/microsoft/media/odbcjetarch1.gif "ODBCJetArch1")  
  
 Использование этих драйверов 16-битными приложениями на Windows 95 не поддерживается.  
  
 Архитектура приложений/драйверов на Windows NT 4.0 и Windows 2000:  
  
 ![Архитектура драйверов&#47;приложения: NT 4.0 и Windows 2000](../../odbc/microsoft/media/odbcjetarch2.gif "ODBCJetArch2")  
  
 Драйверы настольных баз данных являются двухъярусными драйверами. В двухуровневой конфигурации драйвер не выполняет процесс разбора, проверки, оптимизации и выполнения запроса. Вместо этого Microsoft Jet выполняет эти задачи. Он обрабатывает вызовы ODBC API и действует как движок S'L. Microsoft Jet стала неотъемлемой, неотъемлемой частью драйверов: он поставляется с драйверами и проживает с драйверами, даже если ни одно другое приложение на компьютере использует его.  
  
 Драйверы настольной базы данных состоят из шести различных драйверов - или, точнее, одного файла драйвера (Odbcjt32.dll), который [диспетчер драйверов](../../odbc/reference/the-driver-manager.md) ODBC использует шестью различными способами. Флаг DRIVERID в регистрационном входе для источника данных определяет, какой драйвер в Odbcjt32.dll использует менеджер драйвера. Приложение передает этот флаг в строке соединения, включенной в вызов на **S'LDriverConnect.** По умолчанию флаг является идентификатором драйвера Microsoft Access.  
  
 Файл установки драйвера изменяет флаг DRIVERID во время установки. Все драйверы, кроме драйвера Microsoft Access, имеют связанную настройку DLL. При **нажатии на настройку** в [Microsoft ODBC Data Source Administrator](../../odbc/admin/odbc-data-source-administrator.md) для источника данных установщик DLL ODBC (Odbcinst.dll) загружает настройку DLL. Установка DLL экспортирует функцию установки ODBC **S'LConfigDataSource**. Если ручка окна передается на **s'LConfigDataSource,** эта функция отображает окно настройки и изменяет флаг DRIVERID в соответствии с выбранным из пользовательского интерфейса драйвером.  
  
 Когда файл создается программно, ручка окна NULL передается **на s'LConfigDataSource,** и функция создает источник данных динамически, изменяя флаг DRIVERID в соответствии с аргументом *lpszDriver* в вызове функции.  
  
 Odbcjt32.dll реализует функции ODBC поверх API Microsoft Jet. Однако прямого отображения между функциями ODBC и Microsoft Jet не существует. Многие факторы, такие как модели курсора и картографирование СЗЛ, предотвращают прямую корреляцию функций.  
  
 Драйвер ODBC находится между движком Microsoft Jet и менеджером драйверов ODBC. Некоторые функции ODBC, вызванные приложением, обрабатываются менеджером драйвера и не передаются водителю. Для этих функций Microsoft Jet никогда не видит вызов функции, поскольку он не имеет прямого подключения к менеджеру драйвера.
