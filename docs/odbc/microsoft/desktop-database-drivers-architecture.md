---
title: Архитектура драйверов для баз данных на настольном | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- Jet-based ODBC drivers [ODBC], architecture
- ODBC desktop database drivers [ODBC], architecture
- desktop database drivers [ODBC], architecture
ms.assetid: 8b4d13f7-ab37-40b4-a9c6-145e7385352f
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 7487d073b95190418ee7f6900390a2d60ce42e13
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "62629068"
---
# <a name="desktop-database-drivers-architecture"></a>Архитектура драйверов для баз данных на настольном компьютере
Эти драйверы предназначены для использования на Microsoft Windows 95 и более поздних версиях или Windows NT 4.0 и Windows 2000. Поддерживается только 32-разрядных приложений в Windows 95 или более поздней версии; 16-разрядных и 32-разрядных приложений поддерживаются в Windows NT 4.0 и Windows 2000.  
  
> [!NOTE]  
>  Сведения о версии ODBC для использования с драйверами см *Справочник по программированию ODBC*и заметки о выпуске прошлых и текущих. За исключением области отмечено выше, эти драйверы соответствуют *Справочник по программированию ODBC*.  
  
 Драйверы для баз данных ODBC Desktop включают 32-разрядные драйверы для Microsoft Access, dBASE, Microsoft Excel, Paradox и текст. Отсутствует 16 - разрядные драйверы включены. (Драйвер для Microsoft FoxPro доступна отдельно.)  
  
 Архитектура приложения/драйвера в Windows 95 или более поздней версии является:  
  
 ![Приложение&#47;архитектура драйвера: Windows 95 и более поздние версии](../../odbc/microsoft/media/odbcjetarch1.gif "ODBCJetArch1")  
  
 Эти драйверы с 16-разрядных приложений в Windows 95 не поддерживается.  
  
 Архитектура приложения/драйвера в Windows NT 4.0 и Windows 2000 является:  
  
 ![Приложение&#47;архитектура драйвера: Windows NT 4.0 и Windows 2000](../../odbc/microsoft/media/odbcjetarch2.gif "ODBCJetArch2")  
  
 Драйверы для баз данных Desktop являются драйверами два уровня. В двухуровневой конфигурации драйвер не выполняет процесс синтаксического анализа, проверки, оптимизация и выполнения запроса. Вместо этого Jet (Майкрософт) выполняет следующие задачи. Он обрабатывает вызовы ODBC API и выступает в качестве подсистемы SQL. Microsoft Jet становится неотъемлемой, неотделимыми частями драйверы: Он поставляется с драйверами и находится с драйверами, даже если никакие другие приложения на компьютере, использует его.  
  
 Драйверы для баз данных Desktop состоят из шести различными драйверами — или, точнее, один файл драйвера (Odbcjt32.dll), ODBC [диспетчера драйверов](../../odbc/reference/the-driver-manager.md) использует шесть различными способами. Флаг DRIVERID в записи реестра для источника данных определяет, какой драйвер в Odbcjt32.dll использует диспетчера драйверов. Приложение передает этот флаг в строке подключения, включенные в вызове **SQLDriverConnect**. По умолчанию флаг — идентификатор драйвером Microsoft Access.  
  
 Файл установки драйвера изменяет флаг DRIVERID во время установки. Все драйверы, за исключением драйвером Microsoft Access имеют связанные библиотеки DLL программы установки. При нажатии кнопки **установки** в [администратор источников данных ODBC Microsoft](../../odbc/admin/odbc-data-source-administrator.md) для источника данных ODBC установщик DLL (Odbcinst.dll) загружает DLL-файлов установки. Программа установки библиотеки DLL экспортирует функцию установщика ODBC **SQLConfigDataSource**. Если передается дескриптор окна **SQLConfigDataSource**, эта функция отображает окно программы установки и изменяет флаг DRIVERID в соответствии с драйвером, выбранные из пользовательского интерфейса.  
  
 Когда файл создается программным способом, передается дескриптор окна NULL **SQLConfigDataSource**, и функция создает источник данных динамически, флага DRIVERID согласно *lpszDriver*аргумента в вызове функции.  
  
 Odbcjt32.dll реализует функции ODBC на основе Microsoft Jet API. Тем не менее нет однозначного соответствия между функций ODBC и Jet (Майкрософт). Множество факторов, таких как модели курсора и сопоставление SQL, не прямая корреляция функций.  
  
 Драйвер ODBC находится между Microsoft Jet Database engine и диспетчер драйверов ODBC. Некоторые функции ODBC, вызывается приложением обрабатываются диспетчером драйверов и не будут передаваться драйвер. Для этих функций Microsoft Jet не видит вызов, так как он не поддерживает прямое подключение к диспетчеру драйверов функции.
