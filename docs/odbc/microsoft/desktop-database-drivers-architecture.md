---
title: Архитектура драйверов баз данных для настольных систем | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- Jet-based ODBC drivers [ODBC], architecture
- ODBC desktop database drivers [ODBC], architecture
- desktop database drivers [ODBC], architecture
ms.assetid: 8b4d13f7-ab37-40b4-a9c6-145e7385352f
author: MightyPen
ms.author: genemi
ms.openlocfilehash: ccd1f14b0cfbcbdbc675a142ebabf11932409832
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68071912"
---
# <a name="desktop-database-drivers-architecture"></a>Архитектура драйверов для баз данных на настольном компьютере
Эти драйверы предназначены для использования в Microsoft Windows 95 или более поздней версии, а также в Windows NT 4,0 и Windows 2000. В Windows 95 или более поздних версиях поддерживаются только 32-разрядные приложения; 16-разрядные и 32-разрядные приложения поддерживаются в Windows NT 4,0 и Windows 2000.  
  
> [!NOTE]  
>  Сведения о версии ODBC для использования с этими драйверами см. в *справочнике программиста по ODBC*, а также в прошлых и текущих заметках о выпуске. За исключением отмеченных областей, эти драйверы соответствуют *Справочнику программиста ODBC*.  
  
 Драйверы базы данных ODBC для настольных систем включают 32-разрядные драйверы для Microsoft Access, dBASE, Microsoft Excel, Paradox и Text. 16-разрядные драйверы не включены. (Драйвер для Microsoft FoxPro доступен отдельно.)  
  
 Архитектура приложения/драйвера в Windows 95 или более поздней версии:  
  
 ![Архитектура драйвера&#47;приложений: Windows 95 и более поздних версий](../../odbc/microsoft/media/odbcjetarch1.gif "ODBCJetArch1")  
  
 Использование этих драйверов 16-разрядными приложениями в Windows 95 не поддерживается.  
  
 Архитектура приложений и драйверов в Windows NT 4,0 и Windows 2000:  
  
 ![Архитектура драйвера&#47;приложений: NT 4,0 и Windows 2000](../../odbc/microsoft/media/odbcjetarch2.gif "ODBCJetArch2")  
  
 Драйверы базы данных для настольных систем — это два уровня драйверов. В двухуровневой конфигурации драйвер не выполняет процесс синтаксического анализа, проверки, оптимизации и выполнения запроса. Вместо этого Microsoft Jet выполняет эти задачи. Он обрабатывает вызовы API ODBC и выступает в качестве ядра SQL. Microsoft Jet стала неотъемлемой частью могли драйверов: она поставляется с драйверами и размещается вместе с драйверами, даже если другие приложения на компьютере не используют его.  
  
 Драйверы базы данных для настольных систем состоят из шести разных драйверов или более точно, одного файла драйвера (Odbcjt32. dll), который [Диспетчер драйверов](../../odbc/reference/the-driver-manager.md) ODBC использует в шести разных направлениях. Флаг ДРИВЕРИД в записи реестра для источника данных определяет, какой драйвер в Odbcjt32. dll используется диспетчером драйверов. Приложение передает этот флаг в строку подключения, входящую в вызов **SQLDriverConnect**. По умолчанию флагом является идентификатор драйвера Microsoft Access.  
  
 Файл установки драйвера изменяет флаг ДРИВЕРИД во время установки. Все драйверы, за исключением драйвера Microsoft Access, имеют связанную с ним библиотеку DLL установки. При нажатии кнопки **Настройка** в [Администраторе источников данных Microsoft ODBC](../../odbc/admin/odbc-data-source-administrator.md) для источника данных Библиотека DLL установщика ODBC (Odbcinst. DLL) загружает библиотеку DLL установки. Библиотека DLL установки экспортирует функцию установщика ODBC **SQLConfigDataSource**. Если обработчик окна передается в **SQLConfigDataSource**, эта функция отображает окно настройки и изменяет флаг дриверид в соответствии с драйвером, выбранным из пользовательского интерфейса.  
  
 Если файл создается программно, в **SQLConfigDataSource**передается нулевой указатель, а функция динамически создает источник данных, изменяя флаг дриверид в соответствии с аргументом *лпсздривер* в вызове функции.  
  
 Odbcjt32. DLL реализует функции ODBC поверх Microsoft Jet API. Однако прямое сопоставление между функциями ODBC и Microsoft Jet отсутствует. Многие факторы, такие как модели курсоров и сопоставление SQL, предотвращают прямую корреляцию функций.  
  
 Драйвер ODBC находится между ядром Microsoft Jet и диспетчером драйверов ODBC. Некоторые функции ODBC, вызываемые приложением, обрабатываются диспетчером драйверов и не передаются драйверу. Для этих функций Microsoft Jet никогда не видит вызов функции, так как у него нет прямого подключения к диспетчеру драйверов.
