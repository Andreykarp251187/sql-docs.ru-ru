---
title: Функции API уровня ядра (драйвер ODBC для Oracle) | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- functions [ODBC], ODBC driver for Oracle
- ODBC driver for Oracle [ODBC], functions
- core level API functions [ODBC]
- ODBC core level API functions [ODBC]
ms.assetid: 8596eed7-bda6-4cac-ae1f-efde1aab785f
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 19751bb6d0556b117d0a73967d4db00c408733ac
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "81281024"
---
# <a name="core-level-api-functions-odbc-driver-for-oracle"></a>Функции API основного уровня (драйвер ODBC для Oracle)
> [!IMPORTANT]  
>  Эта функция будет удалена в следующей версии Windows. Избегайте использования этого компонента в новых разработках и запланируйте изменение существующих приложений, в которых он применяется. Вместо этого используйте драйвер ODBC, предоставляемый Oracle.  
  
 Функции на этом уровне составляют минимальный уровень соответствия интерфейса драйверам ODBC.  
  
|API, функция|Примечания|  
|------------------|-----------|  
|**SQLAllocConnect**|Выделяет память для маркера подключения *хдбк*в среде, определяемой *хенв*. Диспетчер драйверов обрабатывает этот вызов и вызывает функцию **SQLAllocConnect** драйвера при вызове **SQLConnect**, **SQLBrowseConnect**или **SQLDriverConnect** .|  
|**SQLAllocEnv**|Отображает диалоговое окно, в котором указывается требование для клиентского программного обеспечения Oracle, а затем возвращается SQL_NULL_HANDLE. Если клиентское программное обеспечение Oracle не установлено, эта функция выделяет память для обработчика среды, *хенв*и инициализирует интерфейс уровня вызовов ODBC для использования приложением.|  
|**SQLAllocStmt**|Выделяет память для маркера инструкции и связывает маркер инструкции с соединением, заданным параметром хдбк. Диспетчер драйверов передает этот вызов драйверу, который выделяет память для структуры хстмт.|  
|**SQLBindCol**|Назначает дисковое пространство для результирующего столбца и указывает тип результата.|  
|**SQLCancel**|Отменяет обработку в маркере инструкции, хстмт. В некоторых случаях Oracle не допускает отмену выполняющейся инструкции. Это означает, что выполнение инструкции будет продолжено до тех пор, пока Oracle не завершит процесс, после чего результаты инструкций будут отменены драйвером ODBC для Oracle.|  
|**SQLColAttributes**|Возвращает сведения о дескрипторе для столбца в результирующем наборе. Сведения о дескрипторе возвращаются в виде символьной строки, 32-разрядного значения, зависящего от дескриптора, или целочисленного значения.|  
|**SQLConnect**|Подключается к источнику данных. Чтобы использовать проверку подлинности операционной системы Oracle, укажите "/" в качестве параметра *сзуид* и "" в качестве параметра *сзаусстр* .|  
|**SQLDescribeCol**|Возвращает имя, тип, точность, масштаб и допустимость значений NULL для данного столбца результатов. **Примечание. SQLDescribeCol** сообщает вычисляемые столбцы как SQL_VARCHAR.|  
|**SQLDisconnect**|Закрывает соединение. Если для общей среды включена поддержка пулов соединений и приложение вызывает **SQLDisconnect** для подключения в этой среде, подключение возвращается в пул соединений и по-прежнему доступно для других компонентов, использующих ту же общую среду.|  
|**SQLError**|Возвращает сведения об ошибке или состоянии последней ошибки. Драйвер поддерживает стек или список ошибок, которые могут быть возвращены для аргументов *хстмт*, *хдбк*и *хенв* в зависимости от того, как выполняется вызов **SqlError** . Очередь ошибок очищается после каждой инструкции. Обычно получает сообщение об ошибке Oracle и, в противном случае, пустое.|  
|**SQLExecDirect**|Выполняет новую, неподготовленную инструкцию SQL. Драйвер использует текущие значения переменных маркера параметра, если в инструкции существуют какие либо параметры. Если имена таблицы, представления или поля содержат пробелы, заключите их в кавычки. Например, если база данных содержит таблицу с именем *Моя таблица* и поле *My*, заключите каждый элемент идентификатора следующим образом:<br /><br /> Выберите \`мою таблицу\`. \`Мой поле1\`,; \`Моя таблица\`. \`Мой field2\` из \`моей таблицы\`|  
|**SQLExecute**|Выполняет подготовленную инструкцию SQL (инструкцию, уже подготовленную **SQLPrepare**). Драйвер использует текущие значения переменных маркера параметра, если в инструкции существуют какие либо параметры.|  
|**SQLFetch**|Извлекает одну строку из результирующего набора в расположения, указанные предыдущими вызовами метода **SQLBindCol**. Подготавливает драйвер для вызова **SQLGetData** для непривязанных столбцов.|  
|**SQLFreeConnect**|Освобождает дескриптор подключения и освобождает всю память, выделенную для дескриптора.|  
|**SQLFreeEnv**|Закрывает драйвер ODBC для Oracle и освобождает всю память, связанную с драйвером.|  
|**Функция SQLFreeStmt**|Останавливает обработку, связанную с конкретным хстмт, закрывает все открытые курсоры, связанные с хстмт, отменяет ожидающие результаты и при необходимости освобождает все ресурсы, связанные с этим маркером инструкции.|  
|**SQLGetCursorName**|Возвращает имя курсора, связанного с заданным хстмт.|  
|**SQLNumResultCols**|Возвращает число столбцов в курсоре результирующего набора.|  
|**SQLPrepare**|Подготавливает инструкцию SQL, планируя оптимизацию и выполнение инструкции. Инструкция SQL компилируется для выполнения с помощью **SQLExecDirect**.<br /><br /> Если имена таблицы, представления или поля содержат пробелы, заключите их в кавычки. Например, если база данных содержит таблицу с именем *Моя таблица* и поле *My*, заключите каждый элемент идентификатора следующим образом:<br /><br /> Выберите \`мою таблицу\`. \`Мое поле\` из \`таблицы\`<br /><br /> Сведения об использовании результирующих наборов, содержащих массивы в качестве формальных параметров, см. [в разделе Возврат параметров массива из хранимых процедур](../../odbc/microsoft/returning-array-parameters-from-stored-procedures.md).|  
|**SQLRowCount**|Oracle не предоставляет способ определения количества строк в результирующем наборе до тех пор, пока не будет получена последняя строка, поэтому возвращается значение-1.|  
|**SQLSetCursorName**|Связывает имя курсора с активным маркером инструкции, *хстмт*.|  
|**SQLSetParam**|Заменено на SQLBindParameter в ODBC 2. *x*.|  
|**SQLTransact**|Запрашивает операцию фиксации или отката для всех активных операций на всех дескрипторах инструкций (хстмтс), связанных с соединением, или для всех соединений, связанных с дескриптором среды *хенв*. Если фиксация завершается ошибкой в ручном режиме, транзакция остается активной; можно выбрать откат транзакции или повторить операцию фиксации. Если операция фиксации завершается неудачей в автоматическом режиме транзакций, происходит автоматический откат транзакции. транзакция не может быть неактивной.|
