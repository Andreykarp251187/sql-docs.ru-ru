---
title: Когда следует использовать процедуры | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL statements [ODBC], procedures
- procedures [ODBC], about procedures
ms.assetid: 7dc9e327-dd54-4b10-9f66-9ef5c074f122
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 6f25b629372bbe089489cccdbfa0258dafef3dd0
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "68078975"
---
# <a name="when-to-use-procedures"></a>Когда следует использовать процедуры
Существует ряд преимуществ, с помощью процедуры, все основана на том факте, что с помощью процедур перемещает инструкции SQL из приложения к источнику данных. В приложении, осталась вызов процедуры с возможностью взаимодействия. Имеет следующие преимущества:  
  
-   **Производительность** процедуры обычно являются самым быстрым способом выполнять инструкции SQL. Как и подготовленное выполнение, инструкция компилируется и выполняется в двух отдельных действий. В отличие от подготовленное выполнение процедуры выполняются только во время выполнения. Они не будут скомпилированы в другое время.  
  
-   **Бизнес-правила** объект *бизнес-правило* правило о способе, в котором компания ведет дела. К примеру только пользователь с заголовком менеджера по продажам может быть разрешено добавлять новых заказов на продажу. Размещение этих правил в процедурах позволяет отдельных компаний настраивать вертикальные приложения, преобразование процедур, вызываемых из приложения без необходимости изменять код приложения. Например, приложение для ввода заказов может вызывать процедуру **InsertOrder** с фиксированным числом параметров; точный способ **InsertOrder** реализуется может меняться от компании к компании.  
  
-   **Replaceability** тесно связанные с размещение бизнес-правила в процедурах является тот факт, что процедуры могут быть заменены без повторной компиляции приложения. Если бизнес-правило изменяется после купила и установить приложение компании, компании можно изменить процедуру, содержащую этого правила. С точки зрения приложения ничего не изменилось; он по-прежнему вызывает определенной процедуры для выполнения конкретной задачи.  
  
-   **СУБД SQL** процедуры предоставляют способ для приложений для использования СУБД SQL и по-прежнему остаются с возможностью взаимодействия. Например процедура на СУБД, поддерживающий инструкций управления потоком в SQL может перехватывать и восстановление после ошибок, хотя процедуры в СУБД, не поддерживают инструкции управления потоком может просто вернуть ошибку.  
  
-   **Процедуры выжить транзакции** некоторых источников данных, планы доступ для всех подготовленных инструкций для подключения будут удалены при фиксации или отката транзакции. Путем размещения операторов SQL в процедурах, которые постоянно хранятся в источнике данных, операторы выжить транзакции. Следует ли процедуры выжить в подготовленный частично подготовлен, или что нынешнее зависит от СУБД.  
  
-   **Разделите разработки** процедуры может быть разработан отдельно от остальной части приложения. В больших организациях это может предоставить способ Дополнительно задействовать навыки специализированной программистов. Другими словами разработчики приложений можно написать код пользовательского интерфейса, и программистов базы данных можно написать процедуру.  
  
 Процедуры обычно используются с вертикальной и пользовательских приложений. Эти приложения, как правило, для выполнения основных задач, и существует возможность вызовов процедур жестко закодировать в них. Например, приложение для ввода заказов может вызывать процедуры **InsertOrder**, **DeleteOrder**, **UpdateOrder**, и **GetOrders** .  
  
 Не имеет практического смысла для вызова процедуры из универсальных приложений. Процедуры обычно пишутся для выполнения задачи в контексте конкретного приложения, поэтому не используйте для универсальных приложений. Например, электронной таблицы у него нет причин для вызова **InsertOrder** упомянутой выше процедуры. Кроме того универсальные приложения не следует создавать процедуры во время выполнения, рассчитывая предоставление более быстрого выполнения инструкции; мало того, правило, это будет более медленной, чем выполнение подготовленного или direct, это также потребует выполнения инструкций SQL СУБД.  
  
 Исключением является сред разработки приложений, они часто позволяют программистам создавать инструкции SQL, выполняемых процедур и может позволяют программистам тестирование процедур. Такой вызов сред **SQLProcedures** в списке доступных процедур и **SQLProcedureColumns** Чтобы получить список входных данных, ввода вывода и выходные параметры, процедура возвращает значение и столбцы никаких результирующих наборов, созданных процедурой. Тем не менее таких процедур следует разрабатывать заранее в каждый источник данных; Это требует инструкций СУБД SQL.  
  
 Существуют три основные недостатки использования процедур. Первый — что процедуры записи и компиляции для каждого СУБД, с которым приложение — это выполнить. Хотя это не проблема для пользовательских приложений, он может значительно увеличить разработки и обслуживания время вертикальные приложения может работать с количеством СУБД.  
  
 Второй недостатком является то, что многие СУБД не поддерживают процедуры. Опять же это скорее всего, это вызывает проблему в вертикальные приложения может работать с количеством СУБД. Чтобы определить, поддерживается ли процедуры, приложение вызывает **SQLGetInfo** с параметром SQL_PROCEDURES.  
  
 Третий недостаток, который обычно применяется в средах разработки приложения, — это что ODBC не определяет грамматику standard для создания процедур. То есть несмотря на то, что приложения могут вызывать процедуры interoperably, не могут создавать их interoperably.
