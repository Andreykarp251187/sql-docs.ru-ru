---
title: Когда использовать процедуры Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL statements [ODBC], procedures
- procedures [ODBC], about procedures
ms.assetid: 7dc9e327-dd54-4b10-9f66-9ef5c074f122
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 31aeea226bc8c8aa41f748d1d9a97d55147c4d67
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81289101"
---
# <a name="when-to-use-procedures"></a>Когда следует использовать процедуры
Использование процедур имеет ряд преимуществ, все из них основаны на том факте, что с помощью процедур переносит сяповые выписки из приложения в источник данных. То, что осталось в заявке, является совместимым вызовом процедуры. К числу этих преимуществ относятся:  
  
-   **Производительность** Процедуры, как правило, являются самым быстрым способом выполнения инструкций по S'L. Как и подготовленное исполнение, заявление компилируется и выполняется в два отдельных шага. В отличие от подготовленного выполнения, процедуры выполняются только во время выполнения. Они компилируются в другое время.  
  
-   **Бизнес-правила** *Бизнес-правило* — это правило о том, как компания ведет бизнес. Например, добавлять новые заказы на продажу может только человек с заголовком «Продавец». Размещение этих правил в процедурах позволяет отдельным компаниям настраивать вертикальные приложения путем переписывания процедур, вызванных приложением, без изменения кода приложения. Например, приложение для ввода заказа может вызвать процедуру **InsertOrder** с фиксированным числом параметров; точно как **InsertOrder** снабжено может поменять от компании к компании.  
  
-   **Заменяемость** Тесно связано с размещением бизнес-правил в процедурах тот факт, что процедуры могут быть заменены без перекомпиляции приложения. Если бизнес-правило меняется после того, как компания купила и установила приложение, компания может изменить процедуру, содержащую это правило. С точки зрения приложения, ничего не изменилось; он по-прежнему вызывает определенную процедуру для выполнения конкретной задачи.  
  
-   **DBMS-специфический СЗЛ** Процедуры предоставляют приложениям возможность использовать dBMS-специфический СЗЛ и по-прежнему оставаться совместимыми. Например, процедура на DBMS, поддерживающая операторы управления потоками в S'L, может заманить в ловушку и восстановиться после ошибок, в то время как процедура на DBMS, не поддерживающая операторы управления потоком, может просто вернуть ошибку.  
  
-   **Процедуры выживают сделок** На некоторых источниках данных планы доступа ко всем подготовленным заявлениям о подключении удаляются при совершении или откате транзакции. Размещая операторы S'L в процедурах, которые постоянно хранятся в источнике данных, операторы выживают в транзакции. Выдерживает ли процедуры в подготовленном, частично подготовленном или неподготовленном состоянии, это специфично dBMS.  
  
-   **Отдельное развитие** Процедуры могут быть разработаны отдельно от остальной части приложения. В крупных корпорациях это может дать возможность в дальнейшем использовать навыки высокоспециализированных программистов. Другими словами, программисты приложений могут писать код пользовательского интерфейса, а программисты баз данных могут писать процедуры.  
  
 Процедуры обычно используются вертикальными и пользовательскими приложениями. Эти приложения, как правило, выполняют фиксированные задачи, и это возможно жесткий код процедуры вызовов в них. Например, приложение для ввода заказа может вызвать процедуры **InsertOrder,** **DeleteOrder,** **UpdateOrder**и **GetOrders.**  
  
 Существует мало оснований для вызова процедур из общих приложений. Процедуры обычно пишутся для выполнения задачи в контексте конкретного приложения и поэтому не имеют смысла для общих приложений. Например, электронная таблица не имеет оснований для вызова только что упомянутой процедуры **InsertOrder.** Кроме того, общие приложения не должны создавать процедуры в момент выполнения в надежде обеспечить более быстрое выполнение выписки; это может быть не только медленнее, чем подготовлено или прямое выполнение, но и требует конкретных dBMS-инструкций.  
  
 Исключением являются среды разработки приложений, которые часто предоставляют программистам возможность создавать операторы S'L, выполняющие процедуры, и могут предоставить программистам возможность тестирования процедур. Такие среды вызывают **S'LProcedures** для перечня доступных процедур и **S'LProcedureColumns,** чтобы перечислить входные данные, входные/выходные параметры и параметры вывода, значение возврата процедуры и столбцов любых наборов результатов, созданных процедурой. Однако такие процедуры должны разрабатываться заранее по каждому источнику данных; для этого требуются выписки по специфическим DBMS.  
  
 Использование процедур имеет три основных недостатка. Во-первых, процедуры должны быть написаны и составлены для каждого DBMS, с которым приложение должно работать. Хотя это не является проблемой для пользовательских приложений, это может значительно увеличить время разработки и обслуживания вертикальных приложений, предназначенных для работы с рядом DBMS.  
  
 Вторым недостатком является то, что многие DBMS s не поддерживают процедуры. Опять же, это, скорее всего, будет проблемой для вертикальных приложений, предназначенных для запуска с рядом DBMSs. Чтобы определить, поддерживаются ли процедуры, приложение вызывает **s'LGetInfo** с SQL_PROCEDURES опцией.  
  
 Третий недостаток, который особенно применим к средам разработки приложений, заключается в том, что ODBC не определяет стандартную грамматику для создания процедур. То есть, хотя приложения могут вызывать процедуры совместимо, они не могут создавать их совместимо.
