---
title: Когда следует использовать процедуры | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL statements [ODBC], procedures
- procedures [ODBC], about procedures
ms.assetid: 7dc9e327-dd54-4b10-9f66-9ef5c074f122
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 31aeea226bc8c8aa41f748d1d9a97d55147c4d67
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "81289101"
---
# <a name="when-to-use-procedures"></a>Когда следует использовать процедуры
Использование процедур имеет ряд преимуществ, и все зависит от того факта, что использование процедур перемещает инструкции SQL из приложения в источник данных. То, что осталось в приложении, — это вызов процедуры с возможностью взаимодействия. К этим преимуществам относятся:  
  
-   **Производительность** Процедуры обычно являются самым быстрым способом выполнения инструкций SQL. Как и подготовленное выполнение, инструкция компилируется и выполняется в два отдельных шага. В отличие от подготовленного выполнения, процедуры выполняются только во время выполнения. Они компилируются в другое время.  
  
-   **Бизнес-правила** *Бизнес-правило* — это правило, определяющее способ организации бизнеса. Например, для добавления новых заказов на продажу может быть разрешено только лицо с заголовком "менеджер по продажам". Размещение этих правил в процедурах позволяет индивидуальным компаниям настраивать вертикальные приложения путем перезаписи процедур, вызываемых приложением, без необходимости изменения кода приложения. Например, приложение для ввода заказа может вызвать процедуру **инсертордер** с фиксированным числом параметров. точно то, как реализуется **инсертордер** , может варьироваться от компании до компании.  
  
-   **Заменяемость** Тесное посвященное размещению бизнес-правил в процедурах является тот факт, что процедуры можно заменить без повторной компиляции приложения. Если бизнес-правило изменяется после того, как компания приобрела и установила приложение, компания может изменить процедуру, содержащую это правило. С точки зрения приложения ничего не изменилось; Он по-прежнему вызывает определенную процедуру для выполнения определенной задачи.  
  
-   **SQL, зависящий от СУБД** Процедуры позволяют приложениям использовать SQL, зависящие от СУБД, и по-прежнему оставаться в работоспособном виде. Например, процедура в СУБД, которая поддерживает инструкции управления потоком в SQL, может быть подвергнута перехвату и восстановлению из-за ошибок, а процедура СУБД, которая не поддерживает инструкции управления потоком, может просто вернуть ошибку.  
  
-   **Процедуры сохранятся из транзакций** В некоторых источниках данных планы доступа для всех подготовленных инструкций в соединении удаляются при фиксации или откате транзакции. Поместив инструкции SQL в процедуры, которые постоянно хранятся в источнике данных, эти инструкции остаются в транзакции. Сохранятся ли хранимые процедуры в подготовленном, частично подготовленном или неподготовленном состоянии для конкретной СУБД.  
  
-   **Отдельная разработка** Процедуры можно разрабатывать отдельно от остальной части приложения. В крупных корпорациях это может дать возможность более эффективно использовать навыки строго специализированных программистов. Иными словами, программисты приложения могут написать код пользовательского интерфейса и программистов базы данных, которые могут создавать процедуры.  
  
 Процедуры обычно используются в вертикальных и пользовательских приложениях. Эти приложения обычно выполняют фиксированные задачи, и в них можно жестко кодировать вызовы процедур. Например, приложение для ввода заказа может вызывать процедуры **инсертордер**, **делетеордер**, **UpdateOrder**и **заказы**.  
  
 Для вызова процедур из универсальных приложений существует небольшая причина. Процедуры обычно пишутся для выполнения задачи в контексте определенного приложения и поэтому не используют универсальные приложения. Например, электронная таблица не имеет причины вызывать процедуру **инсертордер** , которую мы только что упоминали. Более того, универсальные приложения не должны создавать процедуры во время выполнения в надеется, что обеспечивает более быстрое выполнение инструкций; Это, скорее всего, медленнее, чем подготовка или прямое выполнение, но также требует инструкций SQL, зависящих от СУБД.  
  
 Исключением являются среды разработки приложений, которые часто предоставляют программистам возможность создавать инструкции SQL, которые выполняют процедуры и могут предоставить программистам возможность тестирования процедур. Такие среды вызывают **SQLProcedures** , чтобы получить список доступных процедур и **SQLProcedureColumns** для перечисления входных, входных и выходных параметров, возвращаемого значения процедуры и столбцов всех результирующих наборов, созданных процедурой. Однако такие процедуры должны разрабатываться заранее в каждом источнике данных. для этого требуются инструкции SQL, относящиеся к СУБД.  
  
 Существует три основных недостатка использования процедур. Во-первых, процедуры должны быть написаны и скомпилированы для каждой СУБД, с которой должно выполняться приложение. Хотя это и не является проблемой для пользовательских приложений, оно может значительно увеличить время разработки и обслуживания для вертикальных приложений, предназначенных для работы с несколькими СУБД.  
  
 Второй недостаток заключается в том, что многие СУБД не поддерживают процедуры. Это, скорее всего, является проблемой для вертикальных приложений, предназначенных для работы с несколькими СУБД. Чтобы определить, поддерживаются ли процедуры, приложение вызывает **SQLGetInfo** с параметром SQL_PROCEDURES.  
  
 Третьим недостатком, особенно применимым к средам разработки приложений, является то, что ODBC не определяет стандартную грамматику для создания процедур. То есть, хотя приложения могут вызывать процедуры интероперабли, они не могут создавать их интероперабли.
