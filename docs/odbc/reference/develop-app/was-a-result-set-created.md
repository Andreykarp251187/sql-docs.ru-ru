---
description: Был ли создан результирующий набор?
title: Был ли создан результирующий набор? | Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- result sets [ODBC], determining if created
ms.assetid: 4a83b8cb-2d57-4e64-b497-80bd587ee1f9
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 57b65c254f48d9c3f5078c3b2c1f576ae54d4740
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88421388"
---
# <a name="was-a-result-set-created"></a>Был ли создан результирующий набор?
В большинстве случаев программисты приложения узнают, будут ли инструкции, выполняемые их приложениями, создавать результирующий набор. Это происходит, если приложение использует жестко запрограммированные инструкции SQL, написанные программистом. Обычно это происходит, когда приложение формирует инструкции SQL во время выполнения: программист может легко включать код, помечающий, создается ли инструкция **SELECT** или инструкция **INSERT** . В некоторых ситуациях программист не может определить, будет ли результирующий набор создаваться инструкцией. Это справедливо, если приложение предоставляет пользователю способ ввода и выполнения инструкции SQL. Это также справедливо, когда приложение формирует инструкцию во время выполнения для выполнения процедуры.  
  
 В таких случаях приложение вызывает **SQLNumResultCols** , чтобы определить количество столбцов в результирующем наборе. Если это значение равно 0, инструкция не создает результирующий набор. Если это любое другое число, инструкция создает результирующий набор.  
  
 Приложение может вызвать **SQLNumResultCols** в любое время после подготовки или выполнения инструкции. Однако, поскольку некоторые источники данных не могут легко описать результирующие наборы, которые будут созданы подготовленными инструкциями, производительность снизится, если **SQLNumResultCols** вызывается после подготовки инструкции, но до ее выполнения.  
  
 Некоторые источники данных также поддерживают определение количества строк, возвращаемых инструкцией SQL в результирующем наборе. Для этого приложение вызывает **SQLRowCount**. Точно то, что представляет число строк, определяется параметром SQL_DYNAMIC_CURSOR_ATTRIBUTES2, SQL_FORWARD_ONLY_CURSOR_ATTRIBUTES2, SQL_KEYSET_CURSOR_ATTRIBUTES2 или SQL_STATIC_CURSOR_ATTRIBUTES2 (в зависимости от типа курсора), возвращаемого вызовом **SQLGetInfo**. Эта битовая маска указывает для каждого типа курсора, является ли возвращенное количество строк точным, приблизительным или недоступным. Влияние изменений на количество строк для статических курсоров или управляемых набором ключей указателей на изменения, вносимые с помощью **SQLBulkOperations** или **SQLSetPos**или с помощью позиционированных инструкций UPDATE или DELETE, зависит от других битов, возвращенных теми же аргументами параметров, которые были перечислены выше. Дополнительные сведения см. в описании функции [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md) .
