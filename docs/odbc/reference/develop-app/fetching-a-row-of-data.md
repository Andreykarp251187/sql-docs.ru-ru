---
title: Получение ряда данных (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQLFetch function [ODBC], fetching a row of data
- cursors [ODBC], fetching rows
- result sets [ODBC], fetching
- fetches [ODBC], row of data
ms.assetid: 16d4a380-0d83-456b-aeee-f10738944e86
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: a702f561b756d5305020df9f015d3ea4b444caa6
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81305675"
---
# <a name="fetching-a-row-of-data"></a>Выборка строки данных
Чтобы получить ряд данных, приложение вызывает **S'LFetch**. **СЗЛУТ** может быть вызван с любым видом курсора, но он перемещает курсор гребного набора только в направлении только вперед. **SLFetch** продвигает курсор к следующему ряду и возвращает данные для любых столбцов, которые были связаны вызовами на **S'LBindCol.** Когда курсор достигает конца набора результатов, **S'LFetch** возвращается SQL_NO_DATA. Примеры вызова **S'LFetch** [см.](../../../odbc/reference/develop-app/using-sqlbindcol.md)  
  
 Точно, как **осуществляется S'LFetch,** является специфическим для драйвера, но общий шаблон заключается в том, чтобы водитель извлекал данные для любых связанных столбцов из источника данных, преобразовывал их в соответствии с типами связанных переменных и размещал преобразованные данные в этих переменных. Если драйвер не может преобразовать какие-либо данные, **S'LFetch** возвращает ошибку. Приложение может продолжить поиск строк, но данные для текущей строки потеряны. То, что происходит с данными для несвязанных столбцов, зависит от драйвера, но большинство драйверов либо извлекают и выбрасывают их, либо вообще не извлекают.  
  
 Драйвер также устанавливает значения любых буферов длины/индикатора, которые были связаны. Если значение данных для столбца null, драйвер устанавливает соответствующий буфер длины/индикатора на SQL_NULL_DATA. Если значение данных не является НУЛЕВ, драйвер устанавливает буфер длины/индикатора на длину данных после преобразования. Если эта длина не может быть определена, как это иногда бывает с длинными данными, которые извлекаются более чем одним вызовом функции, драйвер устанавливает буфер длины/индикатора для SQL_NO_TOTAL. Для типов данных с фиксированной длиной, таких как целые числа и структуры дат, длина байта представляет собой размер типа данных.  
  
 Для данных с переменной длиной, таких как символ и двоичные данные, водитель проверяет длину байт преобразованных данных на длину буфера, привязанного к столбцу; длина буфера указана в аргументе *BufferLength* в **S'LBindCol**. Если длина переоборудованных данных превышает длину буфера байт, водитель усечен и устанавливает данные, чтобы поместиться в буфер, возвращает непросеченную длину в буфере длины/индикатора, возвращает SQL_SUCCESS_WITH_INFO и помещает s'LSTATE 01004 (данные усеченные) в диагностике. Единственным исключением является то, что закладка с переменной длиной усечена при возврате **s'LFetch**, который возвращает S'LSTATE 22001 (струнные данные, право усеченные).  
  
 Данные с фиксированной длиной никогда не усечены, поскольку драйвер предполагает, что размер связанного буфера — это размер типа данных. Усечение данных, как правило, редко, потому что приложение обычно связывает буфер достаточно большой, чтобы держать все значение данных; он определяет необходимый размер из метаданных. Однако приложение может явно связать буфер, который, как ему известно, слишком мал. Например, он может получить и отобразить первые 20 символов описания детали или первые 100 символов длинной текстовой колонки.  
  
 Данные о персонажах должны быть аннулированы водителем до его возврата в приложение, даже если они были усечены. Символ нулевого прекращения не включен в возвращенную длину байта, но требует места в связанном буфере. Например, предположим, что приложение использует строки, состоящие из данных символов в наборе символов ASCII, драйвер имеет 50 символов данных для возврата, а буфер приложения составляет 25 байтов длиной. В буфере приложения водитель возвращает первые 24 символа с последующим символом с нулевым прекращением. В буфере длины/индикатора он возвращает длину байт 50.  
  
 Приложение может ограничить количество строк в наборе результатов, установив атрибут SQL_ATTR_MAX_ROWS оператора перед выполнением оператора, создающего набор результатов. Например, режим предварительного просмотра в приложении, используемом для формата отчетов, требует достаточного количества данных для отображения первой страницы отчета. Ограничивая размер набора результатов, такая функция будет работать быстрее. Этот атрибут оператора предназначен для уменьшения сетевого трафика и может поддерживаться не всеми драйверами.
