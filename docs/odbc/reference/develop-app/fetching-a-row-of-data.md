---
description: Выборка строки данных
title: Выборка строки данных | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQLFetch function [ODBC], fetching a row of data
- cursors [ODBC], fetching rows
- result sets [ODBC], fetching
- fetches [ODBC], row of data
ms.assetid: 16d4a380-0d83-456b-aeee-f10738944e86
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 71ced7d7df30f1bb4f784317b76f7b42553951df
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88499894"
---
# <a name="fetching-a-row-of-data"></a>Выборка строки данных
Чтобы получить строку данных, приложение вызывает **SQLFetch**. **SQLFetch** можно вызывать с любым видом курсора, но он перемещает только курсор набора строк только в прямом направлении. **SQLFetch** перемещает курсор к следующей строке и возвращает данные для всех столбцов, которые были привязаны к вызовам **SQLBindCol**. Когда курсор достигает конца результирующего набора, **SQLFetch** возвращает SQL_NO_DATA. Примеры вызова **SQLFetch**см. в разделе [Использование SQLBindCol](../../../odbc/reference/develop-app/using-sqlbindcol.md).  
  
 Точно то, как реализуется **SQLFetch** , зависит от драйвера, но общий шаблон предназначен для того, чтобы драйвер получал данные для всех связанных столбцов из источника данных, преобразует его в соответствии с типами привязанных переменных и помещает преобразованные данные в эти переменные. Если драйвер не может преобразовать какие бы то ни было данные, **SQLFetch** возвращает ошибку. Приложение может продолжить выборку строк, но данные для текущей строки теряются. Что происходит с данными для несвязанных столбцов, зависит от драйвера, но большинство драйверов извлекают и отменяют их или никогда не извлекают их вообще.  
  
 Драйвер также задает значения всех буферов длины или индикатора, которые были привязаны. Если значение данных для столбца равно NULL, драйвер устанавливает соответствующий буфер длины или индикатора для SQL_NULL_DATA. Если значение данных не равно NULL, драйвер устанавливает буфер длины или индикатора в байтовую длину данных после преобразования. Если эта длина не может быть определена, как и в случае с длинными данными, получаемыми более чем одним вызовом функции, драйвер задает SQL_NO_TOTAL буферу длины или индикатора. Для типов данных фиксированной длины, таких как целые числа и структуры дат, длина байта равна размеру типа данных.  
  
 Для данных переменной длины, таких как символьные и двоичные данные, драйвер проверяет длину байт преобразованных данных по байтовой длине буфера, привязанного к столбцу. Длина буфера указана в аргументе *BufferLength* в **SQLBindCol**. Если длина байта преобразованных данных превышает длину в байтах буфера, драйвер усекает данные для размещения в буфере, возвращает неусеченную длину в буфере длины или индикатора, возвращает SQL_SUCCESS_WITH_INFO и помещает SQLSTATE 01004 (данные усекаются) в диагностике. Единственным исключением является то, что закладка переменной длины усекается при возврате функцией **SQLFetch**, которая возвращает SQLSTATE 22001 (строковые данные, усеченные справа).  
  
 Данные фиксированной длины никогда не усекаются, так как драйвер предполагает, что размер связанного буфера равен размеру типа данных. Усечение данных, как правило, происходит редко, поскольку приложение обычно привязывает буфер, достаточно большой для хранения всего значения данных; Он определяет необходимый размер из метаданных. Однако приложение может явно привязать буфер, который он знает слишком маленьким. Например, он может получить и отобразить первые 20 символов описания части или первые 100 символов для длинного текстового столбца.  
  
 Перед возвратом в приложение символьные данные должны завершаться нулем, даже если они были усечены. Символ завершения со значением NULL не включается в возвращаемую байтовую длину, но требует наличия пространства в связанном буфере. Например, предположим, что приложение использует строки, состоящие из символьных данных, в кодировке ASCII, драйвер содержит 50 символов возвращаемых данных, а буфер приложения имеет длину 25 байт. В буфере приложения драйвер возвращает первые 24 символа, за которыми следует символ завершения со значением NULL. В буфере длины и индикатора возвращается длина в байтах, равная 50.  
  
 Приложение может ограничить число строк в результирующем наборе, установив атрибут инструкции SQL_ATTR_MAX_ROWS перед выполнением инструкции, которая создает результирующий набор. Например, в режиме предварительного просмотра в приложении, используемом для форматирования отчетов, достаточно данных для вывода первой страницы отчета. При указании размера результирующего набора такая возможность будет выполняться быстрее. Этот атрибут инструкции предназначен для уменьшения сетевого трафика и может не поддерживаться всеми драйверами.
