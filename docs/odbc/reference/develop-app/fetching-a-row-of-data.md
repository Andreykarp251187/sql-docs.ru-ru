---
title: Выборка строки данных | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQLFetch function [ODBC], fetching a row of data
- cursors [ODBC], fetching rows
- result sets [ODBC], fetching
- fetches [ODBC], row of data
ms.assetid: 16d4a380-0d83-456b-aeee-f10738944e86
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 012e454d03a0eb4ad16095353351d67e50d9586a
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63061522"
---
# <a name="fetching-a-row-of-data"></a>Выборка строки данных
Для получения строки данных, приложение вызывает **SQLFetch**. **SQLFetch** может вызываться с любого типа курсора, но только курсор перемещается в набор строк в направлении только вперед. **SQLFetch** перемещает курсор на следующую строку и возвращает данные для всех столбцов, которые были связаны с вызовами **SQLBindCol**. Когда курсор достигает конца результат задано, **SQLFetch** не вернет значение SQL_NO_DATA. Для примера вызова **SQLFetch**, см. в разделе [использование SQLBindCol](../../../odbc/reference/develop-app/using-sqlbindcol.md).  
  
 Как именно **SQLFetch** реализуется специфические для драйвера, а также общие шаблон — для получения данных для любой присоединенные столбцы из источника данных, преобразовать его в соответствии с типами привязанным переменным и поместите драйвера преобразованные данные в этих переменных. Если драйвер не может преобразовать любые данные **SQLFetch** возвращает сообщение об ошибке. Приложение может продолжить выборка строк, но данные для текущей строки будут потеряны. Что происходит с данными для несвязанных столбцов зависит от драйвера, но большинство драйверов либо получить и удалить или никогда не получить его вообще.  
  
 Драйвер также задает значения длины и индикатора буферов, которые были связаны. Если значение столбца равно NULL, драйвер задает соответствующий буфер длины/индикатора на SQL_NULL_DATA. Если значение не равно NULL, драйвер устанавливает буфера длины и индикатора байтовая длина данных после преобразования. Если эта длина невозможно определить, что иногда происходит при использовании длинных данных, извлеченных методом более одного вызова функции, драйвер устанавливает буфера длины и индикатора SQL_NO_TOTAL. Для типов данных фиксированной длины, такие как Integer и структуры даты байтовая длина — это размер типа данных.  
  
 Для данных переменной длины, например символьных и двоичных данных драйвер проверяет байтовая длина преобразованных данных от длину в байтах буфера, привязанное к столбцу; Длина буфера задается в *BufferLength* аргумента в **SQLBindCol**. Если байтовая длина преобразованных данных превышает длину буфера в байтах, драйвер производит усечение данных, чтобы уместиться в буфере, возвращает неусеченный длина буфера длины и индикатора, возвращает значение SQL_SUCCESS_WITH_INFO и помещает SQLSTATE 01004 (данные усеченный) диагностики. Единственное исключение — Если закладка переменной длины отбрасывается, если возвращенный **SQLFetch**, который возвращает SQLSTATE 22001 (строковые данные, усечение справа).  
  
 Данные фиксированной длины никогда не усекается, поскольку драйвер предполагает, что размер буфера привязанного является размером типа данных. Усечение данных обычно редко, так как приложение обычно связывает буфер недостаточно велик для хранения значения типа данных; он определяет нужного размера на основе метаданных. Тем не менее приложение может явно связать буфер известных слишком мал. Например может получить и отобразить первым 20 символам часть описания или первые 100 символов столбца длинный текст.  
  
 Символьные данные должны быть нулем драйвером перед возвратом к приложению, даже если они будут усечены. Знак завершения null не включен в возвращаемый байт, но требует пространства в буфере привязки. Например предположим, приложение использует строки, состоящие из символьных данных в кодировке ASCII и драйвер имеет 50 символов данных для возвращения приложения буфера равен 25 байтам. В буфере приложения драйвер возвращает первые 24 символов, за которым следует символ завершения null. В буфер длины/индикатора он возвращает длиной 50 байт.  
  
 Приложение можно ограничить количество строк в результирующем наборе, установив атрибут инструкции SQL_ATTR_MAX_ROWS перед выполнением инструкции, которая создает результат. Например режим предварительного просмотра в приложении, используемый для форматирования отчетов необходимо только недостаточно данных для отображения первой страницы отчета. За счет ограничения размера результирующего набора, такая возможность будет выполняться быстрее. Этот атрибут инструкции предназначены для сокращения сетевого трафика и могут не поддерживаться все драйверы.
