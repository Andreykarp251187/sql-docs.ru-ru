---
title: Дескрипторы операторов | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- statement handles [ODBC]
- handles [ODBC], statement
ms.assetid: 65d6d78b-a8c8-489a-9dad-f8d127a44882
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 730ead7bf90af3b6e6906fe184e0fa3312212137
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68107262"
---
# <a name="statement-handles"></a>Дескрипторы инструкций
Проще всего рассматривать *оператор* как инструкцию SQL, например ** \* SELECT от Employee**. Однако оператор не просто является инструкцией SQL, он состоит из всех сведений, связанных с этой инструкцией SQL, например, всех результирующих наборов, созданных инструкцией и параметрами, используемыми при выполнении инструкции. Оператору даже не обязательно иметь определенную приложением инструкцию SQL. Например, если в инструкции выполняется функция каталога, например **SQLTables** , она выполняет предопределенную инструкцию SQL, которая возвращает список имен таблиц.  
  
 Каждая инструкция определяется с помощью маркера оператора. Инструкция связана с одним соединением, и для этого соединения может существовать несколько инструкций. Некоторые драйверы ограничивают количество активных инструкций, которые они поддерживают; параметр SQL_MAX_CONCURRENT_ACTIVITIES в **SQLGetInfo** указывает, сколько активных инструкций поддерживает драйвер в одном соединении. Инструкция определена как *Активная* , если она имеет ожидающие результаты, где результаты являются либо результирующим набором, либо количеством строк, затронутых инструкцией **INSERT**, **Update**или **Delete** , либо данные отправляются с несколькими вызовами **SQLPutData**.  
  
 В фрагменте кода, который реализует ODBC (диспетчер драйверов или драйвер), обработчик инструкции определяет структуру, содержащую сведения о операторе, например:  
  
-   Состояние инструкции  
  
-   Текущая диагностика на уровне инструкций  
  
-   Адреса переменных приложения, связанных с параметрами инструкции и столбцами результирующего набора  
  
-   Текущие параметры для каждого атрибута инструкции  
  
 Дескрипторы инструкций используются в большинстве функций ODBC. В частности, они используются в функциях для привязки параметров и столбцов результирующего набора **(SQLBindParameter** и **SQLBindCol**), инструкций Prepare и Execute **(SQLPrepare**, **SQLExecute**и **SQLExecDirect**), получения метаданных (**SQLColAttribute** и **SQLDescribeCol**), результатов получения (**SQLFetch**) и получения диагностики (**SQLGetDiagField** и **SQLGetDiagRec**). Они также используются в функциях каталога (**SQLColumns**, **SQLTables**и т. д.) и ряде других функций.  
  
 Дескрипторы инструкций выделяются с помощью **функцию SQLAllocHandle** и освобождаются с помощью **SQLFreeHandle**.
