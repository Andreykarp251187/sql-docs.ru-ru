---
title: Дескрипторы инструкций | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- statement handles [ODBC]
- handles [ODBC], statement
ms.assetid: 65d6d78b-a8c8-489a-9dad-f8d127a44882
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 6f249bb13ece6382e96dfe953b1d3c1d96c7bf65
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63149005"
---
# <a name="statement-handles"></a>Дескрипторы инструкций
Объект *инструкции* проще всего рассматривать как инструкции SQL, таких как **ВЫБЕРИТЕ \* сотрудника из**. Однако инструкция будет больше, чем просто инструкции SQL: он состоит из всех данных, связанных с этой инструкции SQL, таких как все результирующие наборы, созданного с помощью инструкции и параметры, используемые при выполнении инструкции. Оператор даже не нужно иметь определяемый приложением инструкции SQL. Например, при каталога функции например **SQLTables** выполняется в операторе, он выполняет стандартные инструкции SQL, который возвращает список имен таблиц.  
  
 Каждый оператор определяется дескриптор инструкции. Оператор связан с одним подключением и может существовать несколько инструкций для этого соединения. Некоторые драйверы ограничить число активных инструкций, которые они поддерживают; в диалоговом окне SQL_MAX_CONCURRENT_ACTIVITIES **SQLGetInfo** указывает, сколько активных инструкций, которые поддерживает драйвер в одном соединении. Оператор определяется как *active* Если у него есть ожидает результатов, результаты которых результирующий набор или количество строк, затронутых **вставить**, **обновления**, или **Удалить** инструкции или данных, отправляемых с несколькими вызовами в **SQLPutData**.  
  
 В части кода, который реализует ODBC (диспетчера драйверов или драйвер) дескриптор инструкции определяет структуру, содержащую информацию об инструкциях, таких как:  
  
-   Оператор состояния  
  
-   Текущих данных о диагностике уровня инструкций  
  
-   Адреса переменным приложения, связанных с параметрами инструкции и привести столбцы набора  
  
-   Текущие значения каждого атрибута инструкции  
  
 Дескрипторы инструкций используются в большинстве функций ODBC. В частности, они используются в функциях для привязки параметров и привести столбцы набора (**SQLBindParameter** и **SQLBindCol**), Подготовка и выполнение инструкций (**SQLPrepare** **SQLExecute**, и **SQLExecDirect**), извлечения метаданных (**SQLColAttribute** и **SQLDescribeCol**), fetch результаты (**SQLFetch**) и получения диагностических (**SQLGetDiagField** и **SQLGetDiagRec**). Они также используются в функциях каталога (**SQLColumns**, **SQLTables**, и так далее) и ряд других функций.  
  
 Дескрипторы инструкций выделяются с **SQLAllocHandle** и освобождается с помощью **SQLFreeHandle**.
