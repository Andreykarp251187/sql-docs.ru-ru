---
title: Библиотека DLL трассировки | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- trace DLLs [ODBC]
- tracing options [ODBC], trace DLLs
ms.assetid: 5ab99bd3-cdc3-4e2c-8827-932d1fcb6e00
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 6fe910c93beac676e5fb0f663b740c03a826c326
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "67985221"
---
# <a name="trace-dll"></a>Библиотека DLL трассировки
Библиотеки DLL, которая выполняет трассировку является одним из основных компонентов ODBC. Трассировка библиотеку DLL, в настоящее время предоставляется в качестве образца библиотеки DLL в компоненте ODBC пакета SDK для Windows, а также был ранее включенных Microsoft данных Access Components (MDAC) SDK. Таким образом запись реестра, интерфейса и образец кода для библиотеки DLL трассировки доступны. Эта библиотека DLL могут быть заменены DLL, созданные пользователем ODBC или стороннего поставщика трассировки. Пользовательская Библиотека трассировки должен предоставляться отличается от имени исходной трассировки образец библиотеки DLL. Библиотеки DLL трассировки должен устанавливаться в системном каталоге, или они смогут загрузить. Строки подключения не передаются в трассировку DLL диспетчером драйверов.  
  
 Библиотека трассировки выполняет трассировку входных аргументов, выходные аргументы, отложенное аргументы, коды возврата и SQLSTATE. Если трассировка включена, диспетчер драйверов вызывает Библиотека трассировки в двух точках: один раз после входа функции (раньше проверку аргументов) и еще до выполнения возврата функцией.  
  
 Когда приложение вызывает функцию, диспетчер драйверов вызывает функцию трассировки в трассировке DLL до вызова функции в драйвере или обработки сам вызов. Каждая функция ODBC имеет соответствующую функцию трассировки (с префиксом *трассировки*), идентичный функции ODBC, за исключением имени. При вызове функции трассировки, Библиотека трассировки захватывает входных аргументов и возвращает код возврата. Поскольку трассировки DLL вызывается прежде, чем диспетчер драйверов проверяет аргументы, недопустимая функция вызовы, отслеживаются, поэтому записываются ошибки состояния перехода и недопустимые аргументы.  
  
 После вызова функции трассировки в трассировке библиотеки DLL, диспетчер драйверов вызывает функцию ODBC в драйвере. Затем он вызывает **TraceReturn** в трассировке библиотеки DLL. Эта функция принимает два аргумента: значение, возвращенное Библиотека трассировки для функции трассировки и код возврата, возвращаемых драйвером для диспетчера драйверов для функции ODBC (или значение, возвращаемое диспетчером драйверов сам, если он обработан функцию). Функция использует значение, возвращаемое для трассировки функции для обработки значений записанного входного аргумента. Он пишет код, возвращаемый для функции ODBC в файл журнала (или динамически, отображает его, если с поддержкой). Он разыменовывает указатели аргументов выходные данные и записывает значения выходных аргументов.
