---
title: Библиотека DLL трассировки | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- trace DLLs [ODBC]
- tracing options [ODBC], trace DLLs
ms.assetid: 5ab99bd3-cdc3-4e2c-8827-932d1fcb6e00
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 6fe910c93beac676e5fb0f663b740c03a826c326
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "67985221"
---
# <a name="trace-dll"></a>Библиотека DLL трассировки
Библиотека DLL, выполняющая трассировку, является одним из компонентов ядра ODBC. Библиотека DLL трассировки в настоящее время предоставляется в качестве примера библиотеки DLL компонента ODBC Windows SDK и ранее включала пакет SDK для компонентов доступа к данным Microsoft (MDAC). Таким образом, доступна запись реестра, интерфейс и пример кода для библиотеки DLL трассировки. Эту библиотеку DLL можно заменить на библиотеку DLL трассировки, созданную пользователем ODBC или сторонним поставщиком. Для пользовательской библиотеки трассировки необходимо указать имя, отличное от исходного образца библиотеки DLL трассировки. Библиотеки DLL трассировки должны быть установлены в системном каталоге или не загружаются. Диспетчер драйверов не будет передавать строки подключения в библиотеку DLL.  
  
 Библиотека DLL трассировки отслеживает входные аргументы, выходные аргументы, отложенные аргументы, коды возврата и SQLSTATE. Когда трассировка включена, диспетчер драйверов вызывает библиотеку DLL трассировки двумя точками: один раз после ввода функции (перед проверкой аргумента) и снова непосредственно перед возвратом функции.  
  
 Когда приложение вызывает функцию, диспетчер драйверов вызывает функцию трассировки в библиотеке DLL трассировки перед вызовом функции в драйвере или при обработке самого вызова. Каждая функция ODBC имеет соответствующую функцию трассировки (с префиксом *Trace*), идентичную функции ODBC с исключением имени. При вызове функции trace DLL-библиотека трассировки захватывает входные аргументы и возвращает код возврата. Так как библиотека DLL трассировки вызывается до того, как диспетчер драйверов проверяет аргументы, недопустимые вызовы функций отслеживаются, поэтому регистрируются ошибки перехода состояния и недопустимые аргументы.  
  
 После вызова функции trace в DLL трассировки диспетчер драйверов вызывает функцию ODBC в драйвере. Затем он вызывает **трацеретурн** в библиотеке DLL трассировки. Эта функция принимает два аргумента: значение, возвращаемое БИБЛИОТЕКой трассировки для функции трассировки, и код возврата, возвращенный драйвером в диспетчер драйверов для функции ODBC (или значение, возвращаемое диспетчером драйверов при обработке функции). Функция использует значение, возвращенное для функции trace, для работы с захваченными значениями входных аргументов. Он записывает код, возвращаемый для функции ODBC, в файл журнала (или динамически отображается, если он включен). Он отменяет ссылки на указатели выходных аргументов и записывает значения выходных аргументов.
