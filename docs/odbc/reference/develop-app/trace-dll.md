---
title: Трасса DLL Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- trace DLLs [ODBC]
- tracing options [ODBC], trace DLLs
ms.assetid: 5ab99bd3-cdc3-4e2c-8827-932d1fcb6e00
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 8e1f9dc57415ad9865ca1b2ad02487b62a93f18f
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81298074"
---
# <a name="trace-dll"></a>Библиотека DLL трассировки
DLL, выполняемый для отслеживания, является одним из основных компонентов ODBC. Трасса DLL в настоящее время предоставляется в качестве образца DLL в компоненте ODBC Windows SDK, и ранее была включена в компоненты доступа к данным Microsoft Data (MDAC) SDK. Таким образом, доступ к записи в реестре, интерфейсу и коду образца для трассировки DLL. Этот DLL может быть заменен трассой DLL, производимой либо пользователем ODBC, либо сторонним поставщиком. Пользовательский след DLL должен быть дан другое имя, чем оригинальный след образца DLL. Отслеживая DLL должны быть установлены в каталоге системы, иначе они не смогут загрузиться. Строки соединения не будут передаваться диспетчеру драйверов в след DLL.  
  
 След DLL отслеживает входные аргументы, аргументы вывода, отложенные аргументы, коды возврата и S'LSTATEs. При включении трассировки менеджер драйвера вызывает трассу DLL в двух точках: один раз при входе функции (до проверки аргумента) и снова непосредственно перед возвращением функции.  
  
 Когда приложение вызывает функцию, менеджер драйвера вызывает функцию трассировки в отслеживая DLL перед вызовом функции драйвера или обработкой самого вызова. Каждая функция ODBC имеет соответствующую функцию трассировки (прикреплую к *Trace),* которая идентична функции ODBC, за исключением имени. При вызове функции трассировки dLL фиксирует аргументы ввода и возвращает код возврата. Поскольку dLL-след вызывается до того, как менеджер драйвера проверяет аргументы, отслеживаются недействительные вызовы функции, поэтому регистрируются ошибки перехода состояния и недействительные аргументы.  
  
 После вызова функции трассировки в следd, менеджер драйвера вызывает функцию ODBC в драйвере. Затем он вызывает **TraceReturn** в след DLL. Эта функция требует двух аргументов: значения, возвращенного трассой DLL для функции трассировки, и код возврата, возвращенный водителем менеджеру драйвера для функции ODBC (или значение, возвращенное самим менеджером драйвера, если он обработал функцию). Функция использует добавленное значение для функции трассировки для манипулирования значениями захваченных входных аргументов. Он записывает код, возвращенный для функции ODBC, в файл журнала (или отображает его динамически, если он включен). Он разымает указатели аргумента вывода и регистрирует значения аргумента вывода.
