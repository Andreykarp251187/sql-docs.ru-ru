---
title: Отправка данных типа Long | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- long data [ODBC]
- sending long data [ODBC]
ms.assetid: ea989084-a8e6-4737-892e-9ec99dd49caf
author: MightyPen
ms.author: genemi
ms.openlocfilehash: acb4ff1637c1530527af88affaf437334596016b
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "68094344"
---
# <a name="sending-long-data"></a>Отправка данных типа Long
Определите СУБД *данные большой длины* как любой символьных или двоичных данных через определенный размер, например 254 символа. Он не может быть невозможно сохранить весь элемент больших объемов данных в памяти, например когда этот элемент представляет документ длинный текст или точечный рисунок. Поскольку такие данные не могут храниться в один буфер, источник данных отправляет его драйвер в частях с **SQLPutData** при выполнении инструкции. Параметры, для которых данные отправляются во время выполнения, называются *параметров данных времени выполнения*.  
  
> [!NOTE]  
>  Приложения могла реально отправить данные любого типа во время выполнения с помощью **SQLPutData**, несмотря на то, что в части могут отправляться только символьных и двоичных данных. Тем не менее, если данные помещаются в один буфер, нет смысла использовать **SQLPutData**. Это гораздо проще привязать буфер и позволить драйвер извлечения данных из буфера.  
  
 Для отправки данных во время выполнения, приложение выполняет следующие действия:  
  
1.  Передает 32-разрядное значение, которое идентифицирует параметр в *ParameterValuePtr* аргумента в **SQLBindParameter** вместо передачи адрес буфера. Это значение не анализируется с помощью драйвера. Он возвращается к приложению позже, это означает, что-то в приложение. Например он может быть номер параметра или дескриптор файла, содержащего данные.  
  
2.  Передает буфер длины/индикатора в адрес *StrLen_or_IndPtr* аргумент **SQLBindParameter**.  
  
3.  Хранит значение SQL_DATA_AT_EXEC, ни результатом значение SQL_LEN_DATA_AT_EXEC (*длина*) макрос в буфер длины/индикатора. Оба эти значения определяют драйверу, будут отправлены данные для параметра с **SQLPutData**. Значение SQL_LEN_DATA_AT_EXEC (*длина*) используется при отправке длинных данных к источнику данных, что нужно знать, сколько байтов больших объемов данных будут отправляться таким образом, чтобы его можно заранее выделите место. Чтобы определить, если это значение необходимо для источника данных, приложение вызывает **SQLGetInfo** с параметром SQL_NEED_LONG_DATA_LEN. Все драйверы должны поддерживать этот макрос; Если источник данных не требует байтовая длина, драйвер можно пропустить.  
  
4.  Вызовы **SQLExecute** или **SQLExecDirect**. Драйвер обнаруживает, что буфер длины/индикатора содержит значение значение SQL_DATA_AT_EXEC, ни результатом значение SQL_LEN_DATA_AT_EXEC (*длина*) макрос и возвращает SQL_NEED_DATA как возвращаемое значение функции.  
  
5.  Вызовы **SQLParamData** в ответ на SQL_NEED_DATA возвращаемое значение. Если данные большой длины должен быть отправлен, **SQLParamData** возвращает SQL_NEED_DATA. В буфере, на которые указывают *ValuePtrPtr* аргумент, драйвер возвращает значение, которое определяет параметр данных во время выполнения. Если имеется более одного параметра данных во время выполнения, приложение должно использовать это значение, чтобы определить, какой параметр для отправки данных; драйвер не является обязательным для запроса данных для параметров данных времени выполнения в определенном порядке.  
  
6.  Вызовы **SQLPutData** для отправки данных параметр к драйверу. Если данные параметра не помещается в один буфер, как это часто бывает в случае с длинных данных, приложение вызывает **SQLPutData** несколько раз, чтобы отправить данные в частях; само драйвер и источник данных для пересборки данных. Если приложение передает заканчивающуюся нулем строку данных, драйвер или источник данных необходимо удалить знак завершения null как часть процесса сборки.  
  
7.  Вызовы **SQLParamData** еще раз, чтобы указать, что он отправлены все данные для параметра. При наличии параметров данных времени выполнения, для которых данные не были отправлены, драйвер возвращает SQL_NEED_DATA и значение, которое определяет следующего параметра; приложение возвращается к шагу 6. Если данные отправлены для всех параметров данных времени выполнения, при выполнении инструкции. **SQLParamData** возвращает SQL_SUCCESS или SQL_SUCCESS_WITH_INFO и может возвращать любое возвращаемое значение "или" диагностический, **SQLExecute** или **SQLExecDirect** может возвращать.  
  
 После **SQLExecute** или **SQLExecDirect** возвращает SQL_NEED_DATA и до передачи данных полностью для последнего параметра данных во время выполнения, инструкция находится в состоянии необходимые данные. Хотя инструкция находится в состоянии необходимые данные, приложение может вызвать только **SQLPutData**, **SQLParamData**, **SQLCancel**, **SQLGetDiagField**, или **SQLGetDiagRec**; все остальные функции возвращают параметром SQLSTATE HY010 (функционировать ошибка последовательности). Вызов **SQLCancel** отменяет выполнение инструкции и возвращает его в предыдущее состояние. Дополнительные сведения см. в разделе [приложении б: Таблицы перехода состояния ODBC](../../../odbc/reference/appendixes/appendix-b-odbc-state-transition-tables.md).  
  
 Пример отправки данных во время выполнения, см. в разделе [SQLPutData](../../../odbc/reference/syntax/sqlputdata-function.md) описание функции.
