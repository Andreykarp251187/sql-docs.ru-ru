---
description: Множественные результаты
title: Несколько результатов | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQLMoreResults function [ODBC], multiple results
- row counts [ODBC]
- multiple results [ODBC]
- result sets [ODBC], multiple results
- SQLGetInfo function [ODBC], multiple results
ms.assetid: a3c32e4b-8fe7-4a33-ae39-ae664001f315
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: dc42bfa96c4784d232d8359a15ac74b2f3c5a2be
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88429256"
---
# <a name="multiple-results"></a>Множественные результаты
*Результат* представляет собой нечто, возвращаемое источником данных после выполнения инструкции. ODBC имеет два типа результатов: результирующие наборы и количество строк. Количество *строк* — это число строк, затронутых инструкцией UPDATE, DELETE или INSERT. Пакеты, описанные в [пакетах инструкций SQL](../../../odbc/reference/develop-app/batches-of-sql-statements.md), могут формировать несколько результатов.  
  
 В следующей таблице перечислены параметры **SQLGetInfo** , используемые приложением для определения того, возвращает ли источник данных несколько результатов для каждого из пакетов разных типов. В частности, источник данных может возвращать одно количество строк для всего пакета инструкций или отдельных строк для каждой инструкции в пакете. В случае выполнения инструкции создания результирующего набора с массивом параметров источник данных может возвращать один результирующий набор для всех наборов параметров или отдельных результирующих наборов для каждого набора параметров.  
  
|Тип пакета|Число строк|Наборы результатов|  
|----------------|----------------|-----------------|  
|Явный пакет|SQL_BATCH_ROW_COUNT [a]|--[b]|  
|Процедура|SQL_BATCH_ROW_COUNT [a]|--[b]|  
|Массивы параметров|SQL_PARAM_ARRAYS_ROW_COUNTS|SQL_PARAM_ARRAYS_SELECTS|  
  
 [a] число строк, создающих инструкции в пакете, может быть поддерживаемым, но возврат количества строк не поддерживается. Параметр SQL_BATCH_SUPPORT в **SQLGetInfo** указывает, разрешены ли инструкции по созданию количества строк в пакетах; параметр SQL_BATCH_ROW_COUNTS указывает, возвращаются ли данные о количестве строк в приложение.  
  
 [b] явные пакеты и процедуры всегда возвращают несколько результирующих наборов, если они включают несколько инструкций, создающих результирующий набор.  
  
> [!NOTE]  
>  Параметр SQL_MULT_RESULT_SETS, представленный в ODBC 1,0, предоставляет только общие сведения о том, можно ли вернуть несколько результирующих наборов. В частности, он имеет значение «Y», если SQL_BS_SELECT_EXPLICIT или SQL_BS_SELECT_PROC разряды возвращаются для SQL_BATCH_SUPPORT или если SQL_PAS_BATCH возвращается для SQL_PARAM_ARRAYS_SELECT.  
  
 Для обработки нескольких результатов приложение вызывает **SQLMoreResults**. Эта функция отменяет текущий результат и делает следующий результат доступным. Он возвращает SQL_NO_DATA, если больше нет доступных результатов. Например, предположим, что следующие инструкции выполняются в виде пакета:  
  
```  
SELECT * FROM Parts WHERE Price > 100.00;  
UPDATE Parts SET Price = 0.9 * Price WHERE Price > 100.00  
```  
  
 После выполнения этих инструкций приложение извлекает строки из результирующего набора, созданного инструкцией **SELECT** . По завершении выборки строк она вызывает **SQLMoreResults** , чтобы сделать доступным количество частей, которые были переоценены. При необходимости **SQLMoreResults** отклоняет невыбранные строки и закрывает курсор. Затем приложение вызывает **SQLRowCount** , чтобы определить, сколько частей было передано с помощью инструкции **Update** .  
  
 Драйвер зависит от того, будет ли выполняться вся Пакетная инструкция, прежде чем будут доступны все результаты. В некоторых реализациях это так. в других случаях вызов **SQLMoreResults** активирует выполнение следующей инструкции в пакете.  
  
 В случае сбоя одной из инструкций в пакете **SQLMoreResults** возвратит либо SQL_ERROR, либо SQL_SUCCESS_WITH_INFO. Если выполнение пакета было прервано в случае сбоя инструкции или если инструкция Failed была последней инструкцией в пакете, **SQLMoreResults** возвратит SQL_ERROR. Если пакет не был прерван при сбое выполнения инструкции и инструкция Failed не была последней инструкцией в пакете, **SQLMoreResults** возвратит SQL_SUCCESS_WITH_INFO. SQL_SUCCESS_WITH_INFO указывает, что был создан хотя бы один результирующий набор или счетчик, и пакет не был прерван.
