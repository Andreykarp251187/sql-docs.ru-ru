---
title: Несколько результатов Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQLMoreResults function [ODBC], multiple results
- row counts [ODBC]
- multiple results [ODBC]
- result sets [ODBC], multiple results
- SQLGetInfo function [ODBC], multiple results
ms.assetid: a3c32e4b-8fe7-4a33-ae39-ae664001f315
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: d90414b631a7e81a7868ab7974b64ea84a0ea452
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81302418"
---
# <a name="multiple-results"></a>Множественные результаты
*Результатом* является что-то, возвращенное источником данных после выполнения оператора. ODBC имеет два типа результатов: наборы результатов и количество строк. *Количество строк* — это количество строк, затронутых обновлением, удалением или вставкой оператора. Пакеты, описанные в [пакетах заявлений s'L,](../../../odbc/reference/develop-app/batches-of-sql-statements.md)могут генерировать несколько результатов.  
  
 В следующей таблице перечислены варианты **приложения,** которые использует приложение для определения того, возвращает ли источник данных несколько результатов для каждого другого типа партии. В частности, источник данных может возвращать одно строковое количество для всей партии инструкций или отдельных строк для каждой выписки в пакете. В случае создания исходной выписки, выполненной с набором параметров, источник данных может вернуть один набор результатов для всех наборов параметров или отдельных наборов результатов для каждого набора параметров.  
  
|Тип пакета|Количество строк|Результирующие наборы|  
|----------------|----------------|-----------------|  
|Явная партия|SQL_BATCH_ROW_COUNT|--Б)|  
|Процедура|SQL_BATCH_ROW_COUNT|--Б)|  
|Массивы параметров|SQL_PARAM_ARRAYS_ROW_COUNTS|SQL_PARAM_ARRAYS_SELECTS|  
  
 Операторы, генерирующие количество строк в пакете, могут быть поддержаны, но возврат строки не поддерживается. Опция SQL_BATCH_SUPPORT в **S'LGetInfo** указывает, допускаются ли операторы, генерирующие количество строк, в пакетах; SQL_BATCH_ROW_COUNTS вариант указывает, возвращаются ли эти строки в приложение.  
  
 Явные пакеты и процедуры всегда возвращают несколько наборов результатов, когда они включают несколько инструкций, генерирующих набор результатов.  
  
> [!NOTE]  
>  Опция SQL_MULT_RESULT_SETS, введенная в ODBC 1.0, предоставляет только общую информацию о том, можно ли вернуть несколько наборов результатов. В частности, в случае возврата SQL_BS_SELECT_EXPLICIT или SQL_BS_SELECT_PROC битов за SQL_BATCH_SUPPORT или в SQL_PAS_BATCH для SQL_PARAM_ARRAYS_SELECT, устанавливается "Y".  
  
 Для обработки нескольких результатов приложение вызывает **S'LMoreResults**. Эта функция отбрасывает текущий результат и делает следующий результат доступным. Он возвращает SQL_NO_DATA, когда больше нет результатов. Например, предположим, что следующие операторы выполняются как пакет:  
  
```  
SELECT * FROM Parts WHERE Price > 100.00;  
UPDATE Parts SET Price = 0.9 * Price WHERE Price > 100.00  
```  
  
 После выполнения этих инструкций приложение получает строки из набора результатов, созданного оператором **SELECT.** Когда это делается, изготавливая строки, он называет **S'LMoreResults,** чтобы сделать доступным количество частей, которые были repriced. При **необходимости, S'LMoreResults** отбрасывает неизведанные строки и закрывает курсор. Затем приложение вызывает **S'LRowCount,** чтобы определить, сколько деталей было переоценено выпиской **UPDATE.**  
  
 Выполняется ли вся выписка пакетов до появления каких-либо результатов. В некоторых реализациях это имеет место; в других случаях вызов **S'LMoreResults** запускает выполнение следующего оператора в пакете.  
  
 Если одна из инструкций в пакете выходит из строя, **S'LMoreResults** возвращается либо SQL_ERROR, либо SQL_SUCCESS_WITH_INFO. Если пакет был прерван, когда выписка не сработала или неудаваемый отчет был последним утверждением в пакете, **S'LMoreResults** вернет SQL_ERROR. Если пакет не был прерван, когда выписка не сработала, а неудаваемый анонс не был последним утверждением в пакете, **S'LMoreResults** вернется SQL_SUCCESS_WITH_INFO. SQL_SUCCESS_WITH_INFO указывает на то, что был сгенерирован по крайней мере один набор или количество результатов и что пакет не был прерван.
