---
title: Использование функций базы данных | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- interoperability [ODBC], database features
ms.assetid: 59760114-508e-46c5-81d2-8f2498c0d778
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 3a945eef43a1fc12689853c3fa209f6126df4f0d
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "67951870"
---
# <a name="considering-database-features-to-use"></a>Оценка возможности использования функций базы данных
После того как базовый уровень взаимодействия известен, необходимо учитывать функции базы данных, используемые приложением. Например, какие инструкции SQL будет выполнять приложение? Приложение будет использовать прокручиваемые курсоры? Провод? Описано? Данные длиннее? Идеи о том, какие функции могут не поддерживаться всеми СУБД, см. в описании функций [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md), [SQLSetConnectAttr](../../../odbc/reference/syntax/sqlsetconnectattr-function.md)и [SQLSetStmtAttr](../../../odbc/reference/syntax/sqlsetstmtattr-function.md) , а также в [приложении C: грамматика SQL](../../../odbc/reference/appendixes/appendix-c-sql-grammar.md). Функции, необходимые для приложения, могут исключить некоторые СУБД из списка целевых СУБД. Они также могут продемонстрировать, что приложение может легко ориентироваться на множество СУБД.  
  
 Например, если необходимые функции просты, они обычно могут быть реализованы с высокой степенью взаимодействия. Приложение, выполняющее простую инструкцию **SELECT** и получающее результаты с однонаправленным курсором, скорее всего, будет строго совместимым благодаря простоте: почти все драйверы и СУБД поддерживают необходимые функции.  
  
 Однако, если требуемые функции более сложны, например прокручиваемые курсоры, инструкции по позиционированным обновлениям и удаления, а также процедуры, то часто приходится создавать компромиссы. Существует несколько возможностей.  
  
-   **Более низкие возможности взаимодействия, дополнительные функции.** Приложение включает функции, но работает только с СУБД, которые их поддерживают.  
  
-   **Более высокая функциональная совместимость, меньшее количество функций.** Приложение удаляет функции, но работает с дополнительными СУБД.  
  
-   **Более высокая функциональная совместимость, дополнительные возможности.** Приложение включает функции, но делает их доступными только с теми СУБД, которые их поддерживают.  
  
-   **Более высокая функциональная совместимость, дополнительные возможности.** Приложение использует функции с СУБД, которые их поддерживают, и эмулирует их для СУБД, не имеющих.  
  
 Первые два варианта относительно просты в реализации, поскольку эти функции используются либо со всеми поддерживаемыми СУБД, либо без них. Два последних варианта, с другой стороны, являются более сложными. В обоих случаях необходимо проверить, поддерживает ли СУБД функции и в последнем случае написать потенциально большой объем кода для эмуляции этих функций. Поэтому эти схемы, скорее всего, потребовали больше времени на разработку и могут быть медленнее во время выполнения.  
  
 Рассмотрим универсальное приложение запросов, которое может подключаться к одному источнику данных. Приложение принимает запрос от пользователя и отображает результаты в окне. Теперь предположим, что у этого приложения есть одна функция, позволяющая пользователям одновременно отображать результаты нескольких запросов. То есть они могут выполнить запрос и просмотреть некоторые результаты, выполнить другой запрос и просмотреть некоторые его результаты, а затем вернуться к первому запросу. Это представляет проблему взаимодействия, так как некоторые драйверы поддерживают только одну активную инструкцию.  
  
 Приложение имеет несколько вариантов, в зависимости от того, что возвращает драйвер для параметра SQL_MAX_CONCURRENT_ACTIVITIES в **SQLGetInfo**:  
  
-   **Всегда поддерживает несколько запросов.** После подключения к драйверу приложение проверяет количество активных инструкций. Если драйвер поддерживает только одну активную инструкцию, приложение закрывает соединение и информирует пользователя о том, что драйвер не поддерживает требуемые функции. Приложение легко реализуется и обладает полной функциональностью, но имеет более низкую совместимость.  
  
-   **Никогда не поддерживает несколько запросов.** Приложение полностью удаляет эту функцию. Это легко реализовать и обеспечивает высокую совместимость, но имеет меньше функциональных возможностей.  
  
-   **Поддержка нескольких запросов только в том случае, если драйвер работает.** После подключения к драйверу приложение проверяет количество активных инструкций. Приложение позволяет пользователю запускать новую инструкцию, если она уже активна, только если драйвер поддерживает несколько активных инструкций. Приложение имеет более высокую функциональность и возможность взаимодействия, но сложнее реализовать.  
  
-   **Всегда поддерживает несколько запросов и эмулирует их при необходимости.** После подключения к драйверу приложение проверяет количество активных инструкций. Приложение всегда разрешает пользователю запускать новую инструкцию, если она уже активна. Если драйвер поддерживает только одну активную инструкцию, приложение открывает дополнительное подключение к этому драйверу и выполняет новую инструкцию для этого соединения. Приложение имеет полную функциональность и обеспечивает высокую совместимость, но сложнее в реализации.
