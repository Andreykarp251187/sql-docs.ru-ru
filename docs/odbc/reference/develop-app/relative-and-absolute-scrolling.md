---
title: Относительная и Абсолютная Прокрутка Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- absolute scrolling [ODBC]
- relative scrolling [ODBC]
- scrollable cursors [ODBC]
- cursors [ODBC], scrollable
ms.assetid: 3d0ff48d-fef5-4c01-bb1d-a583e6269b66
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: ae0ed5af8d116a3038b55b1e3d68231154c2a35c
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81300104"
---
# <a name="relative-and-absolute-scrolling"></a>Относительная и абсолютная прокрутка
Большинство вариантов прокрутки в **S'LFetchScroll** позиционируют курсор относительно текущего положения или абсолютного положения. **S'LFetchScroll** поддерживает получение следующего, предварительного, первого и последнего рядов, а также относительную извлечения (получение *строки n* строки от начала текущего строки) и абсолютной извлечения (получить строку, начиная с строки *n).* Если *n* отрицательный в абсолютном извлечении, строки отсчитываются из конца набора результатов. Таким образом, абсолютный извлечение строки -1 означает получение строки, которая начинается с последней строки в наборе результатов.  
  
 Динамические курсоры обнаруживают строки, вставленные в набор результатов и удаленные, поэтому динамические курсоры не могут получить строку в определенном количестве, кроме чтения с начала набора результатов, что, вероятно, будет медленным. Кроме того, абсолютный извлечение не очень полезен в динамических курсорах, поскольку ряды меняются по мере вставки и удаления строк; поэтому последовательное получение одного и того же числа строк может давать разные строки.  
  
 Приложения, использующие **S'LFetchScroll** только для своих возможностей блок-курсора, например отчетов, скорее всего, пройдут через набор результатов в один раз, используя только возможность получить следующий набор строк. С другой стороны, приложения на основе экрана могут воспользоваться всеми возможностями **S'LFetchScroll.** Если приложение устанавливает размер строки к количеству строк, отображаемых на экране, и связывает буферы экрана с набором результатов, оно может переводить операции строки прокрутки непосредственно на вызовы в **S'LFetchScroll.**  
  
|Операция полосы прокрутки|Параметр прокрутки SQLFetchScroll|  
|--------------------------|-------------------------------------|  
|На страницу вверх|SQL_FETCH_PRIOR|  
|На страницу вниз|SQL_FETCH_NEXT|  
|На строку вверх|SQL_FETCH_RELATIVE с *FetchOffset* равна -1|  
|На строку вниз|SQL_FETCH_RELATIVE с *FetchOffset равна* 1|  
|Прокрутка окна в верхней части|SQL_FETCH_FIRST|  
|Прокрутка окна внизу|SQL_FETCH_LAST|  
|Случайное положение ползунка|SQL_FETCH_ABSOLUTE|  
  
 Такие приложения также должны позиционировать окно прокрутки после операции прокрутки, которая требует текущего номера строки и количества строк. Для текущего номера строки приложения могут либо отслеживать текущий номер строки, либо вызывать **S'LGetStmtAttr** с SQL_ATTR_ROW_NUMBER атрибутом, чтобы получить его.  
  
 Количество строк в курсоре, которое является размером набора результатов, доступно как SQL_DIAG_CURSOR_ROW_COUNT поле диагностического заголовка. Значение в этой области определяется только после того, как был вызван **S'LExecute,** **S'LExecDirect**, или **S'LMoreResult.** Это число может быть либо приблизительное количество или точное количество, в зависимости от возможностей водителя. Поддержка драйвера может быть определена, позвонив в **s'LGetInfo** с типами атрибутов курсора и проверяя, возвращается ли SQL_CA2_CRC_APPROXIMATE или SQL_CA2_CRC_EXACT бит для типа курсора.  
  
 Точное количество строк никогда не поддерживается для динамического курсора. Для других типов курсоров водитель может поддерживать точное или приблизительное количество строк, но не оба. Если драйвер не поддерживает ни точное, ни приблизительное количество строк для определенного типа курсора, поле SQL_DIAG_CURSOR_ROW_COUNT содержит количество строк, которые были извлечены до сих пор. Независимо от того, что поддерживает драйвер, **S'LFetchScroll** с *операцией* SQL_FETCH_LAST приведет к SQL_DIAG_CURSOR_ROW_COUNT поле, чтобы содержать точное количество строк.
