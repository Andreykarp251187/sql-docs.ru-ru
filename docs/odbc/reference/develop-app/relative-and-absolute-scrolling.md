---
title: Относительная и абсолютная прокрутка | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- absolute scrolling [ODBC]
- relative scrolling [ODBC]
- scrollable cursors [ODBC]
- cursors [ODBC], scrollable
ms.assetid: 3d0ff48d-fef5-4c01-bb1d-a583e6269b66
author: MightyPen
ms.author: genemi
ms.openlocfilehash: e2034a3922dcd3db77113e08a6c48fe7ac39457f
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68138060"
---
# <a name="relative-and-absolute-scrolling"></a>Относительная и абсолютная прокрутка
Большая часть параметров прокрутки в **SQLFetchScroll** положение курсора относительно текущей позиции или абсолютной позиции. **SQLFetchScroll** поддерживает выборку следующих, предыдущих, первых и последних наборов строк, а также относительную выборку (получение строк набора строк *n* из начала текущего набора строк) и абсолютную выборку (выбор набора строк, начиная со строки *n*). Если *n* является отрицательным в абсолютной выборки, строки учитываются с конца результирующего набора. Таким образом, Абсолютная выборка строки 1 означает получение набора строк, который начинается с последней строки в результирующем наборе.  
  
 Динамические курсоры обнаруживают строки, вставленные в результирующий набор и удаленные из него, поэтому для динамических курсоров нет простого способа получить строку с определенным числом, кроме чтения с начала результирующего набора, что, вероятно, будет медленным. Более того, Абсолютная выборка не очень полезна в динамических курсорах, так как номера строк меняются при вставке и удалении строк; Следовательно, успешная выборка одного и того же номера строки может привести к различным строкам.  
  
 Приложения, использующие **SQLFetchScroll** только для возможностей блочных курсоров, таких как отчеты, скорее всего, будут проходить через результирующий набор один раз, используя только параметр для выборки следующего набора строк. С другой стороны, приложения на основе экрана могут воспользоваться всеми возможностями **SQLFetchScroll**. Если приложение устанавливает размер набора строк равным количеству строк, отображаемым на экране, и привязывает буферы экрана к результирующему набору, он может перевести операции полосы прокрутки непосредственно в вызовы **SQLFetchScroll**.  
  
|Операция полосы прокрутки|Параметр прокрутки SQLFetchScroll|  
|--------------------------|-------------------------------------|  
|На страницу вверх|SQL_FETCH_PRIOR|  
|На страницу вниз|SQL_FETCH_NEXT|  
|На строку вверх|SQL_FETCH_RELATIVE с *фетчоффсет* , равным-1|  
|На строку вниз|SQL_FETCH_RELATIVE с *фетчоффсет* , равным 1|  
|Прокрутка сверху|SQL_FETCH_FIRST|  
|Прокрутить поле снизу|SQL_FETCH_LAST|  
|Случайное положение ползунка|SQL_FETCH_ABSOLUTE|  
  
 Такие приложения также должны располагать поле прокрутки после операции прокрутки, для которой требуется текущий номер строки и число строк. Для номера текущей строки приложения могут либо отследить номер текущей строки, либо вызвать **SQLGetStmtAttr** с помощью атрибута SQL_ATTR_ROW_NUMBER, чтобы получить его.  
  
 Число строк в курсоре, которое является размером результирующего набора, доступно в виде поля SQL_DIAG_CURSOR_ROW_COUNT заголовка диагностики. Значение в этом поле определяется только после вызова **SQLExecute**, **SQLExecDirect**или **склморересулт** . Это число может быть приблизительным числом или точным числом в зависимости от возможностей драйвера. Поддержка драйвера может быть определена путем вызова **SQLGetInfo** с использованием атрибутов курсора и проверки того, возвращается ли бит SQL_CA2_CRC_APPROXIMATE или SQL_CA2_CRC_EXACT для типа курсора.  
  
 Точное число строк никогда не поддерживается для динамического курсора. Для других типов курсоров драйвер может поддерживать точное или приблизительное количество строк, но не оба. Если драйвер не поддерживает точное или приблизительное количество строк для определенного типа курсора, поле SQL_DIAG_CURSOR_ROW_COUNT содержит количество строк, которые были получены на данный момент. Независимо от того, что поддерживает драйвер, **SQLFetchScroll** с *операцией* SQL_FETCH_LAST приведет к тому, что поле SQL_DIAG_CURSOR_ROW_COUNT будет содержать точное число строк.
