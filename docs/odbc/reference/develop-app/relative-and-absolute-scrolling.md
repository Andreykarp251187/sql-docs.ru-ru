---
title: Относительная и абсолютная прокрутка | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- absolute scrolling [ODBC]
- relative scrolling [ODBC]
- scrollable cursors [ODBC]
- cursors [ODBC], scrollable
ms.assetid: 3d0ff48d-fef5-4c01-bb1d-a583e6269b66
author: MightyPen
ms.author: genemi
ms.openlocfilehash: e2034a3922dcd3db77113e08a6c48fe7ac39457f
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "68138060"
---
# <a name="relative-and-absolute-scrolling"></a>Относительная и абсолютная прокрутка
Почти все действия, параметры прокрутки в **SQLFetchScroll** позиционирования курсора относительно текущей позиции или абсолютное позиционирование. **SQLFetchScroll** поддерживает выборку следующего, предыдущего, первого и последнего наборов строк, как хорошо как относительной (набора строк, *n* строк с начала текущего набора строк) и абсолютной (fetch начальный набор строк в строке *n*). Если *n* имеет отрицательное значение в абсолютная выборка, строки отсчитываются с конца результирующего набора. Таким образом абсолютная выборка строки -1 означает, что для выборки строк, который начинается с последней строки в результирующем наборе.  
  
 Динамические курсоры обнаруживает строки вставляются в, а также удален из результирующего набора, поэтому нет простого способа для динамических курсоров для извлечения строки определенный числом, отличным от чтения в начале результирующего набора, который является с низкой. Кроме того абсолютной не очень полезен в динамические курсоры так, как изменить номера строк, как строки вставки и удаления; Таким образом можно последовательно выборка один и тот же номер строки могут выдавать различные строки.  
  
 Приложения, использующие **SQLFetchScroll** только для своего блока возможности курсора, такие как отчеты, скорее всего для передачи из результирующего набора, один раз, только в режиме для получения следующего набора строк. На экране приложений, с другой стороны, можно воспользоваться преимуществами все возможности **SQLFetchScroll**. Если приложение задает размер набора строк, равное количеству строк, отображаемых на экране и привязывает буферы экранов к результирующему набору, то оно может преобразовывать операции полосы прокрутки непосредственно в вызовы **SQLFetchScroll**.  
  
|Операция полосы прокрутки|Параметр прокрутки SQLFetchScroll|  
|--------------------------|-------------------------------------|  
|На страницу вверх|SQL_FETCH_PRIOR|  
|На страницу вниз|SQL_FETCH_NEXT|  
|На строку вверх|SQL_FETCH_RELATIVE с *FetchOffset* равно-1|  
|На строку вниз|SQL_FETCH_RELATIVE с *FetchOffset* равно 1|  
|Ползунок полосы прокрутки в верхней части|SQL_FETCH_FIRST|  
|Ползунок полосы прокрутки внизу|SQL_FETCH_LAST|  
|Случайное положение ползунка|SQL_FETCH_ABSOLUTE|  
  
 Такие приложения также должны поместите ползунок полосы прокрутки, после операции прокрутки, которая требует номер текущей строки и число строк. Для номер текущей строки, приложения можно либо отслеживать, номер текущей строки или вызов **SQLGetStmtAttr** атрибутом SQL_ATTR_ROW_NUMBER, чтобы получить его.  
  
 Количество строк в курсоре, размер результата значение, доступен в виде поля SQL_DIAG_CURSOR_ROW_COUNT диагностики заголовка. Значение в этом поле определяется только после того, как **SQLExecute**, **SQLExecDirect**, или **SQLMoreResult** был вызван. Это число может быть приблизительное число или точное число, в зависимости от возможности драйвера. Поддержка драйверов можно определить путем вызова **SQLGetInfo** типах сведений атрибуты курсора и проверки, возвращаются ли бит SQL_CA2_CRC_APPROXIMATE или SQL_CA2_CRC_EXACT для типа курсора.  
  
 Счетчиком конкретную строку никогда не поддерживается для динамического курсора. Для других типов курсоров драйвер может поддерживать либо количество строк точное или приблизительное, но не оба. Если драйвер поддерживает точное ни приблизительное количество строк для определенного типа курсора, поле SQL_DIAG_CURSOR_ROW_COUNT содержит количество строк, которые выбраны в данный момент. Независимо от того, какой драйвер поддерживает **SQLFetchScroll** с *операции* SQL_FETCH_LAST приведет к SQL_DIAG_CURSOR_ROW_COUNT поле, содержащее число конкретную строку.
