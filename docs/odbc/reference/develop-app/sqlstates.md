---
title: SQLSTATE | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- diagnostic information [ODBC], sqlstates
- SQLSTATE [ODBC]
ms.assetid: f29fff2e-3d09-4a8c-a2f9-2059062cbebf
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 3ad31d9fd07e0b9f7bdf633f8ed546331880787c
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "63149042"
---
# <a name="sqlstates"></a>атрибуты SQLSTATE
SQLSTATE приводятся подробные сведения о причине предупреждения или ошибки. Несмотря на то, что эти SQLSTATE, которые начинаются с обмена мгновенными Сообщениями относятся к ODBC, SQLSTATE, в данном руководстве основаны на в спецификацию ISO/инфраструктура процедур Идентификации интерфейса командной строки.  
  
 В отличие от кодов возврата SQLSTATE, в данном руководстве приведены рекомендации и драйверы не требуются, чтобы вернуть их. Таким образом хотя драйверы должен возвращать правильный код SQLSTATE для любой ошибки или предупреждения, которые они поддерживают обнаружение, приложения не следует рассчитывать на это всегда происходит. В этом случае есть две причины:  
  
-   **Неполноты** несмотря на то, что это руководство содержит большое количество ошибок и предупреждений и возможные причины появления этих ошибок и предупреждений, он не завершен и, возможно, никогда не будет; драйвер реализации просто изменяться незначительно. Любого конкретного драйвера, вероятно, не вернет все SQLSTATE перечисленные в данном руководстве и могут возвращать SQLSTATE, не перечисленные в данном руководстве.  
  
-   **Сложность** некоторые СУБД - особенно такие СУРБД - возвращают буквально тысячи ошибки и предупреждения. Драйверы для таких механизмов вряд ли для сопоставления всех этих ошибок и предупреждений, которые SQLSTATE, из-за усилия участвуют, inexactness сопоставлений, большой размер полученного кода и низкое значение результирующий код, возвращающий часто программирование ошибки, которые никогда не должны быть обнаружены во время выполнения. Таким образом драйверы должны сопоставляться столько ошибки и предупреждения как кажется вполне разумным и не забудьте сопоставить эти ошибки и предупреждения, на какие приложения логики может служить, например SQLSTATE 01004 (данных).  
  
 Так как SQLSTATE, надежно не возвращаются, большинство приложений просто отображают их для пользователя, а также их связанные диагностические сообщения, которое часто предназначена для данной конкретной ошибке или предупреждения, возникшего и машинный код ошибки. Нет редко потери функциональности в этом, так как приложения нельзя основывать программную логику на большинстве SQLSTATE все равно. Например, предположим, что **SQLExecDirect** возвращает сообщение SQLSTATE 42000 (синтаксическая ошибка или нарушение доступа). Если инструкции SQL, вызвавшей эту ошибку жестко или созданные приложением, это ошибка программирования, и код необходимо исправить. Если инструкция SQL, введенные пользователем, это ошибка пользователя, и все это возможно, информируя пользователя проблемы выполняла приложения.  
  
 При приложений основу программную логику SQLSTATE, они должны подготавливаться для SQLSTATE не должны быть возвращены, или для разных SQLSTATE, возвращаемых. Точно которой SQLSTATE возвращаются надежно могут основываться только на работу с многочисленные драйверами. Тем не менее правило является SQLSTATE для ошибки, возникающие в драйвере или диспетчер драйверов, в отличие от источника данных, скорее всего, возвращаемых надежно. Например, большинство драйверов, возможно, возвращать SQLSTATE HYC00 (дополнительная возможность, не реализована), а, скорее всего, меньше драйверы SQLSTATE 42021 (столбец уже существует).  
  
 Следующие SQLSTATE указать во время выполнения ошибки или предупреждения и являются хорошими кандидатами на котором основывается программную логику. Тем не менее нет никакой гарантии, что все драйверы возвращают их.  
  
-   01004 (данных)  
  
-   01S02 (значение параметра изменено)  
  
-   HY008 (операция отменена)  
  
-   HYC00 (дополнительная возможность не реализована)  
  
-   HYT00 (истекло время ожидания)  
  
 SQLSTATE HYC00 (дополнительная возможность не реализована) особенно важен, поскольку он является единственным способом, в котором приложение может определить, поддерживает ли драйвер определенный атрибут инструкции или соединения.  
  
 Полный список SQLSTATE и какие функции возвращают их, см. в разделе [приложении a. Коды ошибок ODBC](../../../odbc/reference/appendixes/appendix-a-odbc-error-codes.md). Подробное описание условий, при которых каждая функция может возвращать определенного SQLSTATE см. в разделе этой функции.
