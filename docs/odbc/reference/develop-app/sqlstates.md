---
title: SQLSTATE | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- diagnostic information [ODBC], sqlstates
- SQLSTATE [ODBC]
ms.assetid: f29fff2e-3d09-4a8c-a2f9-2059062cbebf
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 8213c08e6844003d880129dda4b441a5592bbc86
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68107338"
---
# <a name="sqlstates"></a>атрибуты SQLSTATE
SQLSTATE предоставляют подробные сведения о причине предупреждения или ошибки. SQLSTATE в этом руководстве основаны на тех, которые находятся в спецификации ISO/инфраструктура процедур идентификации CLI, хотя эти SQLSTATE, которые начинаются с IM, относятся к ODBC.  
  
 В отличие от кодов возврата, SQLSTATE в этом руководстве являются рекомендациями, и для их возврата не требуются драйверы. Таким образом, хотя драйверы должны возвращать правильные значения SQLSTATE для любых ошибок или предупреждений, которые они способны обнаружить, приложения не должны подсчитаться этим всегда. Причины этой ситуации — двойная:  
  
-   **Незавершенность** Хотя в этом руководстве содержится большое количество ошибок и предупреждений, а также возможные причины этих ошибок и предупреждений, они не являются полными и, скорее всего, никогда не будут. реализации драйверов просто имеют слишком много различий. Все указанные драйверы, вероятно, не будут возвращать SQLSTATE, перечисленные в этом руководстве, и могут возвращать SQLSTATE, не перечисленные в этом руководстве.  
  
-   **Сложность** Некоторые ядра СУБД, особенно ядра реляционной базы данных, возвращают тысячи ошибок и предупреждений. Драйверы для таких ядер вряд ли будут сопоставлять все эти ошибки и предупреждения SQLSTATE из-за затраченных усилий, неточности сопоставлений, большого размера результирующего кода и нижнего значения результирующего кода, который часто возвращает программирование. ошибки, которые никогда не должны встречаться во время выполнения. Таким образом, драйверы должны сопоставлять столько ошибок и предупреждений, сколько кажется разумным, и сопоставлять эти ошибки и предупреждения о том, какая логика приложения может быть основана, например SQLSTATE 01004 (усечение данных).  
  
 Так как SQLSTATE не возвращаются надежно, большинство приложений просто отображает их пользователю вместе с соответствующим диагностическим сообщением, которое часто поддается конкретной ошибке или предупреждению, а также машинному коду ошибки. В этом случае нередко возникают какие-либо потери функциональности, так как приложения в большинстве SQLSTATE не могут основывать логику программирования. Например, предположим, что **SQLExecDirect** возвращает SQLSTATE 42000 (синтаксическая ошибка или нарушение прав доступа). Если инструкция SQL, вызвавшая эту ошибку, жестко запрограммирована или создана приложением, это ошибка программирования, и код необходимо исправить. Если пользователь вводит инструкцию SQL, это ошибка пользователя, и приложение выполнило все, что можно сделать, изменив пользователя проблемы.  
  
 Когда приложения выполняют базовую логику программирования на SQLSTATE, они должны быть подготовлены для возврата SQLSTATE, а также для возврата другого SQLSTATE. Точно такие SQLSTATE могут быть основаны только на работе с множеством драйверов. Однако общая рекомендация заключается в том, что SQLSTATE для ошибок, возникающих в драйвере или диспетчере драйверов, а не в источнике данных, скорее всего, они будут надежно возвращены. Например, большинство драйверов, вероятно, возвращают SQLSTATE HYC00 (Необязательная функция не реализована), в то время как меньшее число драйверов, вероятно, возвращает SQLSTATE 42021 (столбец уже существует).  
  
 Следующие SQLSTATE указывают на ошибки или предупреждения во время выполнения и являются хорошими кандидатами на базовую логику программирования. Однако нет никакой гарантии, что все драйверы возвращают их.  
  
-   01004 (усечение данных)  
  
-   01S02 (значение параметра изменено)  
  
-   HY008 (операция отменена)  
  
-   HYC00 (необязательный компонент не реализован)  
  
-   HYT00 (время ожидания истекло)  
  
 SQLSTATE HYC00 (Необязательная функция не реализована) особенно важен, поскольку это единственный способ, с помощью которого приложение может определить, поддерживает ли драйвер определенную инструкцию или атрибут соединения.  
  
 Полный список SQLSTATE и возвращаемых ими функциях см. [в приложении a: коды ошибок ODBC](../../../odbc/reference/appendixes/appendix-a-odbc-error-codes.md). Подробное описание условий, при которых каждая функция может возвращать определенный SQLSTATE, см. в этой функции.
