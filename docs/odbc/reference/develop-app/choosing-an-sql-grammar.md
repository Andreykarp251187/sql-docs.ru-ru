---
description: Выбор грамматики SQL
title: Выбор грамматики SQL | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL statements [ODBC], interoperability
- interoperability of SQL statements [ODBC], SQL grammar
- SQL grammar [ODBC], selecting
ms.assetid: 4e0d189b-e407-47e0-92a9-f9982230dd0e
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 7936631c830d65d58e69d6cd77a728dfd8e664b0
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88461586"
---
# <a name="choosing-an-sql-grammar"></a>Выбор грамматики SQL
Первое решение, которое следует принять при построении инструкций SQL, — какую грамматику использовать. Помимо грамматики, доступной из различных основных стандартов, таких как Open Group, ANSI и ISO, практически каждый поставщик СУБД определяет собственную грамматику, каждая из которых немного отличается от стандартной.  
  
 [Приложение C. грамматика SQL](../../../odbc/reference/appendixes/appendix-c-sql-grammar.md). описывает минимальную грамматику SQL, которую должны поддерживать все драйверы ODBC. Эта грамматика является подмножеством начального уровня для SQL-92. Драйверы могут поддерживать дополнительную грамматику в соответствии с уровнями промежуточного, полного или FIPS 127-2, определенных SQL-92. Дополнительные сведения см. в разделе [Минимальная грамматика SQL](../../../odbc/reference/appendixes/sql-minimum-grammar.md) в приложении C: грамматика SQL и sql-92.  
  
 В приложении C также определяются *escape-последовательности* , содержащие стандартную грамматику для общедоступных языковых функций, таких как внешние объединения, которые не охватываются грамматикой SQL-92. Дополнительные сведения см. в подразделах [escape-последовательности ODBC](../../../odbc/reference/appendixes/odbc-escape-sequences.md) в приложении C: грамматика SQL и [escape-последовательности](../../../odbc/reference/develop-app/escape-sequences.md)далее в этом разделе.  
  
 Выбранная грамматика влияет на то, как драйвер обрабатывает инструкцию. Драйверы должны изменить SQL-92 SQL и определенные в ODBC escape-последовательности на SQL, зависящие от СУБД. Поскольку большинство грамматик SQL основаны на одном или нескольких различных стандартах, большинство драйверов не выполняет никаких действий для удовлетворения этого требования. Он часто состоит только из поиска escape-последовательностей, определенных ODBC, и замены их на грамматику, относящуюся к конкретной СУБД. Когда драйвер обнаруживает грамматику, он не распознается, предполагается, что грамматика зависит от СУБД и передает инструкцию SQL без изменения в источник данных для выполнения.  
  
 Таким образом, в действительности существует два варианта использования грамматики: грамматика SQL-92 (и escape-последовательности ODBC) и грамматика для конкретной СУБД. Из них только грамматика SQL-92 — это возможность взаимодействия, поэтому все взаимодействующие приложения должны его использовать. Приложения, которые не поддерживают взаимодействие, могут использовать грамматику SQL-92 или специальную грамматику СУБД. Грамматики, зависящие от СУБД, имеют два преимущества: они могут использовать любые функции, не охваченные SQL-92, и они выполняются быстрее, поскольку драйверу не нужно изменять их. Последняя функция может быть применена частично с помощью задания атрибута SQL_ATTR_NOSCAN инструкции, который останавливает Поиск и замену escape-последовательностей драйвером.  
  
 Если используется грамматика SQL-92, приложение может определить, как оно будет изменено драйвером, вызвав **SQLNativeSql**. Это часто полезно при отладке приложений. **SQLNativeSql** принимает инструкцию SQL и возвращает ее после того, как драйвер его изменил. Так как эта функция находится в базовом уровне соответствия интерфейсов, она поддерживается всеми драйверами.
