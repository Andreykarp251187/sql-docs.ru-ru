---
title: Управляемые набором ключей курсоры | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- keyset-driven cursors [ODBC]
- cursors [ODBC], key-set driven
ms.assetid: 01769f43-1d9c-4685-84fa-15a6465335e9
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 0c40fe8c823115c3131a1719185bce8f1506df81
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "68138841"
---
# <a name="keyset-driven-cursors"></a>Управляемые ключевым набором курсоры
Управляемые набором ключей курсора находится между статический и динамический курсор в его способность обнаруживать изменения. Так же как статический курсор, он не всегда обнаруживает изменения, внесенные в членство и порядок элементов результирующего набора. Как динамический курсор оно обнаруживать изменения значений строк в результирующем наборе (при условии уровень изоляции транзакции, задаваемое при помощи атрибута SQL_ATTR_TXN_ISOLATION подключения).  
  
 Если открыт курсор, управляемый набором ключей, она сохраняет ключи для всего результирующего набора. Это устраняет очевидным членство и порядок результирующего набора. Как курсор прокрутки результирующего набора, он использует ключи в этом *keyset* для получения текущего значения данных для каждой строки. Например предположим, курсор, управляемый набором ключей извлекает строки и другое приложение, а затем обновляет этой строки. Если курсор refetches строки, значения, которые видит являются новые, так как он refetched строки, используя свой ключ. По этой причине управляемые набором ключей курсоры всегда может обнаружить изменения, произведенные сами и другие.  
  
 Когда курсор пытается извлечь строку, которая была удалена, эта строка отображается как «путь» в результирующем наборе: В наборе ключей ключ для этой строки есть, но самой строки в результирующем наборе больше нет. Если обновляются ключевых значений в строки, строка считается были удалены, а затем вставляется, поэтому такие строки также отображаются как пропуски в результирующем наборе. Хотя курсоры всегда может обнаружить строки, удаленные другим пользователям, его можно удалить ключи для строк, он удаляет себя из набора ключей. Управляемые набором ключей курсоры, которые этого не может определять свои собственные операции удаления. Ли определенный курсоры обнаруживает свои собственные операции удаления указывается в виде параметра SQL_STATIC_SENSITIVITY **SQLGetInfo**.  
  
 Строк, вставленных другими пользователями никогда не являются видимыми для курсоров, управляемых набором ключей, так как ключи для этих строк не существует в наборе ключей. Однако курсоры при необходимости можно добавить ключи для строк, он располагается в наборе ключей. Управляемые набором ключей курсоры, сделать это можно определить свои собственные операции вставки. Ли определенный курсоры обнаруживает свой собственный вставок передается в виде параметра SQL_STATIC_SENSITIVITY **SQLGetInfo**.  
  
 Массив статусов строк, заданное атрибутом значения SQL_ATTR_ROW_STATUS_PTR инструкции может содержать SQL_ROW_SUCCESS, SQL_ROW_SUCCESS_WITH_INFO или SQL_ROW_ERROR для любой строки. Он возвращает SQL_ROW_UPDATED, SQL_ROW_DELETED, SQL_ROW_ADDED для строк, которые оно распознает как обновленные, удалены или вставлены.  
  
 Управляемые набором ключей курсоры обычно реализуются путем создания временной таблицы, содержащий ключи для каждой строки в результирующем наборе. Так как курсор также необходимо определить, были ли обновлены строки, эта таблица обычно содержит столбец с сведения о версиях строк.  
  
 Чтобы перейти на исходном результирующем наборе, курсоры открывается статического курсора поверх временную таблицу. Для получения строки в исходном результирующем наборе, курсор сначала извлекает соответствующий ключ из временной таблицы, а затем извлекает текущие значения для строки. Если используются блочные курсоры, курсор следует получить несколько ключей и строк.
