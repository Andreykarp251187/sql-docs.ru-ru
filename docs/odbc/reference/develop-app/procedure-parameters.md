---
title: Параметры процедуры | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- procedure parameters [ODBC]
ms.assetid: 54fd857e-d2cb-467d-bb72-121e67a8e88d
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 35d43ca7cf6e603d7dabca9eacf1e026daa753b7
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "81306964"
---
# <a name="procedure-parameters"></a>Параметры процедуры
Параметрами в вызовах процедур могут быть входные, входные и выходные параметры. Это отличается от параметров во всех остальных инструкциях SQL, которые всегда являются входными параметрами.  
  
 Входные параметры используются для отправки значений в процедуру. Например, предположим, что таблица Parts содержит столбцы PartID, Description и Price. Процедура Инсертпарт может иметь входной параметр для каждого столбца в таблице. Пример:  
  
```  
{call InsertPart(?, ?, ?)}  
```  
  
 Драйвер не должен изменять содержимое входного буфера до тех пор, пока **SQLExecDirect** или **SQLExecute** не возвратит SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_ERROR, SQL_INVALID_HANDLE или SQL_NO_DATA. Содержимое входного буфера не должно изменяться, пока **SQLExecDirect** или **SQLExecute** возвращает SQL_NEED_DATA или SQL_STILL_EXECUTING.  
  
 Входные и выходные параметры используются для отправки значений в процедуры и извлечения значений из процедур. Использование того же параметра, что и вход, и выходной параметр, — это путаница, которую следует избегать. Например, предположим, что процедура принимает идентификатор заказа и возвращает идентификатор клиента. Это можно определить с помощью одного параметра ввода-вывода:  
  
```  
{call GetCustID(?)}  
```  
  
 Возможно, лучше использовать два параметра: входной параметр для идентификатора заказа, а также выходной или входной/выходной параметр для идентификатора клиента:  
  
```  
{call GetCustID(?, ?)}  
```  
  
 Выходные параметры используются для получения возвращаемого значения процедуры и для получения значений из аргументов процедуры. процедуры, возвращающие значения, иногда называют *функциями*. Например, предположим, что описанная процедура **жеткустид** возвращает значение, указывающее, удалось ли найти заказ. В следующем вызове первый параметр является выходным параметром, используемым для получения возвращаемого значения процедуры, второй параметр — входной параметр, используемый для указания идентификатора заказа, а третий параметр — выходной параметр, используемый для получения идентификатора клиента:  
  
```  
{? = call GetCustID(?, ?)}  
```  
  
 Драйверы обработают значения входных и выходных параметров в процедурах не так, как входные параметры в других инструкциях SQL. При выполнении инструкции они извлекают значения переменных, привязанных к этим параметрам, и отправляют их в источник данных.  
  
 После выполнения инструкции драйверы хранят возвращаемые значения входных и выходных и выходных параметров в переменных, привязанных к этим параметрам. Эти возвращаемые значения не гарантированно задаются до тех пор, пока не будут получены все результаты, возвращенные процедурой, и **SQLMoreResults** вернул SQL_NO_DATA. Если при исполнении инструкции возникает ошибка, содержимое буфера параметров ввода-вывода или буфера выходного параметра не определено.  
  
 Приложение вызывает **склпроцедуре** , чтобы определить, имеет ли процедура возвращаемое значение. Он вызывает **SQLProcedureColumns** , чтобы определить тип (возвращаемое значение, вход, вход, выход или выход) для каждого параметра процедуры.
