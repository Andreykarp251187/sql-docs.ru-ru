---
title: Параметры процедуры Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- procedure parameters [ODBC]
ms.assetid: 54fd857e-d2cb-467d-bb72-121e67a8e88d
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 35d43ca7cf6e603d7dabca9eacf1e026daa753b7
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81306964"
---
# <a name="procedure-parameters"></a>Параметры процедуры
Параметры в процедурных вызовах могут быть входные, входные/выходные или выходные параметры. Это отличается от параметров во всех других инструкциях S'L, которые всегда являются параметрами ввода.  
  
 Параметры ввода используются для отправки значений в процедуру. Например, предположим, что в таблице Части есть столбцы PartID, Описание и Цена. Процедура InsertPart может иметь параметр ввода для каждого столбца в таблице. Пример:  
  
```  
{call InsertPart(?, ?, ?)}  
```  
  
 Драйвер не должен изменять содержимое буфера ввода до тех пор, пока **s'LExecDirect** или **S'LExecute** не возвращает SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_ERROR, SQL_INVALID_HANDLE или SQL_NO_DATA. Содержимое буфера ввода не должно быть изменено, в то время как **S'LExecDirect** или **S'LExecute** возвращается SQL_NEED_DATA или SQL_STILL_EXECUTING.  
  
 Параметры ввода/вывода используются как для отправки значений в процедуры, так и для получения значений из процедур. Использование одного и того же параметра, что и входный и выходный параметр, как правило, сбивает с толку и следует избегать. Например, предположим, что процедура принимает идентификатор заказа и возвращает идентификатор клиента. Это можно определить с помощью одного параметра ввода/вывода:  
  
```  
{call GetCustID(?)}  
```  
  
 Возможно, было бы лучше использовать два параметра: вхотворный параметр для идентификатора заказа и параметр вывода или ввода/вывода для идентификатора клиента:  
  
```  
{call GetCustID(?, ?)}  
```  
  
 Параметры вывода используются для получения значения возврата процедуры и получения значений из аргументов процедуры; процедуры, которые возвращают значения, иногда называются *функциями.* Например, предположим, что только что упомянутая процедура **GetCustID** возвращает значение, указывающее, удалось ли ей найти заказ. В следующем вызове первым параметром является выходный параметр, используемый для получения значения возврата процедуры, второй параметр является вхотворным параметром, используемым для определения идентификатора заказа, а третий параметр — выходным параметром, используемым для получения идентификатора клиента:  
  
```  
{? = call GetCustID(?, ?)}  
```  
  
 Драйверы обрабатывают значения для входных и входных/выходных параметров в процедурах не иначе, чем параметры ввода в других инструкциях S'L. Когда значение выполняется, они извлекают значения переменных, связанных с этими параметрами, и отправляют их в источник данных.  
  
 После выполнения оператора драйверы хранят возвратные значения входных/выходных и выходных параметров в переменных, привязанных к этим параметрам. Эти возвращенные значения не будут гарантированы, чтобы быть установлены до тех пор, пока все результаты, возвращенные процедурой были извлечены и **S'LMoreResults** вернулся SQL_NO_DATA. Если выполнение оператора приводит к ошибке, содержание буфера параметра ввода/вывода или буфера параметра вывода не определены.  
  
 Приложение вызывает **S'LProcedure,** чтобы определить, имеет ли процедура значение возврата. Он вызывает **S'LProcedureColumns** для определения типа (значение возврата, входные данные, входные /выходные или выходные) каждого параметра процедуры.
