---
description: Шаг 4а. Выборка результатов
title: Шаг 4A. получение результатов | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- application process [ODBC], fetching results
- fetches [ODBC], fetching results
ms.assetid: 77d30142-c774-473c-96fb-b364bb92ac60
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 91a81809d07faafac6511bb5ec96c97d4f59d654
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88491361"
---
# <a name="step-4a-fetch-the-results"></a>Шаг 4а. Выборка результатов
Следующим шагом является выборка результатов, как показано на следующем рисунке.  
  
 ![Выборка результатов в приложении ODBC](../../../odbc/reference/develop-app/media/pr14.gif "pr14")  
  
 Если инструкция, выполненная в шаге 3: сборка и выполнение инструкции SQL, была инструкцией **SELECT** или функцией каталога, приложение сначала вызывает **SQLNumResultCols** , чтобы определить количество столбцов в результирующем наборе. Этот шаг необязателен, если приложение уже знает количество столбцов результирующего набора, например, если инструкция SQL жестко запрограммирована в вертикальном или пользовательском приложении.  
  
 Затем приложение извлекает имя, тип данных, точность и масштаб каждого столбца результирующего набора с помощью **SQLDescribeCol**. Опять же, это не требуется для таких приложений, как вертикальные и пользовательские приложения, которые уже узнают эту информацию. Приложение передает эту информацию в **SQLBindCol**, которая привязывает переменную приложения к столбцу в результирующем наборе.  
  
 Теперь приложение вызывает **SQLFetch** для получения первой строки данных и помещает данные из этой строки в переменные, привязанные к **SQLBindCol**. Если в строке есть данные типа Long, он вызывает **SQLGetData** для получения этих данных. Приложение по мере необходимости вызывает **SQLFetch** и **SQLGetData** для получения дополнительных данных. После завершения выборки данных он вызывает **SQLCloseCursor** , чтобы закрыть курсор.  
  
 Полное описание получения результатов см. в разделе Получение результатов [(базовый)](../../../odbc/reference/develop-app/retrieving-results-basic.md) и [Получение результатов (дополнительно)](../../../odbc/reference/develop-app/retrieving-results-advanced.md).  
  
 Теперь приложение возвращает значение "шаг 3. сборка и выполнение инструкции SQL" для выполнения другой инструкции в той же транзакции. или переходит к шагу 5. Фиксация транзакции для фиксации или отката транзакции.
