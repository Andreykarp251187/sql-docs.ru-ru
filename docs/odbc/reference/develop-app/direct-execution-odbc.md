---
title: Прямое выполнение ODBC | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL statements [ODBC], direct execution
- direct execution [ODBC]
- SQL statements [ODBC], executing
ms.assetid: dd00a535-b136-494f-913b-410838e3de7e
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 73c061718dc326e43f72be369a28ad12726a3cab
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63242353"
---
# <a name="direct-execution-odbc"></a>Прямое выполнение (ODBC)
Прямое выполнение — это самый простой способ выполнения инструкции. При отправке инструкции для выполнения источника данных, компилирует его в плане доступа и затем выполняет план доступа.  
  
 Прямое выполнение часто используемые универсальные приложения, которые создают и выполняют инструкции во время выполнения. Например следующий код создает инструкцию SQL и выполняет его один раз:  
  
```  
SQLCHAR *SQLStatement;  
  
// Build an SQL statement.  
BuildStatement(SQLStatement);  
  
// Execute the statement.  
SQLExecDirect(hstmt, SQLStatement, SQL_NTS);  
```  
  
 Прямое выполнение лучше всего подходит для инструкций, которые выполняются один раз. Его основной недостаток заключается в том, что синтаксический анализ инструкции SQL, каждый раз при его выполнении. Кроме того приложение не удается получить сведения о результирующем наборе, созданного с помощью инструкции (если таковые имеются) до после выполнения инструкции; Это возможно в тех случаях, если инструкция подготовлена и выполнена в двух отдельных действий.  
  
 Для выполнения инструкции непосредственно, приложение выполняет следующие действия:  
  
1.  Устанавливает значения всех параметров. Дополнительные сведения см. в разделе [параметров инструкции](../../../odbc/reference/develop-app/statement-parameters.md)далее в этом разделе.  
  
2.  Вызовы **SQLExecDirect** и передает его строка, содержащая инструкцию SQL.  
  
3.  Когда **SQLExecDirect** вызывается драйвер:  
  
    -   Изменяет инструкцию SQL для использования источника данных грамматику SQL без анализа оператор; Сюда входят, заменив escape-последовательности, рассматриваемые в [escape-последовательности в ODBC](../../../odbc/reference/develop-app/escape-sequences-in-odbc.md). Приложение может получить измененной форме инструкции SQL, вызвав **SQLNativeSql**. Escape-последовательности, не заменяются, если значение атрибута инструкции SQL_ATTR_NOSCAN.  
  
    -   Получает текущие значения параметров и преобразует их при необходимости. Дополнительные сведения см. в разделе [параметров инструкции](../../../odbc/reference/develop-app/statement-parameters.md)далее в этом разделе.  
  
    -   Отправляет инструкцию и значения параметров, преобразованное к источнику данных для выполнения.  
  
    -   Возвращает все ошибки. К ним относятся виртуализации или состояние диагностики например SQLSTATE 24000 (недопустимое состояние курсора), синтаксические ошибки, такие как SQLSTATE 42000 (синтаксическая ошибка или нарушение доступа) и семантические ошибки, например SQLSTATE 42S02 (базовая таблица или представление не найден).
