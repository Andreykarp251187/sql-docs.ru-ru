---
title: Прямое исполнение ODBC (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL statements [ODBC], direct execution
- direct execution [ODBC]
- SQL statements [ODBC], executing
ms.assetid: dd00a535-b136-494f-913b-410838e3de7e
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: bc5d942ac0c2af54168248d8e416ca233b2c69e6
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81305165"
---
# <a name="direct-execution-odbc"></a>Прямое выполнение (ODBC)
Прямое выполнение — это самый простой способ выполнения оператора. Когда заявление представлено для выполнения, источник данных компилирует его в план доступа, а затем выполняет этот план доступа.  
  
 Прямое выполнение обычно используется общими приложениями, которые создают и выполняют операторы во время выполнения. Например, следующий код создает выписку s'L и выполняет ее один раз:  
  
```  
SQLCHAR *SQLStatement;  
  
// Build an SQL statement.  
BuildStatement(SQLStatement);  
  
// Execute the statement.  
SQLExecDirect(hstmt, SQLStatement, SQL_NTS);  
```  
  
 Прямое выполнение лучше всего подходит для инструкций, которые будут выполнены один раз. Его основным недостатком является то, что выписка по S'L разбирается каждый раз, когда она выполняется. Кроме того, приложение не может получить информацию о наборе результатов, созданных выпиской (если таковые имеется) до тех пор, пока заявление не будет выполнено; это возможно, если заявление подготовлено и выполнено в два отдельных шага.  
  
 Для выполнения оператора непосредственно приложение выполняет следующие действия:  
  
1.  Устанавливает значения любых параметров. Для получения дополнительной [информации см.](../../../odbc/reference/develop-app/statement-parameters.md)  
  
2.  Вызывает **вызов sLExecDirect** и передает ему строку, содержащую выписку s'L.  
  
3.  При вызове **S'LExecDirect** драйвер:  
  
    -   Изменяет заявление S'L, чтобы использовать грамматику источника данных s'L без анализа оператора; это включает в себя замену побега последовательности обсуждаются в [побег последовательности в ODBC](../../../odbc/reference/develop-app/escape-sequences-in-odbc.md). Приложение может получить измененную форму выписки по S'L, позвонив по **телефону S'LNativeSl.** Последовательности побега не заменяются при установке атрибута SQL_ATTR_NOSCAN оператора.  
  
    -   Извлекает текущие значения параметров и преобразует их по мере необходимости. Для получения дополнительной [информации см.](../../../odbc/reference/develop-app/statement-parameters.md)  
  
    -   Отправляет значение оператора и преобразованное значение параметров в источник данных для выполнения.  
  
    -   Возвращает любые ошибки. К ним относятся секвенирование или диагностика состояния, такие как S'LSTATE 24000 (состояние недействительного курсора), синтаксические ошибки, такие как S'Lstate 42000 (ошибка Синтаксиса или нарушение доступа), а также семантические ошибки, такие как S'Lstate 42S02 (базовая таблица или представление не найдено).
