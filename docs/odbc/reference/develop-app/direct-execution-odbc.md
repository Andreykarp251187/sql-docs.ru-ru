---
title: Прямое выполнение ODBC | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL statements [ODBC], direct execution
- direct execution [ODBC]
- SQL statements [ODBC], executing
ms.assetid: dd00a535-b136-494f-913b-410838e3de7e
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 72d9222be541a8d41b5b9935ac7cbbcfde4da19c
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68039806"
---
# <a name="direct-execution-odbc"></a>Прямое выполнение (ODBC)
Прямое выполнение — это самый простой способ выполнения инструкции. Когда инструкция отправляется для выполнения, источник данных компилирует его в план доступа, а затем выполняет этот план доступа.  
  
 Прямое выполнение обычно используется универсальными приложениями, которые создают и выполняют инструкции во время выполнения. Например, следующий код создает инструкцию SQL и выполняет ее один раз:  
  
```  
SQLCHAR *SQLStatement;  
  
// Build an SQL statement.  
BuildStatement(SQLStatement);  
  
// Execute the statement.  
SQLExecDirect(hstmt, SQLStatement, SQL_NTS);  
```  
  
 Прямое выполнение лучше подходит для инструкций, которые будут выполняться один раз. Его основной недостаток заключается в том, что инструкция SQL анализируется каждый раз при выполнении. Кроме того, приложение не может получить сведения о результирующем наборе, созданном инструкцией (если таковая имеется), до выполнения инструкции. это возможно, если инструкция подготовлена и выполняется в два отдельных шага.  
  
 Для непосредственного выполнения инструкции приложение выполняет следующие действия:  
  
1.  Задает значения любых параметров. Дополнительные сведения см. в подразделе [Параметры инструкции](../../../odbc/reference/develop-app/statement-parameters.md)далее в этом подразделе.  
  
2.  Вызывает **SQLExecDirect** и передает ему строку, содержащую инструкцию SQL.  
  
3.  При вызове **SQLExecDirect** драйвер:  
  
    -   Изменяет инструкцию SQL для использования грамматики SQL источника данных без синтаксического анализа инструкции. Это включает в себя замену escape-последовательностей, обсуждаемых в [escape-последовательностям в ODBC](../../../odbc/reference/develop-app/escape-sequences-in-odbc.md). Приложение может извлекать измененную форму инструкции SQL путем вызова **SQLNativeSql**. Escape-последовательности не заменяются, если задан атрибут SQL_ATTR_NOSCAN инструкции.  
  
    -   Извлекает значения текущих параметров и преобразует их при необходимости. Дополнительные сведения см. в подразделе [Параметры инструкции](../../../odbc/reference/develop-app/statement-parameters.md)далее в этом подразделе.  
  
    -   Отправляет инструкции и преобразованные значения параметров в источник данных для выполнения.  
  
    -   Возвращает все ошибки. Они включают в себя виртуализацию или диагностику состояния, например SQLSTATE 24000 (недопустимое состояние курсора), синтаксические ошибки, такие как SQLSTATE 42000 (синтаксическая ошибка или нарушение прав доступа), и семантические ошибки, такие как SQLSTATE 42S02 (не найдена базовая таблица или представление).
