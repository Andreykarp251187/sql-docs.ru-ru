---
title: Совершение и откат транзакций (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- rolling back transactions [ODBC]
- committing transactions [ODBC]
- transactions [ODBC], rolling back
- transactions [ODBC], committing
ms.assetid: 800f2c1a-6f79-4ed1-830b-aa1a62ff5165
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 1c272d60242d31622452c4dcb0f6a16c4838768f
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81299114"
---
# <a name="committing-and-rolling-back-transactions"></a>Фиксация и откат транзакций
Для фиксации или отката транзакции в режиме ручного коммита приложение вызывает **S'LEndTran.** Драйверы DBMS, поддерживающие транзакции, обычно реализуют эту функцию, выполняя выписку **COMMIT** или **ROLLBACK.** Менеджер драйвера не вызывает **S'LEndTran,** когда подключение находится в режиме автоматического коммита; он просто возвращает SQL_SUCCESS, даже если приложение пытается откатить транзакцию. Поскольку драйверы DBMS, не поддерживающие транзакции, всегда находятся в режиме автоматического коммита, они могут либо реализовать **S'LEndTran,** чтобы вернуть SQL_SUCCESS, не делая ничего, или не реализовывать его вообще.  
  
> [!NOTE]  
>  Приложения не должны совершать или откатывать транзакции, выполняя заявления **COMMIT** или **ROLLBACK** с **помощью s'L'LExecute** или **S'LExecDirect.** Последствия этого не определены. Возможные проблемы включают драйвер, не зная, когда транзакция активна, и эти заявления, не в состоянии против источников данных, которые не поддерживают транзакции. Вместо этого эти приложения должны вызываться на **вызов S'LendTran.**  
  
 Если приложение передает ручку среды в **S'LEndTran,** но не передает ручку соединения, менеджер драйвера концептуально вызывает **s'LEndTran** с помощью обработки среды для каждого драйвера, имеющем одно или несколько активных соединений в среде. Затем драйвер совершает транзакции по каждому подключению в среде. Однако важно понимать, что ни водитель, ни менеджер драйвера не выполняют двухфазный коммит на соединениях в среде; это всего лишь удобство программирования для одновременного вызова **S'LEndTran** для всех соединений в среде.  
  
 *(Двухфазный коммит* обычно используется для совершения транзакций, которые распространяются по нескольким источникам данных. На первом этапе опрашиваются источники данных о том, могут ли они совершить свою часть транзакции. На втором этапе транзакция фактически совершается по всем источникам данных. Если какие-либо источники данных отвечают на первом этапе, что они не могут совершить транзакцию, вторая фаза не происходит.)
