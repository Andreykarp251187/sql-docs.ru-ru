---
description: Прокрутка и выборка строк (ODBC)
title: Прокрутка и выборка строк (ODBC) | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- scrollable cursors [ODBC]
- fetches [ODBC], scrollable cursors
- cursors [ODBC], scrollable
- scrolling rows [ODBC]
ms.assetid: c43764cb-5841-4b89-9dc0-984a7488b3c1
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: b6fcdd2cd635a7da66a5d81c4beb24088f96382b
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88476496"
---
# <a name="scrolling-and-fetching-rows-odbc"></a>Прокрутка и выборка строк (ODBC)
При использовании прокручиваемого курсора приложения вызывают **SQLFetchScroll** для позиционирования курсора и выборки строк. **SQLFetchScroll** поддерживает относительную прокрутку (следующую, предыдущую и относительную *n* строк), абсолютную прокрутку (первую, последнюю и строку *n*) и позиционирование по закладке. Аргументы *фетчориентатион* и *фетчоффсет* в **SQLFetchScroll** указывают набор строк для выборки, как показано на следующих схемах.  
  
 ![Выборка следующего, предыдущего, первого и последнего набора строк](../../../odbc/reference/develop-app/media/pr20_2.gif "pr20_2")  
  
 **Выборка следующего, предыдущего, первого и последнего набора строк**  
  
 ![Выборка абсолютных, относительных наборов строк и наборов строк с закладками](../../../odbc/reference/develop-app/media/pr20_1.gif "pr20_1")  
  
 **Получение абсолютных, относительных и закладка наборов строк**  
  
 **SQLFetchScroll** позиционирует курсор на указанную строку и возвращает строки в наборе строк, начиная с этой строки. Если указанный набор строк пересекается с концом результирующего набора, возвращается частичный набор строк. Если указанный набор строк пересекается с началом результирующего набора, обычно возвращается первый набор строк в результирующем наборе. полные сведения см. в описании функции [SQLFetchScroll](../../../odbc/reference/syntax/sqlfetchscroll-function.md) .  
  
 В некоторых случаях приложению может потребоваться разместить курсор без извлечения каких бы то ни было данных. Например, может потребоваться проверить, существует ли строка, или просто получить закладку для строки, не перекрывая другие данные по сети. Для этого он устанавливает для атрибута SQL_ATTR_RETRIEVE_DATA инструкции значение SQL_RD_OFF. Переменная, привязанная к столбцу закладки (если таковая имеется), всегда обновляется независимо от значения этого атрибута инструкции.  
  
 После получения набора строк приложение может вызвать функцию **SQLSetPos** для позиционирования в определенную строку набора строк или обновить строки в наборе строк. Дополнительные сведения об использовании функции **SQLSetPos**см. в разделе [Обновление данных с помощью SQLSetPos](../../../odbc/reference/develop-app/updating-data-with-sqlsetpos.md).  
  
> [!NOTE]  
>  В ODBC 2 поддерживается прокрутка. *x* драйверов, **SQLExtendedFetch**. Дополнительные сведения см. в разделе [блочные курсоры, прокручиваемые курсоры и обратная совместимость](../../../odbc/reference/appendixes/block-cursors-scrollable-cursors-and-backward-compatibility.md)в приложении G: рекомендации по драйверам для обеспечения обратной совместимости.
