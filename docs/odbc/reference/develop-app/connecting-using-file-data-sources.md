---
title: Подключение с использованием файлововых источников данных (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- connecting to driver [ODBC], file data sources
- SQLDriverConnect function [ODBC], connecting using file data sources
- connecting to data source [ODBC], SQLDriverConnect
- connecting to driver [ODBC], SQLDriverConnect
- connecting to data source [ODBC], file data sources
- file data sources [ODBC]
ms.assetid: 3003f8c2-8be6-41cc-8d9c-612e9bd0f3ae
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 8c752fc3b09c06c68dcc216cacac63744dc3101b
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81287414"
---
# <a name="connecting-using-file-data-sources"></a>Подключение с использованием файловых источников данных
Информация о подключении к источнику данных файла хранится в файле .dsn. В результате строка соединения может быть использована повторно одним пользователем или совместно распределена между несколькими пользователями, если у них установлен соответствующий драйвер. Файл содержит имя драйвера (или другое имя источника данных в случае неразделяемого источника данных файла) и опционную строку соединения, которая может быть использована **S'LDriverConnect.** Менеджер драйвера создает строку соединения для вызова на **S'LDriverConnect** из ключевых слов в файле .dsn.  
  
 Источник данных файла позволяет приложению указывать параметры соединения без необходимости создания строки соединения для использования с **S'LDriverConnect.** Источник данных файла обычно создается путем указания ключевого слова **SAVEFILE,** что заставляет менеджера драйвера сохранять строку вывода соединения, созданную путем вызова к **файлу** .dsn. Эта строка соединения может быть использована повторно, позвонив по **s'LDriverConnect** с ключевым словом **FILEDSN.** Это упрощает процесс соединения и обеспечивает постоянный источник строки соединения.  
  
 Источники файловых данных также могут быть созданы, позвонив в DLL установщика **S'LCreateDataSource.** Информация может быть записана в файле .dsn, позвонив по **s'LWriteFileDSN,** и прочитать из файла .dsn, позвонив по **телефону S'LReadFileDSN;** обе эти функции также находятся в установщике DLL. Для получения информации об установке DLL [см.](../../../odbc/reference/install/configuring-data-sources.md)  
  
 Ключевые слова, используемые для информации о подключении, находятся в разделе «ODBC» файла .dsn. Минимальная информация, которую будет иметь файл .dsn в разделе «ODBC», является ключевым словом DRIVER:  
  
```  
DRIVER = SQL Server  
```  
  
 Файл,общий .dsn обычно содержит строку соединения, следующим образом:  
  
```  
DRIVER = SQL Server  
UID = Larry  
DATABASE = MyDB  
```  
  
 Когда источник данных файла недораздельен, файл .dsn содержит только ключевое слово **DSN.** Когда менеджер драйвера отправляет информацию в неразделяемом источнике данных файла, он по мере необходимости подключается к источнику данных, указанному ключевым словом **DSN.** Неразделанный файл .dsn будет содержать следующее ключевое слово:  
  
```  
DSN = MyDataSource  
```  
  
 Строка соединения, используемая для источника данных файла, является объединением ключевых слов, указанных в файле .dsn, и ключевых слов, указанных в строке соединения в вызове на **S'LDriverConnect.** Если какое-либо из ключевых слов в файле .dsn противоречит ключевым словам в строке соединения, менеджер драйвера решает, какое значение ключевых слов следует использовать. Для получения более подробной информации, [см.](../../../odbc/reference/syntax/sqldriverconnect-function.md)  
  
## <a name="see-also"></a>См. также:  
 [https://support.microsoft.com/kb/165866](https://support.microsoft.com/kb/165866)
