---
description: Размер набора строк
title: Размер набора строк | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- rowset size [ODBC]
- cursors [ODBC], block
- result sets [ODBC], rowset size
- block cursors [ODBC]
- result sets [ODBC], block cursors
ms.assetid: 60366ae8-175c-456a-ae5e-bdd860786911
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: d915d6e11fc7678312eab60c3316815cfabab38e
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88465612"
---
# <a name="rowset-size"></a>Размер набора строк
Используемый размер набора строк зависит от приложения. Приложения на основе экранов обычно используют одну из двух стратегий. Первый — задать размер набора строк равным количеству строк, отображаемых на экране; Если пользователь изменяет размер экрана, приложение соответствующим образом изменяет размер набора строк. Второй способ — установить для размера набора строк большее значение, например 100, что сокращает количество вызовов к источнику данных. Приложение прокручивается локально в наборе строк, когда это возможно, и получает новые строки только при прокрутке за пределами набора строк.  
  
 Другие приложения, такие как отчеты, обычно устанавливают размер набора строк равным максимальному числу строк, которые приложение может попытаться обменять, с большим набором строк, однако нагрузка на каждую строку иногда сокращается. Точно то, насколько большой набор строк может зависеть от размера каждой строки и объема доступной памяти.  
  
 Размер набора строк задается вызовом **SQLSetStmtAttr** с аргументом *атрибута* SQL_ATTR_ROW_ARRAY_SIZE. Приложение может изменять размер набора строк, привязывать новые буферы наборов строк (путем вызова **SQLBindCol** или указания смещения привязки) даже после выбора строк или и того, и другого. Влияние изменения размера набора строк зависит от функции:  
  
-   **SQLFetch** и **SQLFetchScroll** используют размер набора строк во время вызова, чтобы определить количество извлекаемых строк. Однако **SQLFetchScroll** с *фетчориентатион* SQL_FETCH_NEXT увеличивает курсор на основе набора строк предыдущей выборки, а затем извлекает набор строк на основе текущего размера набора строк.  
  
-   Функция **SQLSetPos** использует размер набора строк, который действует в результате предыдущего вызова метода **SQLFetch** или **SQLFetchScroll**, поскольку функция **SQLSetPos** работает с уже установленным набором строк. Функция **SQLSetPos** также выбирает новый размер набора строк, если **SQLBulkOperations** был вызван после изменения размера набора строк.  
  
-   **SQLBulkOperations** использует размер набора строк, действующий во время вызова, так как он выполняет операции над таблицей независимо от любого набора строк.
