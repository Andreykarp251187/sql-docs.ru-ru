---
title: Размер Роусета (англ.) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- rowset size [ODBC]
- cursors [ODBC], block
- result sets [ODBC], rowset size
- block cursors [ODBC]
- result sets [ODBC], block cursors
ms.assetid: 60366ae8-175c-456a-ae5e-bdd860786911
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 11b95768934f96e1587b3c570b2510f3c2849239
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81304245"
---
# <a name="rowset-size"></a>Размер набора строк
Какой размер строки использовать зависит от приложения. Приложения на основе экрана обычно следуют одной из двух стратегий. Во-первых, установить размер рядов на количество строк, отображаемых на экране; если пользователь изменяет размер экрана, приложение изменяет размер строки соответственно. Во-вторых, установить размер строки на большее число, например 100, что уменьшает количество вызовов к источнику данных. Приложение прокручивается локально в строке, когда это возможно, и получает новые строки только тогда, когда оно прокручивается за пределами рядового набора.  
  
 Другие приложения, такие как отчеты, как правило, устанавливают размер строки к наибольшего числу строк, которые приложение может разумно обрабатывать - с большим набором строк, накладные расходы сети на строку иногда уменьшается. Точно, насколько большой может быть ряд, зависит от размера каждой строки и объема доступной памяти.  
  
 Размер Rowset устанавливается вызовом в **S'LSetStmtAttr** с аргументом *атрибута* SQL_ATTR_ROW_ARRAY_SIZE. Приложение может изменить размер строки, связать новые буферы строк (позвонив в **S'LBindCol** или указав привязку смещения) даже после того, как строки были извлечены, или оба. Последствия изменения размера строки зависят от функции:  
  
-   **На** момент вызова, чтобы определить, сколько строк нужно получить, **используется** размер строки. Тем не менее, **S'LFetchScroll** с *FetchOrientation* SQL_FETCH_NEXT шагом курсор на основе строки предыдущего извлечения, а затем получает строку на основе текущего размера строки.  
  
-   **По** состоянию на предыдущий вызов на **sLFetch** или **S'LFetchScroll**используется размер строки, который действует, поскольку **S'LSetPos** работает на уже установленном наборе строк. Кроме **того,** после изменения размера рядового набора **s'LSetPos** также подберет новый размер рядового набора.  
  
-   **На** момент вызова размер строки используется в действии, поскольку он выполняет операции на столе, независимо от любого извлеченного набора строк.
