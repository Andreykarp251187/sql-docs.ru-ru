---
title: Связывание параметров по имени (Названные параметры) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- named parameters [ODBC]
- binding parameters by name [ODBC]
ms.assetid: e2c3da5a-6c10-4dd5-acf9-e951eea71a6b
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: a1e214f50488c4600ed39f76e91618cc5ce53de4
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81306375"
---
# <a name="binding-parameters-by-name-named-parameters"></a>Привязка параметров по имени (именованные параметры)
Некоторые DBMS позволяют приложению указывать параметры сохраненной процедуры по имени, а не по позиции в процедурном вызове. Такие параметры называются *названными параметрами.* ODBC поддерживает использование названных параметров. В ODBC указанные параметры используются только в вызовах к сохраненным процедурам и не могут быть использованы в других инструкциях S'L.  
  
 Водитель проверяет значение SQL_DESC_UNNAMED поля IPD, чтобы определить, используются ли именованные параметры. Если SQL_DESC_UNNAMED не настроен на SQL_UNNAMED, водитель использует имя в поле SQL_DESC_NAME IPD для определения параметра. Чтобы связать параметр, приложение может вызвать **S'LBindParameter,** чтобы указать информацию о параметре, а затем вызвать **S'LSetDescField,** чтобы установить SQL_DESC_NAME поле IPD. При использовании именованных параметров порядок параметра в вызове процедуры не имеет значения, а номер записи параметра игнорируется.  
  
 Разница между неназванными параметрами и указанными параметрами заключается в соотношении между рекордным числом дескриптора и номером параметра в процедуре. При использовании неназванных параметров первый параметр-маркер связан с первой записью в орфотворе, что, в свою очередь, связано с первым параметром (в порядке создания) в процедурном вызове. При использовании именованных параметров первый параметр по-прежнему связан с первой записью осценариста параметра, но связь между рекордным числом дескриптора и номером параметра в процедуре больше не существует. Именованные параметры не используют отображение номера дескриптора в положении параметра процедуры; вместо этого имя записи дескриптора отображается в названии параметра процедуры.  
  
> [!NOTE]  
>  Если включена автоматическая популяция IPD, водитель заселит дескриптор таким образом, чтобы порядок записей дескриптора соответствовал порядку параметров в определении процедуры, даже если используются указанные параметры.  
  
 Если используется именуемый параметр, то все параметры должны быть названы параметрами. Если какой-либо параметр не является указанным параметром, то ни один из параметров ca не будет назван. Если бы существовала смесь названных параметров и неназванных параметров, поведение было бы зависимым от водителя.  
  
 В качестве примера названных параметров предположим, что процедура хранения сервера S'L была определена следующим образом:  
  
```  
CREATE PROCEDURE test @title_id int = 1, @quote char(30) AS <blah>  
```  
  
 В этой процедуре, @title_idпервый параметр, имеет значение по умолчанию 1. Приложение может использовать следующий код для использования этой процедуры таким образом, чтобы он опознавательный относясь только к одному динамическому параметру. Этот параметр является именованным параметром с названием "цитата".\@  
  
```  
// Prepare the procedure invocation statement.  
SQLPrepare(hstmt, "{call test(?)}", SQL_NTS);  
  
// Populate record 1 of ipd.  
SQLBindParameter(hstmt, 1, SQL_PARAM_INPUT, SQL_C_CHAR, SQL_CHAR,  
                  30, 0, szQuote, 0, &cbValue);  
  
// Get ipd handle and set the SQL_DESC_NAMED and SQL_DESC_UNNAMED fields  
// for record #1.  
SQLGetStmtAttr(hstmt, SQL_ATTR_IMP_PARAM_DESC, &hIpd, 0, 0);  
SQLSetDescField(hIpd, 1, SQL_DESC_NAME, "@quote", SQL_NTS);  
  
// Assuming that szQuote has been appropriately initialized,  
// execute.  
SQLExecute(hstmt);  
```
