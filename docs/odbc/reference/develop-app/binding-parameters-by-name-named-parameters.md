---
title: Привязка параметров по имени (именованные параметры) | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- named parameters [ODBC]
- binding parameters by name [ODBC]
ms.assetid: e2c3da5a-6c10-4dd5-acf9-e951eea71a6b
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 68dfb8976312016ee7f2e42fc4fcdecb93fd28cf
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "63199376"
---
# <a name="binding-parameters-by-name-named-parameters"></a>Привязка параметров по имени (именованные параметры)
Некоторые СУБД позволяют приложению задать параметры в хранимую процедуру по имени, а не по позиции в вызове процедуры. Такие параметры называются *именованные параметры*. ODBC поддерживает использование именованных параметров. В ODBC именованные параметры используются только в вызовы хранимых процедур и не может использоваться в других инструкциях SQL.  
  
 Драйвер проверяет значение поля SQL_DESC_UNNAMED IPD для проверки работоспособности с именем, что при использовании параметров. Если SQL_DESC_UNNAMED не имеет значение SQL_UNNAMED, драйвер использует имя поля SQL_DESC_NAME IPD для идентификации параметра. Чтобы привязать параметр, приложение может вызвать **SQLBindParameter** к укажите сведения о параметрах, а затем вызывать **SQLSetDescField** задать поля SQL_DESC_NAME IPD. Если используются именованные параметры, порядок параметров в вызове процедуры не имеет значения, и номер записи параметра игнорируется.  
  
 Разница между неименованные и именованные параметры участвующем в отношении между номер записи дескриптора и номер параметра в процедуре. При использовании неименованных параметров первому маркеру параметра относится к первой записи в дескриптор параметра, который в свою очередь относится к первому параметру (в порядке создания) в вызове процедуры. Если используются именованные параметры, первому маркеру параметра по-прежнему относится к первой записи дескриптор параметра, но связь между номер записи дескриптора и номер параметра в процедуре больше не существует. Именованные параметры не следует использовать сопоставление номер записи дескриптор для положение параметра процедуры; Вместо этого имя записи дескриптора сопоставляется имени параметра процедуры.  
  
> [!NOTE]  
>  Если включено автоматическое заполнение IPD, то драйвер будет заполнять дескриптор таким образом, порядок записей дескриптора будет соответствовать порядку параметров в определении процедуры, даже если используются именованные параметры.  
  
 Если используется именованный параметр, все параметры должны быть именованными параметрами. Если любой параметр не имеет именованный параметр, ни один из параметров ЦС быть именованные параметры. Если и именованные параметры, и неименованные параметры, поведение будет зависеть от драйвера.  
  
 Например именованных параметров Предположим, что SQL Server, хранимая процедура определена следующим образом:  
  
```  
CREATE PROCEDURE test @title_id int = 1, @quote char(30) AS <blah>  
```  
  
 В этой процедуре, первый параметр, @title_id, имеет значение по умолчанию 1. Приложение может использовать следующий код для вызова этой процедуры, таким образом, что он указывает только один динамический параметр. Этот параметр представляет собой именованный параметр с именем "\@Квота».  
  
```  
// Prepare the procedure invocation statement.  
SQLPrepare(hstmt, "{call test(?)}", SQL_NTS);  
  
// Populate record 1 of ipd.  
SQLBindParameter(hstmt, 1, SQL_PARAM_INPUT, SQL_C_CHAR, SQL_CHAR,  
                  30, 0, szQuote, 0, &cbValue);  
  
// Get ipd handle and set the SQL_DESC_NAMED and SQL_DESC_UNNAMED fields  
// for record #1.  
SQLGetStmtAttr(hstmt, SQL_ATTR_IMP_PARAM_DESC, &hIpd, 0, 0);  
SQLSetDescField(hIpd, 1, SQL_DESC_NAME, "@quote", SQL_NTS);  
  
// Assuming that szQuote has been appropriately initialized,  
// execute.  
SQLExecute(hstmt);  
```
