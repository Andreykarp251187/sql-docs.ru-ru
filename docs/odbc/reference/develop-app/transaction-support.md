---
title: Поддержка транзакций | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- transactions [ODBC], degree of support
ms.assetid: d56e1458-8da2-4d73-a777-09e045c30a33
author: MightyPen
ms.author: genemi
ms.openlocfilehash: a0b5e33f94c5452a2062f7c18339f27c8da73fa9
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68086059"
---
# <a name="transaction-support"></a>Поддержка транзакций
Степень поддержки для транзакций определяется драйвером. ODBC предназначен для реализации в базе данных с одним пользователем или с настольными системами, не требующей управления несколькими обновлениями данных. Более того, некоторые базы данных, поддерживающие транзакции, делают это только для инструкций языка обработки данных DML SQL. Существуют ограничения или специальные семантики транзакций, касающиеся использования языка описания данных DDL, когда транзакция активна. То есть может существовать поддержка транзакций для нескольких одновременных обновлений таблиц, но не для изменения числа и определения таблиц во время транзакции.  
  
 Приложение определяет, поддерживаются ли транзакции, можно ли включить DDL в транзакцию и какие-либо специальные эффекты включения DDL в транзакцию путем вызова **SQLGetInfo** с параметром SQL_TXN_CAPABLE. Дополнительные сведения см. в описании функции [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md) .  
  
 Если драйвер не поддерживает транзакции, но приложение имеет возможность (используя API, отличный от ODBC) для блокировки и разблокировки данных, приложения могут обеспечить поддержку транзакций, блокируя и разблокируя записи и таблицы по мере необходимости. Чтобы реализовать пример перемещения учетной записи, приложение будет блокировать записи для обеих учетных записей, копировать текущие значения, дебетировать первую учетную запись, кредитовать вторую учетную запись и разблокировать записи. Если какие бы то ни было действия не выполнены, приложение сбросит учетные записи с помощью копий.  
  
 Даже источники данных, поддерживающие транзакции, могут не поддерживать более одной транзакции за раз в определенной среде. Приложения вызывают **SQLGetInfo** с параметром SQL_MULTIPLE_ACTIVE_TXN, чтобы определить, может ли источник данных поддерживать одновременные активные транзакции в нескольких подключениях в одной среде. Поскольку существует одна транзакция на одно соединение, это интересно только для приложений с несколькими подключениями к одному источнику данных.
