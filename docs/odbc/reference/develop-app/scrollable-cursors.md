---
title: Прокручиваемые курсоры | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- scrollable cursors [ODBC]
- cursors [ODBC], scrollable
ms.assetid: 2c8a5f50-9b37-452f-8160-05f42bc4d97e
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 38eb4c8e5cc859297a36115ba5cc6dd2c0529304
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68061612"
---
# <a name="scrollable-cursors"></a>Прокручиваемые курсоры
В современных экранных приложениях пользователь прокручивается назад и вперед по данным. Для таких приложений возврат к ранее полученной строке является проблемой. Одна из возможных вариантов — закрыть и снова открыть курсор, а затем выбрать строки, пока курсор не достигнет нужной строки. Другой возможностью является чтение результирующего набора, кэширование его на локальном компьютере и реализация прокрутки в приложении. Обе возможности хорошо работают только с мелкими результирующими наборами, а вторая возможность — сложно реализовать. Лучшим решением является использование *прокручиваемого курсора,* который может перемещаться назад и вперед в результирующем наборе.  
  
 *Прокручиваемый курсор* обычно используется в современных экранных приложениях, в которых пользователь прокручивается назад и вперед по данным. Однако приложения должны использовать прокручиваемые курсоры только в том случае, если курсоры не будут выполнять задание, так как прокручиваемые курсоры обычно более дороги, чем однонаправленные курсоры.  
  
 Возможность перемещения назад вызывает вопрос, неприменимый к однонаправленным курсорам: должен ли прокручиваемый курсор обнаруживать изменения, внесенные в строки, которые были ранее получены? То есть должен ли он обнаруживать обновленные, удаленные и вновь вставленные строки?  
  
 Этот вопрос возникает из-за того, что определение результирующего набора — набор строк, соответствующих определенным критериям, не находится в состоянии, когда строки проверяются на соответствие этим критериям, и не проверяет, должны ли строки содержать одни и те же данные при каждой их выборки. Первое появление позволяет прокручивать курсоры, чтобы определить, были ли вставлены или удалены строки, а вторая позволяет им обнаруживать обновленные данные.  
  
 Возможность обнаружения изменений иногда бывает полезной, иногда это не так. Например, приложению учета требуется курсор, который игнорирует все изменения. балансирующие книги невозможны, если курсор отображает последние изменения. С другой стороны, для системы резервирования авиакомпании необходим курсор, показывающий последние изменения данных. без такого курсора он должен постоянно создавать запрос к базе данных, чтобы продемонстрировать актуальную доступность рейса.  
  
 Чтобы охватить потребности различных приложений, ODBC определяет четыре различных типа прокручиваемых курсоров. Эти курсоры зависят как от расходов, так и от их возможности обнаруживать изменения в результирующем наборе. Обратите внимание, что если прокручиваемый курсор может обнаруживать изменения в строках, он может обнаружить их только при попытке повторной выборки этих строк. Источник данных не может уведомлять курсор об изменениях в выбранных строках. Обратите внимание, что видимость изменений также контролируется уровнем изоляции транзакций. Дополнительные сведения см. в разделе [изоляция транзакций](../../../odbc/reference/develop-app/transaction-isolation.md).  
  
 Этот раздел содержит следующие подразделы.  
  
-   [Типы прокручиваемых курсоров](../../../odbc/reference/develop-app/scrollable-cursor-types.md)  
  
-   [Использование прокручиваемых курсоров](../../../odbc/reference/develop-app/using-scrollable-cursors.md)  
  
-   [Относительная и абсолютная прокрутка](../../../odbc/reference/develop-app/relative-and-absolute-scrolling.md)  
  
-   [Закладки](../../../odbc/reference/develop-app/bookmarks-odbc.md)
