---
title: SQLDescribeCol и SQLColAttribute | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQLColAttribute function [ODBC], and SQLDescribeCol
- SQLDescribeCol function [ODBC], and SQLColAttribute
- result sets [ODBC], metadata
- retrieving result set meta data [ODBC]
- metadata [ODBC], result set
ms.assetid: c2ca442c-03a8-4e0f-9e67-b300bb15962f
author: MightyPen
ms.author: genemi
ms.openlocfilehash: d602368475c6f1326cc615453116e898b1c1892f
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68107446"
---
# <a name="sqldescribecol-and-sqlcolattribute"></a>SQLDescribeCol и SQLColAttribute
**SQLDescribeCol** и **SQLColAttribute** используются для получения метаданных результирующего набора. Разница между этими двумя функциями заключается в том, что **SQLDescribeCol** всегда возвращает те же пять фрагментов информации (имя столбца, тип данных, точность, масштаб и допустимость значений NULL), а **SQLColAttribute** возвращает один фрагмент информации, запрашиваемый приложением. Однако **SQLColAttribute** может возвращать более широкие возможности выбора метаданных, включая чувствительность столбца к регистру, размер отображения, возможность обновления и возможность поиска.  
  
 Во многих приложениях, особенно тех, которые отображают данные, требуются только метаданные, возвращаемые **SQLDescribeCol**. Для этих приложений быстрее использовать **SQLDescribeCol** , чем **SQLColAttribute** , так как информация возвращается в одном вызове. Для других приложений, особенно для обновления данных, требуются дополнительные метаданные, возвращаемые **SQLColAttribute** , и, следовательно, используются обе функции. Кроме того, **SQLColAttribute** поддерживает метаданные, относящиеся к драйверу. Дополнительные сведения см. в разделе [зависящие от драйвера типы данных, Типы дескрипторов, типы сведений, типы диагностики и атрибуты](../../../odbc/reference/develop-app/driver-specific-data-types-descriptor-information-diagnostic.md).  
  
 Приложение может получить метаданные результирующего набора в любое время после подготовки или выполнения инструкции и до закрытия курсора над результирующим набором. Очень небольшое число приложений требует наличия метаданных результирующего набора после подготовки инструкции и до ее выполнения. Если это возможно, приложения должны ожидать получения метаданных до тех пор, пока не будет выполнена инструкция, поскольку некоторые источники данных не могут возвращать метаданные для подготовленных инструкций и Эмуляция этой возможности в драйвере зачастую является очень длительным процессом. Например, драйвер может создать результирующий набор нулевой строки, заменив предложение **WHERE** инструкции **SELECT** на предложение **WHERE 1 = 2** и выполнив результирующую инструкцию.  
  
 Метаданные часто извлекаются из источника данных. По этой причине драйверы должны кэшировать все метаданные, которые они получают с сервера, и удерживать их до тех пор, пока курсор над результирующим набором открыт. Кроме того, приложения должны запрашивать только те метаданные, которые им абсолютно нужны.
