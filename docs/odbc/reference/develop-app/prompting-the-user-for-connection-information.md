---
title: Запрос сведений о подключении для пользователя | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- connecting to data source [ODBC], SqlConnect
- connecting to driver [ODBC], prompting user for information
- connecting to driver [ODBC], SQLConnect
- connecting to driver [ODBC], SQLDriverConnect
- connecting to data source [ODBC], SqlDriverConnect
- SQLConnect function [ODBC], prompting user for connection information
- connecting to data source [ODBC], prompting user for information
- prompting user for connection information [ODBC]
- SQLDriverConnect function [ODBC], prompting user for connection information
ms.assetid: da98e9b9-a4ac-4a9d-bae6-e9252b1fe1e5
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 9b0f120a1076f14f5e67d506e52a446e0a3d4713
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "81282087"
---
# <a name="prompting-the-user-for-connection-information"></a>Запрос сведений о подключении у пользователя
Если приложение использует **SQLConnect** и должно запросить у пользователя какие-либо сведения о соединении, например имя пользователя и пароль, он должен сделать это. Хотя это позволяет приложению управлять своим «внешним видом», оно может заставить приложение содержать код, зависящий от драйвера. Это происходит, когда приложению необходимо запросить у пользователя сведения о подключении, относящиеся к драйверу. Это является невозможной ситуацией для универсальных приложений, которые предназначены для работы с любыми драйверами, включая драйверы, которые не существуют при написании приложения.  
  
 **SQLDriverConnect** может запросить у пользователя сведения о подключении. Например, пользовательская программа, упомянутая ранее, может передать следующую строку подключения в **SQLDriverConnect**:  
  
```  
DSN=XYZ Corp;  
```  
  
 После этого драйвер может отобразить диалоговое окно с запросом идентификаторов пользователей и паролей, как показано на следующем рисунке.  
  
 ![Диалоговое окно с запросом идентификаторов и паролей пользователей](../../../odbc/reference/develop-app/media/pr18.gif "pr18")  
  
 То, что драйвер может запрашивать сведения о подключении, особенно полезен для универсальных и вертикальных приложений. Эти приложения не должны содержать сведений, относящихся к драйверу, и наличие в драйвере запроса сведений, необходимых для хранения этой информации из приложения. Это показано в двух предыдущих примерах. Когда приложение передало только имя источника данных драйверу, оно не содержит сведений, относящихся к драйверу, и поэтому не привязано к определенному драйверу. Когда приложение передавало в драйвер полную строку подключения, оно было привязано к драйверу, который мог бы интерпретировать эту строку.  
  
 Универсальное приложение может выполнить этот шаг дальше и даже не указывать источник данных. Когда **SQLDriverConnect** получает пустую строку подключения, диспетчер драйверов отображает следующее диалоговое окно.  
  
 ![Диалоговое окно выбора источника данных](../../../odbc/reference/develop-app/media/ch06a.gif "CH06A")  
  
 После того как пользователь выберет источник данных, диспетчер драйверов создаст строку подключения, указывающую этот источник данных, и передаст ее драйверу. После этого драйвер может запросить у пользователя любые дополнительные сведения, необходимые для этого.  
  
 Условия, при которых драйвер запрашивает пользователя, контролируются флагом *DriverCompletion* ; Существуют параметры, которые всегда запрашивают, запрашивают при необходимости или никогда не запрашиваются. Полное описание этого флага см. в описании функции [SQLDriverConnect](../../../odbc/reference/syntax/sqldriverconnect-function.md) .
