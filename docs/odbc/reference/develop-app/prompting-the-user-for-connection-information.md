---
title: Запрашивая разрешения пользователя для сведений о соединении | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- connecting to data source [ODBC], SqlConnect
- connecting to driver [ODBC], prompting user for information
- connecting to driver [ODBC], SQLConnect
- connecting to driver [ODBC], SQLDriverConnect
- connecting to data source [ODBC], SqlDriverConnect
- SQLConnect function [ODBC], prompting user for connection information
- connecting to data source [ODBC], prompting user for information
- prompting user for connection information [ODBC]
- SQLDriverConnect function [ODBC], prompting user for connection information
ms.assetid: da98e9b9-a4ac-4a9d-bae6-e9252b1fe1e5
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 58df84bf96306a2cfbc0567a3d5f6cb13514a06e
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "62861909"
---
# <a name="prompting-the-user-for-connection-information"></a>Запрос сведений о подключении у пользователя
Если приложение использует **SQLConnect** и ему нужно запрашивать пользователя сведения о соединении, такие как имя пользователя и пароль, он должен сделать это сам. Это позволяет приложению контролировать его «вид», она вынудит приложение должно содержать код для конкретного драйвера. Это происходит, когда приложение должно запрашивать сведения о подключении специфические для драйвера. Это представляется невозможным ситуации для универсальных приложений, которые предназначены для работы с всех драйверов, включая драйверы, которые отсутствуют при записи приложения.  
  
 **SQLDriverConnect** можно запрашивать сведения о соединении. Например, пользовательская программа, упомянутых выше можно передать следующую строку подключения для **SQLDriverConnect**:  
  
```  
DSN=XYZ Corp;  
```  
  
 Драйвер может затем отобразить диалоговое окно, которое запрашивает идентификаторы пользователей и пароли, аналогичную следующей иллюстрации.  
  
 ![Диалоговое окно, которое запрашивает идентификаторы пользователей и пароли](../../../odbc/reference/develop-app/media/pr18.gif "pr18")  
  
 Что драйвер может запросить сведения соединения особенно полезна в универсальных и вертикальные приложения. Эти приложения не должны содержать сведения, относящиеся к драйверу и наличие прав драйвера для необходимой ему информации сохраняет эту информацию из приложения. Это показано в предыдущих двух примерах. Когда приложение передало только имя источника данных к драйверу, приложение не содержал сведения о любой специфические для драйвера и таким образом не привязаны для драйвера. Когда приложение передало полная строка подключения к драйверу, он был привязан к драйвер, который может интерпретировать эту строку.  
  
 Универсальное приложение может дополнительно выполнить это действие и даже указать источник данных. Когда **SQLDriverConnect** Получает пустую строку соединения, диспетчер драйверов отображает следующее диалоговое окно.  
  
 ![Диалоговое окно выбора источника данных](../../../odbc/reference/develop-app/media/ch06a.gif "CH06A")  
  
 После выбора пользователем источника данных, диспетчер драйверов создает строку подключения, указав этот источник данных и передает его к драйверу. Драйвер может затем запросить у пользователя дополнительную информацию, которую ей.  
  
 Условия, при которых драйвер запрашивает у пользователя управляются *DriverCompletion* флаг; существуют параметры всегда запрашивать, при необходимости запрашивает или никогда не запрашивать подтверждение. Полное описание этого флага, см. в разделе [SQLDriverConnect](../../../odbc/reference/syntax/sqldriverconnect-function.md) описание функции.
