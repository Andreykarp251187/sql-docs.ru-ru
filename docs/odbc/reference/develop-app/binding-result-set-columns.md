---
description: Привязка столбцов результирующего набора
title: Привязка столбцов результирующего набора | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- result sets [ODBC], binding columns
- binding columns [ODBC]
ms.assetid: 4bc9c30f-83ae-4766-a746-032953c187ad
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: e6a228de81deb5cdfdaa62ee7940185b14bcaef8
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88499947"
---
# <a name="binding-result-set-columns"></a>Привязка столбцов результирующего набора
Приложения могут привязывать столько или сколько столбцов результирующего набора по мере выбора, включая привязку без столбцов. Когда строка данных извлекается, драйвер возвращает приложению данные для связанных столбцов. Будет ли приложение привязывать все столбцы результирующего набора, зависит от приложения. Например, приложения, создающие отчеты, обычно имеют фиксированный формат. такие приложения создают результирующий набор, содержащий все столбцы, используемые в отчете, а затем привязывают и получают данные для всех этих столбцов. Приложения, отображающие экраны с заполнением данных, иногда позволяют пользователю выбирать отображаемые столбцы. такие приложения создают результирующий набор, содержащий все столбцы, которые может потребоваться пользователю, но привязывать и извлекать данные только для тех столбцов, которые выбраны пользователем.  
  
 Данные могут быть получены из непривязанных столбцов путем вызова **SQLGetData**. Обычно это вызывается для получения длинных данных, которые часто превышают длину одного буфера и должны извлекаться в частях.  
  
 Столбцы могут быть привязаны в любое время даже после того, как были получены строки. Однако новые привязки вступают в силу только при следующей выборки строки. они не применяются к данным из уже выбранных строк.  
  
 Переменная остается привязанной к столбцу до тех пор, пока к столбцу не будет привязана другая переменная, пока столбец не будет несвязан, вызвав **SQLBindCol** с пустым указателем в качестве адреса переменной, пока не будут отменены все столбцы путем вызова **SQLFreeStmt** с параметром SQL_UNBIND или до тех пор, пока инструкция не будет освобождена. По этой причине приложение должно быть уверенным в том, что все привязанные переменные остаются действительными, пока они привязаны. Дополнительные сведения см. в разделе [выделение и освобождение буферов](../../../odbc/reference/develop-app/allocating-and-freeing-buffers.md).  
  
 Поскольку привязки столбцов — это просто сведения, связанные со структурой инструкций, их можно задать в любом порядке. Они также не зависят от результирующего набора. Например, предположим, что приложение привязывает столбцы результирующего набора, созданного следующей инструкцией SQL:  
  
```  
SELECT * FROM Orders  
```  
  
 Если затем приложение выполняет инструкцию SQL  
  
```  
SELECT * FROM Lines  
```  
  
 для одного и того же маркера инструкции привязки столбцов для первого результирующего набора по-прежнему вступают в силу, так как это привязки, хранящиеся в структуре инструкций. В большинстве случаев это неплохая практика программирования, и его следует избегать. Вместо этого приложение должно вызвать **SQLFreeStmt** с параметром SQL_UNBIND, чтобы отменить привязку всех старых столбцов, а затем привязать новые.
