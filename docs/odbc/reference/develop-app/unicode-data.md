---
description: Данные в Юникоде
title: Данные в Юникоде | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- Unicode [ODBC], data
- data types [ODBC], Unicode
- C data types [ODBC], Unicode
- SQL data types [ODBC], Unicode
ms.assetid: abc28718-e6d9-49fb-97ff-402d50c3c375
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: f217e6b629936cc835d134c89d972bb1408b9d0b
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88339120"
---
# <a name="unicode-data"></a>Данные в Юникоде
Типы данных SQL в Юникоде предназначены для описания данных, находящиеся в Юникоде изначально в СУБД. Тип данных в Юникоде позволяет приложению привязывать данные к буферу Юникода. Диспетчер драйверов может преобразовать данные из типа Юникода C (SQL_C_WCHAR), чтобы сделать его функцией с драйвером ANSI.  
  
 ODBC 3,0 или 2. Приложение *x* всегда будет привязано к типам данных ANSI. Для оптимальной производительности приложение ODBC 3,5 (или более поздней версии) должно быть привязано к типу данных ANSI C, если тип столбца SQL — ANSI, и должен быть привязан к типу данных Юникода C, если тип столбца SQL — Unicode.  
  
 Индикаторы типа SQL в Юникоде: SQL_WCHAR, SQL_WVARCHAR и SQL_WLONGVARCHAR. SQL_WCHAR данные имеют фиксированную длину строки, тогда как SQL_WVARCHAR имеет переменную длину с объявленным максимальным значением и SQL_WLONGVARCHAR имеет переменную длину с максимальным значением, зависящим от источника данных.  
  
 Индикатор типа Юникода C имеет SQL_C_WCHAR. Это значение по умолчанию для каждого из индикаторов типа SQL в Юникоде. Все типы SQL можно преобразовать в SQL_C_WCHAR, а SQL_C_WCHAR можно преобразовать во все типы SQL. Приложение может получать данные одним из трех способов:  
  
-   Получение данных в виде SQL_C_CHAR.  
  
-   Получение данных в виде SQL_C_WCHAR.  
  
-   Объявите данные как SQL_C_TCHAR. Это макрос, который вставляет SQL_C_WCHAR, если приложение компилируется как приложение в Юникоде, или вставляет SQL_C_CHAR, если он компилируется как приложение ANSI.  
  
 SQL_C_TCHAR объявляется в функции следующим образом:  
  
```  
SQLBindParameter(StatementHandle, 1, SQL_PARAM_INPUT, SQL_C_TCHAR, SQL_WCHAR, NameLen, 0, Name, 0, &Name)  
```  
  
 Если приложение компилируется как приложение в Юникоде, аргумент *ValueType* изменится с SQL_C_TCHAR на SQL_C_WCHAR. Если приложение компилируется как приложение ANSI, аргумент *ValueType* изменится на SQL_C_CHAR.  
  
 Драйверы Юникода по-прежнему должны поддерживать типы данных ANSI, в том числе SQL_CHAR. Если приложение, работающее с драйвером Юникода, привязывается к SQL_CHAR, диспетчер драйверов не будет сопоставлять SQL_CHAR данные с SQL_WCHAR. Драйвер Юникода должен принимать данные SQL_CHAR.  
  
 Диспетчер драйверов хранит драйверы и имена DSN в Юникоде и при необходимости сопоставляет их с ANSI. Если символ Юникода не может быть сопоставлен с символом ANSI (как это может произойти, если символы из кодовой страницы, не являющейся собственной кодовой страницей компьютера, используются в именах драйверов и имен DSN), то символы, которые не удалось преобразовать, представлены символом по умолчанию, предоставленным системой.
