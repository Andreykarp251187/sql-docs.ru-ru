---
title: Обновление строк по закладкам с помощью SQLBulkOperations | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- data updates [ODBC], bookmarks
- SQLBulkOperations function [ODBC], updating rows
- data updates [ODBC], SQLBulkOperations
- bookmarks [ODBC]
- updating data [ODBC], bookmarks
- updating data [ODBC], SQLBulkOperations
ms.assetid: c9ad82b7-8dba-45b0-bdb9-f4668b37c0d6
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: e9f0c59324542793301965c7d3555cf35ad40f5d
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "63194397"
---
# <a name="updating-rows-by-bookmark-with-sqlbulkoperations"></a>Обновление строк по закладкам с помощью SQLBulkOperations
При обновлении строки по закладкам, **SQLBulkOperations** позволяет обновить одну или несколько строк таблицы источника данных. Строки идентифицируются по закладкам в столбце привязанного закладки. Обновить строку, используя данные в буферах приложения для каждого привязанного столбца (кроме случаев, когда значение в буфер длины/индикатора для столбца SQL_COLUMN_IGNORE). Непривязанные столбцы не обновляется.  
  
 Для обновления строк по закладкам с **SQLBulkOperations**, приложение:  
  
1.  Получает и кэширует закладки все обновляемые строки. Если имеется более одного закладки и используется привязка на уровне столбцов, закладки, хранятся в массиве. Если имеется более одного закладки и используется привязка на уровне строки, закладки, хранятся в массив структур строк.  
  
2.  Устанавливает атрибут SQL_ATTR_ROW_ARRAY_SIZE инструкции число закладок и привязывает буфер, содержащий значение, или массив, закладок, столбец 0.  
  
3.  Помещает новые значения данных в буферах набора строк. Сведения о том, как для отправления объемных данных с помощью **SQLBulkOperations**, см. в разделе [длинных данных и функции SQLSetPos и SQLBulkOperations](../../../odbc/reference/develop-app/long-data-and-sqlsetpos-and-sqlbulkoperations.md).  
  
4.  Задает значение в буфер длины/индикатора каждого столбца, при необходимости. Это байтовая длина данных или SQL_NTS для столбцов, привязанных к буферам строк байтовая длина данных для столбцов, привязанных к двоичных буферах и SQL_NULL_DATA для всех столбцов будет присвоено значение NULL.  
  
5.  Задает значение в буфер длины/индикатора тех столбцов, которые не должны быть обновлены для SQL_COLUMN_IGNORE. Несмотря на то, что приложение может пропустить этот шаг и повторно отправить существующих данных, этот способ малоэффективен и привести к отправке значений в источнике данных, были усечены при чтении.  
  
6.  Вызовы **SQLBulkOperations** с *операции* аргумент значение SQL_UPDATE_BY_BOOKMARK.  
  
 Для каждой строки, которая отправляется к источнику данных, как обновление буферы приложения должны иметь допустимую строку данных. Если буферы приложения заполняются выборкой, если массив состояния строк была сохранена, и состояние для строки имеет значение SQL_ROW_DELETED, SQL_ROW_ERROR или SQL_ROW_NOROW, недопустимые данные может непреднамеренно отправляться к источнику данных.
