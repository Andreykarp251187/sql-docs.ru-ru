---
title: Обновление строк по закладке с помощью S'LBulkOperations (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- data updates [ODBC], bookmarks
- SQLBulkOperations function [ODBC], updating rows
- data updates [ODBC], SQLBulkOperations
- bookmarks [ODBC]
- updating data [ODBC], bookmarks
- updating data [ODBC], SQLBulkOperations
ms.assetid: c9ad82b7-8dba-45b0-bdb9-f4668b37c0d6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 9c755297e8beadad92b5be81d78ca534bb96ecae
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81283202"
---
# <a name="updating-rows-by-bookmark-with-sqlbulkoperations"></a>Обновление строк по закладкам с помощью SQLBulkOperations
При обновлении строки по закладке, **S'LBulkOperations** делает обновление источника данных одним или несколько строк таблицы. Строки идентифицируются закладкой в связанной колонке закладок. Строка обновляется с использованием данных в буферах приложения для каждого связанного столбца (за исключением случаев, когда значение буфера длины/индикатора для столбца SQL_COLUMN_IGNORE). Несвязанные столбцы не будут обновляться.  
  
 Для обновления строк по закладке с **помощью S'LBulkOperations**, приложение:  
  
1.  Извлекает и кэширует закладки всех строк, которые будут обновлены. При использовании более одной закладки и привязки к столбцом закладки закладки хранятся в массиве; если используется несколько закладок и используется связывание с рядом, закладки хранятся в массиве структур строки.  
  
2.  Устанавливает SQL_ATTR_ROW_ARRAY_SIZE заявление атрибутом к числу закладок и связывает буфер, содержащий значение закладки, или массив закладок, к столбу 0.  
  
3.  Размещает новые значения данных в буферах рядового набора. Для получения информации о том, как отправлять [Long Data and SQLSetPos and SQLBulkOperations](../../../odbc/reference/develop-app/long-data-and-sqlsetpos-and-sqlbulkoperations.md)длинные данные с **помощью S'LBulkOperations,** см.  
  
4.  Устанавливает значение в буфере длины/индикатора каждого столбца по мере необходимости. Это длина данных или SQL_NTS для столбцов, привязанных к строке буферов, длина байт данных для столбцов, привязанных к бинарным буферам, и SQL_NULL_DATA для любых столбцов, которые будут установлены на NULL.  
  
5.  Устанавливает значение в буфере длины/индикатора тех столбцов, которые не должны обновляться до SQL_COLUMN_IGNORE. Хотя приложение может пропустить этот шаг и отправить существующие данные, это неэффективно и рискует отправить значения в источник данных, которые были усечены при чтении.  
  
6.  Вызывает **S'LBulkOperations** с аргументом *операции,* установленным для SQL_UPDATE_BY_BOOKMARK.  
  
 Для каждой строки, отправленной в источник данных в качестве обновления, буферы приложения должны иметь действительные данные строки. Если буферы приложения были заполнены путем извлечения, если массив состояния строки был сохранен, и если значение состояния для строки SQL_ROW_DELETED, SQL_ROW_ERROR или SQL_ROW_NOROW, недействительные данные могут быть непреднамеренно отправлены в источник данных.
