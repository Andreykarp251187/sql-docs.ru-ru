---
title: Переходы государства (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- state transitions [ODBC]
- unallocated state [ODBC]
- handles [ODBC], state transitions
- allocated state [ODBC]
- connection state [ODBC]
ms.assetid: fc741611-6535-43cc-8156-6d897d04664e
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 3a480b7ff8953ef94f0efc4886a09731730a61b7
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81299697"
---
# <a name="state-transitions"></a>Переходы состояния
ODBC определяет дискретные *состояния* для каждой среды, каждого соединения и каждого оператора. Например, среда имеет три возможных состояния: Unallocated (в котором не выделяется среда), Выделение (в котором среда выделяется, но нет соединений выделены), и соединение (в котором среда и одно или несколько соединений выделены). Соединения имеют семь возможных состояний; заявления имеют 13 возможных состояний.  
  
 Конкретный элемент, идентифицированный по его ручке, перемещается из одного состояния в другое, когда приложение вызывает определенную функцию или функции и передает ручку этому элементу. Такое движение называется *переходом к состоянию.* Например, выделение ручки среды с **помощью S'LAllocHandle** перемещает среду от нераспределенной до распределенной, а освобождение этой ручки с **помощью S'LFreeHandle** возвращает ее из выделенного в нераспределенную. ODBC определяет ограниченное число переходов правового состояния, что является еще одним способом сказать, что функции должны быть вызваны в определенном порядке.  
  
 Некоторые функции, такие как **S'LGetConnectAttr,** не влияют на состояние вообще. Другие функции влияют на состояние одного элемента. Например, **S'LDisconnect** перемещает соединение из состояния соединения в выделенное состояние. Наконец, некоторые функции влияют на состояние более чем одного элемента. Например, выделение ручки соединения с **s'LAllocHandle** перемещает соединение из нераспределенного состояния в выделенное состояние и перемещает среду из выделенного состояния в состояние соединения.  
  
 Если приложение вызывает функцию не по порядку, функция возвращает *ошибку перехода состояния.* Например, если среда находится в состоянии подключения и приложение вызывает **s'LFreeHandle** с этой обработкой среды, **S'LFreeHandle** возвращает S'LSTATE HY010 (ошибка последовательности функций), потому что она может быть вызвана только тогда, когда среда находится в распределенном состоянии. Определяя это как недействительный переход состояния, ODBC предотвращает освобождение среды приложения при наличии активных подключений.  
  
 Некоторые переходы состояния присущи дизайну ODBC. Например, невозможно выделить ручку соединения без предварительного выделения ручки среды, поскольку функция, распределяющая ручку соединения, требует ручки среды. Другие переходы состояния применяются менеджером драйверов и драйверами. Например, **s'LExecute** выполняет подготовленное заявление. Если ручка оператора, переданная ей, не находится в подготовленном состоянии, **S'LExecute** возвращает S'LSTATE HY010 (ошибка последовательности функций).  
  
 С точки зрения приложения переходы состояния обычно просты: переходы правового состояния, как правило, идут рука об руку с потоком хорошо написанного приложения. Переходы состояния являются более сложными для менеджера драйверов и драйверов, поскольку они должны отслеживать состояние среды, каждое соединение и каждое заявление. Большая часть этой работы выполняется менеджером драйверов; большая часть работы, которую должны выполнить драйверы, выполняется с операторами с нерешенными результатами.  
  
 Части 1 и 2 этого руководства ("Введение в ODBC" и "Разработка приложений и драйверов"), как правило, не упоминают переходы состояний. Вместо этого они описывают порядок, в котором должны вызываться функции. Например, в "Исполнение заявлений" говорится, что для того, чтобы она может быть выполнена с **помощью S'LExecute,** необходимо подготовить заявление с **помощью S'L.** Для полного описания состояний и переходов состояния, включая, какие переходы проверяются [Appendix B: ODBC State Transition Tables](../../../odbc/reference/appendixes/appendix-b-odbc-state-transition-tables.md)менеджером драйверов и которые должны быть проверены драйверами, см.
