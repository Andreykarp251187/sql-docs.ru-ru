---
description: Курсоры (ODBC)
title: Курсоры (ODBC) | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- forward-only cursors [ODBC]
- scrollable cursors [ODBC]
- cursors [ODBC], about cursors
- cursors [ODBC]
- fetches [ODBC], cursors
- result sets [ODBC], fetching
- block cursors [ODBC]
ms.assetid: 0b114352-3c63-4d33-9220-182ede90e4aa
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 10dbd2517c29bcd02d1d39abe0b2caec1bf03312
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88429406"
---
# <a name="odbc-cursors"></a>Курсоры ODBC
Приложение извлекает данные с *курсором*. Курсор отличается от результирующего набора: результирующий набор — это набор строк, соответствующих определенным условиям поиска, тогда как курсор — это программное обеспечение, которое возвращает эти строки приложению. Курсор Name *(«имя»),* который применяется к базам данных, вероятно, из мерцающего курсора на компьютере. Точно так же, как курсор указывает на текущую позицию на экране и где будут отображаться введенные слова, курсор в результирующем наборе указывает текущую позицию в результирующем наборе и строку, которая будет возвращена далее.  
  
 Модель курсора в ODBC основана на модели курсора во внедренном SQL. Одной из заметных различий между этими моделями является способ открытия курсоров. В внедренном SQL перед использованием курсор должен быть явно объявлен и открыт. В ODBC курсор неявно открывается при выполнении инструкции, создающей результирующий набор. При открытии курсора он располагается перед первой строкой результирующего набора. В внедренных SQL и ODBC курсор должен быть закрыт после того, как приложение завершит его использование.  
  
 Разные курсоры имеют разные характеристики. Наиболее распространенный тип курсора, который называется *однонаправленным курсором,* может перемещаться только вперед по результирующему набору. Чтобы вернуться к предыдущей строке, приложение должно закрыть и снова открыть курсор, а затем считывать строки с начала результирующего набора до тех пор, пока не достигнет требуемой строки. Однонаправленные курсоры обеспечивают быстрый механизм для выполнения одного прохода через результирующий набор.  
  
 Однонаправленные курсоры менее полезны для приложений на основе экрана, в которых пользователь прокручивается назад и вперед по данным. Такие приложения могут использовать однонаправленный курсор, считывая результирующий набор один раз, кэшировать данные локально и выполнять прокрутку. Однако это хорошо работает только с небольшими объемами данных. Лучшим решением является использование *прокручиваемого курсора,* который обеспечивает произвольный доступ к результирующему набору. Такие приложения также могут повысить производительность, вычисляя более одной строки данных за раз, используя то, что называется *блочным курсором.* Дополнительные сведения о блочных курсорах см. [в разделе Использование блочных курсоров](../../../odbc/reference/develop-app/using-block-cursors.md).  
  
 Однонаправленный курсор является типом курсора по умолчанию в ODBC и рассматривается в следующих разделах. Дополнительные сведения о блочных курсорах и прокручиваемых курсорах см. в разделе [блочные](../../../odbc/reference/develop-app/block-cursors.md) курсоры и [прокручиваемые курсоры](../../../odbc/reference/develop-app/scrollable-cursors.md).  
  
> [!IMPORTANT]  
>  Фиксация или откат транзакции с помощью явного вызова **SQLEndTran** или работы в режиме автоматической фиксации приводит к тому, что некоторые источники данных закрывают все курсоры на всех инструкциях в соединении. Дополнительные сведения см. в разделе атрибуты SQL_CURSOR_COMMIT_BEHAVIOR и SQL_CURSOR_ROLLBACK_BEHAVIOR в описании функции [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md) .
