---
title: Курсоры | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- forward-only cursors [ODBC]
- scrollable cursors [ODBC]
- cursors [ODBC], about cursors
- cursors [ODBC]
- fetches [ODBC], cursors
- result sets [ODBC], fetching
- block cursors [ODBC]
ms.assetid: 0b114352-3c63-4d33-9220-182ede90e4aa
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 91765f0572d8c880f7505948f7756b373fe28f62
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "63042130"
---
# <a name="cursors"></a>Курсоры
Приложение извлекает данные с *курсор*. Курсор отличается от результирующего набора: Результирующий набор — это набор строк, который соответствует конкретным условиям поиска, тогда как курсор — программное обеспечение, которое возвращает эти строки в приложение. Имя *курсора,* применительно к базам данных, вероятно, произошло из мерцающего курсора на компьютере терминала. Так же, как этот курсор указывает текущее положение на экране, и где отобразятся Далее вводимых слов, курсора на результирующем наборе указывает текущее положение в результирующем наборе, и какие строки будут возвращены рядом.  
  
 Модель курсора в ODBC основан на модели курсора в embedded SQL. Примечательным отличием между этими моделями — способ курсоры открыты. В embedded SQL курсор должен быть явно объявлены и открыт, прежде чем можно будет использовать. В ODBC курсор неявно открывается при выполнении инструкции, которая создает результирующий набор. Если курсор открыт, он располагается перед первой строкой результирующего набора. В embedded SQL и ODBC курсор должен быть закрыт после завершения его использования приложения.  
  
 Различные курсоры имеют разные характеристики. Наиболее распространенный тип курсора, который называется *однопроходный курсор,* можно только Переместить вперед из результирующего набора. Чтобы вернуться к предыдущей строки, приложение необходимо закрыть и заново откройте его и затем чтение строк в начале результирующего набора, пока не достигнет необходимые строки. Однопроходные курсоры предоставляют быстрый механизм за один проход результирующий набор.  
  
 Однопроходные курсоры являются менее полезно для приложений на экране, в которых пользователь выполняет прокрутку назад и вперед по данным. Такие приложения могут использовать однопроходный курсор, считывая результирующий набор после кэширования данные локально и выполнять прокрутку сами. Тем не менее это работает хорошо, только с небольшим объемом данных. Лучшим решением является использование *Прокручиваемый курсор* которого обеспечивает произвольный доступ к результирующему набору. Такие приложения можно также повысить производительность, получение более одной строки данных за раз, с помощью так называемый *блочный курсор.* Дополнительные сведения о блочных курсоров, см. в разделе [использование блочных курсоров](../../../odbc/reference/develop-app/using-block-cursors.md).  
  
 Однопроходный курсор имеет тип курсора по умолчанию в ODBC и рассматривается в следующих разделах. Дополнительные сведения о блочных курсоров и прокручиваемых курсоров, см. в разделе [блочные курсоры](../../../odbc/reference/develop-app/block-cursors.md) и [Прокручиваемые курсоры](../../../odbc/reference/develop-app/scrollable-cursors.md).  
  
> [!IMPORTANT]  
>  Фиксация или откат транзакции, либо путем явного вызова **SQLEndTran** или по работе в режиме автоматической фиксации, вызывает некоторые источники данных закрыть все курсоры для всех инструкций в соединении. Дополнительные сведения см. в разделе атрибутов SQL_CURSOR_COMMIT_BEHAVIOR и SQL_CURSOR_ROLLBACK_BEHAVIOR [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md) описание функции.
