---
title: Курсоры | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- forward-only cursors [ODBC]
- scrollable cursors [ODBC]
- cursors [ODBC], about cursors
- cursors [ODBC]
- fetches [ODBC], cursors
- result sets [ODBC], fetching
- block cursors [ODBC]
ms.assetid: 0b114352-3c63-4d33-9220-182ede90e4aa
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: da899e4dc47daff03c31277b3edd4d9c642b87cb
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81305295"
---
# <a name="cursors"></a>Курсоры
Приложение получает данные с *помощью курсора.* Курсор отличается от набора результатов: набор результатов представляет собой набор строк, который соответствует определенным критериям поиска, в то время как курсор — это программное обеспечение, которое возвращает эти строки в приложение. *Курсор имени,* как это относится к базам данных, вероятно, возник из мигающего курсора на компьютерном терминале. Точно так же, как курсор указывает текущее положение на экране и где набранные слова будут отображаться дальше, курсор на наборе результатов указывает текущее положение в наборе результатов и какую строку будет возвращено дальше.  
  
 Модель курсора в ODBC основана на модели курсора во встроенном S'L. Одним из заметных различий между этими моделями является способ открытия курсоров. Во встроенном S'L курсор должен быть явно объявлен и открыт, прежде чем он может быть использован. В ODBC курсор неявно открывается при выполнении оператора, создаваемого набора результатов. При открытии курсора он расположен перед первым рядом набора результатов. Как во встроенных S'L, так и в ODBC курсор должен быть закрыт после того, как приложение закончило его использование.  
  
 Различные курсоры имеют различные характеристики. Наиболее распространенный тип курсора, который называется *вперед только курсор,* может двигаться вперед только через набор результатов. Чтобы вернуться в предыдущую строку, приложение должно закрыть и повторно открыть курсор, а затем прочитать строки с начала набора результатов, пока он не достигнет требуемой строки. Курсоры только вперед обеспечивают быстрый механизм для принятия одного прохода через набор результатов.  
  
 Курсоры только вперед менее полезны для приложений на основе экрана, в которых пользователь прокручивает данные назад и вперед. Такие приложения могут использовать курсор только вперед, читая набор результатов один раз, кэшируя данные локально и выполняя прокрутку себя. Тем не менее, это хорошо работает только с небольшими объемами данных. Лучшим решением является использование *прокрутки курсора,* который обеспечивает случайный доступ к набору результатов. Такие приложения также могут повысить производительность, приговывая несколько строк данных одновременно, используя так называемый *курсор блока.* Для получения дополнительной информации о курсорах блоков [см.](../../../odbc/reference/develop-app/using-block-cursors.md)  
  
 Курсор только для форварда является типом курсора по умолчанию в ODBC и обсуждается в следующих разделах. Для получения дополнительной информации о курсорах блоков и прокрутки курсоры, см [Блок Cursors](../../../odbc/reference/develop-app/block-cursors.md) и [Scrollable Cursors](../../../odbc/reference/develop-app/scrollable-cursors.md).  
  
> [!IMPORTANT]  
>  Совершение или откат транзакции, либо путем явного вызова **S'LEndTran,** либо при работе в режиме автоматического коммита, приводит к тому, что некоторые источники данных закрывают все курсоры на все операторы соединения. Для получения дополнительной информации в описании функции [s'LGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md) приведены характеристики SQL_CURSOR_COMMIT_BEHAVIOR и SQL_CURSOR_ROLLBACK_BEHAVIOR.
