---
title: Установка значений параметров | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- parameter values [ODBC]
ms.assetid: 13e5da79-b60c-48d0-b467-773f481ef2a4
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 0bb1115290f53c19fae1aacb0a976cfcef63e086
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68094235"
---
# <a name="setting-parameter-values"></a>Установка значений параметров
Чтобы задать значение параметра, приложение просто устанавливает значение переменной, привязанной к параметру. Не имеет значения, если задано это значение, если оно задано до выполнения инструкции. Приложение может задать значение до или после привязки переменной и может изменить это значение столько раз, сколько оно требуется. При выполнении инструкции драйвер просто извлекает текущее значение переменной. Это особенно полезно, когда подготовленная инструкция выполняется более одного раза. Приложение устанавливает новые значения для некоторых или всех переменных при каждом выполнении инструкции. Пример см. в разделе [подготовленное выполнение](../../../odbc/reference/develop-app/prepared-execution-odbc.md)ранее.  
  
 Если буфер длины или индикатора был привязан в вызове **SQLBindParameter**, перед выполнением инструкции необходимо задать одно из следующих значений.  
  
-   Длина байта данных в связанной переменной. Драйвер проверяет эту длину только в том случае, если переменная является символьной или двоичной (значение*ValueType* — SQL_C_CHAR или SQL_C_BINARY).  
  
-   SQL_NTS. Данные являются строкой, завершающейся нулем.  
  
-   SQL_NULL_DATA. Значение данных равно NULL, а драйвер не учитывает значение привязанной переменной.  
  
-   SQL_DATA_AT_EXEC или результат макроса SQL_LEN_DATA_AT_EXEC. Значение параметра отправляется с помощью **SQLPutData**. Дополнительные сведения см. в подразделе « [Отправка длинных данных](../../../odbc/reference/develop-app/sending-long-data.md)» ниже.  
  
 В следующей таблице показаны значения привязанной переменной и буфер длины/индикатора, который задается приложением для различных значений параметров.  
  
|Параметр<br /><br /> value|Параметр<br /><br /> SQL<br /><br /> тип данных|Переменная (C)<br /><br /> тип данных|Значение <br /><br /> привязка<br /><br /> Переменный|Значение <br /><br /> Длина и индикатор<br /><br /> buffer [d]|  
|-------------------------|-----------------------------------------|----------------------------------|-------------------------------------|----------------------------------------------------|  
|"ABC"|SQL_CHAR|SQL_C_CHAR|ABC\0 [a]|SQL_NTS или 3|  
|10|SQL_INTEGER|SQL_C_SLONG|10|--|  
|10|SQL_INTEGER|SQL_C_CHAR|10 \ 0 [a]|SQL_NTS или 2|  
|1 P.M.|SQL_TYPE_TIME|SQL_C_TYPE_TIME|13, 0, 0 [b]|--|  
|1 P.M.|SQL_TYPE_TIME|SQL_C_CHAR|{t ' 13:00:00 '} \ 0 [a], [c]|SQL_NTS или 14|  
|NULL|SQL_SMALLINT|SQL_C_SSHORT|--|SQL_NULL_DATA|  
  
 [a] "\ 0" представляет символ завершения, равный null. Символ завершения null требуется только в том случае, если значение в буфере длины или индикатора SQL_NTS.  
  
 [b] числа в этом списке являются числами, хранящимися в полях структуры TIME_STRUCT.  
  
 [c] строка использует предложение escape-даты ODBC. Дополнительные сведения см. в статье [литералы даты, времени и отметок времени](../../../odbc/reference/develop-app/date-time-and-timestamp-literals.md).  
  
 [d] драйверы должны всегда проверять это значение, чтобы определить, является ли оно специальным значением, например SQL_NULL_DATA.  
  
 То, что драйвер выполняет со значением параметра во время выполнения, зависит от драйвера. При необходимости драйвер преобразует значение из типа данных C и длину байта привязанной переменной в тип данных SQL, точность и масштаб параметра. В большинстве случаев драйвер отправляет значение в источник данных. В некоторых случаях оно форматирует значение как текст и вставляет его в инструкцию SQL перед отправкой инструкции в источник данных.
