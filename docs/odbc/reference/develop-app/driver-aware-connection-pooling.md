---
title: Организация пулов соединений с учетом драйверов | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
ms.assetid: 53e7e3f7-edab-4d0b-8943-45442ba3ebc9
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 70b70c841f37bd69179137c807c0dadcfd932d2b
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "81287604"
---
# <a name="driver-aware-connection-pooling"></a>Организация пулов соединений с учетом драйвера
Создание пулов соединений с учетом драйвера — это новая функция диспетчера драйверов в Windows 8. Пул соединений с учетом драйвера позволяет модулям записи драйверов настраивать поведение пула подключений в драйвере ODBC.  
  
> [!NOTE]  
>  Использование пулов соединений с поддержкой драйвера не поддерживается в библиотеке курсоров. Приложение получит сообщение об ошибке, если оно попытается включить библиотеку курсоров через SQLSetConnectAttr, когда включена поддержка пулов соединений с поддержкой драйвера.  
  
 Пул соединений с учетом драйвера позволяет устранить следующие проблемы, связанные с пулами подключений диспетчера драйверов:  
  
 **Фрагментация пула** Диспетчер драйверов будет возвращать подключение из пула, только если это точное совпадение со строкой подключения нового запроса на соединение.  Одна из причин, по которой диспетчеру драйверов требуется точное соответствие, заключается в том, что диспетчер драйверов не понимает каждое ключевое слово строки подключения конкретного драйвера и его значение.  Однако некоторые значения ключевого слова строки подключения (например, имя базы данных) могут не требовать точного совпадения, так как драйвер может изменить базу данных менее чем на время, необходимое для открытия нового соединения (Точная разница во времени зависит от источника данных). И различия в некоторых атрибутах подключения (например SQL_ATTR_CURRENT_CATALOG) могут занять больше времени, чем различия в других атрибутах (например, SQL_ATTR_LOGIN_TIMEOUT). Это также может помешать диспетчеру драйверов использовать недорогое, повторно используемое подключение из пула. Если драйверу необходимо создать множество новых подключений, производительность приложения может снизиться, а масштабируемость источника данных может снизиться. Фрагментацию пула можно сократить с помощью пулов соединений с учетом драйверов, так как драйвер может лучше оценить стоимость повторного использования соединения в пуле для запроса на подключение.  
  
 **Параметры приложения не учитываются** Некоторые источники данных могут эффективно открывать новые подключения (по сравнению с сбросом некоторых атрибутов), поэтому приложение может предпочесть открыть новое подключение, а не пытаться повторно использовать несовпадающее подключение из пула и сбросить некоторые значения (хотя это может быть медленнее во время выполнения фразы инициализации пула соединений). Но некоторые приложения могут уменьшить нагрузку на сервер и открыть меньшее число подключений, хотя для устранения несоответствий при правильном поведении может потребоваться больше затрат. Без использования пулов соединений с учетом драйверов нельзя задать этот тип предпочтения эффективно, так как диспетчер драйверов не распознает все атрибуты подключения, относящиеся к драйверу. Организация пулов соединений с учетом драйверов позволяет драйверу получить настройки пользователя (с атрибутом SQLSetConnectAttr, зависящим от драйвера), чтобы лучше оценить стоимость повторного использования соединения из пула в зависимости от предпочтений пользователя.  
  
 Дополнительные сведения о пуле соединений с учетом драйверов см. в разделе Разработка сведений о [пуле подключений в драйвере ODBC](../../../odbc/reference/develop-driver/developing-connection-pool-awareness-in-an-odbc-driver.md).  
  
## <a name="determining-driver-support"></a>Определение поддержки драйверов  
 Использование пулов соединений с учетом драйверов является необязательным компонентом, который драйвер может не поддерживать. Чтобы определить, поддерживается ли драйвер, используйте SQL_DRIVER_AWARE_POOLING_SUPPORTED *инфотипе* [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md).  
  
## <a name="how-to-enable-driver-aware-connection-pooling"></a>Включение пулов соединений с учетом драйверов  
 Приложение может использовать сведения о пуле соединений с драйвером, присвоив атрибуту SQL_ATTR_CONNECTION_POOLING значение SQL_CP_DRIVER_AWARE с [SQLSetEnvAttr](../../../odbc/reference/syntax/sqlsetenvattr-function.md). Если драйвер не поддерживает сведения о пуле подключений, будет использоваться пул подключений диспетчера драйверов (то же, что указано SQL_CP_ONE_PER_HENV, а не SQL_CP_DRIVER_AWARE). Приложения ODBC 2. x и 3. x могут включать эту функцию.  
  
## <a name="see-also"></a>См. также:  
 [Разработка драйвера ODBC](../../../odbc/reference/develop-driver/developing-an-odbc-driver.md)
