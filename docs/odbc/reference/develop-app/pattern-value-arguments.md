---
title: Аргументы значения шаблона | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- catalog functions [ODBC], arguments
- arguments in catalog functions [ODBC], pattern value
- pattern value arguments [ODBC]
ms.assetid: 1d3f0ea6-87af-4836-807f-955e7df2b5df
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 53c091fd0b7a6cfdf390997fb5163fbc9d98e18c
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68023354"
---
# <a name="pattern-value-arguments"></a>Аргументы значения шаблона
Некоторые аргументы в функциях каталога, например аргумент *TableName* в **SQLTables**, принимают шаблоны поиска. Эти аргументы принимают шаблоны поиска, если атрибуту инструкции SQL_ATTR_METADATA_ID присвоено значение SQL_FALSE. они являются аргументами идентификатора, которые не принимают шаблон поиска, если для этого атрибута задано значение SQL_TRUE.  
  
 Символы шаблона поиска:  
  
-   Подчеркивание (_), представляющее любой одиночный символ.  
  
-   Знак процента (%), который представляет любую последовательность из нуля или более символов.  
  
-   Escape-символ, который зависит от драйвера и используется для включения знаков подчеркивания, знаков процента и escape-символа в качестве литералов. Если escape-символ предшествует неспециальному символу, то escape-символ не имеет специального значения. Если escape-символ предшествует специальному символу, он поменяет Специальный символ. Например, "\a" будет рассматриваться как два символа: "\\" и "a", но "\\%" будет рассматриваться как неспециальный одиночный символ "%".  
  
 Escape-символ извлекается с параметром SQL_SEARCH_PATTERN_ESCAPE в **SQLGetInfo**. Он должен предшествовать любому символу подчеркивания, знаку процента или escape-знаку в аргументе, который принимает шаблоны поиска для включения этого символа в качестве литерала. Примеры приведены в следующей таблице.  
  
|Шаблон поиска|Description|  
|--------------------|-----------------|  
|Конкретного|Все идентификаторы, содержащие букву A|  
|ABC_|Все четыре идентификатора символов, начиная с ABC|  
|ABC\\_|Идентификатор ABC_, предполагая, что escape-символ является обратной\\косой чертой ()|  
|\\\\%|Все идентификаторы, начинающиеся с обратной косой черты (\\), если escape-символ является обратной косой чертой|  
  
 Необходимо уделить особое внимание последовательному поиску символов шаблона поиска в аргументах, принимающих шаблоны поиска. Это особенно верно для символа подчеркивания, который обычно используется в идентификаторах. Распространенной ошибкой в приложениях является получение значения из одной функции каталога и передача этого значения в аргумент шаблона поиска в другой функции каталога. Например, предположим, что приложение получает имя таблицы MY_TABLE из результирующего набора для **SQLTables** и передает его в **SQLColumns** для получения списка столбцов в MY_TABLE. Вместо того чтобы получать столбцы для MY_TABLE, приложение получит столбцы для всех таблиц, соответствующих шаблону поиска MY_TABLE, например MY_TABLE, MY1TABLE, MY2TABLE и т. д.  
  
> [!NOTE]
>  ODBC 2. драйверы *x* не поддерживают шаблоны поиска в аргументе *CatalogName* в **SQLTables**. Драйверы ODBC 3 *. x* принимают шаблоны поиска в этом аргументе, если для атрибута среды SQL_ATTR_ ODBC_VERSION задано значение SQL_OV_ODBC3; они не принимают шаблоны поиска в этом аргументе, если для него задано значение SQL_OV_ODBC2.  
  
 Передача пустого указателя в аргумент шаблона поиска не ограничивает поиск этого аргумента. то есть, указатель null и шаблон поиска% (любые символы) эквивалентны. Однако шаблон поиска нулевой длины, т. е. допустимый указатель на строку нулевой длины, соответствует только пустой строке ("").
