---
title: Аргументы значения шаблона | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- catalog functions [ODBC], arguments
- arguments in catalog functions [ODBC], pattern value
- pattern value arguments [ODBC]
ms.assetid: 1d3f0ea6-87af-4836-807f-955e7df2b5df
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 8f4a32d9ab637de5b52466cfcb628a57ff6c044b
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62861731"
---
# <a name="pattern-value-arguments"></a>Аргументы значения шаблона
Некоторые аргументы в каталоге функции, такие как *TableName* аргумента в **SQLTables**, примите шаблонов поиска. Эти аргументы принимают шаблонов поиска, если атрибут инструкции SQL_ATTR_METADATA_ID имеет значение SQL_FALSE; они являются идентификатор аргументы, которые не принимают шаблону поиска, если этот атрибут имеет значение SQL_TRUE.  
  
 Символы шаблон поиска могут:  
  
-   Символ подчеркивания (_), который представляет любой единичный символ.  
  
-   Знак процента (%), который представляет любой последовательности из нуля или более символов.  
  
-   Escape-символа, специфические для драйвера и используемый посредством добавления символа подчеркивания, регистрируется в %, и escape-символа как литералы. Если escape-символ предшествует символ одного неспециального, escape-символ не имеет специального значения. Если escape-символ предшествует специальный символ, он экранирует специальный символ. Например, «\a» будут рассматриваться как два символа "\\" и «», но "\\%» будет рассматриваться как один символ одного неспециального «%».  
  
 Escape-символа, полученного с помощью параметра SQL_SEARCH_PATTERN_ESCAPE в **SQLGetInfo**. Он должен указываться перед любой символ подчеркивания, процента или escape-символ в аргумент, который принимает шаблонов поиска, чтобы включить этот символ как литерал. Примеры приведены в следующей таблице.  
  
|Шаблон поиска|Описание|  
|--------------------|-----------------|  
|% %A|Все идентификаторы, содержащий букву A|  
|ABC_|Все идентификаторы четырех символов, начиная с ABC|  
|ABC\\_|Идентификатор ABC_, при условии, что escape-символ — обратную косую черту (\\)|  
|\\\\%|Все идентификаторы, начиная с обратной косой черты (\\), при условии, что escape-символ — это обратная косая черта|  
  
 Для экранирования символов шаблон поиска в аргументах, которые принимают шаблонов поиска необходимо принимать специальные меры. Это особенно верно для символа подчеркивания, которая часто используется в качестве идентификаторов. Распространенная ошибка заключается в приложениях — извлечь значение из одной функции каталога и передавать это значение в аргумент шаблона поиска в другую функцию каталога. Предположим, например, приложение извлекает имя таблицы, задать MY_TABLE из результата для **SQLTables** и передает ее, **SQLColumns** для получения списка столбцов в MY_TABLE. Вместо получения столбцов для MY_TABLE, приложение будет получать столбцы для всех таблиц, соответствующих шаблону поиска MY_TABLE, например MY_TABLE, MY1TABLE, MY2TABLE и т. д.  
  
> [!NOTE]
>  ODBC 2. *x* драйверы не поддерживают шаблоны поиска в *CatalogName* аргумента в **SQLTables**. ODBC 3 *.x* драйверы принимают шаблонов поиска в этот аргумент, если атрибуту окружения SQL_ATTR_ ODBC_VERSION присвоено значение SQL_OV_ODBC3; они не принимают шаблонов поиска в этот аргумент, если он становится равным SQL_OV_ODBC2.  
  
 Передача null указателя в аргумент шаблона поиска не ограничивает поиск для этого аргумента; то есть эквивалентны указателем null и шаблон поиска % (символы). Тем не менее, шаблон поиска нулевой длины — то есть допустимый указатель на строку нулевой длины - соответствует только пустую строку (»»).
