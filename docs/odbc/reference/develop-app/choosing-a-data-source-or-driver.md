---
title: Выбор данных источника или драйвер | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- connecting to driver [ODBC], selecting driver
- connecting to data source [ODBC], selecting data source
- data sources [ODBC], selecting
- ODBC drivers [ODBC], selecting
ms.assetid: 10aaf570-01ab-4478-8339-bdde2a5e3dd1
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 9aac31af80ff5774d464f76f130d2d113002e60a
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "68001400"
---
# <a name="choosing-a-data-source-or-driver"></a>Выбор источника данных или драйвера
Источник данных или драйвер, который используется приложением иногда жестко закодирована в приложении. Например, пользовательское приложение отделом MIS для передачи данных из одного источника данных в другой будет содержать имена этих данных источников-приложение просто не будет работать с другими источниками. Еще один пример — это вертикальное приложение, например тому, который используется для ввода заказов. Такое приложение всегда использует тот же источник данных, с предварительно определенной схемой, известные для приложения.  
  
 Другие приложения выберите источник данных или драйвера во время выполнения. Как правило это универсальных приложений, выполняющих нерегламентированные запросы, например электронную таблицу, которая использует ODBC для импорта данных. Такие приложения обычно перечислены доступные источники данных или драйверы и позволить пользователям выбирать те, которые они хотят работать с. Ли универсального приложения перечислены источники данных и драйверы часто зависит от того, использует ли приложение драйверы на основе СУБД или файловые.  
  
 Драйверы на основе СУБД обычно требуют сложного набора сведений о соединении, например сетевой адрес, сетевой протокол, имя базы данных и т. д. Источник данных предназначена для того, чтобы скрыть все эти данные. Таким образом парадигма источник данных предоставляет возможности для использования с драйверами на основе СУБД. Приложение может выводить список источников данных для пользователя в одном из двух способов. Оно может вызвать **SQLDriverConnect** с **DSN** ключевое слово (имя источника данных) и не связанное значение; the Driver Manager отобразит список имен источников данных. Если приложению управлять внешним видом списка, он вызывает метод **SQLDataSources** для получения списка доступных источников данных и создает собственное диалоговое окно. Эта функция реализуется диспетчером драйверов и может быть вызван до загрузки всех драйверов. Затем приложение вызывает функцию подключения и передает его имя источника данных.  
  
 Если источник данных не указан, используется источник данных по умолчанию, указывает сведения о системе. (Дополнительные сведения см. в разделе [по умолчанию подраздел](../../../odbc/reference/install/default-subkey.md).) Если **SQLConnect** вызывается с помощью *ServerName* аргумент, который не удается найти, является указателем null или «Default», диспетчер драйверов подключается к источнику данных по умолчанию. По умолчанию, источник данных используется также в том случае, если строка подключения, которая используется в вызове **SQLDriverConnect** или **SQLBrowseConnect** содержит **DSN** ключевое слово, равным «по умолчанию «или если указанный источник данных не найден. Кроме того, по умолчанию, источник данных используется в том случае, если строка подключения, которая используется в вызове **SQLDriverConnect** не содержит **DSN** ключевое слово.  
  
 С драйверами на основе файлов можно использовать парадигму файл. Для данных, хранящихся на локальном компьютере пользователи часто знают, что их данные будут в определенный файл, например Employee.dbf. Вместо выбора источника данных неизвестно, проще для таких пользователей выбрать файл, что они знают. Чтобы реализовать это, сначала вызывает приложение **SQLDrivers**. Эта функция реализуется диспетчером драйверов и может быть вызван до загрузки всех драйверов. **SQLDrivers** возвращает список доступных драйверов; он также возвращает значения для **FileUsage** и **FileExtns** ключевые слова. **FileUsage** ключевое слово объясняется ли драйверы на основе файла считать файлы как таблицы, не Xbase или как базы данных, как Microsoft® Access. **FileExtns** ключевое слово список расширений имен файлов, распознает драйвер, например .dbf драйвер Xbase. Используя эту информацию, приложение создает диалоговое окно с помощью которого пользователь выбирает файл. Исходя из расширение выбранного файла, затем приложение подключается к драйверу, вызвав **SQLDriverConnect** с **ДРАЙВЕР** ключевое слово.  
  
 Нет элементов для остановки приложения от использования источника данных с помощью драйверов на основе файла или вызова **SQLDriverConnect** с **ДРАЙВЕР** ключевое слово для подключения к драйверов на основе СУБД. Ниже приведены несколько наиболее частые способы использования **ДРАЙВЕР** ключевое слово для драйверов на основе СУБД:  
  
-   **Не Создание источников данных.** Например пользовательское приложение может использовать конкретный драйвер и базы данных. Если имя драйвера и все сведения, необходимые для подключения к базе данных, жестко в приложении, пользователи не должны создавать источник данных на своем компьютере, чтобы запустить приложение. Это необходимо сделать всего лишь установить драйвер и приложение.  
  
     Недостаток этого метода — что приложение необходимо перекомпилировать и распространять при изменении сведений о соединении. Если имя источника данных, жестко задано в приложения, а не полного подключения, каждый пользователь должен изменить только данные в источнике данных.  
  
-   **Доступ к определенной СУБД один раз.** Например, может содержать электронную таблицу, получающего данные путем вызова функции ODBC **ДРАЙВЕР** ключевое слово для идентификации конкретного драйвера. Так как имя драйвера, имеет смысл, чтобы все пользователи, имеющие этот драйвер, электронной таблицы могут быть переданы между этими пользователями. Если электронной таблицы содержит имя источника данных, каждый пользователь пришлось создавать один и тот же источник данных, чтобы использовать таблицы.  
  
-   **Обзор системы для всех баз данных, доступной для конкретного драйвера.** Дополнительные сведения см. в разделе [подключение с помощью SQLBrowseConnect](../../../odbc/reference/develop-app/connecting-with-sqlbrowseconnect.md)далее в этом разделе.
