---
title: Выбор источника данных или драйвера Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- connecting to driver [ODBC], selecting driver
- connecting to data source [ODBC], selecting data source
- data sources [ODBC], selecting
- ODBC drivers [ODBC], selecting
ms.assetid: 10aaf570-01ab-4478-8339-bdde2a5e3dd1
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: b10aafad95463f56ec0f5a029eac59a02cff003b
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81303375"
---
# <a name="choosing-a-data-source-or-driver"></a>Выбор источника данных или драйвера
Источник данных или драйвер, используемый приложением, иногда жестко закодирован в приложении. Например, пользовательское приложение, написанное отделом MIS для передачи данных из одного источника данных в другой, будет содержать имена этих источников данных - приложение просто не будет работать с какими-либо другими источниками данных. Другим примером является вертикальное приложение, например, используемое для ввода заказа. Такое приложение всегда использует тот же источник данных, который имеет предопределенную схему, известную приложением.  
  
 Другие приложения выбирают источник данных или драйвер во время выполнения. Как правило, это универсальные приложения, которые делают специальные запросы, такие как электронная таблица, которая использует ODBC для импорта данных. Такие приложения обычно перечисляют доступные источники данных или драйверы и позволяют пользователям выбирать те, с чем они хотят работать. Независимо от того, перечисляет ли в универсальном приложении источники данных, драйверы или оба часто зависит от того, использует ли приложение драйверы на основе DBMS или файла.  
  
 Драйверам на основе DBMS обычно требуется сложный набор информации о подключении, такой как сетевой адрес, сетевой протокол, имя базы данных и так далее. Цель юномы данных заключается в сокрытии всей этой информации. Таким образом, парадигма источника данных поддается использованию с dBMS-драйверами. Приложение может отображать список источников данных пользователю одним из двух способов. Он может вызывать **S'LDriverConnect** с ключевым словом **DSN** (имя источника данных) и не связанных с ним значений; менеджер драйвера будет отображать список имен источников данных. Если приложение хочет контролировать внешний вид списка, оно вызывает **S'LDataSources** для получения списка доступных источников данных и строит свой собственный диалоговый ящик. Эта функция реализована менеджером драйверов и может быть вызвана до загрузки драйверов. Затем приложение вызывает функцию соединения и передает ей имя выбранного источника данных.  
  
 Если источник данных не указан, используется источник данных по умолчанию, указанный системной информацией. (Для получения дополнительной [информации см. Подключили по умолчанию](../../../odbc/reference/install/default-subkey.md).) Если **S'LConnect** вызывается с помощью аргумента *ServerName,* который не может быть найден, является нулевой указателем, или "DEFAULT", менеджер драйвера подключается к источнику данных по умолчанию. Источник данных по умолчанию также используется, если строка соединения, используемая при вызове на **S'LDriverConnect** или **S'LBrowseConnect,** содержит ключевое слово **DSN,** установленное на "DEFAULT" или если указанный источник данных не найден. Кроме того, используется источник данных по умолчанию, если строка соединения, используемая при вызове в **S'LDriverConnect,** не содержит ключевого слова **DSN.**  
  
 С драйверами на основе файлов можно использовать парадигму файлов. Для данных, хранящихся на локальном компьютере, пользователи часто знают, что их данные в определенном файле, например Employee.dbf. Вместо выбора неизвестного источника данных, таким пользователям проще выбрать знакомый файл. Для реализации этого приложения сначала вызывает **S'LDrivers.** Эта функция реализована менеджером драйверов и может быть вызвана до загрузки драйверов. **S'LDrivers** возвращает список доступных драйверов; он также возвращает значения для ключевых слов **FileUsage** и **FileExtns.** Ключевое слово **FileUse** объясняет, рассматривают ли драйверы файлов как таблицы, как Xbase, или как базы данных, как microsoft® Access. Ключевое слово **FileExtns** перечисляет расширения имени файла, которые распознает драйвер, например .dbf для драйвера Xbase. Используя эту информацию, приложение строит диалоговый ящик, через который пользователь выбирает файл. На основе расширения выбранного файла приложение подключается к драйверу, позвонив по **ключевому** слову **DRIVER.**  
  
 Нет ничего, что остановило бы приложение от использования источника данных с драйвером на основе файлов или вызова **S'LDriverConnect** с ключевым словом **DRIVER** для подключения к драйверу на основе DBMS. Вот несколько распространенных применений ключевого слова **DRIVER** для драйверов на основе DBMS:  
  
-   **Не создавать источники данных.** Например, пользовательское приложение может использовать определенный драйвер и базу данных. Если имя драйвера и вся информация, необходимая для подключения к базе данных, жестко закодированы в приложении, пользователям не нужно создавать источник данных на своем компьютере для запуска приложения. Все, что они должны сделать, это установить приложение и драйвер.  
  
     Недостатком этого метода является то, что приложение должно быть перекомпилировано и перераспространено при изменении информации о подключении. Если имя источника данных жестко закодировано в приложении вместо полной информации о подключении, каждый пользователь должен изменять только информацию в источнике данных.  
  
-   **Доступ к определенному DBMS один раз.** Например, электронная таблица, которая получает данные, вызывая функции ODBC, может содержать ключевое слово **DRIVER** для идентификации конкретного драйвера. Поскольку имя драйвера имеет смысл для всех пользователей, которые имеют этот драйвер, электронная таблица может быть передана среди этих пользователей. Если в таблице содержится имя источника данных, каждый пользователь должен будет создать один и тот же источник данных для использования электронной таблицы.  
  
-   **Просмотр системы для всех баз данных, доступных для конкретного драйвера.** Для получения более подробной [информации, см.](../../../odbc/reference/develop-app/connecting-with-sqlbrowseconnect.md)
