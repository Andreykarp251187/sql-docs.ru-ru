---
title: Выбор источника данных или драйвера | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- connecting to driver [ODBC], selecting driver
- connecting to data source [ODBC], selecting data source
- data sources [ODBC], selecting
- ODBC drivers [ODBC], selecting
ms.assetid: 10aaf570-01ab-4478-8339-bdde2a5e3dd1
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 9aac31af80ff5774d464f76f130d2d113002e60a
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68001400"
---
# <a name="choosing-a-data-source-or-driver"></a>Выбор источника данных или драйвера
Источник данных или драйвер, используемый приложением, иногда жестко запрограммирован в приложении. Например, пользовательское приложение, написанное подразделением MIS для перемещения данных из одного источника данных в другой, будет содержать имена этих источников данных — приложение просто не будет работать с какими-либо другими источниками данных. Еще один пример — вертикальное приложение, например, которое используется для ввода заказа. Такое приложение всегда использует тот же источник данных, который имеет стандартную схему, известную приложением.  
  
 Другие приложения выбирают источник данных или драйвер во время выполнения. Обычно это универсальные приложения, которые выполняют нерегламентированные запросы, такие как электронная таблица, использующая ODBC для импорта данных. Такие приложения обычно предоставляют список доступных источников данных или драйверов и позволяют пользователям выбирать те из них, с которыми они хотят работать. Как универсальное приложение перечисляет источники данных, драйверы или и то, и другое, зависит от того, использует ли приложение драйверы на основе СУБД или файловых драйверов.  
  
 Для драйверов на основе СУБД обычно требуется сложный набор сведений о соединении, например сетевой адрес, Сетевой протокол, имя базы данных и т. д. Назначение источника данных заключается в скрытии всей этой информации. Таким образом, парадигма источника данных предназначена для использования с драйверами на основе СУБД. Приложение может отображать список источников данных для пользователя одним из двух способов. Он может вызвать **SQLDriverConnect** с ключевым словом **DSN** (имя источника данных) и без связанного значения. Диспетчер драйверов отобразит список имен источников данных. Если приложение хочет контролировать внешний вид списка, оно вызывает **SQLDataSources** для получения списка доступных источников данных и конструирует собственное диалоговое окно. Эта функция реализуется диспетчером драйверов и может быть вызвана перед загрузкой любых драйверов. Затем приложение вызывает функцию подключения и передает ей имя выбранного источника данных.  
  
 Если источник данных не указан, используется источник данных по умолчанию, заданный сведениями о системе. (Дополнительные сведения см. в разделе [подраздел по умолчанию](../../../odbc/reference/install/default-subkey.md).) Если **SQLConnect** вызывается с помощью аргумента *ServerName* , который не удается найти, является пустым указателем или имеет значение по умолчанию, диспетчер драйверов подключается к источнику данных по умолчанию. Источник данных по умолчанию также используется, если строка подключения, используемая в вызове **SQLDriverConnect** или **SQLBrowseConnect** , содержит ключевое слово **DSN** , установленное в значение Default, или если указанный источник данных не найден. Кроме того, используется источник данных по умолчанию, если строка соединения, используемая в вызове **SQLDriverConnect** , не содержит ключевого слова **DSN** .  
  
 С помощью драйверов на основе файлов можно использовать парадигму файлов. Для данных, хранящихся на локальном компьютере, пользователи часто узнают, что их данные находятся в определенном файле, например Employee. dbf. Вместо выбора неизвестного источника данных пользователям будет проще выбрать файл, который им известен. Для реализации этого приложения сначала вызывается **SQLDrivers**. Эта функция реализуется диспетчером драйверов и может быть вызвана перед загрузкой любых драйверов. **SQLDrivers** возвращает список доступных драйверов; Он также возвращает значения для ключевых слов **филеусаже** и **филикстнс** . Ключевое слово **филеусаже** описывает, следует ли файловым драйверам обрабатывать файлы как таблицы, как это делает xbase или как базы данных, как это делает Microsoft® Access. Ключевое слово **филикстнс** перечисляет расширения имен файлов, распознаваемые драйвером, например. dbf для драйвера xbase. Используя эти сведения, приложение формирует диалоговое окно, в котором пользователь выбирает файл. В зависимости от расширения выбранного файла приложение подключается к драйверу, вызывая **SQLDriverConnect** с ключевым словом **Driver** .  
  
 Нет никакой необходимости приостанавливаться приложению использовать источник данных с драйвером на основе файлов или вызывать **SQLDriverConnect** с ключевым словом **Driver** для подключения к драйверу на основе СУБД. Ниже приведены несколько распространенных применений ключевого слова **Driver** для драйверов на основе СУБД.  
  
-   **Не создаются источники данных.** Например, пользовательское приложение может использовать определенный драйвер и базу данных. Если имя драйвера и все сведения, необходимые для подключения к базе данных, жестко запрограммированы в приложении, пользователям не нужно создавать на своем компьютере источник данных для запуска приложения. Все, что необходимо сделать, — это установить приложение и драйвер.  
  
     Недостаток этого метода заключается в том, что приложение должно быть перекомпилировано и распространяться при изменении сведений о соединении. Если имя источника данных жестко запрограммировано в приложении вместо сведений о соединении, каждый пользователь должен изменить только данные в источнике данных.  
  
-   **Доступ к определенной СУБД за один раз.** Например, электронная таблица, извлекающая данные путем вызова функций ODBC, может содержать ключевое слово **Driver** для распознавания конкретного драйвера. Поскольку имя драйвера имеет смысл для всех пользователей, имеющих этот драйвер, электронная таблица может передаваться между пользователями. Если электронная таблица содержит имя источника данных, каждый пользователь должен будет создать тот же источник данных для использования электронной таблицы.  
  
-   **Просмотр системы для всех баз данных, доступных для конкретного драйвера.** Дополнительные сведения см. Далее в подразделе [подключение с помощью SQLBrowseConnect](../../../odbc/reference/develop-app/connecting-with-sqlbrowseconnect.md).
