---
title: Подключение с помощью SQLBrowseConnect | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- connecting to driver [ODBC], SQLBrowseConnect
- SQLBrowseConnect function [ODBC], connecting
- connecting to data source [ODBC], SQLBrowseConnect
ms.assetid: 6c2e9f76-b766-48df-b109-246bb05ae45d
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 04df089b97bf385925c87a98b3f89cdac3ef21e4
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68083135"
---
# <a name="connecting-with-sqlbrowseconnect"></a>Подключение с помощью SQLBrowseConnect
**SQLBrowseConnect**, например **SQLDriverConnect**, использует строку подключения. Однако при использовании **SQLBrowseConnect**приложение может создать полную строку подключения во время выполнения. Это позволяет приложению:  
  
-   Создайте собственные диалоговые окна для запроса этих сведений, сохраняя при этом контроль над его внешним видом.  
  
-   просматривать систему в поисках источников данных, которые может использовать конкретный драйвер, возможно, за несколько шагов. Например, пользователь может сначала просмотреть серверы в сети, а после выбора сервера с помощью драйвера просмотреть доступные базы данных этого сервера.  
  
 Приложение вызывает **SQLBrowseConnect** и передает строку подключения, известную как *строка подключения для запроса просмотра* , указывающую драйвер или источник данных. Драйвер возвращает строку подключения, известную как *строка подключения к результату обзора,* которая содержит ключевые слова, возможные значения (если ключевое слово принимает дискретный набор значений) и понятные имена пользователей. Приложение создает диалоговое окно с понятными именами пользователей и запрашивает у пользователя значения. Затем он создает новую строку подключения к запросу обзора на основе этих значений и возвращает его в драйвер с другим вызовом **SQLBrowseConnect**.  
  
 Так как строки соединения передаются обратно, драйвер может предоставить несколько уровней обзора, возвращая новую строку подключения, когда приложение возвращает старое. Например, при первом вызове приложением **SQLBrowseConnect**драйвер может вернуть ключевые слова, чтобы запросить у пользователя имя сервера. Когда приложение возвращает имя сервера, драйвер может вернуть ключевые слова, чтобы запросить у пользователя базу данных. Процесс обзора будет завершен после того, как приложение возвращало имя базы данных.  
  
 Каждый раз, когда **SQLBrowseConnect** возвращает новую строку подключения к результату обзора, она возвращает SQL_NEED_DATA в качестве кода возврата. Это указывает приложению, что процесс подключения не завершен. Пока **SQLBrowseConnect** не возвратит SQL_SUCCESS, соединение будет иметь состояние данных и не может использоваться в других целях, например для установки атрибута соединения. Приложение может завершить процесс обзора соединения, вызвав **SQLDisconnect**.  
  
 Этот раздел содержит следующий раздел.  
  
-   [Пример просмотра SQL Server](../../../odbc/reference/develop-app/sql-server-browsing-example.md)
