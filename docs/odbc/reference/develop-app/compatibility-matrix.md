---
title: Матрица совместимости Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver compatibility issues [ODBC]
- ODBC drivers [ODBC], backward compatibility
- backward compatibility [ODBC], application and driver compatibility
- compatibility [ODBC], application and driver compatibility
- application compatibility issues [ODBC]
- application upgrades [ODBC], compatibility matrix
- upgrading applications [ODBC], compatibility matrix
ms.assetid: 0690b463-15a1-48fa-9d0b-9cc9e5bf7fc6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 0406599e1657a900d1669861572ff13834cec670
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81307457"
---
# <a name="compatibility-matrix"></a>Матрица совместимости
В следующей таблице описывается совместимость типов приложений и драйверов, определенных ранее в данном разделе.  
  
|Тип приложения<br /><br /> и версия|32-битный ODBC<br /><br /> *2.x* драйвер|ODBC *3.x*<br /><br /> Драйвер|Водитель ODBC 3.8|Драйвер ISO и Open Group|  
|--------------------------------------|-----------------------------------|---------------------------|---------------------|-----------------------------------------|  
|16-разрядное приложение, любая версия|Совместимые|Совместимые|Совместимые|Совместимые|  
|Чистое приложение *2.x*|Совместимые|Совместимые|Совместимые|Не совместимо|  
|Чистое *2.x* перекомпилированное приложение|Совместимые|Совместимо|Совместимо|Не совместимо|  
|Приложение Pure *2.x* Unicode|Совместимые|Совместимо|Совместимо|Не совместимо|  
|Приложение Pure Open Group и приложение, соответствующее Требованиям ISO|Не совместимо|Совместимо|Совместимо|Совместимо|  
|Чистое приложение 3.0|Не совместимо|Совместимые|Совместимые|Не совместимо|  
|Чистое приложение 3.5|Не совместимо|Совместимые|Совместимые|Не совместимо|  
|Чистое приложение 3.8 (или выше)|Не совместимо с|Не совместимо с|Совместимые|Не совместимо с|  
|Замененное приложение|Совместимые|Совместимые|Совместимые|Не совместимо|  
  
 Приложение должно пересоставить с помощью заголовков ODBC 3.5 (или выше) с опцией UNICODE (если это приложение Unicode) и установить ODBCVER на 0x0250.  
  
 Приложение должно компилироваться с помощью заголовков ODBC 3.5 (или выше) и связываться с менеджером драйверов ODBC. Он также должен установить флаг заголовка ODBC_STD.  
  
 Эта конфигурация потенциально может не работать, потому что в ODBC *2.x* есть функции, которые не входят в стандарты, такие как закладки.  
  
 Эта конфигурация потенциально может не работать, потому что в ODBC *3.x* есть функции, которые не входят в стандарты, такие как закладки.  
  
 Эта конфигурация потенциально может выполнить неудачу, поскольку в ODBC 3.8 есть функции, которые не входят в драйверы ODBC 2.x или 3.x, такие как [типы c данных в ODBC.](../../../odbc/reference/develop-app/c-data-types-in-odbc.md)  
  
## <a name="driver-manager-compatibility"></a>Совместимость менеджера драйвера  
 Приложение ODBC 3.0, которое должно работать со всеми версиями Driver Manager, должно выполнять следующие варианты при запуске:  
  
-   Выделите ручку среды.  
  
-   Установите атрибут среды SQL_ATTR_ODBC_VERSION на SQL_OV_ODBC3_80. Если менеджер драйвера возвращается SQL_ERROR, менеджер драйвера старше 3,8. Сбросить SQL_ATTR_ODBC_VERSION SQL_OV_ODBC3 или SQL_OV_ODBC2, в случае необходимости, в соответствии с менеджером драйвера.  
  
-   Выделите ручку соединения.  
  
-   Сделайте соединение.  
  
-   Для определения версии драйвера можно SQL_DRIVER_ODBC_VER позвонить в s'LGetInfo. Если драйвером является водитель ODBC 3.8, можно использовать конкретные типы C, характерные для драйвера. В противном случае не используйте типы данных C, специфичные для драйверов.  
  
 Обратите внимание, что перекомпилированное приложение ODBC 3.x может использовать функции ODBC 3.8, отличные от типов C, характерных для драйверов, не указывая SQL_OV_ODBC3_80 для SQL_ATTR_ODBC_VERSION. Это похоже на перекомпилированное приложение ODBC 2.x с использованием функций ODBC 3.x.  
  
## <a name="using-sqlcancelhandle-in-an-application-compatible-with-all-driver-managers"></a>Использование S'LКанскантернавла в приложении, совместимом со всеми менеджерами драйверов  
 Из-за того, что [функция S'LCancelHandle](../../../odbc/reference/syntax/sqlcancelhandle-function.md) не поддерживается в менеджерах драйверов, которые были выпущены до Windows 7, приложение не может быть загружено в старых версиях Windows, если оно вызывает **S'LCancelHandle** напрямую. Для работы со всеми версиями менеджеров драйверов и использования **S'LCancelHandle** на новых версиях Windows, приложение должно позвонить **в S'LCancelHandle** косвенно, используя **LoadLibrary** и **GetProcAddress.**  
  
## <a name="see-also"></a>См. также:  
 [Новые возможности ODBC 3.8](../../../odbc/reference/what-s-new-in-odbc-3-8.md)
