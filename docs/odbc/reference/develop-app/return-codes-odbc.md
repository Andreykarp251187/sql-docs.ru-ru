---
title: Коды возврата ODBC Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- return codes [ODBC]
- diagnostic information [ODBC], return codes
ms.assetid: e893b719-4392-476f-911a-5ed6da6f7e94
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 15e434025ed1201ca61371c2fb88e70143e131a5
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81304315"
---
# <a name="return-codes-odbc"></a>Коды возврата ODBC
Каждая функция в ODBC возвращает код, известный как его *обратный код,* который указывает на общий успех или сбой функции. Программная логика обычно основана на кодах возврата.  
  
 Например, следующий код вызывает **S'LFetch** для извлечения строк в наборе результатов. Он проверяет код возврата функции, чтобы определить, был ли достигнут конец набора результатов (SQL_NO_DATA), была ли возвращена какая-либо предупреждающая информация (SQL_SUCCESS_WITH_INFO) или если произошла ошибка (SQL_ERROR).  
  
```  
SQLRETURN   rc;  
SQLHSTMT    hstmt;  
  
while ((rc=SQLFetch(hstmt)) != SQL_NO_DATA) {  
   if (rc == SQL_SUCCESS_WITH_INFO) {  
      // Call function to display warning information.  
   } else if (rc == SQL_ERROR) {  
      // Call function to display error information.  
      break;  
   }  
   // Process row.  
}  
```  
  
 Код возврата SQL_INVALID_HANDLE всегда указывает на программную ошибку, поэтому не должен встречаться во время выполнения. Все другие коды возврата предоставляют сведения времени выполнения, хотя SQL_ERROR может означать программную ошибку.  
  
 В следующей таблице определяются коды возврата.  
  
|Код возврата|Описание|  
|-----------------|-----------------|  
|SQL_SUCCESS|Функция успешно завершена. Приложение вызывает **S'LGetDiagField** для получения дополнительной информации из записи заголовка.|  
|SQL_SUCCESS_WITH_INFO|Функция выполнена успешно, возможно, с несмертельной ошибкой (предупреждение). Для получения дополнительной информации приложение вызывает **s'LGetDiagRec** или **S'LGetDiagField.**|  
|SQL_ERROR|Функция не сработала. Для получения дополнительной информации приложение вызывает **s'LGetDiagRec** или **S'LGetDiagField.** Содержание любых аргументов вывода к функции не определено.|  
|SQL_INVALID_HANDLE|Функция не сработала из-за недействительной среды, соединения, оператора или дескриптора. Это указывает на ошибку программирования. Дополнительная информация отсутствует в **s'LGetDiagRec** или **S'LGetDiagField.** Этот код возвращается только тогда, когда ручка является нулевой указателем или является неправильным типом, например, когда ручка оператора передается для аргумента, требующего ручки соединения.|  
|SQL_NO_DATA|Больше никаких данных не было. Для получения дополнительной информации приложение вызывает **s'LGetDiagRec** или **S'LGetDiagField.** Один или несколько записей о статусе, определяемых драйверами, в классе 02xxx могут быть возвращены. **Примечание:**  В ODBC 2. *x*, этот код возврата был назван SQL_NO_DATA_FOUND.|  
|SQL_NEED_DATA|Необходимы дополнительные данные, например, когда данные параметра отправляются во время выполнения или требуется дополнительная информация о подключении. Приложение вызывает **s'LGetDiagRec** или **S'LGetDiagField** для получения дополнительной информации, если таковые имеется.|  
|SQL_STILL_EXECUTING|Функция, которая была начата асинхронно, все еще исполняется. Приложение вызывает **s'LGetDiagRec** или **S'LGetDiagField** для получения дополнительной информации, если таковые имеется.|
