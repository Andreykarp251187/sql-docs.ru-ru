---
title: Диагностические сообщения Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- diagnostic information [ODBC], diagnostic messages messages
- error messages [ODBC], diagnostic messages
- diagnostic messages [ODBC]
ms.assetid: 98027871-9901-476e-a722-ee58b7723c1f
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: be63e9d78960e40ac5e9ee016d2cfd868d99a922
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81305835"
---
# <a name="diagnostic-messages"></a>Диагностические сообщения
С каждым S'Lstate возвращается диагностическое сообщение. Тот же S'LSTATE часто возвращается с несколькими различными сообщениями. Например, за большинство ошибок в синтаксисе S'LSTATE 42000 (ошибка Syntax или нарушение доступа) возвращается s'LSTATE. Однако каждая ошибка синтаксиса, скорее всего, будет описана другим сообщением.  
  
 Примеры диагностических сообщений перечислены в столбце Ошибки в таблице S'LSTATEs в приложении A и в каждой функции. Хотя драйверы могут возвращать эти сообщения, они с большей вероятностью вернут любое сообщение, передаваемые им источником данных.  
  
 Приложения обычно отображают диагностические сообщения пользователю, а также код ошибки S'Lstate. Это помогает пользователю и персоналу службы поддержки определить причину любых проблем. Информация о компонентах, встроенная в сообщение, особенно полезна при этом.  
  
 Диагностические сообщения поступают из источников данных и компонентов в соединении ODBC, таких как драйверы, шлюзы и менеджер драйверов. Как правило, источники данных не поддерживают напрямую ODBC. Следовательно, если компонент в подключении ODBC получает сообщение из источника данных, он должен определить источник данных как источник сообщения. Он также должен идентифицировать себя как компонент, который получил сообщение.  
  
 Если источником ошибки или предупреждения является сам компонент, диагностическое сообщение должно объяснить это. Таким образом, текст сообщений имеет два разных формата. Для ошибок и предупреждений, которые не происходят в источнике данных, диагностическое сообщение должно использовать этот формат:  
  
 **-** *поставщик-идентификатор* **-** *ODBC-компонент-идентификатор* **-** *компонент-поставленный-текст*  
  
 Для ошибок и предупреждений, возникающих в источнике данных, диагностическое сообщение должно использовать этот формат:  
  
 **-** *поставщик-идентификатор* **-** *ODBC-компонент-идентификатор* **-** *данный-источник-идентификатор* **-** *данные-источник-поставляемый-текст*  
  
 В следующей таблице показано значение каждого элемента.  
  
|Элемент|Значение|  
|-------------|-------------|  
|*поставщик-идентификатор*|Идентифицирует поставщика компонента, в котором произошла ошибка или предупреждение или полученный ошибка или предупреждение непосредственно из источника данных.|  
|*ODBC-компонент-идентификатор*|Определяет компонент, в котором произошла ошибка или предупреждение или полученный погрешность или предупреждение непосредственно из источника данных.|  
|*данные-источник-идентификатор*|Идентифицирует источник данных. Для драйверов на основе файлов, как правило, это формат файла, например, Xbase для драйверов на основе DBMS, это продукт DBMS.|  
|*компонент-поставленный-текст*|Генерируется компонентом ODBC.|  
|*данные-источники,поставляемые-текст*|Генерируется источником данных.|  
  
 В этом случае водитель выступает как водитель, так и в качестве источника данных.  
  
 Кронштейны**должны**быть включены в сообщение и не указывать дополнительные элементы.
