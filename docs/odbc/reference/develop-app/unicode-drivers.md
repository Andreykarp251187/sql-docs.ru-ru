---
title: Драйверы Юникода | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- Unicode [ODBC], drivers
- Unicode [ODBC], functions
- functions [ODBC], Unicode functions
ms.assetid: 3b4742d5-74fb-4aff-aa21-d83a0064d73d
author: MightyPen
ms.author: genemi
ms.openlocfilehash: ca9b70ee6a96759e496b831f7c12dc3ee78419b7
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68087874"
---
# <a name="unicode-drivers"></a>Драйверы Юникода
Должен ли драйвер использовать драйвер Юникода или драйвер ANSI полностью зависит от природы источника данных. Если источник данных поддерживает данные в Юникоде, драйвер должен быть драйвером Юникода. Если источник данных поддерживает только данные ANSI, драйвер должен оставаться драйвером ANSI.  
  
 Драйвер Юникода должен экспортировать **склконнектв** , чтобы он был распознан диспетчером драйверов как драйвер Unicode.  
  
 Драйвер Юникода должен принимать функции Юникода (с суффиксом *W*) и хранить данные в Юникоде. Он также может принимать функции ANSI, но не является обязательным для. (Диспетчер драйверов не передает вызов функции ANSI с суффиксом *A* к драйверу, но преобразует его в вызов функции ANSI без суффикса, а затем передает его драйверу.)  
  
 Драйвер Юникода должен иметь возможность возвращать результирующие наборы в Юникоде или ANSI в зависимости от привязки приложения. Если приложение привязывается к SQL_C_CHAR, драйвер Unicode должен преобразовать SQL_WCHAR данные в SQL_CHAR. Диспетчер драйверов будет сопоставлять SQL_C_WCHAR SQL_C_CHAR для драйверов ANSI, но не сопоставляет драйверы Юникода.  
  
> [!NOTE]  
>  При определении типа драйвера диспетчер драйверов вызывает **SQLSetConnectAttr** и задает атрибут SQL_ATTR_ANSI_APP во время подключения. Если приложение использует API-интерфейсы ANSI, SQL_ATTR_ANSI_APP будет иметь значение SQL_AA_TRUE и, если оно использует Юникод, оно будет установлено в SQL_AA_FALSE. Этот атрибут используется, чтобы драйвер мог выполнять различные действия на основе типа приложения. Атрибут не может быть задан напрямую приложением и не поддерживается **SQLGetConnectAttr**. Если драйвер одинаково работает как в приложениях ANSI, так и в Юникоде, он должен возвращать SQL_ERROR для этого атрибута. Если драйвер возвращает SQL_SUCCESS, диспетчер драйверов будет разделять подключения ANSI и Юникод при использовании пула соединений.
