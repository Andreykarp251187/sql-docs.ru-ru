---
title: Что делает менеджер драйверов (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver manager [ODBC], backward compatibility
- compatibility [ODBC], driver manager
- ODBC driver manager [ODBC]
- backward compatibility [ODBC], driver manager
ms.assetid: 57f65c38-d9ee-46c8-9051-128224a582c6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 07ab0784e6f6ad4487a02a179a5fa3be2617c930
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81306565"
---
# <a name="what-the-driver-manager-does"></a>Функции диспетчера драйверов
В следующей таблице кратко излагается, как карты менеджера драйверов ODBC *3.x* звонят в драйверы ODBC *2.x* и ODBC *3.x.*  
  
|Функция или<br /><br /> атрибут инструкции|Комментарии|  
|-----------------------------------------|--------------|  
|SQL_ATTR_FETCH_BOOKMARK_PTR|Очки на закладку для использования с **S'LFetchScroll**. Ниже приведены детали реализации:<br /><br /> - Когда приложение устанавливает это в драйвере ODBC *2.x,* диспетчер ДРАЙВЕРod-драйвер ODBC *3.x* кэши. Он dereferences указатель и передает значение для драйвера ODBC *2.x* в *FetchOffset* аргумент **S'LExtendedFetch,** когда **S'LFetchScroll** позже называется приложением.<br />- Когда приложение устанавливает это в драйвере ODBC *3.x,* менеджер драйвера ODBC *3.x* передает вызов водителю.|  
|SQL_ATTR_ROW_STATUS_PTR|Очки на массиве статуса строки, заполненные **S'LFetch,** **S'LFetchScroll,** **S'LBulkOperations,** и **S'LSetPos.** Ниже приведены детали реализации:<br /><br /> - Когда приложение устанавливает это в драйвере ODBC *2.x,* менеджер драйвера драйвера ODBC *3.x* кэширует его значение. Он передает это значение драйверу ODBC *2.x* в аргументе *RowStatusArray* из **S'LExtendedFetch,** когда называется **S'LFetchScroll** или **S'LFetch.**<br />- Когда приложение устанавливает это в драйвере ODBC *3.x,* менеджер драйвера ODBC *3.x* передает вызов водителю.<br />- В состоянии S6, если приложение устанавливает SQL_ATTR_ROW_STATUS_PTR, а затем вызывает **S'LBulkOperations** (с *операцией* SQL_ADD) или **S'LSetPos** без предварительного вызова **S'LFetch** или **S'LFetchScroll**, S'LSTATE HY011 (атрибут не может быть установлен сейчас) возвращается.|  
|SQL_ATTR_ROWS_FETCHED_PTR|Указывает на буфер, в котором **S'LFetch** и **S'LFetchScroll** возвращают количество строк, извлеченных. Ниже приведены детали реализации:<br /><br /> - Когда приложение устанавливает это в драйвере ODBC *2.x,* менеджер драйвера драйвера ODBC *3.x* кэширует его значение. Он передает это значение драйверу ODBC *2.x* в аргументе *RowCountPtr* **s'LExtendedFetch,** когда приложение вызывает **s'LFetch** или **S'LFetchScroll.**<br />- Когда приложение устанавливает это в драйвере ODBC *3.x,* менеджер драйвера ODBC *3.x* передает вызов водителю.|  
|SQL_ATTR_ROW_ARRAY_SIZE|Устанавливает размер рядового набора. Ниже приведены детали реализации:<br /><br /> - Когда приложение устанавливает это в драйвере ODBC *2.x,* менеджер драйвера ODBC *3.x* отображает его на атрибут SQL_ROWSET_SIZE оператора.<br />- Когда приложение устанавливает это в драйвере ODBC *3.x,* менеджер драйвера ODBC *3.x* передает вызов водителю.<br />- Когда приложение, работая с драйвером ODBC *3.x,* вызывает **S'LSetScrollOptions,** SQL_ROWSET_SIZE устанавливается на значение в аргументе *RowsetSize,* если базовый драйвер не поддерживает **S'LSetScrollOptions.**|  
|SQL_ROWSET_SIZE|Устанавливает размер строки, используемый **S'LExtendedFetch,** когда **S'LExtendedFetch** вызывается приложением ODBC *2.x.* Ниже приведены детали реализации:<br /><br /> - Когда приложение устанавливает это, менеджер драйвера ODBC *3.x* передает вызов водителю, независимо от версии драйвера.<br />- Когда приложение, работая с драйвером ODBC *2.x,* вызывает **S'LSetScrollOptions,** SQL_ROWSET_SIZE устанавливается значение в аргументе **RowsetSize.**|  
|**СЗЛБалКОперации**|Выполняет операцию вставки, обновляет, удаляет или получает с помощью операций закладок. Ниже приведены детали реализации:<br /><br /> - Когда приложение вызывает **S'LBulkOperations** с *операцией* SQL_ADD в драйвере ODBC *2.x,* менеджер драйвера ODBC *3.x* отображает его на **S'LSetPos** с *помощью SQL_ADD.*<br />- При работе с драйвером ODBC *2.x,* который не поддерживает **S'LSetPos** с *помощью операции* SQL_ADD, менеджер драйверов ODBC *3.x* не отображает **S'LSetPos** с *операцией* SQL_ADD **с** *операцией* SQL_ADD. Это объясняется тем, что **S'LBulkOperations** нельзя назвать в состоянии S7, которое в ODBC *2.x* было единственным состоянием, в котором можно было бы назвать **S'LSetPos.**<br />- Если приложение вызывает **S'LBulkOperations** с *операцией* SQL_ADD в драйвере ODBC *2.x,* прежде чем позвонить в **S'LFetchScroll,** менеджер драйвера ODBC *3.x* возвращает ошибку.|  
|**Sqlextendedfetch**|Возвращает указанный ряд. За исключением только что отмеченного ограничения, менеджер драйвера ODBC *3.x* передает водителю вызовы на **S'LExtendedFetch** водителю, независимо от версии драйвера.|  
|**SQLFetch**|Возвращает следующий ряд. Ниже приведены детали реализации:<br /><br /> - Когда приложение вызывает **S'LFetch** в драйвере ODBC *2.x,* менеджер драйвера ODBC *3.x* отображает его на **S'LExtendedFetch.** Аргумент *FetchOrientation* **из S'LExtendedFetch** установлен на SQL_FETCH_NEXT. Менеджер драйвера использует кэшированное значение атрибута SQL_ATTR_ROW_STATUS_PTR оператора для аргумента *RowStatusArray* и кэшированное значение атрибута SQL_ATTR_ROWS_FETCHED_PTR оператора для аргумента *RowCountPtr.*<br />- Приложение ODBC *3.x* может смешивать звонки на **S'LFetch** и **S'LFetchScroll** в драйвере ODBC *2.x,* потому что менеджер драйвера ODBC *3.x* maps **s'LFetch** на **S'LExtendedFetch,** когда приложение вызывает его в драйвере ODBC *2.x.*<br />- Если драйвер ODBC *2.x* не поддерживает **S'LExtendedFetch,** менеджер драйвера ODBC *3.x* не отображает **S'LFetch** или **S'LFetchScroll** в **S'LExtendedFetch,** когда приложение вызывает его в этом драйвере. Если приложение пытается установить SQL_ATTR_ROW_ARRAY_SIZE на значение, превышающее 1, возвращается функция S'LSTATE HYC00 (необязательная функция не реализована).<br />- За исключением только что отмеченных ограничений, менеджер драйвера ODBC *3.x* передает водителю звонки на **S'LFetch,** независимо от версии драйвера.|  
|**SQLFetchScroll**|Возвращает указанный ряд. Ниже приведены детали реализации:<br /><br /> - Когда приложение вызывает **S'LFetchScroll** в драйвере ODBC *2.x,* менеджер драйвера ODBC *3.x* отображает его на **S'LExtendedFetch.** Он использует кэшированное значение атрибута SQL_ATTR_ROW_STATUS_PTR оператора для аргумента *RowStatusArray* и кэшированное значение атрибута SQL_ATTR_ROWS_FETCHED_PTR оператора для аргумента *RowCountPtr.* Если аргумент *FetchOrientation* в **S'LFetchScroll** SQL_FETCH_BOOKMARK, он использует кэшированное значение атрибута SQL_ATTR_FETCH_BOOKMARK_PTR оператора для аргумента *FetchOffset* и возвращает ошибку, если аргумент *FetchOffset* **s'LFetchScroll** не 0.<br />- Когда приложение вызывает это в драйвере ODBC *3.x,* менеджер драйвера ODBC *3.x* передает вызов водителю.|  
|**функция SQLSetPos;**|Выполняет различные позиционированные операции. Менеджер драйвера ODBC *3.x* передает водителю звонки в **S'LSetPos,** независимо от версии драйвера.|  
|**СЗЛСЕтПрокрутисОпции**|Когда менеджер драйверов нанесет карты **для** приложения, работающего с драйвером ODBC *3.x,* не поддерживающим **S'LSetScrollOptions,** менеджер-водитель устанавливает опцию SQL_ROWSET_SIZE оператора, а не SQL_ATTR_ROW_ARRAY_SIZE атрибута, *аргументу RowsetSize* в **S'LSetScrollOption.** В результате этого приложение не может использовать сяритогевую опционы **slSetScrollOptions** при получении нескольких строк по вызову в **S'LFetch** или **S'LFetchScroll.** Он может быть использован только при получении нескольких строк по вызову в **S'LExtendedFetch.**|
