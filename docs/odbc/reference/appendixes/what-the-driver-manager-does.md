---
title: Функции диспетчера драйверов | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver manager [ODBC], backward compatibility
- compatibility [ODBC], driver manager
- ODBC driver manager [ODBC]
- backward compatibility [ODBC], driver manager
ms.assetid: 57f65c38-d9ee-46c8-9051-128224a582c6
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 4fa53595d304dc8200805a98491a824cf52a1bbb
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62735080"
---
# <a name="what-the-driver-manager-does"></a>Функции диспетчера драйверов
В следующей таблице перечислены как ODBC 3 *.x* диспетчера драйверов сопоставляет вызовы ODBC 2. *x* а ODBC 3 *.x* драйверы.  
  
|Функция или<br /><br /> атрибут инструкции|Комментарии|  
|-----------------------------------------|--------------|  
|SQL_ATTR_FETCH_BOOKMARK_PTR|Указывает на закладку для использования с **SQLFetchScroll**. Ниже приведены сведения о реализации.<br /><br /> — Если приложение задает это в ODBC 2. *x* драйвера ODBC 3 *.x* диспетчера драйверов кэширует его. Он разыменовывает указатель и передает значение в ODBC 2. *x* драйвера в *FetchOffset* аргумент **SQLExtendedFetch** при **SQLFetchScroll** позже вызывается приложением.<br />— Если приложение задает это в ODBC 3 *.x* драйвера ODBC 3 *.x* диспетчера драйверов передает этот вызов к драйверу.|  
|SQL_ATTR_ROW_STATUS_PTR|Указывает на массив статусов строк заполняются **SQLFetch**, **SQLFetchScroll**, **SQLBulkOperations**, и **SQLSetPos**. Ниже приведены сведения о реализации.<br /><br /> — Если приложение задает это в ODBC 2. *x* драйвера ODBC 3 *.x* диспетчера драйверов кэширует его значение. Он передает это значение ODBC 2. *x* драйвера в *RowStatusArray* аргумент **SQLExtendedFetch** при **SQLFetchScroll** или **SQLFetch** вызывается.<br />— Если приложение задает это в ODBC 3 *.x* драйвера ODBC 3 *.x* диспетчера драйверов передает этот вызов к драйверу.<br />— В состоянии S6, если приложение устанавливает значения SQL_ATTR_ROW_STATUS_PTR и затем вызывает **SQLBulkOperations** (с *операции* из SQL_ADD) или **SQLSetPos** без предварительного вызова функции **SQLFetch** или **SQLFetchScroll**, SQLSTATE HY011 (атрибут нельзя установить сейчас) возвращается.|  
|SQL_ATTR_ROWS_FETCHED_PTR|Указывает на буфер, в который **SQLFetch** и **SQLFetchScroll** возвращают число возвращаемых строк. Ниже приведены сведения о реализации.<br /><br /> — Если приложение задает это в ODBC 2. *x* драйвера ODBC 3 *.x* диспетчера драйверов кэширует его значение. Он передает это значение ODBC 2. *x* драйвера в *RowCountPtr* аргумент **SQLExtendedFetch** при **SQLFetch** или **SQLFetchScroll** вызывается приложением.<br />— Если приложение задает это в ODBC 3 *.x* драйвера ODBC 3 *.x* диспетчера драйверов передает этот вызов к драйверу.|  
|SQL_ATTR_ROW_ARRAY_SIZE|Задает размер набора строк. Ниже приведены сведения о реализации.<br /><br /> — Если приложение задает это в ODBC 2. *x* драйвера ODBC 3 *.x* диспетчера драйверов сопоставляет его с атрибутом SQL_ROWSET_SIZE инструкции.<br />— Если приложение задает это в ODBC 3 *.x* драйвера ODBC 3 *.x* диспетчера драйверов передает этот вызов к драйверу.<br />— Если приложение, работа с ODBC 3 *.x* драйвер вызывает **SQLSetScrollOptions**, SQL_ROWSET_SIZE присваивается значение в *RowsetSize* аргумент Если базовый драйвер не поддерживает **SQLSetScrollOptions**.|  
|SQL_ROWSET_SIZE|Задает размер набора строк, используемых **SQLExtendedFetch** при **SQLExtendedFetch** вызывается ODBC 2 *.x* приложения. Ниже приведены сведения о реализации.<br /><br /> — Если приложение задает, ODBC 3 *.x* диспетчера драйверов передает этот вызов к драйверу, независимо от версии драйвера.<br />— При работе с ODBC 2 приложения. *x* драйвер вызывает **SQLSetScrollOptions**, SQL_ROWSET_SIZE присваивается значение в **RowsetSize** аргумент.|  
|**SQLBulkOperations**|Выполняет вставки операции или обновления, удаления или fetch операциями закладки. Ниже приведены сведения о реализации.<br /><br /> — Если приложение вызывает **SQLBulkOperations** с *операции* из SQL_ADD в ODBC 2. *x* драйвера ODBC 3 *.x* диспетчера драйверов сопоставляет его **SQLSetPos** с *операции* из SQL_ADD.<br />— При работе с ODBC 2. *x* драйвер, который не поддерживает **SQLSetPos** с *операции* из SQL_ADD ODBC 3 *.x* диспетчер драйверов не соответствует **SQLSetPos** с *операции* из SQL_ADD для **SQLBulkOperations** с *операции* из SQL_ADD. Это обусловлено **SQLBulkOperations** не может быть вызван в состоянии S7, какие в ODBC 2. *x* было единственное состояние, в котором **SQLSetPos** может вызываться.<br />— Если приложение вызывает **SQLBulkOperations** с *операции* из SQL_ADD в ODBC 2. *x* драйвера перед вызовом **SQLFetchScroll**, ODBC 3 *.x* диспетчера драйверов возвращает сообщение об ошибке.|  
|**SQLExtendedFetch**|Возвращает указанный набор строк. За исключением случая, упомянутых, ODBC 3 *.x* диспетчера драйверов передает вызовы **SQLExtendedFetch** к драйверу, независимо от версии драйвера.|  
|**SQLFetch**|Возвращает следующий набор строк. Ниже приведены сведения о реализации.<br /><br /> — Если приложение вызывает **SQLFetch** в ODBC 2. *x* драйвера ODBC 3 *.x* диспетчера драйверов сопоставляет его **SQLExtendedFetch**. *FetchOrientation* аргумент **SQLExtendedFetch** присваивается SQL_FETCH_NEXT. Диспетчер драйверов использует кэшированное значение атрибута инструкции значения SQL_ATTR_ROW_STATUS_PTR *RowStatusArray* аргумент и кэшированное значение атрибута sql_attr_rows_fetched_ptr, которое указывает оператор для  *RowCountPtr* аргумент.<br />3 ODBC *.x* приложений можно смешивать вызовы **SQLFetch** и **SQLFetchScroll** в ODBC 2. *x* драйвер поскольку ODBC 3 *.x* сопоставляет диспетчера драйверов **SQLFetch** для **SQLExtendedFetch** когда приложение вызывает его в ODBC 2. *x* драйвера.<br />-Если ODBC 2. *x* драйвер не поддерживает **SQLExtendedFetch**, ODBC 3 *.x* диспетчер драйверов не соответствует **SQLFetch** или  **SQLFetchScroll** для **SQLExtendedFetch** когда приложение вызывает его в этот драйвер. Если приложение пытается установить SQL_ATTR_ROW_ARRAY_SIZE значение больше 1, SQLSTATE HYC00 возвращается (дополнительная возможность не реализована).<br />— За исключением для только что было отмечено, ограничения ODBC 3 *.x* диспетчера драйверов передает вызовы **SQLFetch** к драйверу, независимо от версии драйвера.|  
|**SQLFetchScroll**|Возвращает указанный набор строк. Ниже приведены сведения о реализации.<br /><br /> — Если приложение вызывает **SQLFetchScroll** в ODBC 2. *x* драйвера ODBC 3 *.x* диспетчера драйверов сопоставляет его **SQLExtendedFetch**. Она использует кэшированное значение атрибута инструкции значения SQL_ATTR_ROW_STATUS_PTR *RowStatusArray* аргумент и кэшированное значение атрибута sql_attr_rows_fetched_ptr, которое указывает оператор для *RowCountPtr* аргумент. Если *FetchOrientation* аргумента в **SQLFetchScroll** является sql_fetch_bookmark аргумента, он использует кэшированное значение атрибута инструкции SQL_ATTR_FETCH_BOOKMARK_PTR для *FetchOffset*  аргумент и возвращает ошибку, если *FetchOffset* аргумент **SQLFetchScroll** является не равен 0.<br />— Если приложение вызывает это в ODBC 3 *.x* драйвера ODBC 3 *.x* диспетчера драйверов передает этот вызов к драйверу.|  
|**SQLSetPos**|Выполняет различные позиционированных операций. ODBC 3 *.x* диспетчера драйверов передает вызовы **SQLSetPos** к драйверу, независимо от версии драйвера.|  
|**SQLSetScrollOptions**|Когда диспетчер драйверов сопоставляет **SQLSetScrollOptions** для приложения, работа с ODBC 3 *.x* драйвер, который не поддерживает **SQLSetScrollOptions**, драйвер Диспетчер задает параметр инструкции SQL_ROWSET_SIZE, атрибут не SQL_ATTR_ROW_ARRAY_SIZE инструкции к *RowsetSize* аргумента в **SQLSetScrollOption**. В результате **SQLSetScrollOptions** не может использоваться приложением, при получении нескольких строк путем вызова **SQLFetch** или **SQLFetchScroll**. Он может использоваться только в том случае, если получение несколько строк с помощью вызова **SQLExtendedFetch**.|
