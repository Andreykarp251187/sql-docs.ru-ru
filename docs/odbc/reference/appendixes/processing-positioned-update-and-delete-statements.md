---
title: Обработка позиционированных обновлений и удалений Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- positioned deletes [ODBC]
- ODBC cursor library [ODBC], statement processing
- cursor library [ODBC], positioned update or delete
- positioned updates [ODBC]
- SQL statements [ODBC], cursor library
- ODBC cursor library [ODBC], positioned update or delete
- cursor library [ODBC], statement processing
ms.assetid: 2975dd97-48e6-4d0a-a9c7-40759a7d94c8
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 4b3f20da018bcd4e28e8ffca097fb5a4373d7f42
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81308025"
---
# <a name="processing-positioned-update-and-delete-statements"></a>Обработка инструкций позиционированного обновления и удаления
> [!IMPORTANT]  
>  Эта функция будет удалена в будущей версии Windows. Избегайте использования этой функции в новых разработках и планируйте модифицировать приложения, использующие эту функцию в настоящее время. Корпорация Майкрософт рекомендует использовать функцию курсора драйвера.  
  
 Библиотека курсора поддерживает позиционированное обновление и удаление инструкций, заменяя положение WHERE CURRENT of в таких **заявлениях** положением **WHERE,** в котором перечисляются значения, хранящиеся в кэше для каждого связанного столба. Библиотека курсора передает недавно построенные заявления **UPDATE** и **DELETE** водителю для выполнения. Для позиционированных инструкций обновления библиотека курсора обновляет свой кэш из значений в буферах строк и устанавливает соответствующее значение в массиве состояния строки для SQL_ROW_UPDATED. Для позиционированных инструкций удаления он устанавливает соответствующее значение в массиве состояния строки на SQL_ROW_DELETED.  
  
> [!CAUTION]  
>  Положение **WHERE,** построенное библиотекой курсоров для идентификации текущей строки, может не идентифицировать строки, определить другую строку или определить несколько строк. Для получения дополнительной [информации см.](../../../odbc/reference/appendixes/constructing-searched-statements.md)  
  
 Позиционированные инструкции по обновлению и удалению подлежат следующим ограничениям:  
  
-   Позиционированные операторы обновления и удаления могут использоваться только в следующих случаях: когда оператор **SELECT** генерирует набор результатов; когда заявление **SELECT** не содержит присоединения, положения **UNION** или положения **GROUP BY;** и когда какие-либо столбцы, использовавшие псевдоним или выражение в списке выбора, не были связаны с **S'LBindCol.**  
  
-   Если приложение готовит позиционированное обновление или удаление оператора, оно должно сделать это после того, как оно вызвало **S'LFetch** или **S'LFetchScroll.** Несмотря на то, что библиотека курсора отправляет заявление водителю для подготовки, она закрывает заявление и выполняет его непосредственно, когда приложение вызывает **S'LExecute.**  
  
-   Если драйвер поддерживает только одно активное утверждение, библиотека курсора получает остальную часть набора результатов, а затем повторно извлекает текущий набор строк из своего кэша, прежде чем он выполнит позиционированное обновление или удаление оператора. Если приложение вызывает функцию, которая возвращает метаданные в наборе результатов (например, **S'LNumResultCols** или **S'LDescribeCol),** библиотека курсора возвращает ошибку.  
  
-   Если позиционированное обновление или удаление выполняется на столбце таблицы, которая включает столбец метки времени, который автоматически обновляется каждый раз, когда выполняется обновление, все последующие позиционируемые операторы обновляются или удаляются, если столбец метки времени связан. Это происходит потому, что поисковое обновление или удаление оператора, которое создает библиотека курсора, не будет точно идентифицировать строку для обновления. Значение в исискаленных операторах для столбца метки времени не будет соответствовать автоматически обновленного значения столбца метки времени.
