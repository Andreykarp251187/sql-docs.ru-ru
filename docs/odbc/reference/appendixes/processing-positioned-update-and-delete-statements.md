---
title: Обработка позиционированного обновления и инструкций Delete | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- positioned deletes [ODBC]
- ODBC cursor library [ODBC], statement processing
- cursor library [ODBC], positioned update or delete
- positioned updates [ODBC]
- SQL statements [ODBC], cursor library
- ODBC cursor library [ODBC], positioned update or delete
- cursor library [ODBC], statement processing
ms.assetid: 2975dd97-48e6-4d0a-a9c7-40759a7d94c8
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 41b4fe248f815e63c48a8da70edc88a1cc173667
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "68028435"
---
# <a name="processing-positioned-update-and-delete-statements"></a>Обработка инструкций позиционированного обновления и удаления
> [!IMPORTANT]  
>  Этот компонент будет удален в будущих версиях Windows. Избегайте использования этой функции в новых разработках и запланируйте изменение приложений, которые сейчас ее используют. Корпорация Майкрософт рекомендует использовать функциональные возможности драйвера курсора.  
  
 Поддерживает библиотеку курсор расположен инструкции update и delete, заменив **WHERE CURRENT OF** предложение в таких операторах с **ГДЕ** предложения, который перечисляет значения, хранящиеся в кэше для каждого привязанного столбца. Библиотека курсоров передает нового созданного **обновление** и **удалить** инструкций драйвера для выполнения. Для инструкций позиционированного обновления библиотеки курсоров обновляет свой кэш на основе значений в буферах набора строк и задает соответствующее значение в массив статусов строк для SQL_ROW_UPDATED. Для инструкций позиционированного delete она задает соответствующее значение в массив статусов строк для SQL_ROW_DELETED.  
  
> [!CAUTION]  
>  **ГДЕ** предложение, созданный библиотекой курсоров для идентификации текущей строки сможет определить все строки, определить другую строку или определить более одной строки. Дополнительные сведения см. в разделе [создав поиск инструкций](../../../odbc/reference/appendixes/constructing-searched-statements.md)далее в этом приложении.  
  
 Позиционированного обновления и удаления инструкций распространяются следующие ограничения:  
  
-   Позиционированного обновления и удаления операторы могут использоваться только в следующих случаях: когда **ВЫБЕРИТЕ** создания результирующего набора инструкции; когда **ВЫБЕРИТЕ** инструкция не содержит соединение,  **ОБЪЕДИНЕНИЕ** предложения, или **GROUP BY** предложение; и если не были привязаны любые столбцы, используемые псевдониму или выражение в списке выбора с **SQLBindCol**.  
  
-   Если приложение подготавливает позиционированного обновления или инструкции delete, это необходимо сделать после вызова **SQLFetch** или **SQLFetchScroll**. Несмотря на то, что библиотека курсоров отправляет инструкцию драйвера для подготовки, он закрывает ее и выполняет его непосредственно при вызове приложением **SQLExecute**.  
  
-   Если драйвер поддерживает только одну активную инструкцию, библиотека выборки курсора, остальная часть результата задать и затем refetches текущего набора строк из своего кэша до выполнения позиционированных инструкция update или delete. Если затем приложение вызывает функцию, которая возвращает метаданные в результирующем наборе (например, **SQLNumResultCols** или **SQLDescribeCol**), библиотеку курсоров возвращает сообщение об ошибке.  
  
-   Если для столбца таблицы, содержащей столбец типа timestamp, которое автоматически обновляется каждый раз при выполнении обновления выполняется позиционированного обновления или инструкции delete, все последующие позиционированного обновления и удаления в завершится ошибкой, если столбец отметки времени привязан. Это происходит, так как поисковое обновление или удаление, инструкцию, которая создает библиотеку курсоров не будет точно идентифицировать строку для обновления. Значение, в которой выполняется поиск инструкции столбец отметки времени не будет соответствовать автоматически обновляемое значение столбца отметки времени.
