---
description: Обработка инструкций позиционированного обновления и удаления
title: Обработка позиционированных инструкций UPDATE и DELETE | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- positioned deletes [ODBC]
- ODBC cursor library [ODBC], statement processing
- cursor library [ODBC], positioned update or delete
- positioned updates [ODBC]
- SQL statements [ODBC], cursor library
- ODBC cursor library [ODBC], positioned update or delete
- cursor library [ODBC], statement processing
ms.assetid: 2975dd97-48e6-4d0a-a9c7-40759a7d94c8
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: f11e5acd8afe46397126ddb4c1d4127eb99fc67a
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88483207"
---
# <a name="processing-positioned-update-and-delete-statements"></a>Обработка инструкций позиционированного обновления и удаления
> [!IMPORTANT]  
>  Эта функция будет удалена в следующей версии Windows. Избегайте использования этой функции в новых разработках и запланируйте изменение приложений, которые в настоящее время используют эту функцию. Корпорация Майкрософт рекомендует использовать функцию курсора драйвера.  
  
 Библиотека курсоров поддерживает позиционированные инструкции UPDATE и DELETE, заменяя предложение **WHERE CURRENT of** в таких инструкциях с предложением **WHERE** , которое перечисляет значения, хранящиеся в его кэше для каждого привязанного столбца. Библиотека курсоров передает вновь сформированные инструкции **Update** и **Delete** драйверу для выполнения. Для позиционированных инструкций UPDATE библиотека курсоров обновляет свой кэш из значений в буферах набора строк и устанавливает соответствующее значение в массиве состояния строки в SQL_ROW_UPDATED. Для инструкций позиционированного удаления он задает для соответствующего значения в массиве состояния строки значение SQL_ROW_DELETED.  
  
> [!CAUTION]  
>  Предложение **WHERE** , созданное библиотекой курсоров для обнаружения текущей строки, может не распознать какие-либо строки, указывать другую строку или указывать более одной строки. Дополнительные сведения см. в подразделе [Конструирование поисковых инструкций](../../../odbc/reference/appendixes/constructing-searched-statements.md)далее в этом приложении.  
  
 На инструкции позиционированного обновления и удаления распространяются следующие ограничения.  
  
-   Операторы позиционированного обновления и удаления можно использовать только в следующих случаях: при формировании результирующего набора инструкцией **SELECT** ; Если инструкция **SELECT** не содержит соединение, предложение **Union** или предложение **Group By** ; а если любые столбцы, в которых использовался псевдоним или выражение в списке выбора, не были привязаны к **SQLBindCol**.  
  
-   Если приложение готовит инструкцию позиционированного обновления или удаления, оно должно сделать это после вызова **SQLFetch** или **SQLFetchScroll**. Хотя библиотека курсоров отправляет инструкцию драйверу для подготовки, она закрывает инструкцию и выполняет ее непосредственно, когда приложение вызывает **SQLExecute**.  
  
-   Если драйвер поддерживает только одну активную инструкцию, Библиотека курсоров извлекает оставшуюся часть результирующего набора, а затем повторно извлекает текущий набор строк из своего кэша перед выполнением инструкции позиционированного обновления или удаления. Если приложение вызывает функцию, возвращающую метаданные в результирующем наборе (например, **SQLNumResultCols** или **SQLDescribeCol**), Библиотека курсоров возвращает ошибку.  
  
-   Если инструкция позиционированного обновления или удаления выполняется над столбцом таблицы, включающей столбец timestamp, который автоматически обновляется при каждом выполнении обновления, все последующие инструкции UPDATE и DELETE завершатся ошибкой, если столбец отметок времени привязан. Это происходит потому, что искомая библиотека курсора Update или DELETE не будет точно указывать обновляемую строку. Значение в поисковом выражении для столбца timestamp не будет совпадать с автоматически обновляемым значением столбца timestamp.
