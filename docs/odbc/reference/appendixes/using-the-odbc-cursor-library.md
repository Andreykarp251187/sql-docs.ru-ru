---
title: Использование библиотеки курсоров ODBC | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- ODBC cursor library [ODBC], using cursor library
- cursor library [ODBC], using cursor library
ms.assetid: 9653f2f8-ccfc-4220-99ef-601dc0fa641c
author: MightyPen
ms.author: genemi
ms.openlocfilehash: cdddf2e757c549de460f5e22c2ea76ce91a2a969
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68069969"
---
# <a name="using-the-odbc-cursor-library"></a>Использование библиотеки курсоров ODBC
> [!IMPORTANT]  
>  Эта функция будет удалена в следующей версии Windows. Избегайте использования этой функции в новых разработках и запланируйте изменение приложений, которые в настоящее время используют эту функцию. Корпорация Майкрософт рекомендует использовать функцию курсора драйвера.  
  
 Чтобы использовать библиотеку курсоров ODBC, приложение:  
  
1.  Вызывает **SQLSetConnectAttr** с *атрибутом* SQL_ATTR_ODBC_CURSORS, чтобы указать, как библиотека курсоров должна использоваться с определенным соединением. Библиотека курсоров может использоваться всегда (SQL_CUR_USE_ODBC), используется только в том случае, если драйвер не поддерживает прокручиваемые курсоры (SQL_CUR_USE_IF_NEEDED) или никогда не используется (SQL_CUR_USE_DRIVER).  
  
2.  Вызывает **SQLConnect**, **SQLDriverConnect**или **SQLBrowseConnect** для подключения к источнику данных.  
  
3.  Вызывает **SQLSetStmtAttr** для указания типа курсора (SQL_ATTR_CURSOR_TYPE), параллелизма (SQL_ATTR_CONCURRENCY) и размера набора строк (SQL_ATTR_ROW_ARRAY_SIZE). Библиотека курсоров поддерживает однопроходные и статические курсоры. Однонаправленные курсоры должны быть доступны только для чтения, тогда как статические курсоры могут быть доступны только для чтения или могут использовать управление оптимистичным параллелизмом, сравнивая значения.  
  
4.  Выделяет один или несколько буферов наборов строк и вызывает **SQLBindCol** один или несколько раз для привязки этих буферов к столбцам результирующего набора.  
  
5.  Формирует результирующий набор, выполняя инструкцию **SELECT** или процедуру или вызывая функцию каталога. Если приложение будет выполнять позиционированные инструкции UPDATE, то оно должно выполнить инструкцию **SELECT для Update** , чтобы создать результирующий набор.  
  
6.  Вызывает **SQLFetch** или **SQLFetchScroll** один или несколько раз для прокрутки результирующего набора.  
  
 Приложение может изменять значения данных в буферах набора строк. Чтобы обновить буферы набора строк данными из кэша библиотеки курсора, приложение вызывает **SQLFetchScroll** с аргументом *фетчориентатион* , для которого задано значение SQL_FETCH_RELATIVE а для аргумента *фетчоффсет* задано значение 0.  
  
 Чтобы получить данные из непривязанного столбца, приложение вызывает функцию **SQLSetPos** для позиционирования курсора в нужной строке. Затем он вызывает **SQLGetData** для получения данных.  
  
 Чтобы определить количество строк, полученных из источника данных, приложение вызывает **SQLRowCount**.
