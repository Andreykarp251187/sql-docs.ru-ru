---
title: Использование библиотеки ODBC Cursor (англ.) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- ODBC cursor library [ODBC], using cursor library
- cursor library [ODBC], using cursor library
ms.assetid: 9653f2f8-ccfc-4220-99ef-601dc0fa641c
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 8c740ed78de51684eac38ad0c54ab2224986018d
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81301405"
---
# <a name="using-the-odbc-cursor-library"></a>Использование библиотеки курсоров ODBC
> [!IMPORTANT]  
>  Эта функция будет удалена в будущей версии Windows. Избегайте использования этой функции в новых разработках и планируйте модифицировать приложения, использующие эту функцию в настоящее время. Корпорация Майкрософт рекомендует использовать функцию курсора драйвера.  
  
 Чтобы воспользоваться библиотекой курсора ODBC, приложение:  
  
1.  Вызывает **sLSetConnectAttr** с *атрибутом* SQL_ATTR_ODBC_CURSORS, чтобы указать, как должна использоваться библиотека курсоров с определенным соединением. Библиотека курсоров всегда может использоваться (SQL_CUR_USE_ODBC), использоваться только в том случае, если драйвер не поддерживает прокрутки курсоров (SQL_CUR_USE_IF_NEEDED) или никогда не используется (SQL_CUR_USE_DRIVER).  
  
2.  Для подключения к исходучку данных для подключения к исходу данным вызывает **вызовы**на веб-подъёмную связь, **S'LDriverConnect**или **S'LBrowseConnect.**  
  
3.  Вызывает **sLSetStmtAttr,** чтобы указать тип курсора (SQL_ATTR_CURSOR_TYPE), размер параллелизма (SQL_ATTR_CONCURRENCY) и размер рядов (SQL_ATTR_ROW_ARRAY_SIZE). Библиотека курсора поддерживает вперед только курсоры. Курсоры только вперед должны быть прочитаны только для чтения, в то время как статические курсоры можно читать только или использовать оптимистичный параллелический контроль, сравнивая значения.  
  
4.  Выделяет один или несколько буферов строк и вызывает **S'LBindCol** один или несколько раз, чтобы связать эти буферы с набором столбцов.  
  
5.  Генерирует результат, установленный путем выполнения оператора **SELECT** или процедуры, или вызова функции каталога. Если приложение будет выполнять позиционированные операторы обновления, оно должно выполнить выписку **SELECT FOR UPDATE** для создания набора результатов.  
  
6.  Для прокрутки набора результатов один или несколько раз вызывает **s-LFetch** или **S'LFetchScroll.**  
  
 Приложение может изменять значения данных в буферах строк. Чтобы обновить буферы строк с данными из кэша библиотеки курсора, приложение вызывает **S'LFetchScroll** с аргументом *FetchOrientation,* установленным для SQL_FETCH_RELATIVE, и *аргументом FetchOffset,* установленным на 0.  
  
 Для получения данных из неограниченного столбца приложение вызывает **S'LSetPos** для размещения курсора на нужном ряду. Затем для получения данных он вызывает **s'LGetData.**  
  
 Чтобы определить количество строк, извлеченных из источника данных, приложение вызывает **S'LRowCount**.
