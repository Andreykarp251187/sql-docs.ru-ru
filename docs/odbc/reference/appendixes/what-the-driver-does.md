---
title: Функции драйвера | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- scrollable cursors [ODBC]
- cursors [ODBC], backward compatibility
- compatibility [ODBC], cursors
- backward compatibility [ODBC], cursors
- block cursors [ODBC]
ms.assetid: 75dcdea6-ff6b-4ac8-aa11-a1f9edbeb8e6
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 685f67c9f24593a5c50097de426b76fef068d6e9
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62735025"
---
# <a name="what-the-driver-does"></a>Функции драйвера
В следующей таблице перечислены какие функции и инструкции атрибуты ODBC 3 *.x* драйвер следует реализовать для блока и Прокручиваемые курсоры.  
  
|Функция или<br /><br /> атрибут инструкции|Комментарии|  
|-----------------------------------------|--------------|  
|SQL_ATTR_ROW_STATUS_PTR|Наборы, заполняются адрес массив статусов строк **SQLFetch** и **SQLFetchScroll**. Этот массив заполняется также **SQLSetPos** Если **SQLSetPos** вызывается в состоянии инструкции S6. Если **SQLSetPos** вызывается в состоянии S7, этот массив пуст, но массива, на которые указывают *RowStatusArray* аргумент **SQLExtendedFetch** заполняется. Дополнительные сведения см. в разделе [переходы инструкций](../../../odbc/reference/appendixes/statement-transitions.md) в приложении б: Таблицы перехода состояния ODBC.|  
|SQL_ATTR_ROWS_FETCHED_PTR|Задает адрес буфера, в котором **SQLFetch** и **SQLFetchScroll** возвращают число возвращаемых строк. Если **SQLExtendedFetch** является именем, этот буфер не заполнено, но *RowCountPtr* аргумент указывает число возвращаемых строк.|  
|SQL_ATTR_ROW_ARRAY_SIZE|Задает размер набора строк, используемых **SQLFetch** и **SQLFetchScroll**.|  
|SQL_ROWSET_SIZE|Задает размер набора строк, используемых **SQLExtendedFetch**. ODBC 3 *.x* драйверы реализовать это, если они хотят работать с ODBC 2. *x* приложения, которые вызывают **SQLExtendedFetch** или **SQLSetPos**.|  
|**SQLBulkOperations**|Если ODBC 3 *.x* драйвер должны работать с ODBC 2. *x* приложений, использующих **SQLSetPos** с *операции* из SQL_ADD, драйвер должен поддерживать **SQLSetPos** с  *Операция* из SQL_ADD в дополнение к **SQLBulkOperations** с *операции* из SQL_ADD.|  
|**SQLExtendedFetch**|Возвращает указанный набор строк. ODBC 3 *.x* драйверы реализовать это, если они хотят работать с ODBC 2. *x* приложения, которые вызывают **SQLExtendedFetch** или **SQLSetPos**. Ниже приведены сведения о реализации.<br /><br /> -Драйвер получает размер набора строк из значение атрибута инструкции SQL_ROWSET_SIZE.<br />-Драйвер извлекает адрес массив статусов строк из *RowStatusArray* аргумент, не атрибут значения SQL_ATTR_ROW_STATUS_PTR инструкции. *RowStatusArray* аргумента в вызове **SQLExtendedFetch** не должно быть пустым указателем. (Обратите внимание, что в ODBC 3 *.x*, атрибут значения SQL_ATTR_ROW_STATUS_PTR инструкции может быть пустым указателем.)<br />-Драйвер возвращает адрес буфера строк, загружаемых из *RowCountPtr* аргумент, не sql_attr_rows_fetched_ptr, которое указывает атрибут инструкции.<br />-Драйвер возвращает SQLSTATE 01S01 (ошибка в строке) для указания, что произошла ошибка во время выборки строк с помощью вызова **SQLExtendedFetch**. ODBC 3 *.x* драйвер должен возвращать SQLSTATE 01S01 (ошибка в строке) только тогда, когда **SQLExtendedFetch** вызывается, не при **SQLFetch** или **SQLFetchScroll** вызывается. Для сохранения обратной совместимости при SQLSTATE 01S01 (ошибка в строке) возвращается **SQLExtendedFetch**, диспетчер драйверов не упорядочивает записи состояния в очереди ошибок в соответствии с правилами, перечисленным в «последовательность из состояния Записи» раздела [SQLGetDiagField](../../../odbc/reference/syntax/sqlgetdiagfield-function.md).|  
|**SQLFetch**|Возвращает следующий набор строк. Ниже приведены сведения о реализации.<br /><br /> -Драйвер извлекает размер набора строк из значения атрибута SQL_ATTR_ROW_ARRAY_SIZE инструкции.<br />-Драйвер извлекает адрес массив статусов строк из значения SQL_ATTR_ROW_STATUS_PTR атрибут инструкции.<br />-Драйвер извлекает адрес получаемых буфер из атрибута SQL_ATTR_ROWS_FETCHED_PTR инструкции строк.<br />-Приложение можно смешивать вызовы между **SQLFetchScroll** и **SQLFetch**.<br />-   **SQLFetch** возвращает закладки, если столбец 0 привязан.<br />-   **SQLFetch** может вызываться для возврата более одной строки.<br />-Драйвер не возвращает SQLSTATE 01S01 (ошибка в строке) для указания, что произошла ошибка во время выборки строк с помощью вызова **SQLFetch**.|  
|**SQLFetchScroll**|Возвращает указанный набор строк. Ниже приведены сведения о реализации.<br /><br /> -Драйвер получает размер набора строк из инструкции атрибута SQL_ATTR_ROW_ARRAY_SIZE.<br />-Драйвер извлекает адрес массив статусов строк из значения SQL_ATTR_ROW_STATUS_PTR атрибут инструкции.<br />-Драйвер извлекает адрес получаемых буфер из атрибута SQL_ATTR_ROWS_FETCHED_PTR инструкции строк.<br />-Приложение можно смешивать вызовы между **SQLFetchScroll** и **SQLFetch**.<br />-Драйвер не возвращает SQLSTATE 01S01 (ошибка в строке) для указания, что произошла ошибка во время выборки строк с помощью вызова **SQLFetchScroll**.|  
|**SQLSetPos**|Выполняет различные позиционированных операций. Ниже приведены сведения о реализации.<br /><br /> -Это может вызываться в состояниях инструкции S6 или S7. Дополнительные сведения см. в разделе [переходы инструкций](../../../odbc/reference/appendixes/statement-transitions.md) в приложении б: Таблицы перехода состояния ODBC.<br />— Если это называется в состоянии инструкции S5 или S6, драйвер получает размер набора строк из атрибута SQL_ATTR_ROWS_FETCHED_PTR инструкции и адрес массив статусов строк из значения SQL_ATTR_ROW_STATUS_PTR атрибут инструкции.<br />— Если это называется в состоянии инструкции S7, драйвер получает размер набора строк из атрибута инструкции SQL_ROWSET_SIZE и адрес массив статусов строк из *RowStatusArray* аргумент  **SQLExtendedFetch**.<br />-Драйвер возвращает SQLSTATE 01S01 (ошибка в строке) только для того, чтобы указать, что произошла ошибка во время выборки строк с помощью вызова **SQLSetPos** для выполнения массовой операции, при вызове функции в состоянии S7. Для сохранения обратной совместимости, в том случае, если SQLSTATE 01S01 (ошибка в строке) возвращается **SQLSetPos**, диспетчер драйверов не упорядочивает записи состояния в очереди ошибок в соответствии с правилами, перечисленным в «Последовательность из состояния записи» раздел [SQLGetDiagField](../../../odbc/reference/syntax/sqlgetdiagfield-function.md).<br />— Если драйвер должны работать с ODBC 2. *x* приложения, которые вызывают **SQLSetPos** с *операции* аргумент SQL_ADD, драйвер должен поддерживать **SQLSetPos** с  *Операция* аргумент SQL_ADD.|
