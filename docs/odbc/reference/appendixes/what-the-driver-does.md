---
title: Что делает водитель Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- scrollable cursors [ODBC]
- cursors [ODBC], backward compatibility
- compatibility [ODBC], cursors
- backward compatibility [ODBC], cursors
- block cursors [ODBC]
ms.assetid: 75dcdea6-ff6b-4ac8-aa11-a1f9edbeb8e6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: c0438478f5aa625ffdd4d3bcd1c0a6f0f80d3367
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81301395"
---
# <a name="what-the-driver-does"></a>Функции драйвера
В следующей таблице кратко излагаются функции и функции, атрибуты атрибутов драйвера ODBC *3.x* для блокируемых и прокрутковых курсоров.  
  
|Функция или<br /><br /> атрибут инструкции|Комментарии|  
|-----------------------------------------|--------------|  
|SQL_ATTR_ROW_STATUS_PTR|Устанавливает адрес массива статуса строки, заполненного **S'LFetch** и **S'LFetchScroll.** Этот массив также заполняется **S'LSetPos,** если **S'LSetPos** называется в заявлении состояние S6. Если **S'LSetPos** называется в состоянии S7, этот массив не заполнен, но массив, на который указывает аргумент *RowStatusArray* **из S'LExtendedFetch,** заполняется. Для получения дополнительной информации смотрите [Переходные процессы в приложении](../../../odbc/reference/appendixes/statement-transitions.md) B: Таблицы перехода состояния ODBC.|  
|SQL_ATTR_ROWS_FETCHED_PTR|Устанавливает адрес буфера, в котором **S'LFetch** и **S'LFetchScroll** возвращают количество строк, извлеченных. Если вызовs **s'LExtendedFetch,** этот буфер не заполнен, но аргумент *RowCountPtr* указывает на количество строк, извлеченных.|  
|SQL_ATTR_ROW_ARRAY_SIZE|Устанавливает размер строки, используемый **S'LFetch** и **S'LFetchScroll.**|  
|SQL_ROWSET_SIZE|Устанавливает размер строки, используемый **S'LExtendedFetch.** Драйверы ODBC *3.x* реализуют это, если они хотят работать с приложениями ODBC *2.x,* которые называются **S'LExtendedFetch** или **S'LSetPos.**|  
|**СЗЛБалКОперации**|Если драйвер ODBC *3.x* должен работать с приложениями ODBC *2.x,* которые используют **S'LSetPos** с *операцией* SQL_ADD, то водитель должен поддерживать **S'LSetPos** с *операцией* SQL_ADD в дополнение к **S'LBulkOperations** с *операцией* SQL_ADD.|  
|**Sqlextendedfetch**|Возвращает указанный ряд. Драйверы ODBC *3.x* реализуют это, если они хотят работать с приложениями ODBC *2.x,* которые называются **S'LExtendedFetch** или **S'LSetPos.** Ниже приведены детали реализации:<br /><br /> - Водитель извлекает размер строки из значения атрибута SQL_ROWSET_SIZE оператора.<br />- Водитель извлекает адрес массива статуса строки из аргумента *RowStatusArray,* а не атрибут SQL_ATTR_ROW_STATUS_PTR оператора. Аргумент *RowStatusArray* в вызове на **S'LExtendedFetch** не должен быть нулевым указателем. (Обратите внимание, что в ODBC *3.x*атрибут SQL_ATTR_ROW_STATUS_PTR оператора может быть нулевой указатель.)<br />- Водитель извлекает адрес строк, извлеченных буфера из аргумента *RowCountPtr,* а не SQL_ATTR_ROWS_FETCHED_PTR атрибута оператора.<br />- Водитель возвращает S'LSTATE 01S01 (Ошибка в строке), чтобы указать, что ошибка произошла в то время как строки были извлечены по вызову на **S'LExtendedFetch**. Водитель ODBC *3.x* должен вернуть S'LSTATE 01S01 (ошибка в строке) только при вызове **S'LExtendedFetch,** а не при вызове **S'LFetch** или **S'LFetchScroll.** Для сохранения обратной совместимости, когда S'LSTATE 01S01 (Ошибка в строке) возвращается **s'LExtendedFetch**, менеджер-водитель не задает записи статуса в очереди ошибок в соответствии с правилами, указанными в разделе "Последовательность записей о состоянии" в разделе [S'LGetDiagField.](../../../odbc/reference/syntax/sqlgetdiagfield-function.md)|  
|**SQLFetch**|Возвращает следующий ряд. Ниже приведены детали реализации:<br /><br /> - Водитель извлекает размер строки из значения атрибута SQL_ATTR_ROW_ARRAY_SIZE оператора.<br />- Водитель извлекает адрес массива состояния строки из атрибута SQL_ATTR_ROW_STATUS_PTR оператора.<br />- Водитель извлекает адрес строк, извлеченных буфера из атрибута SQL_ATTR_ROWS_FETCHED_PTR оператора.<br />- Приложение может смешивать звонки между **S'LFetchScroll** и **S'LFetch.**<br />-   **S'LFetch** возвращает закладки, если столбец 0 связан.<br />-   **S'LFetch** можно вызвать, чтобы вернуть несколько строк.<br />- Драйвер не возвращает S'LSTATE 01S01 (Ошибка в строке), чтобы указать, что ошибка произошла в то время как строки были извлечены по вызову на **S'LFetch**.|  
|**SQLFetchScroll**|Возвращает указанный ряд. Ниже приведены детали реализации:<br /><br /> - Водитель извлекает размер строки из атрибута SQL_ATTR_ROW_ARRAY_SIZE оператора.<br />- Водитель извлекает адрес массива состояния строки из атрибута SQL_ATTR_ROW_STATUS_PTR оператора.<br />- Водитель извлекает адрес строк, извлеченных буфера из атрибута SQL_ATTR_ROWS_FETCHED_PTR оператора.<br />- Приложение может смешивать звонки между **S'LFetchScroll** и **S'LFetch.**<br />- Драйвер не возвращает S'LSTATE 01S01 (Ошибка в строке), чтобы указать, что ошибка произошла в то время как строки были извлечены по вызову на **S'LFetchScroll**.|  
|**функция SQLSetPos;**|Выполняет различные позиционированные операции. Ниже приведены детали реализации:<br /><br /> - Это можно назвать в заявлении говорится S6 или S7. Для получения более подробной информации смотрите [переходные данные в приложении](../../../odbc/reference/appendixes/statement-transitions.md) B: Таблицы перехода состояния ODBC.<br />- Если это называется в состоянии оператора S5 или S6, водитель извлекает размер строки из атрибута SQL_ATTR_ROWS_FETCHED_PTR оператора и адрес массива состояния строки из атрибута SQL_ATTR_ROW_STATUS_PTR оператора.<br />- Если это называется в состоянии s7 оператора, то драйвер извлекает размер строки из атрибута SQL_ROWSET_SIZE оператора и адрес массива состояния строки из аргумента *RowStatusArray* из **S'LExtendedFetch.**<br />- Драйвер возвращает S'LSTATE 01S01 (Ошибка в строке) только для того, чтобы указать, что ошибка произошла в то время как строки были извлечены по вызову в **S'LSetPos** для выполнения основной операции, когда функция называется в состоянии S7. Для сохранения обратной совместимости, если S'LSTATE 01S01 (Ошибка в строке) возвращается **компанией S'LSetPos,** менеджер-водитель не задает записи о состоянии в очереди ошибок в соответствии с правилами, указанными в разделе "Последовательность записей о состоянии" в разделе [S'LGetDiagField.](../../../odbc/reference/syntax/sqlgetdiagfield-function.md)<br />- Если водитель должен работать с приложениями ODBC *2.x,* которые вызывают **S'LSetPos** с *аргументом операции* SQL_ADD, то водитель должен поддерживать **S'LSetPos** с *аргументом операции* SQL_ADD.|
