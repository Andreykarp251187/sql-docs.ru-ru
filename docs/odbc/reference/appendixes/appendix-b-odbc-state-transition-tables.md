---
title: Приложение Б. Таблицы перехода состояния ODBC | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- state transitions [ODBC]
- transitioning states [ODBC], about state transitions
- state transitions [ODBC], about state transitions
ms.assetid: 15088dbe-896f-4296-b397-02bb3d0ac0fb
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 82c19931073aa96eb045f574e8670068f3d3c659
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63026926"
---
# <a name="appendix-b-odbc-state-transition-tables"></a>Приложение Б. Таблицы перехода состояния ODBC
В таблицах в этом приложении показано, как функции ODBC вызывают переходы среды, подключения, инструкции и дескриптора состояний. Состояние среды, подключения, инструкции или дескриптора обычно определяет, когда можно вызывать функции, которые используют соответствующий тип дескриптора (среды, подключения, инструкции или дескриптора). Состояния среды, подключения, инструкции и дескриптора перекрываться примерно, как показано на следующем рисунке. Например точное перекрытие подключения указано, C5 и C6 и инструкции о том, что S1 через S12 является данных зависит от источника, так как транзакции начинаются в разное время в разных источниках данных, а состояние дескриптора D1i (неявно выделить дескриптор) от о состоянии инструкции, с которой связан дескриптор при этом состояние D1e (явно выделить дескриптор) не зависит от состояния любой инструкции. Описание каждого состояния, см. в разделе [переходы среды](../../../odbc/reference/appendixes/environment-transitions.md), [переходы подключения](../../../odbc/reference/appendixes/connection-transitions.md), [переходы инструкций](../../../odbc/reference/appendixes/statement-transitions.md), и [переходы дескрипторов ](../../../odbc/reference/appendixes/descriptor-transitions.md)далее в этом приложении.  
  
 Состояний среды и соединения перекрытие следующим образом:  
  
 ![Перекрытие состояний среды и соединения](../../../odbc/reference/appendixes/media/app01.gif "app01")  
  
 Следующим Перекрытие состояний инструкции и соединения:  
  
 ![Инструкции и соединения указано перекрытие](../../../odbc/reference/appendixes/media/app02.gif "app02")  
  
 Следующим Перекрытие состояний инструкции и дескриптора:  
  
 ![Инструкции и дескриптора состояния перекрытие](../../../odbc/reference/appendixes/media/app03.gif "app03")  
  
 Состояния соединения и дескриптора перекрытие следующим образом:  
  
 ![Соединения и дескриптора состояния перекрытие](../../../odbc/reference/appendixes/media/app04.gif "app04")  
  
 Каждая запись в таблице переход может принимать одно из следующих значений:  
  
-   **--** — Состояние остается неизменным после выполнения функции.  
  
-   **E**  

     **_n_**  , **C_n_**, **S_n_**, или **D_n_** -состояние среды, подключения, инструкции или дескриптора перемещается в указанное состояние.  
 
-   **(IH)**  -Функции передан недопустимый дескриптор. Если дескриптор был дескриптор null или является допустимым дескриптором неправильный тип — например, дескриптор соединения была передана при дескриптора инструкции требовалось - функция возвращает SQL_INVALID_HANDLE; в противном случае поведение не определено и, возможно, Неустранимая ошибка. Эта ошибка отображается только в том случае, если он является единственным возможным результат вызова функции в указанном состоянии. Эта ошибка не приводит к изменению состояния и всегда обнаружен диспетчером драйверов, как указано в круглых скобках.  
  
-   **NS** -следующего состояния. Оператор перехода аналогичен так, как если бы инструкция не вышли асинхронного состояния. Предположим, например, инструкцию, которая создает результирующий набор переходит в состояние S11 из состояния S1 поскольку **SQLExecDirect** возвращаемое значение SQL_STILL_EXECUTING. Нотация NS в состоянии S11 означает, что переходы для инструкции те же инструкции в состоянии S1, которые создает результирующий набор. Если **SQLExecDirect** возвращает ошибку, инструкция остается в состоянии S1; выполняется успешно, инструкция перемещает состояние S5; Если необходимые данные, инструкция перемещается в состоянии S8; и если он выполняется по-прежнему остается в состоянии S11.  

-   **_XXXXX_**  или **(*XXXXX*)** — это состояние SQLSTATE, связана с таблицей перехода; Обнаружено диспетчером драйверов SQLSTATE заключены в скобки. Функция вернула значение SQL_ERROR и указанным SQLSTATE, но не изменяет состояние. Например если **SQLExecute** вызывается перед **SQLPrepare**, он возвращает параметром SQLSTATE HY010 (функционировать ошибка последовательности).  

> [!NOTE]  
>  Таблицы не содержат ошибок, не имеющих отношения к таблицы перехода, которые не изменяют состояние. Например, если **SQLAllocHandle** вызывается в состояние среды E1 и возвращает SQLSTATE HY001 (ошибка выделения памяти), среды остается в состоянии E1; это не показано в таблице перехода среды для  **SQLAllocHandle**.  
  
 Если среды, подключения, инструкции или дескриптора можно переместить несколько состояний, каждое возможное состояние отображается, и сноски, объяснить условия, при которых происходит каждый переход. Следующие сноски могут отображаться в любой таблице.  
  
|Сноска|Значение|  
|--------------|-------------|  
|b|До или после. Курсор был установлен перед началом результирующего набора или в конце результирующего набора.|  
|с|Текущая функция. Текущая функция выполнялась асинхронно.|  
|d|Требуются данные. Функция вернула значение SQL_NEED_DATA.|  
|Д.|Ошибка. Функция возвращает значение SQL_ERROR.|  
|i|Недопустимая строка. Курсор был установлен на строки в результирующем наборе и либо строка была удалена, или возникла ошибка в операции в строке. Если существует массив статусов строк, значение в массив статусов строк для строки было SQL_ROW_DELETED или SQL_ROW_ERROR. (Массив статусов строк указывает атрибут инструкции значения SQL_ATTR_ROW_STATUS_PTR.)|  
|nf|Не найден. Функция вернула значение SQL_NO_DATA. Это не применяется, когда **SQLExecDirect**, **SQLExecute**, или **SQLParamData** вернула значение SQL_NO_DATA, после выполнения поиска инструкция update или delete.|  
|np|Не подготовлена. Инструкция не подготовлена.|  
|nr|Нет результатов. Инструкция не будет или не удалось создать результирующий набор.|  
|o|Другие функции. Другая функция выполнялась асинхронно.|  
|p|Подготовить. Инструкция была подготовлена.|  
|r|Результаты. Инструкция будет или была создана (возможно, пустой) результирующий набор.|  
|s|Успешно. Функция вернула значение SQL_SUCCESS_WITH_INFO или SQL_SUCCESS.|  
|v|Допустимую строку. Курсор был установлен для строки в результирующем наборе и строки успешно вставлены, обновлены, или другая операция в строке успешно выполнен. Если существует массив статусов строк, значение в массив статусов строк для строки было SQL_ROW_ADDED, SQL_ROW_SUCCESS или SQL_ROW_UPDATED. (Массив статусов строк указывает атрибут инструкции значения SQL_ATTR_ROW_STATUS_PTR.)|  
|x|Выполняющиеся. Функция вернула значение SQL_STILL_EXECUTING.|  
  
## <a name="sqlfreehandle"></a>SQLFreeHandle  
 В этом примере строке перехода состояния среды таблицы для **SQLFreeHandle** при *HandleType* является SQL_HANDLE_ENV выглядит следующим образом.  
  
|E0<br /><br /> Не выделено|E1<br /><br /> выделено|E2<br /><br /> Соединение|  
|------------------------|----------------------|-----------------------|  
|(IH)|E0|(HY010)|  
  
 Если **SQLFreeHandle** вызывается в состояние среды E0 с *HandleType* значение SQL_HANDLE_ENV, диспетчер драйверов возвращает SQL_INVALID_HANDLE. Если он вызывается в состоянии E1 с *HandleType* значение SQL_HANDLE_ENV, среде перемещает состояние E0, если функция завершается успешно и остается в состоянии E1, если функция завершается с ошибкой. Если он вызывается в состоянии E2 с *HandleType* значение SQL_HANDLE_ENV, диспетчер драйверов всегда возвращает значение SQL_ERROR и параметром SQLSTATE HY010 (функционировать ошибка последовательности) и среды остается в состоянии E2.  
  
 Чтобы понять таблицы перехода состояния, необходимые для понимания того, какой элемент (среды, подключения, инструкции или дескриптора), они ссылаются на. Предположим, что функция принимает дескриптор элемента типа X. Таблица переходов между состояниями X для этой функции описано, как вызывающий влияет на функции, дескриптор типа X, элемент этого элемента. Например **SQLDisconnect** принимает дескриптор соединения. Таблица переходов между состояниями подключения для **SQLDisconnect** описывается как **SQLDisconnect** влияет на состояние соединения, для которого он вызывается.  
  
 Предположим, что функция принимает дескриптор элемента типа Y, где Y не равно X. Таблица переходов между состояниями X для этой функции описано, как вызывающий влияет на функции, дескриптор типа X, связанный с элементом типа Y, к элементу типа Y. Например, оператор перехода таблицы состояний для **SQLDisconnect** описывается как **SQLDisconnect** воздействует на состояние при вызове с дескриптором соединения с помощью которого оператор оператор связан.  
  
 Это приложение содержит следующие разделы.  
  
-   [Переходы среды](../../../odbc/reference/appendixes/environment-transitions.md)  
  
-   [Переходы подключения](../../../odbc/reference/appendixes/connection-transitions.md)  
  
-   [Переходы инструкций](../../../odbc/reference/appendixes/statement-transitions.md)  
  
-   [Переходы дескрипторов](../../../odbc/reference/appendixes/descriptor-transitions.md)
