---
title: 'Приложение B: Таблицы перехода государства ODBC (ru) Документы Майкрософт'
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- state transitions [ODBC]
- transitioning states [ODBC], about state transitions
- state transitions [ODBC], about state transitions
ms.assetid: 15088dbe-896f-4296-b397-02bb3d0ac0fb
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: db20c492ababbe6bf8f065fce88067c643f2694d
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81302888"
---
# <a name="appendix-b-odbc-state-transition-tables"></a>Приложение Б. Таблицы перехода состояния ODBC
Таблицы в этом приложении показывают, как функции ODBC вызывают переходы состояния среды, соединения, оператора и дескриптора. Состояние среды, соединения, оператора или дескриптора обычно диктует, когда могут вызываться функции, которые используют соответствующий тип ручки (окружающая среда, соединение, оператора или дескриптор). Состояния среды, соединения, оператора и дескриптора перекрываются примерно так, как показано на следующих иллюстрациях. Например, точное перекрытие состояний соединения C5 и C6 и оператора s1 через S12 зависит от источников данных, так как транзакции начинаются в разное время на разных источниках данных, а состояние дескриптора D1i (неявно выделенный дескриптор) зависит от состояния оператора, с которым связан дескриптор, в то время как состояние D1e (явно выделенный дескриптор) не зависит от состояния любого оператора. Для описания каждого состояния см. [Переходы среды,](../../../odbc/reference/appendixes/environment-transitions.md) [переходы к](../../../odbc/reference/appendixes/connection-transitions.md)подключению, [переходы к операторам](../../../odbc/reference/appendixes/statement-transitions.md)и [переходы дескриптора,](../../../odbc/reference/appendixes/descriptor-transitions.md)позже в этом приложении.  
  
 Состояния среды и соединения перекрываются следующим образом:  
  
 ![Перекрытие состояний среды и соединения](../../../odbc/reference/appendixes/media/app01.gif "app01")  
  
 Состояния соединения и оператора перекрываются следующим образом:  
  
 ![Перекрытие состояний инструкции и соединения](../../../odbc/reference/appendixes/media/app02.gif "app02")  
  
 Состояния оператора и дескриптора перекрываются следующим образом:  
  
 ![Перекрытие состояний инструкции и дескриптора](../../../odbc/reference/appendixes/media/app03.gif "app03")  
  
 Состояния соединения и дескриптора перекрываются следующим образом:  
  
 ![Перекрытие состояний соединения и дескриптора](../../../odbc/reference/appendixes/media/app04.gif "app04")  
  
 Каждая запись в таблице переходного периода может быть одним из следующих значений:  
  
-   **--**-Состояние остается неизменным после выполнения функции.  
  
-   **E**  

     **_n_** , **C_n_,** **S_n_** или **D_n_** - среда, соединение, оператора или состояние дескриптора перемещается в указанное состояние.  
 
-   **(IH)** - Недействительная ручка была передана функции. Если ручка была нулевой ручкой или была допустимой ручкой неправильного типа - например, ручка соединения была пройдена, когда требуется ручка оператора, - функция возвращается SQL_INVALID_HANDLE; в противном случае поведение является неопределенным и, вероятно, фатальным. Эта ошибка отображается только тогда, когда это единственный возможный результат вызова функции в указанном состоянии. Эта ошибка не изменяет состояние и всегда обнаруживается менеджером драйвера, как указано в скобках.  
  
-   **NS** - Следующее государство. Переход к заявлению такой же, как если бы заявление не проходило через асинхронные состояния. Например, предположим, что выписка, создающая набор результатов, входит в состояние S11 из состояния S1, поскольку **s'LExecDirect** вернулся SQL_STILL_EXECUTING. Нотация NS в состоянии S11 означает, что переходы для оператора такие же, как и для оператора в состоянии S1, создающее набор результатов. Если **S'LExecDirect** возвращает ошибку, утверждение остается в состоянии S1; если это удается, заявление переходит к государству S5; если ему нужны данные, заявление переходит в состояние S8; и если он все еще исполняет, он остается в состоянии S11.  

-   **_XXXXX_** или ***(XXXXX*)** - СЗЛСТАТ, связанный с таблицей переходного периода; СЗЛСТАТ, обнаруженные менеджером драйверов, заключены в скобки. Функция вернулась SQL_ERROR и указанным S'LSTATE, но состояние не меняется. Например, если **s'LExecute** вызывается до **s'LPrepare,** он возвращает S'LSTATE HY010 (ошибка последовательности функций).  

> [!NOTE]  
>  Таблицы не отображают ошибки, не связанные с таблицами перехода, которые не меняют состояние. Например, когда **S'LAllocHandle** вызывается в состоянии среды E1 и возвращает S'LSTATE HY001 (ошибка распределения памяти), среда остается в состоянии E1; это не показано в таблице перехода среды для **S'LAllocHandle**.  
  
 Если среда, соединение, оператора или дескриптор могут перемещаться в более чем одно состояние, отображается каждое возможное состояние и одна или несколько сносок объясняют условия, при которых происходит каждый переход. Следующие сноски могут появиться в любой таблице.  
  
|Сноски|Значение|  
|--------------|-------------|  
|b|До или после. Курсор был расположен до начала набора результатов или после окончания набора результатов.|  
|с|Текущая функция. Нынешняя функция исполняла асинхронно.|  
|d|Нужны данные. Функция вернула SQL_NEED_DATA.|  
|Д.|Ошибка. Функция вернулась SQL_ERROR.|  
|i|Недействительная строка. Курсор был расположен на строке в наборе результатов, и либо строка была удалена, либо ошибка произошла в операции на строке. При наличии массива статуса строки значение в массиве состояния строки для строки было SQL_ROW_DELETED или SQL_ROW_ERROR. (На массив состояния строки указывается атрибут SQL_ATTR_ROW_STATUS_PTR оператора.)|  
|nf|Не найдено. Функция вернула SQL_NO_DATA. Это не применяется в случае возврата SQL_NO_DATA после выполнения поискового обновления или удаления оператора **s'LExecDirect,** **S'L'LExecute,** или **s'LParamData.**|  
|np|Не подготовлен. Заявление не было подготовлено.|  
|nr|Результаты отсутствуют. Заявление не создает или не создает набор результатов.|  
|o|Другая функция. Другой функцией было выполнение асинхронно.|  
|p|Подготовлены. Заявление было подготовлено.|  
|r|Результаты. Заявление будет или же создать (возможно, пустой) набор результатов.|  
|s|Успешно. Функция возвращается SQL_SUCCESS_WITH_INFO или SQL_SUCCESS.|  
|v|Действительная строка. Курсор был расположен на строке в наборе результатов, и строка была успешно вставлена, успешно обновлена, или другая операция на строке была успешно завершена. При наличии массива статуса строки значение в массиве состояния строки для строки было SQL_ROW_ADDED, SQL_ROW_SUCCESS или SQL_ROW_UPDATED. (На массив состояния строки указывается атрибут SQL_ATTR_ROW_STATUS_PTR оператора.)|  
|x|Выполняющиеся. Функция вернулась SQL_STILL_EXECUTING.|  
  
## <a name="sqlfreehandle"></a>SQLFreeHandle  
 В этом примере строка в таблице перехода состояния среды для **S'LFreeHandle,** когда *HandleType* SQL_HANDLE_ENV, заключается в следующем.  
  
|E0<br /><br /> Не выделено|E1<br /><br /> Allocated|E2<br /><br /> Соединение|  
|------------------------|----------------------|-----------------------|  
|(IH)|E0|(HY010)|  
  
 Если **S'LFreeHandle** вызывается в состоянии среды E0 с *набором HandleType,* SQL_HANDLE_ENV, менеджер драйвера возвращается SQL_INVALID_HANDLE. Если он вызывается в состоянии E1 с *набором HandleType,* чтобы SQL_HANDLE_ENV, среда перемещается в состояние E0, если функция успешно работает, и остается в состоянии E1, если функция выходит из строя. Если он называется в состоянии E2 с *набором HandleType,* чтобы SQL_HANDLE_ENV, менеджер драйвера всегда возвращает SQL_ERROR и S'LSTATE HY010 (ошибка последовательности функций), а среда остается в состоянии E2.  
  
 Чтобы понять таблицы перехода состояния, необходимо понять, к какому элементу (среда, соединение, оператора или дескриптор) они ссылаются. Предположим, что функция принимает ручку элемента типа X. Таблица перехода состояния X для этой функции описывает, как вызов функции с ручкой элемента типа X влияет на этот элемент. Например, **sLDisconnect** принимает ручку соединения. Таблица перехода состояния соединения для **S'LDisconnect** описывает, как **S'LDisconnect** влияет на состояние соединения, для которого он называется.  
  
 Предположим, что функция принимает ручку элемента типа Y, где Y не равен X. Таблица перехода состояния X для этой функции описывает, как вызов функции с ручкой типа X, связанной с элементом типа Y, влияет на элемент типа Y. Например, в таблице перехода состояния состояния оператора для **S'LDisconnect** описывается, как **S'LDisconnect** влияет на состояние оператора при вызове с ручкой соединения, с которым связано соединение.  
  
 Это приложение содержит следующие темы.  
  
-   [Переходы среды](../../../odbc/reference/appendixes/environment-transitions.md)  
  
-   [Переходы подключения](../../../odbc/reference/appendixes/connection-transitions.md)  
  
-   [Переходы инструкций](../../../odbc/reference/appendixes/statement-transitions.md)  
  
-   [Переходы дескрипторов](../../../odbc/reference/appendixes/descriptor-transitions.md)
