---
title: Выполнение позиционированных обновлений и удалений Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- positioned deletes [ODBC]
- cursor library [ODBC], positioned update or delete
- positioned updates [ODBC]
- ODBC cursor library [ODBC], positioned update or delete
ms.assetid: 1d64f309-2a6e-4ad1-a6b5-e81145549c56
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 96a1aa891ef8ba26c6c239cf35e62a8f36018e65
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81307005"
---
# <a name="executing-positioned-update-and-delete-statements"></a>Выполнение инструкций позиционированного обновления и удаления
> [!IMPORTANT]  
>  Эта функция будет удалена в будущей версии Windows. Избегайте использования этой функции в новых разработках и планируйте модифицировать приложения, использующие эту функцию в настоящее время. Корпорация Майкрософт рекомендует использовать функцию курсора драйвера.  
  
 После того, как приложение получило блок данных с **помощью S'LFetchScroll,** оно может обновить или удалить данные в блоке. Для выполнения позиционированного обновления или удаления приложение:  
  
1.  Вызывает **S'LSetPos** для размещения курсора на строке для обновления или удаления.  
  
2.  Строит позиционированное обновление или удаление оператора со следующим синтаксисом:  
  
     **ОБНОВЛЕНИЕ** *название таблицы*  
  
     **SET** *столбец-идентификатор* **=** -*выражение* &#124; **NULL**  
  
     -**,** *столбец-идентификатор* **=** -*выражение* &#124; **NULL**  
  
     **ГДЕ CURRENT Of** *курсор-имя*  
  
     **DELETE От** *таблицы-имя* ГДЕ CURRENT *курсора-имя* **WHERE CURRENT OF**  
  
     Самый простой способ построить оговорку **SET** в позиционированном обновлении — использовать параметры маркеров для обновления каждого столбца и использовать **S'LBindParameter,** чтобы связать их с буферами строки для обновления строки. В этом случае тип данных C параметра будет таким же, как и тип данных C буфера строки.  
  
3.  Обновляет буферы строки для текущей строки, если он выполнит позиционированное обновление оператора. После успешного выполнения позиционированного оператора обновления библиотека курсора копирует значения из каждой строки в текущем ряду в свой кэш.  
  
    > [!CAUTION]  
    >  Если приложение не обновляет корректно буферы строк перед выполнением оператора обновленного обновления, данные в кэше будут неверными после выполнения оператора.  
  
4.  Выполняет позиционированное обновление или удаляет выписку с помощью другого оператора, чем заявление, связанное с курсором.  
  
    > [!CAUTION]  
    >  Положение **WHERE,** построенное библиотекой курсоров для идентификации текущей строки, может не идентифицировать строки, определить другую строку или определить несколько строк. Для получения дополнительной [информации см.](../../../odbc/reference/appendixes/constructing-searched-statements.md)  
  
 Все позиционированные операторы обновления и удаления требуют имени курсора. Чтобы указать имя курсора, приложение вызывает **S'LSetCursorName** до открытия курсора. Для использования имени курсора, генерируемого драйвером, приложение вызывает **S'LGetCursorName** после открытия курсора.  
  
 После того, как библиотека курсора выполняет позиционированное обновление или удаление оператора, массив состояния, буферы строки и кэш, поддерживаемые библиотекой курсора, содержат значения, указанные в следующей таблице.  
  
|Использовано заявление|Значение в строке статуса массива|Значения в<br /><br /> буферы рядового набора|Значения в<br /><br /> буферы кэша|  
|--------------------|-------------------------------|----------------------------------|---------------------------------|  
|Позиционированное обновление|SQL_ROW_UPDATED|Новые значения|Новые значения|  
|Позиционируется удалить|SQL_ROW_DELETED|Прежние значения|Прежние значения|  
  
 Приложение должно обновить значения в буферах строки перед выполнением позиционированного оператора обновления; после выполнения позиционированного оператора обновления библиотека курсора копирует значения буферов строки в кэше.
