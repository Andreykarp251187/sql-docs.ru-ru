---
title: Функции времени, даты и интервала Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- functions [ODBC], time functions
- functions [ODBC], date functions
- interval functions [ODBC]
- functions [ODBC], interval functions
- time functions [ODBC]
- date functions [ODBC]
ms.assetid: bdf054a0-7aba-4e99-a34a-799917376fd5
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: aec3d6b23383edcc9659ff884e8cd71b0595dae1
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81302825"
---
# <a name="time-date-and-interval-functions"></a>Функции даты, времени и интервалов
В следующей таблице перечислены функции времени и даты, включенные в набор функций масштабирования ODBC. Приложение может определить, какие функции времени и даты поддерживаются драйвером, позвонив в **S'LGetInfo** с *информационным типом* SQL_TIMEDATE_FUNCTIONS.  
  
 Аргументы, обозначаемые как *timestamp_exp* может быть название столбца, результат другой функции масштабирования, или *ODBC-время побега*, *ODBC-дата-побег*, или *ODBC-timestamp-побег*, где основной тип данных может быть представлен как SQL_CHAR, SQL_VARCHAR, SQL_TYPE_TIME, SQL_TYPE_DATE или SQL_TYPE_TIMESTAMP.  
  
 Аргументы, обозначаемые как *date_exp* могут быть названием столбца, результатом другой функции масштабирования, или *ODBC-дата-побег* или *ODBC-timestamp-escape*, где базовый тип данных может быть представлен как SQL_CHAR, SQL_VARCHAR, SQL_TYPE_DATE или SQL_TYPE_TIMESTAMP.  
  
 Аргументы, обозначаемые как *time_exp* могут быть названием столбца, результатом другой функции масштабирования, или *ODBC-time-escape* или *ODBC-timestamp-escape*, где базовый тип данных может быть представлен как SQL_CHAR, SQL_VARCHAR, SQL_TYPE_TIME или SQL_TYPE_TIMESTAMP.  
  
 В соответствии с функциями ODBC 3.0 были добавлены функции CURRENT_DATE, CURRENT_TIME и CURRENT_TIMESTAMP времени, чтобы выровнять их с S'L-92.  
  
|Компонент|Описание|  
|--------------|-----------------|  
|**CURRENT_DATE( )** (ODBC 3.0)|Возвращает текущую дату.|  
|**CURRENT_TIME (точность** *времени)* **)]** (ODBC 3.0)|Возвращает текущее время. Аргумент *точности времени* определяет точность секунд возврата значения.|  
|**CURRENT_TIMESTAMP**<br /> **Точность** по *времени* **(ODBC** 3.0)|Возвращает текущую локальную дату и местное время в качестве значения метки времени. Аргумент *точности временной метки* определяет точность секунд возврата метки времени.|  
|**КУРДАТ( )** (ODBC 1.0)|Возвращает текущую дату.|  
|**КЮРТАЙМ()** (ODBC 1.0)|Возвращает текущее время.|  
|**DAYNAME (date_exp** *date_exp* **)** (ODBC 2.0)|Возвращает строку символов, содержащую конкретное название дня источника данных (например, с воскресенья по субботу или солнце. до Sat., для источника данных, который использует английский язык, или Sonntag через Samstag для источника данных, который использует немецкий) для дневной части *date_exp.*|  
|**DAYOFMONTH** *(date_exp* **)** (ODBC 1.0)|Возвращает день месяца на основе месячного поля в *date_exp* как целое значение в диапазоне 1-31.|  
|**DAYOFWEEK** *(date_exp)* **)** (ODBC 1.0)|Возвращает день недели на основе недельного поля в *date_exp* как целое значение в диапазоне 1-7, где 1 представляет воскресенье.|  
|**DAYOFYEAR** *(date_exp* **)** (ODBC 1.0)|Возвращает день года на основе года поле в *date_exp* как целое значение в диапазоне 1-366.|  
|**Экстракт** *(экстракт-поле из* *экстрактного* **источника)** (ODBC 3.0)|Возвращает *извлекательную полевой* часть *экстрактного источника.* Аргумент *экстрактного источника* — это время даты или интервейт-выражение. Аргумент *экстрактного поля* может быть одним из следующих ключевых слов:<br /><br /> ГОД МЕСЯЦ ДЕНЬ ЧАС В СЕКУНДУ<br /><br /> Точность возвращенного значения определяется реализацией. Шкала 0, если SECOND не указана, и в этом случае шкала не меньше, чем дробные секунды точность *поля источника экстракта.*|  
|**ЧАС** *(time_exp)* **)** (ODBC 1.0)|Возвращает час на основе часового поля в *time_exp* как целое значение в диапазоне 0-23.|  
|**МИНУТА** *(TIME_EXP)* **)** (ODBC 1.0)|Возвращает минуту, основанную на минутном поле в *time_exp* как целое значение в диапазоне 0-59.|  
|**МЕСЯЦ (date_exp** *date_exp* **)** (ODBC 1.0)|Возвращает месяц на основе месячного поля в *date_exp* как целое значение в диапазоне 1-12.|  
|**MONTHNAME (date_exp** *date_exp* **)** (ODBc 2.0)|Возвращает строку символов, содержащую конкретное название источника данных месяца (например, с января по декабрь или январь через декабрь для источника данных, который использует английский язык, или Januar через Dezember для источника данных, который использует немецкий) в течение месяца часть *date_exp*.|  
|**ТЕПЕРЬ ()** (ODBC 1.0)|Возвращает текущую дату и время в качестве значения метки времени.|  
|**КВАРТЕР** *(date_exp* **)** (ODBC 1.0)|Возвращает квартал в *date_exp* как целое значение в диапазоне 1-4, где 1 представляет 1 января по 31 марта.|  
|**SECOND (time_exp** *time_exp* **)** (ODBC 1.0)|Возвращает второе поле на основе второго поля в *time_exp* как целое значение в диапазоне 0-59.|
|**TIMESTAMPADD** *(интервал*, *integer_exp*, *timestamp_exp)* **)** (ODBC 2.0)|Возвращает отметку времени, рассчитанную путем *добавления integer_exp* интервалов *интервала* типа в *timestamp_exp.* Действительные значения *интервала* являются следующими ключевыми словами:<br /><br /> SQL_TSI_FRAC_SECOND<br /><br /> SQL_TSI_SECOND<br /><br /> SQL_TSI_MINUTE<br /><br /> SQL_TSI_HOUR<br /><br /> SQL_TSI_DAY<br /><br /> SQL_TSI_WEEK<br /><br /> SQL_TSI_MONTH<br /><br /> SQL_TSI_QUARTER<br /><br /> SQL_TSI_YEAR<br /><br /> где дробные секунды выражаются в миллиардных долях секунды. Например, в следующем заявлении S'L возвращается имя каждого сотрудника и дата его годичной годовщины:<br /><br /> `SELECT NAME, {fn  TIMESTAMPADD(SQL_TSI_YEAR, 1, HIRE_DATE)} FROM  EMPLOYEES`<br /><br /> Если *timestamp_exp* значение времени и *интервал* определяет дни, недели, месяцы, четверти или годы, дата часть *timestamp_exp* устанавливается к текущей дате до расчета результирующей метки времени.<br /><br /> Если *timestamp_exp* значение даты и *интервал* определяет дробные секунды, секунды, минуты или часы, то временной часть *timestamp_exp* устанавливается до 0 до расчета полученной метки времени.<br /><br /> Приложение определяет, какие интервалы поддерживает источник данных, позвонив в **SQL_TIMEDATE_ADD_INTERVALS** опцию.|  
|**TIMESTAMPDIFF** *(интервал*, *timestamp_exp1*, *timestamp_exp2)* **)** (ODBC 2.0)|Возвращает целый ряд интервалов *интервала* типа, с помощью которого *timestamp_exp2* больше, чем *timestamp_exp1.* Действительные значения *интервала* являются следующими ключевыми словами:<br /><br /> SQL_TSI_FRAC_SECOND<br /><br /> SQL_TSI_SECOND<br /><br /> SQL_TSI_MINUTE<br /><br /> SQL_TSI_HOUR<br /><br /> SQL_TSI_DAY<br /><br /> SQL_TSI_WEEK<br /><br /> SQL_TSI_MONTH<br /><br /> SQL_TSI_QUARTER<br /><br /> SQL_TSI_YEAR<br /><br /> где дробные секунды выражаются в миллиардных долях секунды. Например, в следующем заявлении, в котором приводится информация о каждом сотруднике, и о количестве лет, в течение которых он или она работали:<br /><br /> `SELECT NAME, {fn  TIMESTAMPDIFF(SQL_TSI_YEAR, {fn CURDATE()}, HIRE_DATE)} FROM EMPLOYEES`<br /><br /> Если выражение timestamp — это значение времени, а *интервал* определяет дни, недели, месяцы, кварталы или годы, то часть даты этой метки времени устанавливается к текущей дате до расчета разницы между временными метками.<br /><br /> Если выражение timestamp является значением даты, а *интервал* определяет дробные секунды, секунды, минуты или часы, то временной часть этой метки времени устанавливается до 0, прежде чем вычислить разницу между метками времени.<br /><br /> Приложение определяет, какие интервалы поддерживает источник данных, позвонив в **SQL_TIMEDATE_DIFF_INTERVALS** опцию.|  
|**НЕДЕЛИ (date_exp** *date_exp* **)** (ODBC 1.0)|Возвращает неделю года на основе недельного поля в *date_exp* как целое значение в диапазоне 1-53.|  
|**ГОД (date_exp** *date_exp* **)** (ODBC 1.0)|Возвращает год на основе года поле в *date_exp* как целый значение. Диапазон зависит от источников данных.|
