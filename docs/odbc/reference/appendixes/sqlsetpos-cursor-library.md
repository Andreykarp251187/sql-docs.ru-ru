---
description: SQLSetPos (библиотека курсоров)
title: SQLSetPos (библиотека курсоров) | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQLSetPos function [ODBC], Cursor Library
ms.assetid: 574399c3-2bb2-4d19-829c-7c77bd82858d
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: d35f1461f6a5da3ee894d9275c6ca112bfabab44
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88339240"
---
# <a name="sqlsetpos-cursor-library"></a>SQLSetPos (библиотека курсоров)
> [!IMPORTANT]  
>  Эта функция будет удалена в следующей версии Windows. Избегайте использования этой функции в новых разработках и запланируйте изменение приложений, которые в настоящее время используют эту функцию. Корпорация Майкрософт рекомендует использовать функцию курсора драйвера.  
  
 В этом разделе рассматривается использование функции **SQLSetPos** в библиотеке курсоров. Общие сведения о функции **SQLSetPos**см. в разделе [Функция SQLSetPos](../../../odbc/reference/syntax/sqlsetpos-function.md).  
  
 Библиотека курсоров поддерживает операцию SQL_POSITION только для аргумента *операции* в **SQLSetPos**. Он поддерживает значение SQL_LOCK_NO_CHANGE только для аргумента *LockType* .  
  
 Если драйвер не поддерживает групповые операции, Библиотека курсоров возвращает значение SQLSTATE HYC00 (драйвер не поддерживается) при вызове функции **SQLSetPos** с параметром *RowNumber* , равным 0. Это поведение драйвера не рекомендуется.  
  
 Библиотека курсоров не поддерживает операции SQL_UPDATE и SQL_DELETE при вызове функции **SQLSetPos**. Библиотека курсоров реализует позиционированное обновление или инструкцию SQL путем создания инструкции UPDATE или DELETE с предложением WHERE, которое перечисляет значения, хранящиеся в его кэше для каждого привязанного столбца. Дополнительные сведения см. в разделе [Обработка позиционированных инструкций UPDATE и DELETE](../../../odbc/reference/appendixes/processing-positioned-update-and-delete-statements.md).  
  
 Если драйвер не поддерживает статические курсоры, приложение, работающее с библиотекой курсоров, должно вызывать **SQLSetPos** только для набора строк, полученного с помощью **SQLExtendedFetch** или **SQLFetchScroll**, а не **SQLFetch**. Библиотека курсоров реализует **SQLExtendedFetch** и **SQLFetchScroll** , делая повторяющиеся вызовы **SQLFetch** (с размером набора строк 1) в драйвере. Библиотека курсоров передает вызовы **SQLFetch**, с другой стороны, на драйвер. Если метод **SQLSetPos** вызывается для набора строк многострочные, полученного с помощью **SQLFetch** , когда драйвер не поддерживает статические курсоры, вызов завершится ошибкой, так как функция **SQLSetPos** не работает с курсорами прямого направления. Это будет происходить даже в том случае, если приложение успешно вызвало **SQLSetStmtAttr** , чтобы задать для SQL_ATTR_CURSOR_TYPE значение SQL_CURSOR_STATIC, которое поддерживает библиотека курсоров, даже если драйвер не поддерживает статические курсоры.
