---
title: Функция SQLParamData | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLParamData
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLParamData
helpviewer_keywords:
- SQLParamData function [ODBC]
ms.assetid: 68fe010d-9539-4e5b-a260-c8d32423b1db
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: ec0038e0ec6c87dba403bbe62441815dfa6d0251
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62465970"
---
# <a name="sqlparamdata-function"></a>Функция SQLParamData
**Соответствие стандартам**  
 Представленные версии: Соответствие стандартам 1.0 ODBC: ISO-92  
  
 **Сводка**  
 **SQLParamData** используется совместно с **SQLPutData** для предоставления данных параметра во время выполнения инструкции, а также с **SQLGetData** для получения потоковых выходных данных параметра.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
SQLRETURN SQLParamData(  
     SQLHSTMT       StatementHandle,  
     SQLPOINTER *   ValuePtrPtr);  
```  
  
## <a name="arguments"></a>Аргументы  
 *StatementHandle*  
 [Вход] Дескриптор инструкции.  
  
 *ValuePtrPtr*  
 [Выход] Указатель на буфер, в которую будет возвращен адрес *ParameterValuePtr* буфера, указанного в **SQLBindParameter** (для параметра данных) или адрес *TargetValuePtr* буфера, указанного в **SQLBindCol** (для данных столбца), как в поле записи дескриптора SQL_DESC_DATA_PTR.  
  
## <a name="returns"></a>Возвращает  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_NEED_DATA, SQL_NO_DATA, SQL_STILL_EXECUTING, SQL_ERROR, SQL_INVALID_HANDLE, or SQL_PARAM_DATA_AVAILABLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLParamData** возвращает значение SQL_ERROR или SQL_SUCCESS_WITH_INFO, а связанное значение SQLSTATE можно получить, вызвав **SQLGetDiagRec** с *HandleType* из SQL_ HANDLE_STMT и *обрабатывать* из *StatementHandle*. В следующей таблице перечислены значения SQLSTATE, обычно возвращаемые при помощи **SQLParamData** и объясняется каждый из них в контексте этой функции; описания SQLSTATE, возвращаемых диспетчером драйверов предшествует обозначение «(DM)». Возвращается связанный с каждого значения SQLSTATE значение SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Ошибка|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Специфические для драйвера информационное сообщение. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|07006|Нарушение атрибута ограниченного типа данных|Значение данных, определяемое *ValueType* аргумента в **SQLBindParameter** для привязанного параметра не удалось преобразовать в тип данных, определяемый *ParameterType*аргумента в **SQLBindParameter**.<br /><br /> Возвращаемое значение данных параметра, привязанный как SQL_PARAM_INPUT_OUTPUT или SQL_PARAM_OUTPUT не удалось преобразовать в тип данных, определяемый *ValueType* аргумента в **SQLBindParameter**.<br /><br /> (Если не удается преобразовать значения данных для одной или нескольких строк, но один или несколько строк, возвращенных успешно, эта функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|08S01|Отказ канала связи|Сбой в канале связи между драйвером и источника данных, к которому был подключен драйвер перед обработкой функции было завершено.|  
|22026|Строковые данные, несовпадение длины|Тип данных SQL_NEED_LONG_DATA_LEN в **SQLGetInfo** был «Y» и меньше данных было отправлено параметра long (тип данных был SQL_LONGVARCHAR SQL_LONGVARBINARY и зависящие от источника данных тип данных long), чем было указано с помощью *StrLen_or_IndPtr* аргумента в **SQLBindParameter**.<br /><br /> Тип данных SQL_NEED_LONG_DATA_LEN в **SQLGetInfo** был «Y» и меньше данных было отправлено для длинного столбца (тип данных был SQL_LONGVARCHAR SQL_LONGVARBINARY и зависящие от источника данных тип данных long), чем было указано в Длина буфера, соответствующего столбцу в строку данных, который был добавлен или обновлен с **SQLBulkOperations** или обновлено с помощью **SQLSetPos**.|  
|40001|Сбой сериализации|Выполнен откат транзакции из-за взаимоблокировки ресурсов с другой транзакцией.|  
|40003|Состояние транзакции неизвестно|Не удалось выполнить связанное соединение во время выполнения этой функции и не удается определить состояние транзакции.|  
|HY000|Общая ошибка|Произошла ошибка, для которой было нет конкретных SQLSTATE и SQLSTATE не зависящие от реализации, который был определен. Сообщение об ошибке, возвращенные **SQLGetDiagRec** в  *\*MessageText* буфера описывает ошибку и его причины.|  
|HY001|Ошибка выделения памяти|Драйвер не удалось выделить память, необходимая для поддержки выполнения или завершения функции.|  
|HY008|Операция отменена|Асинхронная обработка была включена для *StatementHandle*. Функция была вызвана, и до его завершения выполнения, **SQLCancel** или **SQLCancelHandle** был вызван для *StatementHandle*; функция затем был вызван снова на *StatementHandle*.<br /><br /> Функция была вызвана, и до его завершения выполнения, **SQLCancel** или **SQLCancelHandle** был вызван для *StatementHandle* из другого потока в многопоточные приложения.|  
|HY010|Ошибка последовательности функций|(DM) предыдущего вызова функции не был выполнен вызов **SQLExecDirect**, **SQLExecute**, **SQLBulkOperations**, или **SQLSetPos** где вернуть код был SQL_NEED_DATA или предыдущего вызова функции был выполнен вызов **SQLPutData**.<br /><br /> Предыдущий вызов функции был выполнен вызов **SQLParamData**.<br /><br /> (DM) был вызван асинхронно выполняемой функции для дескриптора соединения, связанный с *StatementHandle*. Если по-прежнему выполнении асинхронной функции **SQLParamData** была вызвана функция.<br /><br /> (DM) асинхронно выполняемой функции (не такой) был вызван для *StatementHandle* и еще выполнялась при вызове этой функции.<br /><br /> **SQLExecute**, **SQLExecDirect**, **SQLBulkOperations**, или **SQLSetPos** был вызван для *StatementHandle* и Возвращаемое значение SQL_NEED_DATA. **SQLCancel** был вызван перед отправкой данных для всех параметров данных времени выполнения или столбцов.|  
|HY013|Ошибка управления памятью|Не удалось обработать вызов функции, так как базовые объекты памяти оказываются недоступны, возможно из-за нехватки памяти.|  
|HY117|Подключение будет приостановлена из-за состояние транзакции неизвестно. Только отключиться и разрешены функции, доступные только для чтения.|(DM) Дополнительные сведения о состоянии приостановки, см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).|  
|HYT01|Время ожидания подключения истекло|Время ожидания подключения истекло раньше, чем ответил на запрос источника данных. Период времени ожидания задается с помощью **SQLSetConnectAttr**, sql_attr_connection_timeout не учитывается.|  
|IM001|Драйвер не поддерживает эту функцию|(DM), соответствующий драйвер *StatementHandle* не поддерживает функцию.|  
|IM017|Опрос недоступен в режиме асинхронное уведомление|Каждый раз, когда используется модель уведомлений, отключен опроса.|  
|IM018|**SQLCompleteAsync** не был вызван для завершения предыдущей асинхронной операции на этот дескриптор.|Если предыдущий вызов функции в дескриптор возвращает SQL_STILL_EXECUTING, и если включен режим уведомлений, **SQLCompleteAsync** должен вызываться с дескриптором постобработки и завершить операцию.|  
  
 Если **SQLParamData** вызывается при попытке отправки данных для параметра в инструкции SQL, он может возвращать любой SQLSTATE, которые могут быть возвращены, функция, вызываемая для выполнения инструкции (**SQLExecute** или **SQLExecDirect**). Если он вызывается при попытке отправки данных для столбца, обновляемых или добавлены с классом **SQLBulkOperations** или обновляется значением **SQLSetPos**, он может возвращать любой SQLSTATE, которые могут быть возвращены с  **SQLBulkOperations** или **SQLSetPos**.  
  
## <a name="comments"></a>Комментарии  
 **SQLParamData** может вызываться для предоставления данных данные во время выполнения для двух целей: данных параметра, который будет использоваться в вызове **SQLExecute** или **SQLExecDirect**, или столбец данных, который будет использовать, когда обновлены или добавлены с помощью вызова строки **SQLBulkOperations** или обновляются с помощью вызова **SQLSetPos**. Во время выполнения **SQLParamData** возвращает в приложение, указывает, какие данные требуется драйвер.  
  
 Если приложение вызывает **SQLExecute**, **SQLExecDirect**, **SQLBulkOperations**, или **SQLSetPos**, драйвер возвращает SQL_NEED_ ДАННЫЕ, если это необходимо, чтобы данные данных во время выполнения. Затем приложение вызывает **SQLParamData** чтобы определить, какие данные для отправки. Если драйвер требует соответствия данных параметра, драйвер возвращает в  *\*ValuePtrPtr* выходной буфер, значение, которое приложение помещаются в буфер строк. Приложение может использовать это значение, чтобы определить, какие данные параметров, драйвер запрашивает. Если драйвер требует соответствия данных столбца, драйвер возвращает в  *\*ValuePtrPtr* буфера адрес, который был изначально привязан столбец, как показано ниже:  
  
 *Привязан адрес* + *привязки смещение* + ((*номером строки* - 1) x *размер элемента*)  
  
 где переменные определяются, как указано в следующей таблице.  
  
|Переменная|Описание|  
|--------------|-----------------|  
|*Привязан адрес*|Адрес, указанный с помощью *TargetValuePtr* аргумента в **SQLBindCol**.|  
|*Смещение привязки*|Значение, хранящееся по адресу, указанному атрибутом SQL_ATTR_ROW_BIND_OFFSET_PTR инструкции.|  
|*Номер строки*|Отсчитываемый от единицы номер строки в наборе строк. Для выборки одной строки, которые используются по умолчанию, это 1.|  
|*Размер элемента*|Значение атрибута инструкции SQL_ATTR_ROW_BIND_TYPE для буферов данных и длины и индикатора.|  
  
 Он также возвращает значение SQL_NEED_DATA, который показывает, к приложению, он должен вызывать **SQLPutData** для отправки данных.  
  
 Приложение вызывает **SQLPutData** столько раз, при необходимости для отправки данных во время выполнения данные для столбца или параметра. После отправки всех данных для столбца или параметра, приложение вызывает **SQLParamData** еще раз. Если **SQLParamData** снова возвращает SQL_NEED_DATA, данные должны отправляться для другого параметра или столбца. Таким образом, приложение снова вызывает **SQLPutData**. Если все данные во время выполнения отправки данных для всех параметров или столбцов, затем **SQLParamData** возвращает SQL_SUCCESS или SQL_SUCCESS_WITH_INFO, значение в  *\*ValuePtrPtr* не определен, и может выполнить инструкцию SQL или **SQLBulkOperations** или **SQLSetPos** вызова могут быть обработаны.  
  
 Если **SQLParamData** блоки данных параметра, для которой выполняется поиск инструкция update или delete, не влияет на все строки в источнике данных, вызов **SQLParamData** не вернет значение SQL_NO_DATA.  
  
 Дополнительные сведения о том, как данные времени выполнения параметр данных передается во время выполнения инструкции, см. в разделе «Передача значения параметра» в [SQLBindParameter](../../../odbc/reference/syntax/sqlbindparameter-function.md) и [отправки длинных данных](../../../odbc/reference/develop-app/sending-long-data.md). Дополнительные сведения о том, как данные времени выполнения столбца данных является обновляемого или добавляемого, см. в разделе «С помощью SQLSetPos» в [SQLSetPos](../../../odbc/reference/syntax/sqlsetpos-function.md), «Выполнения массового обновления с помощью закладок» в [SQLBulkOperations](../../../odbc/reference/syntax/sqlbulkoperations-function.md), и [длинных данных и функции SQLSetPos и SQLBulkOperations](../../../odbc/reference/develop-app/long-data-and-sqlsetpos-and-sqlbulkoperations.md).  
  
 **SQLParamData** может вызываться для получения потоковых выходных параметров. Когда **SQLMoreResults**, **SQLExecute**, **SQLGetData**, или **SQLExecDirect** возвращает SQL_PARAM_DATA_AVAILABLE, вызова **SQLParamData** для определения, какой параметр имеет значение, доступное. Дополнительные сведения о SQL_PARAM_DATA_AVAILABLE и потоковых выходных параметров, см. в разделе [получение выходных параметров с помощью метода SQLGetData](../../../odbc/reference/develop-app/retrieving-output-parameters-using-sqlgetdata.md).  
  
## <a name="code-example"></a>Пример кода  
 См. в разделе [SQLPutData](../../../odbc/reference/syntax/sqlputdata-function.md).  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Привязка буфер к параметру|[Функция SQLBindParameter](../../../odbc/reference/syntax/sqlbindparameter-function.md)|  
|Отмена обработка инструкций|[Функция SQLCancel](../../../odbc/reference/syntax/sqlcancel-function.md)|  
|Возвращение сведений о параметре в операторе|[Функция SQLDescribeParam](../../../odbc/reference/syntax/sqldescribeparam-function.md)|  
|Выполнение инструкции SQL|[Функция SQLExecDirect](../../../odbc/reference/syntax/sqlexecdirect-function.md)|  
|Выполнении подготовленной инструкции SQL|[Функция SQLExecute](../../../odbc/reference/syntax/sqlexecute-function.md)|  
|Отправка данных параметра во время выполнения|[Функция SQLPutData](../../../odbc/reference/syntax/sqlputdata-function.md)|  
  
## <a name="see-also"></a>См. также  
 [Справочник по API ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)   
 [Получение выходных параметров с помощью метода SQLGetData](../../../odbc/reference/develop-app/retrieving-output-parameters-using-sqlgetdata.md)
