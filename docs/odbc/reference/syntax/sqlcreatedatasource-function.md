---
title: Функция S'LCreateDataSource (англ.) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLCreateDataSource
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLCreateDataSource
helpviewer_keywords:
- SQLCreateDataSource function [ODBC]
ms.assetid: 76ee851a-dca9-40cc-8e9e-eb3f74e560ee
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 94dc0d6d6f3b5bc96ae41aecda5b46f119cff85c
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81301204"
---
# <a name="sqlcreatedatasource-function"></a>Функция SQLCreateDataSource
**Соответствия**  
 Представлена версия: ODBC 2.0  
  
 **Сводка**  
 **СЗЛСоздатьДатаИсточник** отображает диалоговую коробку, с помощью которой пользователь может добавить источник данных.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
BOOL SQLCreateDataSource(  
     HWND    hwnd,  
     LPSTR   lpszDS);  
```  
  
## <a name="arguments"></a>Аргументы  
 *Hwnd*  
 (Вход) Ручка родительского окна.  
  
 *lpszDS*  
 (Вход) Имя источника данных. *lpszDS* может быть нулевой указатель или пустая строка.  
  
## <a name="returns"></a>Результаты  
 **S'LCreateDataSource** возвращает TRUE, если источник данных создан. В противном случае, он возвращает FALSE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **S'LCreateDataSource** возвращает FALSE, связанное * \*значение pfErrorCode* можно получить, позвонив по **телефону S'LInstallerError.** В следующей таблице перечислены * \*значения pfErrorCode,* которые могут быть возвращены **S'LInstallerError,** и приведены в изъяны каждое из них в контексте этой функции.  
  
|*\*pfErrorCode*|Error|Описание|  
|---------------------|-----------|-----------------|  
|ODBC_ERROR_GENERAL_ERR|Общая ошибка установки|Произошла ошибка, для которой не было конкретной ошибки установки.|  
|ODBC_ERROR_INVALID_HWND|Недействительная ручка окна|Аргумент *hwnd* был недействительным или NULL.|  
|ODBC_ERROR_INVALID_DSN|Недействительный DSN|Аргумент *lpszDS* содержал строку, которая была недействительной для DSN.|  
|ODBC_ERROR_REQUEST_FAILED|*Запрос* не удался|Вызов на **ConfigDSN** с ODBC_ADD_DSN опцией не удалось.|  
|ODBC_ERROR_LOAD_LIBRARY_FAILED|Не удалось загрузить библиотеку установки драйвера или переводчика|Библиотека установки драйвера не может быть загружена.|  
|ODBC_ERROR_USER_CANCELED|Пользователь отмененная операция|Пользователь отменил создание нового источника данных.|  
|ODBC_ERROR_CREATE_DSN_FAILED|Не удалось создать запрошенный DSN|Не удалось подключиться к базе данных; вызов на **S'LDriverConnect** для файла DSN не вернул успешное соединение.<br /><br /> Не мог написать в файл.|  
|ODBC_ERROR_OUT_OF_MEM|Недостаточно памяти|Установщик не мог выполнить функцию из-за отсутствия памяти.|  
  
## <a name="comments"></a>Комментарии  
 Если *hwnd* является нулевым, **S'LCreateDataSource** возвращает FALSE. В противном случае он отображает диалоговый ящик **Create New Data Source** со страницей мастера для выбора типа источника данных, который будет настроен, как показано на следующей иллюстрации.  
  
 ![Диалоговое окно создания нового источника данных: выбор типа](../../../odbc/reference/syntax/media/ch23a.gif "CH23A")  
  
 Опция по умолчанию — **Источник данных файла**. При выборе источника данных и нажатии **кнопки Next** отображается следующая страница мастера, содержащая список установленных драйверов.  
  
 ![Диалоговое окно создания нового источника данных: выбор драйвера](../../../odbc/reference/syntax/media/ch23b.gif "CH23B")  
  
 Если **нажат На кнопку «Отмена»,** поле диалога исчезает, а **s'LCreateDataSource** возвращает FALSE с кодом ошибки ODBC_ERROR_USER_CANCELED. Если выбран **источник данных пользователя** или опция **"Источник системных данных",** кнопка **Advanced** недоступна.  
  
 При нажатии **кнопки Next** будет происходить одна из следующих, в зависимости от того, какой тип источника данных был выбран:  
  
-   При выборе **источника данных файла** отображается страница мастера для пользователя для ввода имени файла.  
  
-   Если выбран **источник пользовательских данных** или **источник системных данных,** для просмотра отображается страница мастера, отображающая тип источника данных и драйвера, и при нажатии на **finish—** настроен источник данных.  
  
 Если **Расширенный** нажал на страницу Мастера Создать новый источник данных, страница мастера отображается для пользователя, чтобы ввести информацию о драйвере. В текстовом поле этого диалогового окна введите драйвер и ключевые слова, разделенные возвратами, как показано на следующей иллюстрации.  
  
 ![Диалоговое окно дополнительных настроек создания файлового DSN](../../../odbc/reference/syntax/media/ch23c.gif "CH23C")  
  
 Дополнительные ключевые слова для конкретных драйверов можно найти под описанием **S'LDriverConnect.** Разрешены все, кроме **DSN.**  
  
 По умолчанию для **параметра Verify This Connection** является правдой. Этот по умолчанию применяется независимо от того, активирована эта страница мастера. При нажатии **OK** строка, указанная в текстовом поле, и значение опции **Verify This Connection** конструированы. (При нажатии кнопки **"Закрыть"** или **"Отмена"** теряется любая недавно введенная информация о драйвере, поскольку строка, указанная в текстовом поле, и значение опции **Verify This Connection** не кэшируется.)  
  
 Если **источник данных файла** был выбран на первой странице мастера, то после того, как драйвер был выбран и значения ключевых слов были введены в страницу Advanced wizard, пользователю предлагается ввести имя файла. Нажмите **«Прожектор»** для поиска имени файла, и в этом случае каталог по умолчанию в поле **Browse** указан комбинацией пути, указанного CommonFileDir в HKEY_LOCAL_MACHINE»-ПРОГРАММА»Microsoft»Windows»CurrentVersion и «ODBC»DataSources». (Если Бы CommonFileDir был "C:'Программные файлы "Общие файлы", каталог по умолчанию будет "C:'Программные файлы "Общие файлы"ODBC "Источники данных".)  
  
 При входе имени файла и нажатии **кнопки Next** введомое имя файла проверяется на достоверность в соответствии со стандартными правилами именования файлов операционной системы. Если имя файла является недействительным, поле сообщения об ошибке уведомляет пользователя о том, что имя недействительного файла было введено. После того, как пользователь признает поле сообщения, фокус возвращается на страницу мастера, на которой вводится имя файла. Если имя файла является действительным, страница мастера, показываював выбранные пары значения ключевых слов, отображается для просмотра, как показано на следующей иллюстрации.  
  
 ![Диалоговое окно создания нового источника данных: проверка](../../../odbc/reference/syntax/media/ch23d.gif "CH23D")  
  
 Если **завершена** нажатие и **источник данных файла** был выбран в качестве типа источника данных, и если **проверить эту** опцию подключения является правдой, **S'LDriverConnect** называется с **ключевыми** словами SAVEFILE и **DRIVER.** Аргумент *DriverCompletion* установлен на SQL_DRIVER_COMPLETE. Имя файла для ключевого слова **SAVEFILE** — это имя, которое было введено или выбрано, а имя драйвера для ключевого слова **DRIVER** — это выбранное имя. Если строка соединения, специфичную для драйвера, была указана на странице Advanced wizard, эта строка присоединена после ключевого слова **DRIVER.**  
  
 Если **sLDriverConnect** возвращается SQL_SUCCESS, менеджер драйвера создал файл DSN. **СЗЛСоздатьДатаИсточник** возвращает TRUE. Если **S'LDriverConnect** не возвращается SQL_SUCCESS, поле предупреждения указывает на то, что подключение к источнику данных не может быть подключено. DSN с минимальной информацией о подключении все еще может быть создан. Это поле сообщения позволяет пользователю либо отменить или продолжить создание файла DSN.  
  
 Если пользователь решит продолжить создание DSN, этот процесс продолжается так, как если бы параметр **Проверки этого соединения** был установлен false. Если пользователь решит отменить, FALSE возвращается на **s'LCreateDataSource** с кодом ошибки ODBC_ERROR_CREATE_DSN_FAILED.  
  
 Если **источник данных файла** был выбран в качестве типа источника данных и **проверка этого варианта соединения** FALSE, файл DSN создается с ключевым словом **DRIVER** и пользователь-определенный строки подключения (если таковые имеются) из расширенный мастер странице. Если создание файла было успешным, TRUE возвращается для **S'LCreateDataSource**. Если создание файла не было успешным, окно сообщения об ошибке уведомляет пользователя о любой ошибке, которая была возвращена из операционной системы. FALSE возвращается на **s'LCreateDataSource** с кодом ошибки ODBC_ERROR_CREATE_DSN_FAILED. Для получения дополнительной информации об источниках файлов, [см. Подключение С помощью источников файловых данных,](../../../odbc/reference/develop-app/connecting-using-file-data-sources.md)или см. [SQLDriverConnect](../../../odbc/reference/syntax/sqldriverconnect-function.md)  
  
 Если **пользователь** или **источник системных данных** был выбран в качестве типа источника данных, **ConfigDSN** в библиотеке установки драйверов вызывается с ODBC_ADD_DSN *fRequest*. Для получения дополнительной информации [см.](../../../odbc/reference/syntax/configdsn-function.md)  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Управление источниками данных|[SQLManageDataSources](../../../odbc/reference/syntax/sqlmanagedatasources.md)|
