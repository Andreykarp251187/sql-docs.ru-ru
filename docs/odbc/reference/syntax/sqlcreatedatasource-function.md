---
title: Функция SQLCreateDataSource | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLCreateDataSource
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLCreateDataSource
helpviewer_keywords:
- SQLCreateDataSource function [ODBC]
ms.assetid: 76ee851a-dca9-40cc-8e9e-eb3f74e560ee
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 8b432e8d40952574f1264e07a0b09e91a1e334b3
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "65537604"
---
# <a name="sqlcreatedatasource-function"></a>Функция SQLCreateDataSource
**Соответствие стандартам**  
 Представленные версии: ODBC 2.0  
  
 **Сводка**  
 **SQLCreateDataSource** отображает диалоговое окно, с помощью которого пользователь может добавить источник данных.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
BOOL SQLCreateDataSource(  
     HWND    hwnd,  
     LPSTR   lpszDS);  
```  
  
## <a name="arguments"></a>Аргументы  
 *HWND*  
 [Вход] Дескриптор родительского окна.  
  
 *lpszDS*  
 [Вход] Имя источника данных. *lpszDS* может быть пустым указателем или пустой строкой.  
  
## <a name="returns"></a>Возвращает  
 **SQLCreateDataSource** возвращает TRUE, если создается источник данных. В противном случае возвращается значение FALSE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLCreateDataSource** возвращает значение FALSE, связанным  *\*pfErrorCode* значение можно получить, вызвав **SQLInstallerError**. В следующей таблице перечислены  *\*pfErrorCode* значения, которые могут быть возвращены **SQLInstallerError** и объясняется каждый из них в контексте этой функции.  
  
|*\*pfErrorCode*|Ошибка|Описание|  
|---------------------|-----------|-----------------|  
|ODBC_ERROR_GENERAL_ERR|Ошибки общие установщика|Произошла ошибка для которой нет ошибок определенных установщика.|  
|ODBC_ERROR_INVALID_HWND|Недопустимый дескриптор окна|*Hwnd* аргумент был недопустимым, или значение NULL.|  
|ODBC_ERROR_INVALID_DSN|Недопустимое имя источника данных|*LpszDS* аргумент содержит строку, которая была недопустимое имя источника данных.|  
|ODBC_ERROR_REQUEST_FAILED|*Запросить* сбой|Вызов **ConfigDSN** с параметром ODBC_ADD_DSN не удалось.|  
|ODBC_ERROR_LOAD_LIBRARY_FAILED|Не удалось загрузить библиотеку установки драйвера или перевода|Не удалось загрузить библиотеку установки драйвера.|  
|ODBC_ERROR_USER_CANCELED|Операция отменена пользователем|Создание нового источника данных отменена пользователем.|  
|ODBC_ERROR_CREATE_DSN_FAILED|Не удалось создать запрошенный DSN|Не удалось подключиться к базе данных; вызов **SQLDriverConnect** для файлового имени DSN не возвратил успешное подключение.<br /><br /> Не удалось записать в файл.|  
|ODBC_ERROR_OUT_OF_MEM|Недостаточно памяти|Программа установки не удалось выполнить функцию из-за нехватки памяти.|  
  
## <a name="comments"></a>Комментарии  
 Если *hwnd* имеет значение null, **SQLCreateDataSource** возвращает значение FALSE. В противном случае он отображает **Создание нового источника данных** диалоговое окно со страницей мастера для выбора типа источника данных для настройки, как показано на следующем рисунке.  
  
 ![Создание диалогового окна нового источника данных: выберите тип](../../../odbc/reference/syntax/media/ch23a.gif "CH23A")  
  
 Значение по умолчанию — **источник данных файла**. Если выбран источник данных и **Далее** нажатии отобразится следующая страница мастера, со списком установленных драйверов.  
  
 ![Создание диалогового окна нового источника данных: Выбор драйвера](../../../odbc/reference/syntax/media/ch23b.gif "CH23B")  
  
 Если **отменить** нажатии диалогового окна поле исчезло и **SQLCreateDataSource** возвращает значение FALSE с кодом ошибки ODBC_ERROR_USER_CANCELED. Если параметр **источника данных** или **системный источник данных** параметр был выбран, **Дополнительно** недоступна.  
  
 Когда **Далее** кнопки, будет выполнено одно из следующих действий, в зависимости от того, какой тип данных был выбран источник:  
  
-   Если **источник данных файла** был установлен, пользователь может ввести имя файла отображается страница мастера.  
  
-   Если параметр **источника данных** или **системный источник данных** был выбран, для просмотра, отображается страница мастера, отображения типа источника данных и драйвера и когда **Готово** — нажата, источник данных настроен.  
  
 Если **Дополнительно** щелчке на странице мастера создайте новый источник данных, страница мастера отображается для пользователю ввести сведения, относящиеся к драйверу. Введите в поле "текст" это диалоговое окно драйвера и ключевые слова, разделенные, как показано на следующем рисунке.  
  
 ![Диалоговое окно настроек создания файлового DSN Advance](../../../odbc/reference/syntax/media/ch23c.gif "CH23C")  
  
 Дополнительные ключевые слова специфические для драйвера можно найти в описании **SQLDriverConnect**. Все, кроме **DSN** разрешены.  
  
 По умолчанию для **этим подключением, проверьте** параметр имеет значение TRUE. Это значение по умолчанию применяется независимо от того, имеется ли эта страница мастера активации. Если **ОК** выбран, строки, указанной в текстовом поле и **этим подключением, проверьте** кэшируются значение параметра. (Если **закрыть** кнопку или **отменить** нажатии любой недавно введенные сведения, относящиеся к драйверу теряется, так как строки, указанные в текстовом поле и **этим подключением, проверьте** значение параметра не кэшируются.)  
  
 Если **источник данных файла** был выбран на первой странице мастера, а затем драйвер был выбран и ключевое слово значения были введены в странице мастер расширенной настройки, пользователю предлагается ввести имя файла. Нажмите кнопку **Обзор** для поиска имени файла, в противном случае каталога по умолчанию в **Обзор** поле указывается с помощью сочетания пути, указанному свойством CommonFileDir в HKEY_LOCAL_MACHINE\SOFTWARE\ Microsoft\Windows\CurrentVersion и «ODBC\DataSources». (Если CommonFileDir «C:\Program Files\Common Files», каталог по умолчанию будет «C:\Program Files\Common Files\ODBC\Data источников».)  
  
 Если было введено имя файла и **Далее** выбран, файл введенное имя проверяется на допустимость по стандартным правилам именования файлов операционной системы. Если имя файла является недопустимым, сообщение об ошибке сообщает пользователю, что указано недопустимое имя файла. После того, как пользователь подтверждает окно сообщения, фокус возвращается на страницу мастера, в котором вводится имя файла. Если имя файла является допустимым, страницы мастера, которая отображает пары "выбранное слово значение" отображается на проверку, как показано на следующем рисунке.  
  
 ![Создание диалогового окна нового источника данных: просмотрите](../../../odbc/reference/syntax/media/ch23d.gif "CH23D")  
  
 Если **Готово** нажатии и **источник данных файла** была выбрана в качестве типа источника данных и если **проверить связь** параметр имеет значение TRUE,  **SQLDriverConnect** вызывается с **SAVEFILE** и **ДРАЙВЕР** ключевые слова. *DriverCompletion* аргумент имеет значение SQL_DRIVER_COMPLETE. Имя файла для **SAVEFILE** ключевое слово является имя, введенное или выбранное и имя драйвера для **ДРАЙВЕР** ключевое слово является именем, которая была выбрана. Если строка подключения драйвера был указан на странице мастер расширенной настройки, эта строка добавляется после **ДРАЙВЕР** ключевое слово.  
  
 Если **SQLDriverConnect** возвращает SQL_SUCCESS, диспетчер драйверов создала файлового имени DSN. **SQLCreateDataSource** возвращает значение TRUE. Если **SQLDriverConnect** не возвращает значение SQL_SUCCESS, предупреждающее сообщение поле указывает, что может не быть соединение с источником данных. Имя источника данных с информацией о соединении с минимальными по-прежнему могут создаваться. Это окно сообщения пользователь может отменить или продолжить создание файлового имени DSN.  
  
 Если пользователь нажимает продолжить создание источника данных, этот процесс продолжается так, как если **проверить связь** параметр было присвоено значение FALSE. Если пользователь решит отменить, возвращается значение FALSE для **SQLCreateDataSource** с кодом ошибки ODBC_ERROR_CREATE_DSN_FAILED.  
  
 Если **файла источника данных** была выбрана в качестве типа источника данных и **проверить связь** параметр имеет значение FALSE, создается файловый DSN **ДРАЙВЕР** ключевое слово и Определяемое пользователем строка подключения (если таковые имеются) на странице мастер расширенной настройки. Если создание файла прошла успешно, возвращается значение TRUE для **SQLCreateDataSource**. Если для создания файла не выполнена, сообщение об ошибке уведомляет пользователя с любой ошибка возвращена из операционной системы. Возвращается значение FALSE для **SQLCreateDataSource** с кодом ошибки ODBC_ERROR_CREATE_DSN_FAILED. Дополнительные сведения о файловых источников данных, см. в разделе [подключение с использованием файловых источников данных](../../../odbc/reference/develop-app/connecting-using-file-data-sources.md), или см. в разделе [SQLDriverConnect](../../../odbc/reference/syntax/sqldriverconnect-function.md).  
  
 Если **пользователя** или **системный источник данных** была выбрана в качестве типа источника данных, **ConfigDSN** в настройке драйвера библиотеки вызывается с ODBC_ADD_DSN  *fRequest*. Дополнительные сведения см. в разделе [ConfigDSN](../../../odbc/reference/syntax/configdsn-function.md).  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Управление источниками данных|[SQLManageDataSources](../../../odbc/reference/syntax/sqlmanagedatasources.md)|
