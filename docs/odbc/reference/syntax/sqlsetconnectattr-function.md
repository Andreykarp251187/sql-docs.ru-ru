---
title: Функция S'LSetConnectattr Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLSetConnectAttr
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLSetConnectAttr
helpviewer_keywords:
- SQLSetConnectAttr function [ODBC]
ms.assetid: 97fc7445-5a66-4eb9-8e77-10990b5fd685
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 8424462ddde4f99196e26d633fddfa5bb2ed6ee9
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81301940"
---
# <a name="sqlsetconnectattr-function"></a>Функция SQLSetConnectAttr
**Соответствия**  
 Представлена версия: Соответствие стандартам ODBC 3.0: ISO 92  
  
 **Сводка**  
 **SLSetConnectAttr** устанавливает атрибуты, которые регулируют аспекты соединений.  
  
> [!NOTE]
>  Для получения дополнительной информации о том, что менеджер *.x* драйвера драйвера драйвера *.x* управления драйвером, [см.](../../../odbc/reference/develop-app/mapping-replacement-functions-for-backward-compatibility-of-applications.md)  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLSetConnectAttr(  
     SQLHDBC       ConnectionHandle,  
     SQLINTEGER    Attribute,  
     SQLPOINTER    ValuePtr,  
     SQLINTEGER    StringLength);  
```  
  
## <a name="arguments"></a>Аргументы  
 *ПодключениеРучка*  
 [Input] Дескриптор подключения  
  
 *Атрибут*  
 (Вход) Атрибут для набора, перечисленные в "Комментарии".  
  
 *ValuePtr*  
 (Вход) Указатель на значение, связанное с *атрибутом.* В зависимости от значения *Attribute,* *ValuePtr* будет неподписанным значением integer или укажет на строку символов с нулевым завершением. Обратите внимание, что интегральный тип аргумента *Attribute* не может быть фиксированной длиной, см.  
  
 *Струнная длина*  
 (Вход) Если *Attribute* является атрибутом, определяемым ODBC, и *ValuePtr* указывает на строку символов или бинарный буфер, этот аргумент должен быть длиной*в значение ValuePtr.* Для данных строки символов этот аргумент должен содержать количество байтов в строке.  
  
 Если *Attribute* является атрибутом, определяемым ODBC, а *ValuePtr* — неопределенным, *StringLength* игнорируется.  
  
 Если *атрибут* является атрибутом, определяемым драйвером, приложение указывает характер атрибута менеджеру драйвера, установив аргумент *StringLength.* *StringLength* может иметь следующие значения:  
  
-   Если *ValuePtr* является указателем на строку персонажа, то *StringLength* — это длина строки или SQL_NTS.  
  
-   Если *ValuePtr* является указателем на двоичный буфер, то приложение помещает результат SQL_LEN_BINARY_ATTR *(длина)* макроса в *StringLength.* Это ставит отрицательное значение в *StringLength*.  
  
-   Если *ValuePtr* является указателем на значение, кроме строки символов или двоичной строки, то *StringLength* должен иметь значение SQL_IS_POINTER.  
  
-   Если *ValuePtr* содержит значение с фиксированной длиной, то *StringLength* является либо SQL_IS_INTEGER, либо SQL_IS_UINTEGER, в случае необходимости.  
  
## <a name="returns"></a>Результаты  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_ERROR, SQL_INVALID_HANDLE или SQL_STILL_EXECUTING.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **S'LSetConnectAttr** возвращается SQL_ERROR или SQL_SUCCESS_WITH_INFO, связанное с этим значение S'LSTATE можно получить, позвонив по **телефону S'LGetDiagRec** с *помощью HandleType* of SQL_HANDLE_DBC и *ручки* *ConnectionHandle.* В следующей таблице перечислены значения S'LSTATE, обычно возвращаемые **S'LSetConnectAttr,** и приведены в изъяны каждое из них в контексте этой функции; нотация "(DM)" предшествует описаниям S'LSTATEs, возвращенным менеджером драйвера. Код возврата, связанный с каждым значением S'LSTATE, является SQL_ERROR, если не указано иное.  
  
 Водитель может вернуть SQL_SUCCESS_WITH_INFO предоставить информацию о результатах установки опции.  
  
|SQLSTATE|Error|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Информационное сообщение, конкретное для водителя. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|01S02|Изменение значения опциона|Водитель не поддержал значение, указанное в *ValuePtr,* и заменил аналогичное значение. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|08002|Имя соединения в использовании|Аргумент *Attribute* был SQL_ATTR_ODBC_CURSORS, и водитель уже был подключен к источнику данных.|  
|08003|Подключение не открыто|(DM) Было указано значение *атрибута,* которое требовало открытого соединения, но *ConnectionHandle* не находился в подключенном состоянии.|  
|08S01|Сбой связи|Связь между драйвером и источником данных, к которому был подключен драйвер, не сработала до завершения обработки функции.|  
|24 000|Недопустимое состояние курсора|Аргумент *Attribute* был SQL_ATTR_CURRENT_CATALOG, и набор результатов находится на рассмотрении.|  
|25000|Незаконная операция в локальной транзакции|Соединение находилось в локальной транзакции при попытке завербовать в распределенное соединение транзакции (DTC) путем установки атрибута соединения SQL_ATTR_ENLIST_IN_DTC.<br /><br /> Соединение уже зачислено в DTC.<br /><br /> Подключение было зачислено в распределенное соединение транзакции, и локальная транзакция была начата путем установки SQL_ATTR_AUTOCOMMIT SQL_AUTOCOMMIT_OFF.|  
|3D000|Недействительное название каталога|Аргумент *Attribute* был SQL_CURRENT_CATALOG, а указанное название каталога было недействительным.|  
|HY000|Общая ошибка|Произошла ошибка, в соответствии с которой не было конкретного S'LSTATE и для которой не было определено конкретное осуществление СЗЛСТАТ. Сообщение об ошибке, возвращенное **S'LGetDiagRec** в * \*буфере MessageText,* описывает ошибку и ее причину.|  
|HY001|Ошибка распределения памяти|Водитель не смог выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY008|Operation canceled|Асинхронная обработка была включена для *ConnectionHandle*. Функция **S'LSetConnectAttr** была вызвана, и перед завершением выполнения [функция S'LCancelHandle](../../../odbc/reference/syntax/sqlcancelhandle-function.md) была вызвана на *ConnectionHandle,* а затем функция **S'LSetConnectAttr** была снова вызвана на *ConnectionHandle.*<br /><br /> Или функция **S'LSetConnectAttr** была вызвана, и перед завершением **выполнения, S'LCancelHandle** был вызван на *ConnectionHandle* из другого потока в многопоточном приложении.|  
|HY009|Недействительное использование нулевой указатель|Аргумент *Attribute* определил атрибут соединения, который требует значения строки, а аргумент *ValuePtr* был нулевой указателем.|  
|HY010|Ошибка последовательности функций|(DM) Асинхронно выполнение функции был вызван для *statementHandle,* связанных с *ConnectionHandle* и по-прежнему выполнения, когда **S'LSetConnectAttr** был вызван.<br /><br /> (DM) Асинхронно выполнение функции (не этот) был вызван для *ConnectionHandle* и по-прежнему выполнения, когда эта функция была вызвана.<br /><br /> (DM) **S'LExecute**, **S'LExecDirect**, или **S'LMoreResults** был вызван для одной из декретов оператора, связанных с *ConnectionHandle* и возвращенных SQL_PARAM_DATA_AVAILABLE. Эта функция была вызвана до того, как данные были извлечены для всех потоковых параметров.<br /><br /> (DM) **S'LExecute**, **S'LExecDirect**, **S'LBulkOperations**, или **S'LSetPos** был вызван для *выписки,* связанные с *ConnectionHandle* и вернулся SQL_NEED_DATA. Эта функция была вызвана до отправки данных для всех параметров или столбцов данных.<br /><br /> (DM) **S'LBrowseConnect** был вызван для *ConnectionHandle* и вернулся SQL_NEED_DATA. Эта функция была вызвана до того, как **s'LBrowseConnect** вернулся SQL_SUCCESS_WITH_INFO или SQL_SUCCESS.|  
|HY011|Атрибут не может быть установлен сейчас|Аргумент *Attribute* был SQL_ATTR_TXN_ISOLATION, и сделка была открыта.|  
|HY013|Ошибка управления памятью|Вызов функции не может быть обработан, поскольку основные объекты памяти не могут быть доступны, возможно, из-за низких условий памяти.|  
|HY024|Значение недействительных атрибутов|С учетом указанного значения *attribute,* недействительное значение было указано в *ValuePtr*. (Менеджер драйвера возвращает этот S'LSTATE только для атрибутов соединения и оператора, которые принимают дискретный набор значений, таких как SQL_ATTR_ACCESS_MODE или SQL_ATTR_ASYNC_ENABLE. Для всех остальных атрибутов соединения и оператора водитель должен проверить значение, указанное в *ValuePtr.)*<br /><br /> Аргумент *Attribute* был SQL_ATTR_TRACEFILE или SQL_ATTR_TRANSLATE_LIB, а *ValuePtr* был пустой строкой.|  
|HY090|Недействительная длина строки или буфера|*(DM) \*ValuePtr* является строкой символов, и аргумент *StringLength* был меньше, чем 0, но не был SQL_NTS.|  
|HY092|Недействительный идентификатор атрибута/опциона|(DM) Значение, указанное для аргумента *Attribute,* не было действительным для версии ODBC, поддерживаемой драйвером.<br /><br /> (DM) Значение, указанное для аргумента *Attribute,* было атрибутом только для чтения.|  
|HY114|Драйвер не поддерживает выполнение асинхронных функций уровня соединения|(DM) Приложение пыталось включить асинхронное выполнение функции с SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE для драйвера, который не поддерживает асинхронные операции соединения.|  
|HY117|Подключение приостанавливается из-за неизвестного состояния транзакции. Разрешены только отключить и прочитать только функции.|(DM) Для получения более подробной [SQLEndTran Function](../../../odbc/reference/syntax/sqlendtran-function.md)информации о приостановленном состоянии, см.|  
|HY121|Библиотека Cursor и пулирование драйверов не могут быть включены одновременно|Для получения дополнительной [Driver-Aware Connection Pooling](../../../odbc/reference/develop-app/driver-aware-connection-pooling.md)информации см.|  
|HYC00|Дополнительная функция не реализована|Значение, указанное для аргумента *Attribute,* было действительным атрибутом соединения ODBC или оператора для версии ODBC, поддерживаемой водителем, но не была поддержана водителем.|  
|HYT01|Срок истечения времени подключения|Период тайм-аута соединения истек до того, как источник данных ответил на запрос. Период тайм-аута соединения устанавливается через **S'LSetConnectAttr,** SQL_ATTR_CONNECTION_TIMEOUT.|  
|IM001|Драйвер не поддерживает эту функцию|(DM) Драйвер, связанный с *ConnectionHandle,* не поддерживает функцию.|  
|IM009|Невозможно загрузить перевод DLL|Водитель не смог загрузить перевод DLL, указанный для соединения. Эта ошибка может быть возвращена только при SQL_ATTR_TRANSLATE_LIB *атрибутики.*|  
|IM017|Опрос отключен в асинхронном режиме уведомления|Всякий раз, когда используется модель уведомления, опрос отключается.|  
|IM018|Для завершения предыдущей асинхронной операции на этой ручке не был вызван **S'LCompleteAsync.**|Если предыдущий вызов функции на ручке возвращается SQL_STILL_EXECUTING и если режим уведомления включен, **s'LCompleteAsync** должен быть вызван на ручку, чтобы сделать пост-обработку и завершить операцию.|  
|S1118|Водитель не поддерживает асинхронное уведомление|SQL_ATTR_ASYNC_DBC_EVENT был установлен (после подключения), но асинхронное уведомление не поддерживается водителем.|  
  
 Когда *атрибут* является атрибутом оператора, **S'LSetConnectAttr** может вернуть все S'LSTATEs, возвращенные **s'LSetStmtAttr.**  
  
## <a name="comments"></a>Комментарии  
 Для получения общей информации [Connection Attributes](../../../odbc/reference/develop-app/connection-attributes.md)об атрибутах соединения см.  
  
 В таблице позже в этом разделе показаны определенные в настоящее время атрибуты и версия ODBC, в которой они были введены; ожидается, что будут определены дополнительные атрибуты, с тем чтобы использовать различные источники данных. Диапазон атрибутов зарезервирован ODBC; разработчики драйверов должны резервировать значения для использования в открытом составе для собственного использования драйверов.  
  
> [!NOTE]
>  Возможность установки атрибутов оператора на уровне соединения, позвонив в **s'LSetConnectAttr,** была универсла в ODBC 3 *.x*. Приложения ODBC 3 *.x* никогда не должны устанавливать атрибуты оператора на уровне соединения. Атрибуты оператора ODBC 3 *.x* не могут быть установлены на уровне соединения, за исключением SQL_ATTR_METADATA_ID и SQL_ATTR_ASYNC_ENABLE атрибутов, которые являются атрибутами соединения и атрибутами оператора и могут быть установлены либо на уровне соединения, либо на уровне оператора.  
> 
>  OdBC 3 *.x* драйверам нужна только поддержка этой функциональности, если они должны работать с приложениями ODBC 2 *.x,* которые устанавливают параметры оператора ODBC 2 *.x* на уровне соединения. Для получения более подробной информации в приложении G: Руководство по обратной совместимости с [системой S'LSetConnectOption можно ознакомиться с информацией о s'LSetConnectOption.](../../../odbc/reference/appendixes/sqlsetconnectoption-mapping.md)  
  
 Приложение может вызывать **s'LSetConnectAttr** в любое время между моментом выделения и освобождения соединения. Все атрибуты соединения и оператора, успешно установленные приложением для соединения, сохраняются до тех пор, пока **не** будет вызвано соединение. Например, если приложение вызывает **S'LSetConnectAttr** перед подключением к источнику данных, атрибут сохраняется, даже если **S'LSetConnectAttr** выходит из строя в драйвере при подключении приложения к источнику данных; если приложение устанавливает атрибут для конкретного драйвера, атрибут сохраняется, даже если приложение подключается к другому драйверу на соединении.  
  
 Некоторые атрибуты соединения могут быть установлены только до того, как соединение было сделано; другие могут быть установлены только после подключения. В следующей таблице указаны атрибуты соединения, которые должны быть установлены до или после подключения. *Либо* указывает, что атрибут может быть установлен до или после соединения.  
  
|Атрибут|Устанавливается до или после подключения?|  
|---------------|-------------------------------------|  
|SQL_ATTR_ACCESS_MODE|Либо|  
|SQL_ATTR_ASYNC_DBC_EVENT|Можно использовать|  
|SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE|Либо|  
|SQL_ATTR_ASYNC_DBC_PCALLBACK|Можно использовать|  
|SQL_ATTR_ASYNC_DBC_PCONTEXT|Можно использовать|  
|SQL_ATTR_ASYNC_ENABLE|Либо|  
|SQL_ATTR_AUTO_IPD|Можно использовать|  
|SQL_ATTR_AUTOCOMMIT|Либо|  
|SQL_ATTR_CONNECTION_DEAD|После|  
|SQL_ATTR_CONNECTION_TIMEOUT|Можно использовать|  
|SQL_ATTR_CURRENT_CATALOG|Либо|  
|SQL_ATTR_DBC_INFO_TOKEN|После|  
|SQL_ATTR_ENLIST_IN_DTC|После|  
|SQL_ATTR_LOGIN_TIMEOUT|Перед|  
|SQL_ATTR_METADATA_ID|Можно использовать|  
|SQL_ATTR_ODBC_CURSORS|Перед|  
|SQL_ATTR_PACKET_SIZE|Перед|  
|SQL_ATTR_QUIET_MODE|Можно использовать|  
|SQL_ATTR_TRACE|Можно использовать|  
|SQL_ATTR_TRACEFILE|Можно использовать|  
|SQL_ATTR_TRANSLATE_LIB|После|  
|SQL_ATTR_TRANSLATE_OPTION|После|  
|SQL_ATTR_TXN_ISOLATION|Либо|  
  
 SQL_ATTR_ACCESS_MODE и SQL_ATTR_CURRENT_CATALOG могут быть установлены до или после подключения, в зависимости от водителя. Тем не менее, совместимые приложения устанавливают их перед подключением, поскольку некоторые драйверы не поддерживают их после подключения.  
  
 SQL_ATTR_ASYNC_ENABLE должны быть установлены до того, как будет активное заявление.  
  
 SQL_ATTR_TXN_ISOLATION может быть установлена только в том случае, если на подключении нет открытых транзакций. Некоторые атрибуты соединения поддерживают замену аналогичного значения, если источник \*данных не поддерживает значение, указанное в *ValuePtr.* В таких случаях водитель возвращает SQL_SUCCESS_WITH_INFO и S'LSTATE 01S02 (изменение стоимости опциона). Например, если *attribute* \*SQL_ATTR_PACKET_SIZE и *ValuePtr* превышает максимальный размер пакета, драйвер заменяет максимальный размер. Чтобы определить замещенное значение, приложение вызывает **S'LGetConnectAttr**.  
  
 Если SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE установлен до открытия соединения, менеджер драйвера установит атрибут драйвера при загрузке драйвера во время звонка в **S'LBrowseConnect,** **S'LConnect**или **S'LDriverConnect.** Перед вызовом на **веб-страницы,** **s'L-Connect**или **S'LDriverConnect,** менеджер драйвера не знает, к какому драйверу подключиться, и не знает, поддерживает ли драйвер асинхронные операции соединения. Таким образом, менеджер драйвера всегда возвращает SQL_SUCCESS. Но, в случае, если драйвер не поддерживает асинхронные операции подключения, вызов на **S'LBrowseConnect**, **S'LConnect**, или **S'LDriverConnect** не удастся.  
  
 При установке SQL_ATTR_AUTOCOMMIT FALSE приложения должны вызывать s'LEndTran (SQL_ROLLBACK), если какой-либо API возвращается SQL_ERROR для обеспечения согласованности транзакций.  
  
 Формат информации, установленной в буфере \* *ValuePtr,* зависит от указанного *атрибута.* **SLSetConnectAttr** будет принимать информацию об атрибутах в одном из двух различных форматов: строка символов с нулевым завершением или рядное значение. Формат каждого из них указан в описании атрибута. Строки символов, на которые указывает аргумент *ValuePtr* **о S'LSetConnectAttr,** имеют длину *байтов Струнного Длины.*  
  
 Аргумент *StringLength* игнорируется, если длина определяется атрибутом, как это имеет место для всех атрибутов, введенных в ODBC 2 *.x* или ранее.  
  
|*Атрибут*|*Содержимое ValuePtr*|  
|-----------------|-------------------------|  
|SQL_ATTR_ACCESS_MODE (ODBC 1.0)|Значение СЗЛУИНТЕГЕР. SQL_MODE_READ_ONLY используется драйвером или источником данных в качестве индикатора того, что соединение не требуется для поддержки инструкций S'L, которые вызывают возникновение обновлений. Этот режим можно использовать для оптимизации стратегий блокировки, управления транзакциями или других областей, соответствующих драйверу или источнику данных. Водитель не обязан препятствовать отправке таких заявлений в источник данных. Поведение драйвера и источника данных при запросе для обработки инструкций s'L, которые не читаются только во время подключения только для чтения, определяется реализацией. SQL_MODE_READ_WRITE является значением по умолчанию.|  
|SQL_ATTR_ASYNC_DBC_EVENT (ODBC 3.8)|Значение S'LPOINTER, которое является ручкой событий.<br /><br /> Уведомление о завершении асинхронных функций включено, позвонив в **S'LSetConnectAttr** с SQL_ATTR_ASYNC_STMT_EVENT атрибутом и указав ручку события. **Примечание:**  Метод уведомления не поддерживается библиотекой курсоров. Приложение будет получать сообщение об ошибке, если оно попытается включить библиотеку курсоров через S'LSetConnectAttr, когда будет включен метод уведомления.|  
|SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE (ODBC 3.8)|Значение S-LUINTEGER, которое позволяет или отклоняет асинхронное выполнение выбранных функций на ручке соединения. Для получения дополнительной информации [см.](../../../odbc/reference/develop-app/asynchronous-execution-polling-method.md)<br /><br /> SQL_ASYNC_DBC_ENABLE_ON - Включить асинхронную операцию для определенных функций, связанных с подключением.<br /><br /> SQL_ASYNC_DBC_ENABLE_OFF (по умолчанию) отключить асинхронную операцию для определенных функций, связанных с подключением.<br /><br /> Установка SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE всегда синхронна (то есть, она никогда не вернется SQL_STILL_EXECUTING).<br /><br /> Асинхронное выполнение операций оператора включено с SQL_ATTR_ASYNC_ENABLE.|  
|SQL_ATTR_ASYNC_DBC_PCALLBACK (ODBc 3.8)|Значение S'LPOINTER, которое указывает на структуру контекста.<br /><br /> Только менеджер драйвера может вызвать функцию **драйвера S'LSetStmtAttr** с помощью этого атрибута.|  
|SQL_ATTR_ASYNC_DBC_PCONTEXT (ODBC 3.8)|Значение S'LPOINTER, которое указывает на структуру контекста.<br /><br /> Только менеджер драйвера может вызвать функцию **драйвера S'LSetStmtAttr** с помощью этого атрибута.|  
|SQL_ATTR_ASYNC_ENABLE (ODBC 3.0)|Значение S'LULEN, определяемый, выполняется ли функция, вызванная с помощью оператора по указанному подключению, асинхронно:<br /><br /> SQL_ASYNC_ENABLE_OFF - асинхронная поддержка выполнения уровня соединения для операций оператора (по умолчанию).<br /><br /> SQL_ASYNC_ENABLE_ON - Включить асинхронную поддержку выполнения уровня соединения для операций оператора.<br /><br /> Этот атрибут может быть установлен независимо от того, возвращается ли SQL_AM_CONNECTION или SQL_AM_STATEMENT тип информации с **SQL_ASYNC_MODE** типом информации.|  
|SQL_ATTR_AUTO_IPD (ODBC 3.0)|Значение, основанное только на считывании S'LUINTEGER, которое определяет, поддерживается ли автоматическое население IPD после вызова **в S'LPrepare:**<br /><br /> SQL_TRUE - Автоматическая популяция IPD после вызова в **S'LPrepare** поддерживается водителем.<br /><br /> SQL_FALSE - Автоматическое население IPD после вызова в **S'LPrepare** не поддерживается водителем. Серверы, не поддерживающие подготовленные операторы, не смогут автоматически заполнять IPD.<br /><br /> При возврате SQL_TRUE для атрибута SQL_ATTR_AUTO_IPD соединения может быть установлен атрибут оператора, SQL_ATTR_ENABLE_AUTO_IPD для включания или выключения автоматической популяции IPD. Если SQL_ATTR_AUTO_IPD SQL_FALSE, SQL_ATTR_ENABLE_AUTO_IPD не может быть установлен на SQL_TRUE. Значение SQL_ATTR_ENABLE_AUTO_IPD по умолчанию равно значению SQL_ATTR_AUTO_IPD.<br /><br /> Этот атрибут соединения может быть возвращен **с помощью S'LGetConnectAttr,** но не может быть установлен **S'LSetConnectAttr.**|  
|SQL_ATTR_AUTOCOMMIT (ODBC 1.0)|Значение S-LUINTEGER, которое определяет, следует ли использовать режим автоматического или ручного коммит:<br /><br /> SQL_AUTOCOMMIT_OFF - Драйвер использует режим ручного коммита, и приложение должно явно совершать или откатывать транзакции с **помощью S'LEndTran.**<br /><br /> SQL_AUTOCOMMIT_ON - Драйвер использует режим автоматического коммивояжера. Каждое заявление совершается сразу после его выполнения. Это значение по умолчанию. Любые открытые транзакции в подключении совершаются, когда SQL_ATTR_AUTOCOMMIT настроена на SQL_AUTOCOMMIT_ON, чтобы перейти от ручного режима к режиму автоматического коммификации.<br /><br /> Для получения дополнительной информации [см.](../../../odbc/reference/develop-app/commit-mode.md) **Важно:**  Некоторые источники данных удаляют планы доступа и закрывают курсоры для всех инструкций по подключению каждый раз, когда оператор совершается; режим автоматического выполнения может привести к тому, что это произойдет после выполнения каждой незакавной выписки или при закрытии курсора для запроса. Для получения более подробной информации ознакомьтесь с SQL_CURSOR_COMMIT_BEHAVIOR и SQL_CURSOR_ROLLBACK_BEHAVIOR типами информации в [S'LGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md) и [о влиянии транзакций на курсоры и подготовленные заявления.](../../../odbc/reference/develop-app/effect-of-transactions-on-cursors-and-prepared-statements.md) <br /><br /> Когда пакет выполняется в режиме автоматического выполнения, возможны две вещи. Вся партия может рассматриваться как автоматически выполнимая единица, или каждое утверждение в партии рассматривается как автоматофикатируемый блок. Некоторые источники данных могут поддерживать оба этих поведения и могут обеспечить способ выбора одного или другого. Определяется ли партия как автоматически выдавливаемый блок или каждое отдельное утверждение в пакете автоматически выопределяето.|  
|SQL_ATTR_CONNECTION_DEAD<br /><br /> (ODBC 3.5)|Значение только для чтения S'LUINTEGER, которое указывает состояние соединения. Если SQL_CD_TRUE, соединение было потеряно. Если SQL_CD_FALSE, подключение по-прежнему активируется.|  
|SQL_ATTR_CONNECTION_TIMEOUT (ODBc 3.0)|Значение S-LUINTEGER, соответствующее количеству секунд, чтобы дождаться завершения любого запроса на подключение, перед возвращением в приложение. Водитель должен вернуть S'LSTATE HYT00 (Тайм-аут истек) в любое время, что можно тайм-аут в ситуации, не связанной с выполнением запроса или логин.<br /><br /> Если *ValuePtr* равен 0 (по умолчанию), тайм-аут отсутствует.|  
|SQL_ATTR_CURRENT_CATALOG (ODBC 2.0)|Строка символов, содержащая название каталога, который будет использоваться источником данных. Например, в сервере S'L Server каталог является базой данных, поэтому драйвер отправляет выписку \* _базы данных_ **USE** в источник данных, где база *данных* является базой данных, указанной в *ValuePtr.* Для одноуровневого драйвера каталог может быть каталогом, поэтому драйвер изменяет свой текущий каталог в каталог, указанный в*значение.*|  
|SQL_ATTR_DBC_INFO_TOKEN (ODBC 3.8|Значение S'LPOINTER, используемое для того, чтобы вернуть токен информации о подключении в ручку DBC, когда параметр [S'LRateConnection](../../../odbc/reference/syntax/sqlrateconnection-function.md)'s\**(pRating)* не равен 100.<br /><br /> SQL_ATTR_DBC_INFO_TOKEN установлена только. Для получения этого значения невозможно использовать **s'LGetConnectAttr** или **S'LGetConnectOption.** Менеджер драйвера **s'LSetConnectAttr** не принимает SQL_ATTR_DBC_INFO_TOKEN, так как приложение не должно устанавливать этот атрибут.<br /><br /> Если водитель возвращается SQL_ERROR после установки SQL_ATTR_DBC_INFO_TOKEN, соединение, только что полученное из пула, будет освобождено. Менеджер драйвера попытается получить другое соединение из пула. Дополнительную информацию можно узнать [о разработке информации о подключении-пуле в драйвере ODBC.](../../../odbc/reference/develop-driver/developing-connection-pool-awareness-in-an-odbc-driver.md)|  
|SQL_ATTR_ENLIST_IN_DTC (ODBc 3.0)|Значение S'LPOINTER, которое определяет, следует ли использовать драйвер ODBC в распределенных транзакциях, координируемых службами Microsoft Component Services.<br /><br /> Передайте объект транзакции DTC OLE, который определяет транзакцию для экспорта на сервер S'L, или SQL_DTC_DONE, чтобы положить конец ассоциации DTC соединения.<br /><br /> Клиент вызывает координатора распределенных транзакций Майкрософт (MS DTC) OLE ITransactionDispenser::BeginTransaction метод, чтобы начать транзакцию MS DTC и создать объект транзакции MS DTC, представляющий транзакцию. Затем приложение вызывает S'LSetConnectAttr с SQL_ATTR_ENLIST_IN_DTC возможность связать объект транзакции с подключением ODBC. Все связанные действия базы данных будут выполняться под защитой транзакции MS DTC. Приложение вызывает SQLSetConnectAttr с параметром SQL_DTC_DONE, чтобы завершить связь соединения с координатором распределенных транзакций. Дополнительные сведения см. в документации по MS DTC.|  
|SQL_ATTR_LOGIN_TIMEOUT (ODBC 1.0)|Значение S-LUINTEGER, соответствующее количеству секунд, чтобы дождаться завершения запроса на входе, перед возвращением в приложение. По умолчанию зависит от драйвера. Если *ValuePtr* равен 0, тайм-аут отключен, и попытка подключения будет ждать бесконечно.<br /><br /> Если указанный тайм-аут превышает максимальный тайм-аут входа в источник данных, драйвер заменяет это значение и возвращает S'LSTATE 01S02 (изменение значения опциона).|  
|SQL_ATTR_METADATA_ID (ODBc 3.0)|Значение S'LUINTEGER, определяющее, как обрабатываются строки аргументов функций каталога.<br /><br /> Если SQL_TRUE, строка аргумент функции каталога рассматриваются как идентификаторы. Дело не имеет существенного значения. Для неразграниченных строк драйвер удаляет все задние пространства, а строка складывается в верхний корпус. Для делимитированных строк, водитель удаляет любые ведущие или задние пространства и принимает буквально все, что находится между делимитерами. Если один из этих аргументов установлен на нулевую указку, функция возвращается SQL_ERROR и S'LSTATE HY009 (Недействительное использование нулевого указателя).<br /><br /> Если SQL_FALSE, строки аргументы функций каталога не рассматриваются как идентификаторы. Случай имеет важное значение. Они могут содержать шаблон поиска строки или нет, в зависимости от аргумента.<br /><br /> Значение по умолчанию составляет SQL_FALSE.<br /><br /> Аргумент *TableType,* **который**принимает список значений, не зависит от этого атрибута.<br /><br /> SQL_ATTR_METADATA_ID также может быть установлен на уровне оператора. (Это единственный атрибут соединения, который также является атрибутом оператора.)<br /><br /> Для получения дополнительной информации смотрите [аргументы в каталоге функции](../../../odbc/reference/develop-app/arguments-in-catalog-functions.md).|  
|SQL_ATTR_ODBC_CURSORS (ODBC 2.0)|Значение S'LULEN с указанием того, как менеджер драйвера использует библиотеку курсора ODBC:<br /><br /> SQL_CUR_USE_IF_NEEDED - Менеджер драйвера использует библиотеку курсоров ODBC только в том случае, если это необходимо. Если драйвер поддерживает SQL_FETCH_PRIOR опцию в **S'LFetchScroll,** менеджер драйвера использует возможности прокрутки драйвера. В противном случае он использует библиотеку курсора ODBC.<br /><br /> SQL_CUR_USE_ODBC - Менеджер драйвера использует библиотеку курсоров ODBC.<br /><br /> SQL_CUR_USE_DRIVER - Менеджер драйвера использует возможности прокрутки драйвера. Это параметр по умолчанию.<br /><br /> Для получения дополнительной информации о библиотеке [Appendix F: ODBC Cursor Library](../../../odbc/reference/appendixes/appendix-f-odbc-cursor-library.md)курсора ODBC см. **Предупреждение:**  Библиотека курсора будет удалена в будущей версии Windows. Избегайте использования этой функции в новых разработках и планируйте модифицировать приложения, использующие эту функцию в настоящее время. Корпорация Майкрософт рекомендует использовать функцию курсора драйвера.|  
|SQL_ATTR_PACKET_SIZE (ODBC 2.0)|Значение S-LUINTEGER, определяющее размер сетевого пакета в байтах. **Примечание:**  Многие источники данных либо не поддерживают эту опцию, либо могут вернуться, но не устанавливают размер сетевого пакета. <br /><br /> Если указанный размер превышает максимальный размер пакета или меньше минимального размера пакета, драйвер заменяет это значение и возвращает S'LSTATE 01S02 (изменение значения опциона).<br /><br /> Если приложение устанавливает размер пакета после того, как соединение уже сделано, драйвер возвращает S'LSTATE HY011 (атрибут не может быть установлен сейчас).|  
|SQL_ATTR_QUIET_MODE (ODBC 2.0)|Ручка окна (HWND).<br /><br /> Если ручка окна является нулевой указателем, драйвер не отображает никаких диалоговые коробки.<br /><br /> Если ручка окна не является нулевой указателем, она должна быть родительской ручкой окна приложения. Это значение по умолчанию. Драйвер использует эту ручку для отображения диалоговые коробки. **Примечание:**  Атрибут SQL_ATTR_QUIET_MODE соединения не применяется к диалоговые коробки, отображаемые **S'LDriverConnect.**|  
|SQL_ATTR_TRACE (ODBC 1.0)|Значение S'LUINTEGER, сообщающее менеджеру-водителю, следует ли выполнять трассировку:<br /><br /> SQL_OPT_TRACE_OFF - Отслеживание (по умолчанию)<br /><br /> SQL_OPT_TRACE_ON - Отслеживание<br /><br /> При отслеживании менеджер драйвера записывает каждый вызов функции ODBC в файл трассировки. **Примечание:**  При отслеживании менеджер драйвера может вернуть s'LSTATE IM013 (ошибка файла Трейс) из любой функции. <br /><br /> Приложение определяет файл трассировки с SQL_ATTR_TRACEFILE опцией. Если файл уже существует, к файлу припойет менеджер драйверов. В противном случае он создает файл. Если трассировка завершена и не указан файл следов, менеджер драйвера записывает в файл S'L. LOG в корневом каталоге.<br /><br /> Приложение может установить переменную **ODBCSharedTraceFlag,** чтобы включить отслеживание динамически. Затем трассировка включена для всех запущенных в настоящее время приложений ODBC. Если приложение отключается, оно выключается только для этого приложения.<br /><br /> Если ключевое слово **Trace** в системе информация установлена до 1, когда приложение вызывает **S'LAllocHandle** с *помощью HandleType* SQL_HANDLE_ENV, отслеживание включено для всех ручек. Он включен только для приложения, которое называется **S'LAllocHandle**.<br /><br /> Вызов **S'LSetConnectAttr** с *атрибутом* SQL_ATTR_TRACE не требует, чтобы аргумент *ConnectionHandle* был действительным и не возвращался SQL_ERROR если *ConnectionHandle* является NULL. Этот атрибут применяется ко всем соединениям.|  
|SQL_ATTR_TRACEFILE (ODBC 1.0)|Строка символов с нулевым завершением, содержащая имя файла трассировки.<br /><br /> Значение атрибута по умолчанию SQL_ATTR_TRACEFILE указывается с ключевым словом **TraceFile** в системе информации. Для получения дополнительной [информации см.](../../../odbc/reference/install/odbc-subkey.md)<br /><br /> Вызов **S'LSetConnectAttr** с *атрибутом* SQL_ATTR_ TRACEFILE не требует, чтобы аргумент *ConnectionHandle* был действительным и не вернется SQL_ERROR если *ConnectionHandle* является недействительным. Этот атрибут применяется ко всем соединениям.|  
|SQL_ATTR_TRANSLATE_LIB (ODBC 1.0)|Строка символов с нулевым завершением, содержащая название библиотеки, содержащей функции **S'LDriverToDataSource** и **S'LDataSourceToDriver,** к которой водитель получает доступ для выполнения таких задач, как перевод набора символов. Эта опция может быть указана только в том случае, если драйвер подключился к источнику данных. Настройка этого атрибута будет сохраняться в соединениях. Для получения дополнительной информации о переводе данных, см [Перевод DLLs](../../../odbc/reference/develop-app/translation-dlls.md) и [перевод DLL Функция Справка](../../../odbc/reference/syntax/translation-dll-api-reference.md).|  
|SQL_ATTR_TRANSLATE_OPTION (ODBC 1.0)|Значение 32-битного флага, передаваемый в перевод DLL. Этот атрибут может быть указан только в том случае, если драйвер подключился к источнику данных. Для получения информации о переводе данных [см.](../../../odbc/reference/develop-app/translation-dlls.md)|  
|SQL_ATTR_TXN_ISOLATION (ODBC 1.0)|32-битная битовая маска, которая устанавливает уровень изоляции транзакции для текущего соединения. Приложение должно вызвать **S'LEndTran,** чтобы совершить или откатить все открытые транзакции на подключение, прежде чем позвонить в **s'LSetConnectAttr** с этой опцией.<br /><br /> Действительные значения для *ValuePtr* можно определить, позвонив в **s'LGetInfo** с *InfoType,* равным SQL_TXN_ISOLATION_OPTIONS.<br /><br /> Для описания уровней изоляции транзакций SQL_DEFAULT_TXN_ISOLATION см. [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md) [Transaction Isolation Levels](../../../odbc/reference/develop-app/transaction-isolation-levels.md)|  
  
 Эти функции можно назвать асинхронно только в том случае, если дескриптор является дескриптором реализации, а не дескриптором приложения.  
  
## <a name="code-example"></a>Пример кода  
 [См.](../../../odbc/reference/syntax/sqlconnect-function.md)  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Выделение ручки|[Функция SQLAllocHandle](../../../odbc/reference/syntax/sqlallochandle-function.md)|  
|Возвращение параметра атрибута соединения|[Функция SQLGetConnectAttr](../../../odbc/reference/syntax/sqlgetconnectattr-function.md)|  
  
## <a name="see-also"></a>См. также:  
 [Справка aPI ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)
