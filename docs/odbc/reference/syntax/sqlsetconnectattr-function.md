---
title: Функция SQLSetConnectAttr | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLSetConnectAttr
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLSetConnectAttr
helpviewer_keywords:
- SQLSetConnectAttr function [ODBC]
ms.assetid: 97fc7445-5a66-4eb9-8e77-10990b5fd685
author: MightyPen
ms.author: genemi
ms.openlocfilehash: fd4acd7ce6a33665ce3d32e42328c906aaec3049
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "67910384"
---
# <a name="sqlsetconnectattr-function"></a>Функция SQLSetConnectAttr
**Соответствие стандартам**  
 Представленные версии: ODBC 3.0 стандартов соответствия: ISO-92  
  
 **Сводка**  
 **SQLSetConnectAttr** задает атрибуты, которые управляют аспектами подключений.  
  
> [!NOTE]
>  Дополнительные сведения о что диспетчер драйверов сопоставляет эту функцию, чтобы при ODBC 3 *.x* при работе с ODBC 2 *.x* драйвера, см. в разделе [сопоставление замещающих функций для назад Совместимость приложений](../../../odbc/reference/develop-app/mapping-replacement-functions-for-backward-compatibility-of-applications.md).  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLSetConnectAttr(  
     SQLHDBC       ConnectionHandle,  
     SQLINTEGER    Attribute,  
     SQLPOINTER    ValuePtr,  
     SQLINTEGER    StringLength);  
```  
  
## <a name="arguments"></a>Аргументы  
 *ConnectionHandle*  
 [Input] Дескриптор подключения  
  
 *Attribute*  
 [Вход] Атрибут, чтобы задать, перечисленные в «Комментарии».  
  
 *ValuePtr*  
 [Вход] Указатель на значение, которым будет связана *атрибут*. В зависимости от значения *атрибут*, *ValuePtr* будет иметь значение целого числа без знака или указывает на строку символов с завершающим нулем. Обратите внимание, что тип целочисленного *атрибут* аргумент не может быть фиксированной длины, см. в разделе комментариев для детализации.  
  
 *StringLength*  
 [Вход] Если *атрибут* является атрибутом, определенных для ODBC и *ValuePtr* указывает на строку символов или двоичный буфер, данный аргумент должен иметь длину **ValuePtr*. Для строки символьных данных этот аргумент должен содержать число байтов в строке.  
  
 Если *атрибут* является атрибутом, определенных для ODBC и *ValuePtr* должно быть целым числом, *StringLength* учитывается.  
  
 Если *атрибут* является атрибутом, определяемым драйвером, приложение указывает характер атрибут для диспетчера драйверов, задав *StringLength* аргумент. *StringLength* может иметь следующие значения:  
  
-   Если *ValuePtr* — это указатель на строку символов, затем *StringLength* длина строки или SQL_NTS.  
  
-   Если *ValuePtr* является указателем в двоичный буфер, а затем приложение размещает результат SQL_LEN_BINARY_ATTR (*длина*) в макрос *StringLength*. Это размещает отрицательное значение в *StringLength*.  
  
-   Если *ValuePtr* — это указатель на значение, отличное от строку символов или двоичная строка, затем *StringLength* должно иметь значение SQL_IS_POINTER.  
  
-   Если *ValuePtr* содержит значение фиксированной длины, то *StringLength* является SQL_IS_INTEGER или SQL_IS_UINTEGER, соответствующим образом.  
  
## <a name="returns"></a>Возвращает  
 Значение SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, значение SQL_ERROR, SQL_INVALID_HANDLE или SQL_STILL_EXECUTING.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLSetConnectAttr** возвращает значение SQL_ERROR или SQL_SUCCESS_WITH_INFO, а связанное значение SQLSTATE можно получить, вызвав **SQLGetDiagRec** с *HandleType* из SQL_HANDLE_DBC и *обрабатывать* из *ConnectionHandle*. В следующей таблице перечислены значения SQLSTATE, обычно возвращаемые **SQLSetConnectAttr** и объясняется каждый из них в контексте этой функции; описания SQLSTATE, возвращаемых диспетчером драйверов предшествует обозначение «(DM)». Возвращается связанный с каждого значения SQLSTATE значение SQL_ERROR, если не указано иное.  
  
 Драйвер может возвращать значение SQL_SUCCESS_WITH_INFO для предоставления сведений о результате установив соответствующий параметр.  
  
|SQLSTATE|Ошибка|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Специфические для драйвера информационное сообщение. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|01S02|Значение параметра изменено|Драйвер не поддерживает значения, указанного в *ValuePtr* и заменить примерно такое же значение. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|08002|Имя подключения используется|*Атрибут* аргумент был SQL_ATTR_ODBC_CURSORS и драйвер уже был подключен к источнику данных.|  
|08003|Соединение не открыто|(DM) *атрибут* было указано значение, которое требуется открытое соединение, но *ConnectionHandle* не находился в подключенном состоянии.|  
|08S01|Отказ канала связи|Сбой в канале связи между драйвером и источника данных, к которому был подключен драйвер перед обработкой функции было завершено.|  
|24000|Недопустимое состояние курсора|*Атрибут* аргумент был SQL_ATTR_CURRENT_CATALOG и результирующий набор не ожидались.|  
|25000|Недопустимая операция в локальной транзакции|Соединение было в локальной транзакции при попытке выполнить прикрепление в соединения распределенной транзакции (DTC), задав атрибут SQL_ATTR_ENLIST_IN_DTC соединения.<br /><br /> Соединение уже участвует в DTC.<br /><br /> Подключение принимала в соединения распределенной транзакции и запуска локальной транзакции, задав SQL_ATTR_AUTOCOMMIT равным SQL_AUTOCOMMIT_OFF.|  
|3D000|Недопустимое имя каталога|*Атрибут* аргумент был SQL_CURRENT_CATALOG и было указано неверное имя указанного каталога.|  
|HY000|Общая ошибка|Произошла ошибка, для которой было нет конкретных SQLSTATE и SQLSTATE не зависящие от реализации, который был определен. Сообщение об ошибке, возвращенные **SQLGetDiagRec** в  *\*MessageText* буфера описывает ошибку и его причины.|  
|HY001|Ошибка выделения памяти|Драйвер не удалось выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY008|Операция отменена|Асинхронная обработка была включена для *ConnectionHandle*. **SQLSetConnectAttr** была вызвана функция, и до его завершения выполнения, [функция SQLCancelHandle](../../../odbc/reference/syntax/sqlcancelhandle-function.md) был вызван для *ConnectionHandle*, а затем **SQLSetConnectAttr** функция была вызвана снова на *ConnectionHandle*.<br /><br /> Или **SQLSetConnectAttr** была вызвана функция, и до его завершения выполнения, **SQLCancelHandle** был вызван для *ConnectionHandle* из другого потока в многопоточные приложения.|  
|HY009|Недопустимое использование пустого указателя|*Атрибут* аргумент определенный атрибут соединения, который требуется строковое значение, и *ValuePtr* аргумент был пустым указателем.|  
|HY010|Ошибка последовательности функций|(DM) был вызван асинхронно выполняемой функции для *StatementHandle* связанные с *ConnectionHandle* и еще выполнялась при **SQLSetConnectAttr**был вызван.<br /><br /> (DM) асинхронно выполняемой функции (не такой) был вызван для *ConnectionHandle* и еще выполнялась при вызове этой функции.<br /><br /> (DM) **SQLExecute**, **SQLExecDirect**, или **SQLMoreResults** был вызван для одного из дескрипторов инструкций, связанных с *ConnectionHandle* и возвращается SQL_PARAM_DATA_AVAILABLE. Прежде чем данные были получены для всех параметров потоковой вызове этой функции.<br /><br /> (DM) **SQLExecute**, **SQLExecDirect**, **SQLBulkOperations**, или **SQLSetPos** был вызван для *StatementHandle*  связанные с *ConnectionHandle* и возвращается значение SQL_NEED_DATA. Эта функция был вызван перед отправкой данных для всех параметров данных времени выполнения или столбцов.<br /><br /> (DM) **SQLBrowseConnect** был вызван для *ConnectionHandle* и возвращается значение SQL_NEED_DATA. Эта функция была вызвана до **SQLBrowseConnect** возвращено значение SQL_SUCCESS_WITH_INFO или SQL_SUCCESS.|  
|HY011|Атрибут нельзя установить сейчас|*Атрибут* аргумент был SQL_ATTR_TXN_ISOLATION, и транзакция была открыта.|  
|HY013|Ошибка управления памятью|Не удалось обработать вызов функции, так как базовые объекты памяти оказываются недоступны, возможно из-за нехватки памяти.|  
|HY024|Недопустимое значение атрибута|Дан указанный *атрибут* , недопустимое значение было указано значение в *ValuePtr*. (The Driver Manager возвращает этот SQLSTATE только для подключения и атрибуты инструкции, которые принимают дискретный набор значений, таких как SQL_ATTR_ACCESS_MODE или атрибуту SQL_ATTR_ASYNC_ENABLE. Для всех других атрибутов соединения и инструкции, драйвер должен проверить значение, указанное в *ValuePtr*.)<br /><br /> *Атрибут* аргумент был SQL_ATTR_TRACEFILE или настройки SQL_ATTR_TRANSLATE_LIB, и *ValuePtr* была пустая строка.|  
|HY090|Недопустимая длина строки или буфера|*(DM) \*ValuePtr* представляет собой строку символов и *StringLength* аргумент был, но меньше 0 не SQL_NTS.|  
|HY092|Недопустимый атрибут/идентификатор параметра|(DM) значение, указанное для аргумента *атрибут* недопустимо для версии ODBC, поддерживаемых драйвером.<br /><br /> (DM) значение, указанное для аргумента *атрибут* был атрибут только для чтения.|  
|HY114|Драйвер не поддерживает выполнение асинхронной функции уровня соединения|(DM) приложения была предпринята попытка включить функции асинхронного выполнения с помощью параметр SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE для драйвера, который не поддерживает операции асинхронного подключения.|  
|HY117|Подключение будет приостановлена из-за состояние транзакции неизвестно. Только отключиться и разрешены функции, доступные только для чтения.|(DM) Дополнительные сведения о приостановленном состоянии, см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).|  
|HY121|В то же время нельзя включить библиотеку курсоров и пула с учетом драйвера|Дополнительные сведения см. в разделе [Driver-Aware Connection Pooling](../../../odbc/reference/develop-app/driver-aware-connection-pooling.md).|  
|HYC00|Дополнительная возможность не реализована|Значение, указанное для аргумента *атрибут* был надлежащее подключение ODBC или атрибут инструкции для используемой версии ODBC, поддерживаемых драйвером, но не поддерживается драйвером.|  
|HYT01|Время ожидания подключения истекло|Время ожидания подключения истекло раньше, чем ответил на запрос источника данных. Период времени ожидания задается с помощью **SQLSetConnectAttr**, sql_attr_connection_timeout не учитывается.|  
|IM001|Драйвер не поддерживает эту функцию|Драйвер (DM), связанные с *ConnectionHandle* не поддерживает функцию.|  
|IM009|Не удалось загрузить DLL перевода|Драйвер не удалось загрузить преобразование библиотеки DLL, который был указан для соединения. Эта ошибка может возвращаться только тогда, когда *атрибут* — настройки SQL_ATTR_TRANSLATE_LIB.|  
|IM017|Опрос недоступен в режиме асинхронное уведомление|Каждый раз, когда используется модель уведомлений, отключен опроса.|  
|IM018|**SQLCompleteAsync** не был вызван для завершения предыдущей асинхронной операции на этот дескриптор.|Если предыдущий вызов функции в дескриптор возвращает SQL_STILL_EXECUTING, и если включен режим уведомлений, **SQLCompleteAsync** должен вызываться с дескриптором постобработки и завершить операцию.|  
|S1118|Драйвер не поддерживает асинхронное уведомление|SQL_ATTR_ASYNC_DBC_EVENT был задан (после подключения), но драйвер не поддерживает асинхронное уведомление.|  
  
 Когда *атрибут* является атрибутом инструкции **SQLSetConnectAttr** может возвращать любой SQLSTATE, возвращенный **SQLSetStmtAttr**.  
  
## <a name="comments"></a>Комментарии  
 Общие сведения об атрибутах соединения см. в разделе [атрибуты соединения](../../../odbc/reference/develop-app/connection-attributes.md).  
  
 В настоящее время определены атрибуты и используемая версия ODBC, в котором они были введены отображаются в таблице ниже в данном разделе; предполагается, что определены дополнительные атрибуты для использования различных источников данных. Широкий набор атрибутов зарезервировано для ODBC. разработчики драйверов необходимо зарезервировать значения для собственных нужд конкретного драйвера из Open Group.  
  
> [!NOTE]
>  Возможность устанавливать атрибуты инструкции на уровне соединения, вызвав **SQLSetConnectAttr** был объявлен устаревшим в ODBC 3 *.x*. ODBC 3 *.x* приложения никогда не следует устанавливать атрибуты инструкции на уровне соединения. ODBC 3 *.x* атрибуты инструкции, которые нельзя установить на уровне соединения, за исключением SQL_ATTR_METADATA_ID и атрибуту SQL_ATTR_ASYNC_ENABLE атрибуты, которые являются атрибуты соединения и атрибуты инструкций и могут быть задать на уровне соединения или уровне инструкций.  
> 
>  ODBC 3 *.x* драйверы должен поддерживать эту функцию, только если они должны работать с ODBC 2 *.x* приложения, значение ODBC 2 *.x* параметров инструкции на уровне соединения. Дополнительные сведения см. в разделе [сопоставление SQLSetConnectOption](../../../odbc/reference/appendixes/sqlsetconnectoption-mapping.md) в приложении G: Рекомендации по драйверов для обеспечения обратной совместимости.  
  
 Приложение может вызвать **SQLSetConnectAttr** в любое время между моментом, когда соединение выделяется и освобождается. Все атрибуты инструкции и соединения, успешно установлены приложением для подключения сохраняется до **SQLFreeHandle** вызывается для подключения. Например, если приложение вызывает **SQLSetConnectAttr** перед подключением к источнику данных, атрибут будет повторяться даже в том случае, если **SQLSetConnectAttr** завершается ошибкой в драйвере, если приложение подключается к источник данных; Если приложение устанавливает атрибут специфические для драйвера, атрибут будет повторяться, даже если приложение подключается к другой драйвер для подключения.  
  
 Некоторые атрибуты соединения может быть установлено только в том случае, до подключения; другие могут быть установлены только в том случае, после подключения. В этой таблице перечислены эти атрибуты соединения, которые должны быть установлены до или после соединения. *Либо* указывает, что атрибут может быть задано до или после соединения.  
  
|attribute|Устанавливается перед или после подключения?|  
|---------------|-------------------------------------|  
|SQL_ATTR_ACCESS_MODE|[1]|  
|SQL_ATTR_ASYNC_DBC_EVENT|Допустим любой вариант|  
|SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE|[4]|  
|SQL_ATTR_ASYNC_DBC_PCALLBACK|Допустим любой вариант|  
|SQL_ATTR_ASYNC_DBC_PCONTEXT|Допустим любой вариант|  
|SQL_ATTR_ASYNC_ENABLE|[2]|  
|SQL_ATTR_AUTO_IPD|Допустим любой вариант|  
|SQL_ATTR_AUTOCOMMIT|[5]|  
|SQL_ATTR_CONNECTION_DEAD|После|  
|SQL_ATTR_CONNECTION_TIMEOUT|Допустим любой вариант|  
|SQL_ATTR_CURRENT_CATALOG|[1]|  
|SQL_ATTR_DBC_INFO_TOKEN|После|  
|SQL_ATTR_ENLIST_IN_DTC|После|  
|SQL_ATTR_LOGIN_TIMEOUT|Перед|  
|SQL_ATTR_METADATA_ID|Допустим любой вариант|  
|SQL_ATTR_ODBC_CURSORS|Перед|  
|SQL_ATTR_PACKET_SIZE|Перед|  
|SQL_ATTR_QUIET_MODE|Допустим любой вариант|  
|SQL_ATTR_TRACE|Допустим любой вариант|  
|SQL_ATTR_TRACEFILE|Допустим любой вариант|  
|SQL_ATTR_TRANSLATE_LIB|После|  
|SQL_ATTR_TRANSLATE_OPTION|После|  
|SQL_ATTR_TXN_ISOLATION|[3]|  
  
 [1] SQL_ATTR_ACCESS_MODE и SQL_ATTR_CURRENT_CATALOG можно задать до или после подключения, в зависимости от драйвера. Тем не менее взаимодействующие приложения установить их перед подключением потому, что некоторые драйверы не поддерживают их после подключения.  
  
 [2] перед имеется активный оператор, необходимо задать атрибуту SQL_ATTR_ASYNC_ENABLE.  
  
 [3] SQL_ATTR_TXN_ISOLATION можно задать только в том случае, если нет открытых транзакций для соединения. Некоторые атрибуты соединения поддерживают замену примерно такое же значение, если источник данных не поддерживает значения, указанного в \* *ValuePtr*. В таком случае драйвер возвращает SQL_SUCCESS_WITH_INFO и SQLSTATE 01S02 (значение параметра изменено). Например если *атрибут* — SQL_ATTR_PACKET_SIZE и \* *ValuePtr* превышает максимальный размер пакета, драйвер подставляет максимальный размер. Чтобы определить это значение, приложение вызывает **SQLGetConnectAttr**.  
  
 [4] Если параметр SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE прежде, чем при открытом соединении, диспетчер драйверов задаст атрибута драйвера, когда драйвер загружается во время вызова **SQLBrowseConnect**, **SQLConnect**, или **SQLDriverConnect**. Перед вызовом **SQLBrowseConnect**, **SQLConnect**, или **SQLDriverConnect**, диспетчер драйверов не знает, какой драйвер для подключения к и не имеет ли драйвер поддерживает операции асинхронного подключения. Таким образом диспетчер драйверов всегда возвращает значение SQL_SUCCESS. Но в случае, если драйвер не поддерживает операции асинхронного подключения, вызов **SQLBrowseConnect**, **SQLConnect**, или **SQLDriverConnect** завершится ошибкой.  
  
 [5] при SQL_ATTR_AUTOCOMMIT равным FALSE, приложение должно вызывать SQLEndTran(SQL_ROLLBACK) любого API возвращает значение SQL_ERROR для обеспечения согласованности транзакций.  
  
 Формат данных, задайте \* *ValuePtr* буфера зависит от указанного *атрибут*. **SQLSetConnectAttr** будет принимать данные атрибут в одной из двух различных форматов: строка символов с завершающим нулем, или значение типа integer. Формат каждого из них указан в описании атрибута. Символьные строки, на которые указывают *ValuePtr* аргумент **SQLSetConnectAttr** иметь длину *StringLength* байт.  
  
 *StringLength* аргумент учитывается, если длина определяется по атрибуту, как в случае для всех атрибутов, представленные в ODBC 2 *.x* или более ранней версии.  
  
|*Attribute*|*ValuePtr* содержимое|  
|-----------------|-------------------------|  
|SQL_ATTR_ACCESS_MODE (ODBC 1.0)|Значение типа SQLUINTEGER. SQL_MODE_READ_ONLY драйвером или источник данных служит признаком того, что соединение не является обязательным для поддержки операторов SQL, вызывающих обновлений. Этот режим можно использовать для оптимизации стратегий блокировки, управления транзакциями или других областей, в зависимости от драйвера или источник данных. Драйвер не требуется для предотвращения таких инструкций отправки на источнике данных. Поведение драйвера и источника данных в ответ на запрос для обработки инструкций SQL, которые не только для чтения во время подключения только для чтения, определяемое реализацией. SQL_MODE_READ_WRITE используется по умолчанию.|  
|SQL_ATTR_ASYNC_DBC_EVENT (ODBC 3.8)|Указатель SQLPOINTER значение дескриптора событий.<br /><br /> Уведомление о завершении асинхронной функции включена, вызвав **SQLSetConnectAttr** SQL_ATTR_ASYNC_STMT_EVENT атрибутом и указания обработчика события. **Примечание.**  Метод уведомления не поддерживается с библиотекой курсоров. Приложение будет получать сообщение об ошибке при попытке включить библиотеку курсоров через SQLSetConnectAttr, при включении метод уведомления.|  
|SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE (ODBC 3.8)|Значение SQLUINTEGER, включающее или отключающее асинхронное выполнение функций на дескриптор соединения. Дополнительные сведения см. в разделе [асинхронное выполнение (метод опроса)](../../../odbc/reference/develop-app/asynchronous-execution-polling-method.md).<br /><br /> SQL_ASYNC_DBC_ENABLE_ON = включить асинхронную операцию для указанной функции, относящиеся к соединению.<br /><br /> SQL_ASYNC_DBC_ENABLE_OFF = Disable (по умолчанию) асинхронную операцию для указанной функции, относящиеся к соединению.<br /><br /> Параметр параметр SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE всегда выполняется синхронно (то есть он никогда не вернет значение SQL_STILL_EXECUTING).<br /><br /> Асинхронное выполнение инструкции операций включены с атрибуту SQL_ATTR_ASYNC_ENABLE.|  
|SQL_ATTR_ASYNC_DBC_PCALLBACK (ODBC 3.8)|Указатель SQLPOINTER значение, которое указывает на структуру контекста.<br /><br /> Только для диспетчера драйверов можно вызвать драйвера **SQLSetStmtAttr** функции с этим атрибутом.|  
|SQL_ATTR_ASYNC_DBC_PCONTEXT (ODBC 3.8)|Указатель SQLPOINTER значение, которое указывает на структура контекста.<br /><br /> Только для диспетчера драйверов можно вызвать драйвера **SQLSetStmtAttr** функции с этим атрибутом.|  
|АТРИБУТУ SQL_ATTR_ASYNC_ENABLE (ODBC 3.0)|SQLULEN значение, указывающее, выполняется ли функция, вызываемая с помощью инструкции для указанного подключения асинхронно:<br /><br /> SQL_ASYNC_ENABLE_OFF = Disable подключения уровня асинхронное выполнение поддержка инструкции операций (по умолчанию).<br /><br /> SQL_ASYNC_ENABLE_ON = Включение поддержки уровня асинхронное выполнение подключения для операций инструкции.<br /><br /> Этот атрибут можно задать ли **SQLGetInfo** информацией о SQL_ASYNC_MODE тип возвращает SQL_AM_CONNECTION или SQL_AM_STATEMENT.|  
|SQL_ATTR_AUTO_IPD (ODBC 3.0)|Значение sqluinteger, ПРЕДНАЗНАЧЕННУЮ только для чтения, указывает ли автоматическое заполнение IPD после вызова **SQLPrepare** поддерживается:<br /><br /> SQL_TRUE = автоматическое заполнение IPD после вызова **SQLPrepare** поддерживается драйвером.<br /><br /> Значение SQL_FALSE = автоматическое заполнение IPD после вызова **SQLPrepare** не поддерживается драйвером. Серверы, которые не поддерживают подготовленных инструкций не сможете автоматическое заполнение IPD.<br /><br /> Если для атрибута соединения SQL_ATTR_AUTO_IPD возвращается SQL_TRUE, атрибут инструкции SQL_ATTR_ENABLE_AUTO_IPD можно присвоить выключать автоматическое заполнение IPD. В случае SQL_ATTR_AUTO_IPD SQL_FALSE SQL_ATTR_ENABLE_AUTO_IPD не может быть установлено значение SQL_TRUE. Значение по умолчанию SQL_ATTR_ENABLE_AUTO_IPD равно значению SQL_ATTR_AUTO_IPD.<br /><br /> Этот атрибут подключения могут быть возвращены **SQLGetConnectAttr** , но не может задать **SQLSetConnectAttr**.|  
|SQL_ATTR_AUTOCOMMIT (ODBC 1.0)|SQLUINTEGER значение, указывающее, следует ли использовать режим автоматической фиксации или ручной фиксации:<br /><br /> SQL_AUTOCOMMIT_OFF = драйвер использует режим ручной фиксации и приложение должно явно фиксации или отката транзакции с **SQLEndTran**.<br /><br /> SQL_AUTOCOMMIT_ON = режим автоматической фиксации использует драйвер. Каждая инструкция фиксируется немедленно после его выполнения. Это значение по умолчанию. Открытые транзакции в соединении фиксируются, если SQL_ATTR_AUTOCOMMIT присвоено SQL_AUTOCOMMIT_ON переключиться из режима ручной фиксации в режим автоматической фиксации.<br /><br /> Дополнительные сведения см. в разделе [режим фиксации](../../../odbc/reference/develop-app/commit-mode.md). **Внимание!**  Некоторые источники данных, удалить планы доступа и закройте курсоры для всех инструкций в соединении каждый раз, когда инструкция будет зафиксирован; режим автоматической фиксации может вызвать перезагрузку после выполнения каждой инструкции nonquery или когда курсор закрыт для запроса. Дополнительные сведения см. в разделе SQL_CURSOR_COMMIT_BEHAVIOR и SQL_CURSOR_ROLLBACK_BEHAVIOR типы сведений в [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md) и [влияние транзакций на курсоры и подготовленных инструкций](../../../odbc/reference/develop-app/effect-of-transactions-on-cursors-and-prepared-statements.md). <br /><br /> Если пакет выполняется в режиме автоматической фиксации, возможны две вещи. Всего пакета можно рассматривать как единицы autocommitable, или каждой инструкции в пакете, обрабатывается как модуль autocommitable. Некоторые источники данных может поддерживать оба этих механизма и может предоставить способ выбрать одно из них. Это определенное драйвером ли пакет рассматривается как модуль autocommitable или ли каждая отдельная инструкция в пакете является autocommitable.|  
|SQL_ATTR_CONNECTION_DEAD<br /><br /> (ODBC 3.5)|Только для чтения SQLUINTEGER значение, указывающее состояние подключения. Если значение SQL_CD_TRUE, соединение было потеряно. Если значение SQL_CD_FALSE, подключение по-прежнему активна.|  
|SQL_ATTR_CONNECTION_TIMEOUT НЕ УЧИТЫВАЕТСЯ (ODBC 3.0)|Значение SQLUINTEGER, соответствующее количество секунд ожидания для любой запрос на подключение для выполнения перед возвратом к приложению. Драйвер должен возвращать SQLSTATE HYT00 (истекло время ожидания) в любое время он возможен тайм-аут в ситуации, не связанные с выполнение запроса или имя входа.<br /><br /> Если *ValuePtr* будет равно 0 (по умолчанию), что таймаут не используется.|  
|SQL_ATTR_CURRENT_CATALOG (ODBC 2.0)|Строка символов, содержащая имя каталога, используемый источником данных. Например, в SQL Server, каталог — это база данных, поэтому драйвер отправляет **используйте** _базы данных_ инструкции к источнику данных, где *базы данных* указан в базе данных \* *ValuePtr*. Для драйвера одноуровневых, каталог может быть каталог, поэтому драйвер изменения текущего каталога в каталоге, указанном в **ValuePtr*.|  
|SQL_ATTR_DBC_INFO_TOKEN (ODBC 3.8|Указатель SQLPOINTER значение, используемое для указания обратно маркер информация подключения в DBC обработки при [SQLRateConnection](../../../odbc/reference/syntax/sqlrateconnection-function.md)элемента (\**pRating*) параметра не равно 100.<br /><br /> SQL_ATTR_DBC_INFO_TOKEN доступен только для набора. Невозможно использовать **SQLGetConnectAttr** или **SQLGetConnectOption** для получения этого значения. Диспетчер драйверов **SQLSetConnectAttr** не будет принимать SQL_ATTR_DBC_INFO_TOKEN, так как приложение не задавать этот атрибут.<br /><br /> Если после установки SQL_ATTR_DBC_INFO_TOKEN, драйвер возвращает значение SQL_ERROR, будет освобождена подключение, получен из пула. Диспетчер драйверов попытается получить другое соединение из пула. См. в разделе [драйвера ODBC с поддержкой пула подключений разработка](../../../odbc/reference/develop-driver/developing-connection-pool-awareness-in-an-odbc-driver.md) Дополнительные сведения.|  
|SQL_ATTR_ENLIST_IN_DTC (ODBC 3.0)|Указатель SQLPOINTER значение, указывающее, следует ли использовать драйвер ODBC в распределенных транзакциях, координируемых с помощью службы компонентов Microsoft.<br /><br /> Передайте DTC OLE объект транзакции, задающий транзакцию для экспорта в SQL Server, или параметром SQL_DTC_DONE, чтобы завершить связь соединения.<br /><br /> Клиент вызывает метод координатора распределенных транзакций Microsoft (MS DTC) OLE ITransactionDispenser::BeginTransaction, чтобы начать транзакцию MS DTC и создать объект транзакции MS DTC, представляющий транзакцию. Затем приложение вызывает SQLSetConnectAttr SQL_ATTR_ENLIST_IN_DTC возможность связать объект транзакции с соединением ODBC. Все связанные действия базы данных будут выполняться под защитой транзакции MS DTC. Приложение вызывает SQLSetConnectAttr с параметром SQL_DTC_DONE, чтобы завершить связь соединения. Дополнительные сведения см. в документации по MS DTC.|  
|SQL_ATTR_LOGIN_TIMEOUT (ODBC 1.0)|Значение SQLUINTEGER, соответствующее количество секунд ожидания имени входа запрос на завершение перед возвратом к приложению. Значение по умолчанию зависит от драйвера. Если *ValuePtr* равен 0, время ожидания отключено, а также неограниченное время ожидания попытки подключения.<br /><br /> Если заданное время ожидания превышает время ожидания максимальное входа в источнике данных, драйвер заменяет это значение и возвращает SQLSTATE 01S02 (значение параметра изменено).|  
|SQL_ATTR_METADATA_ID (ODBC 3.0)|Значение SQLUINTEGER, которое определяет, как обрабатываются строковые аргументы функции функции работы с каталогами.<br /><br /> Если SQL_TRUE, строковый аргумент функции работы с каталогами должны обрабатываться как идентификаторы. Регистр не имеет значения. Для nondelimited строк драйвер удаляет все конечные пробелы и строка складывается в верхний регистр. Для строк с разделителями драйвер удаляет все начальные и конечные пробелы и принимает буквально все, что находится между разделителями. Если один из этих аргументов имеет значение является пустым указателем, функция возвращает значение SQL_ERROR и SQLSTATE HY009 (недопустимое использование пустого указателя).<br /><br /> Если значение SQL_FALSE, что строковые аргументы функции каталога не интерпретируются как идентификаторы. Так важен. Они могут содержать либо шаблон поиска строки или нет, в зависимости от аргумента.<br /><br /> Значение по умолчанию — SQL_FALSE.<br /><br /> *TableType* аргумент **SQLTables**, который принимает список значений, не зависит от этого атрибута.<br /><br /> SQL_ATTR_METADATA_ID можно настроить на уровне инструкций. (Это атрибут только соединения, который также является атрибутом инструкции).<br /><br /> Дополнительные сведения см. в разделе [аргументов в функции работы с каталогами](../../../odbc/reference/develop-app/arguments-in-catalog-functions.md).|  
|SQL_ATTR_ODBC_CURSORS (ODBC 2.0)|SQLULEN значение, указывающее, как диспетчер драйверов использует библиотеку курсоров ODBC:<br /><br /> SQL_CUR_USE_IF_NEEDED = The Driver Manager использует библиотеку курсоров ODBC, только в том случае, если он необходим. Если драйвер поддерживает параметр sql_fetch_prior функции в **SQLFetchScroll**, диспетчер драйверов используются прокрутки возможности драйвера. В противном случае он использует библиотеку курсоров ODBC.<br /><br /> SQL_CUR_USE_ODBC = The Driver Manager использует библиотеку курсоров ODBC.<br /><br /> SQL_CUR_USE_DRIVER = The Driver Manager использует возможности переходов драйвера. Это параметр по умолчанию.<br /><br /> Дополнительные сведения о библиотеку курсоров ODBC, см. в разделе [приложение F: Библиотека курсоров ODBC](../../../odbc/reference/appendixes/appendix-f-odbc-cursor-library.md). **Предупреждение!**  Библиотека курсоров будет поддерживаться в будущих версиях Windows. Избегайте использования этой функции в новых разработках и запланируйте изменение приложений, которые сейчас ее используют. Корпорация Майкрософт рекомендует использовать функциональные возможности драйвера курсора.|  
|SQL_ATTR_PACKET_SIZE (ODBC 2.0)|Значение SQLUINTEGER, задающее размер сетевого пакета в байтах. **Примечание.**  Многие источники данных либо не поддерживают этот параметр или только возвращаемое но не задается размер сетевого пакета. <br /><br /> Если указанный размер превышает максимальный размер пакета или меньше, чем минимальный размер пакета, драйвер заменяет это значение и возвращает SQLSTATE 01S02 (значение параметра изменено).<br /><br /> Если приложение задает размер пакета после подключение уже установлено, то драйвер вернет SQLSTATE HY011 (атрибут нельзя установить сейчас).|  
|SQL_ATTR_QUIET_MODE (ODBC 2.0)|Дескриптор окна (HWND).<br /><br /> Если дескриптор окна является указателем null, драйвер не отображает все диалоговые окна.<br /><br /> Если дескриптор не является указателем null, он должен быть дескриптор родительского окна приложения. Это значение по умолчанию. Драйвер использует этот дескриптор для отображения диалоговых окон. **Примечание.**  Атрибут соединения SQL_ATTR_QUIET_MODE не применяется к диалоговым окнам, отображаемого элементом **SQLDriverConnect**.|  
|SQL_ATTR_TRACE (ODBC 1.0)|Значение SQLUINTEGER, указывая диспетчера драйверов, следует ли выполнять трассировку:<br /><br /> SQL_OPT_TRACE_OFF = трассировки off (по умолчанию)<br /><br /> SQL_OPT_TRACE_ON = трассировки на<br /><br /> Когда трассировка включена, диспетчер драйверов записывает каждого вызова функции ODBC в файл трассировки. **Примечание.**  Если трассировка включена, диспетчер драйверов может вернуть SQLSTATE IM013 (Ошибка файла трассировки) из любой функции. <br /><br /> Приложение указывает файл трассировки с параметром SQL_ATTR_TRACEFILE. Если файл уже существует, диспетчер драйверов добавляет к файлу. В противном случае она создает файл. Если трассировка включена, и файлов трассировки не указана, диспетчер драйверов записывает в файл SQL. ВОЙДИТЕ в корневом каталоге.<br /><br /> Приложение может задать переменную **ODBCSharedTraceFlag** для включения трассировки динамически. Трассировка включается для всех приложений ODBC, которые в настоящее время выполнения. Если приложение отключает трассировку, оно будет отключено только для этого приложения.<br /><br /> Если **трассировки** ключевое слово в сведениях о системе имеет значение 1, когда приложение вызывает **SQLAllocHandle** с *HandleType* из SQL_HANDLE_ENV, трассировка включена для всех обрабатывает. Она включена только для приложения, которое вызвало **SQLAllocHandle**.<br /><br /> Вызов **SQLSetConnectAttr** с *атрибут* из SQL_ATTR_TRACE не требует *ConnectionHandle* аргумент быть допустимым и не вернет значение SQL_ERROR, если *ConnectionHandle* имеет значение NULL. Этот атрибут применяется ко всем подключениям.|  
|SQL_ATTR_TRACEFILE (ODBC 1.0)|Строка символов с завершающим нулем, содержащая имя файла трассировки.<br /><br /> Значение по умолчанию атрибута SQL_ATTR_TRACEFILE задается с помощью **TraceFile** ключевое слово в сведениях о системе. Дополнительные сведения см. в разделе [подраздел ODBC](../../../odbc/reference/install/odbc-subkey.md).<br /><br /> Вызов **SQLSetConnectAttr** с *атрибут* из SQL_ATTR_ TRACEFILE не требует *ConnectionHandle* аргумент был допустимым и не вернет значение SQL_ERROR, если *ConnectionHandle* является недопустимым. Этот атрибут применяется ко всем подключениям.|  
|НАСТРОЙКИ SQL_ATTR_TRANSLATE_LIB (ODBC 1.0)|Строка символов нулем, содержащая имя библиотеки, содержащих функции **SQLDriverToDataSource** и **SQLDataSourceToDriver** , обращающихся к драйвер для выполнения задач, таких как Перевод набора знаков. Эта возможность указать, только если драйвер был подключен к источнику данных. Значение этого атрибута будет сохраняться в соединениях. Дополнительные сведения о преобразовании данных см. в разделе [библиотеки DLL преобразования](../../../odbc/reference/develop-app/translation-dlls.md) и [Справочник по функциям библиотеки DLL перевода](../../../odbc/reference/syntax/translation-dll-api-reference.md).|  
|SQL_ATTR_TRANSLATE_OPTION (ODBC 1.0)|32-битовый флаг, значение, передаваемое преобразование библиотеки DLL. Этот атрибут может быть указан только, если драйвер был подключен к источнику данных. Сведения о преобразовании данных см. в разделе [библиотеки DLL преобразования](../../../odbc/reference/develop-app/translation-dlls.md).|  
|SQL_ATTR_TXN_ISOLATION (ODBC 1.0)|Битовая маска 32-разрядной, задает уровень изоляции транзакции для текущего соединения. Приложение должно вызвать **SQLEndTran** для фиксации или отката транзакции все открытые соединения, перед вызовом **SQLSetConnectAttr** с этим параметром.<br /><br /> Допустимые значения для *ValuePtr* можно определить с помощью вызова **SQLGetInfo** с *InfoType* равным SQL_TXN_ISOLATION_OPTIONS.<br /><br /> Описание уровней изоляции транзакций, см. в описании типа сведения SQL_DEFAULT_TXN_ISOLATION в [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md) и [уровни изоляции транзакций](../../../odbc/reference/develop-app/transaction-isolation-levels.md).|  
  
 [1] Эти функции могут вызываться асинхронно только в том случае, если дескриптор является дескриптор реализации, а не дескриптор приложений.  
  
## <a name="code-example"></a>Пример кода  
 См. в разделе [SQLConnect](../../../odbc/reference/syntax/sqlconnect-function.md).  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Выделение дескриптора|[Функция SQLAllocHandle](../../../odbc/reference/syntax/sqlallochandle-function.md)|  
|Возвращает значение атрибута соединения|[Функция SQLGetConnectAttr](../../../odbc/reference/syntax/sqlgetconnectattr-function.md)|  
  
## <a name="see-also"></a>См. также  
 [Справочник по API ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)
