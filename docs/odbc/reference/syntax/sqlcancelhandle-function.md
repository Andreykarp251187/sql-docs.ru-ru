---
title: Функция SQLCancelHandle | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
f1_keywords:
- SQLCancelHandle
helpviewer_keywords:
- SQLCancelHandle function [ODBC]
ms.assetid: 16049b5b-22a7-4640-9897-c25dd0f19d21
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 655c3c76794b170b113442b14ae75cf977ac024c
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63253174"
---
# <a name="sqlcancelhandle-function"></a>Функция SQLCancelHandle
**Соответствие стандартам**  
 Представленные версии: ODBC 3.8  
  
 Соответствие стандартам: None  
  
 Предполагается, что большинство драйверов 3,8 (и более поздние версии) будет реализовать эту функцию. Если драйвер не так, вызов **SQLCancelHandle** с подключением, обрабатывать в *обрабатывать* параметр вернет значение SQL_ERROR с SQLSTATE из IM001 и сообщением "драйвер не поддерживает эту функцию '' вызов для **SQLCancelHandle** с инструкцией обрабатывать как *обрабатывать* параметра будут сопоставлены с вызова **SQLCancel** диспетчером драйверов и могут обрабатываться, если в драйвере реализованы **SQLCancel**. Приложение может использовать **SQLGetFunctions** чтобы определить, поддерживает ли драйвер **SQLCancelHandle**.  
  
 **Сводка**  
 **SQLCancelHandle** отменяет обработку на подключения или инструкции. Диспетчер драйверов сопоставляет вызов **SQLCancelHandle** на вызов **SQLCancel** при *HandleType* является значение SQL_HANDLE_STMT.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
SQLRETURN SQLCancelHandle(  
      SQLSMALLINT  HandleType,  
      SQLHANDLE    Handle);  
```  
  
## <a name="arguments"></a>Аргументы  
 *HandleType*  
 [Вход] Тип дескриптора на котором cacel обработки. Допустимые значения: SQL_HANDLE_DBC или значение SQL_HANDLE_STMT.  
  
 *Дескриптор*  
 [Вход] Дескриптор, в которых требуется отменить обработку.  
  
 Если *обрабатывать* не является допустимым дескриптором типа, заданного параметром *HandleType*, **SQLCancelHandle** возвращает SQL_INVALID_HANDLE.  
  
## <a name="returns"></a>Возвращает  
 Значение SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, значение SQL_ERROR или SQL_INVALID_HANDLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLCancelHandle** возвращает значение SQL_ERROR или SQL_SUCCESS_WITH_INFO, а связанное значение SQLSTATE можно получить, вызвав **SQLGetDiagRec** с *HandleType* из Значение SQL_HANDLE_STMT и инструкции обработки *обрабатывать* или *HandleType* SQL_HANDLE_DBC и дескриптор соединения *обрабатывать*.  
  
 В следующей таблице перечислены значения SQLSTATE, обычно возвращаемые **SQLCancelHandle** и объясняется каждый из них в контексте этой функции; описания SQLSTATE, возвращаемых диспетчером драйверов предшествует обозначение «(DM)». Возвращается связанный с каждого значения SQLSTATE значение SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Ошибка|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Специфические для драйвера информационное сообщение. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|HY000|Общая ошибка|Произошла ошибка, для которой было нет конкретных SQLSTATE и SQLSTATE не зависящие от реализации, который был определен. Сообщение об ошибке, возвращенные [SQLGetDiagRec](../../../odbc/reference/syntax/sqlgetdiagrec-function.md) в аргументе  *\*MessageText* буфера описывает ошибку и его причины.|  
|HY001|Ошибка выделения памяти|Драйвер не удалось выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY010|Ошибка последовательности функций|Функцию асинхронного выполнения, связанных с оператор был вызван для одного из дескрипторов инструкций, связанных с *обрабатывать*, и *HandleType* был значение SQL_HANDLE_DBC. Выполнения при асинхронной функцией **SQLCancelHandle** был вызван.<br /><br /> (DM) *HandleType* аргумент имел значение SQL_HANDLE_STMT; асинхронно выполняемой функции был вызван в дескрипторе подключения; и функция по-прежнему выполняла при вызове этой функции.<br /><br /> (DM) **SQLExecute**, **SQLExecDirect**, или **SQLMoreResults** был вызван для одного из дескрипторов инструкций, связанных с *обрабатывать* и *HandleType* значение SQL_HANDLE_DBC и возвращается SQL_PARAM_DATA_AVAILABLE. Прежде чем данные были получены для всех параметров потоковой вызове этой функции.<br /><br /> **SQLBrowseConnect** был вызван для *ConnectionHandle*и возвращается значение SQL_NEED_DATA. Эта функция был вызван до завершения обзора процесса.|  
|HY013|Ошибка управления памятью|Не удалось обработать вызов функции, так как базовые объекты памяти оказываются недоступны, возможно из-за нехватки памяти.|  
|HY092|Недопустимый атрибут/идентификатор параметра|*HandleType* было присвоено значение SQL_HANDLE_ENV или SQL_HANDLE_DESC.|  
|HY117|Подключение будет приостановлена из-за состояние транзакции неизвестно. Только отключиться и разрешены функции, доступные только для чтения.|(DM) Дополнительные сведения о состоянии приостановки, см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).|  
|HYT01|Время ожидания подключения истекло|Время ожидания подключения истекло раньше, чем ответил на запрос источника данных. Период времени ожидания задается с помощью **SQLSetConnectAttr**, sql_attr_connection_timeout не учитывается.|  
|IM001|Драйвер не поддерживает эту функцию|Драйвер (DM), связанные с *обрабатывать* не поддерживает функцию.|  
  
 Если **SQLCancelHandle** вызывается с *HandleType* значение SQL_HANDLE_STMT, он может возвращать любой SQLSTATE, которое может возвращаться функцией **SQLCancel**.  
  
## <a name="comments"></a>Комментарии  
 Эта функция аналогична **SQLCancel** , но может занять дескриптора инструкции или подключения как параметр, а не только дескриптор инструкции. Диспетчер драйверов сопоставляет вызов **SQLCancelHandle** на вызов **SQLCancel** при *HandleType* является значение SQL_HANDLE_STMT. Это позволяет приложениям использовать **SQLCancelHandle** для отмены инструкции операции, даже если драйвер не реализует **SQLCancelHandle**.  
  
 Дополнительные сведения об отмене операции инструкции, см. в разделе [SQLCancel, функция](../../../odbc/reference/syntax/sqlcancel-function.md).  
  
 Если нет операций выполняется на *обрабатывать* вызов **SQLCancelHandle** не оказывает влияния.  
  
 **SQLCancelHandle** для подключения, дескриптор может отменить следующие типы обработки:  
  
-   Функция, работающего асинхронно на соединение.  
  
-   Функции, выполняемой в дескриптора соединения в другом потоке.  
  
 Когда **SQLCancelHandle** вызывается для отмены функции, работающей асинхронно в подключении, диагностические записи Дэвида тесара **SQLCancelHandle** добавляются для тех, которые возвращаются, когда операция отменено; **SQLCancelHandle** не возвращает диагностические записи, тем не менее, при отмене функции, работающей на соединение в другом потоке.  
  
 С помощью **SQLCancelHandle** отменить **SQLEndTran** установленные подключения в приостановленном состоянии. Дополнительные сведения о состоянии приостановки, см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).  
  
> [!NOTE]  
>  Сведения об использовании **SQLCancelHandle** в приложении, которое будет развертываться в операционной системе Windows старше Windows 7, см. в разделе [Матрица совместимости](../../../odbc/reference/develop-app/compatibility-matrix.md).  
  
#### <a name="canceling-connection-related-asynchronous-processing"></a>Отмена асинхронной обработки, относящиеся к соединению  
 Если функция возвращает значение SQL_STILL_EXECUTING, приложение может вызвать **SQLCancelHandle** для отмены операции. При успешном выполнении, запрос на отмену **SQLCancelHandle** возвращает значение SQL_SUCCESS. Это не означает отмены исходной функции; он показывает, что запрос на отмену был обработан. Драйвер и источника данных определяют при или при отмене операции. Приложение должно продолжить вызывать у исходной функции, пока код возврата не SQL_STILL_EXECUTING. Если исходной функции была отменена, возвращается значение SQL_ERROR и SQLSTATE HY008 (операция отменена). Если исходной функции завершения обработки (не было отменено), возвращается значение SQL_SUCCESS или SQL_SUCCESS_WITH_INFO, или значение SQL_ERROR и SQLSTATE, отличный от HY008 (операция отменена), если сбой исходной функции.  
  
#### <a name="canceling-functions-executing-on-another-thread"></a>Отмена функции выполнение в другом потоке  
 В многопоточных приложений приложения можно отменить операцию, которая выполняется в другом потоке. Чтобы отменить операцию, приложение вызывает **SQLCancelHandle** с дескриптором, используемые функцией, но в другом потоке. Драйвера и операционной системы определяют, как она будет отменена. **SQLCancelHandle** возвращают код указывает, обрабатывается ли драйвер запрос, возвращая значение SQL_SUCCESS или SQL_ERROR (диагностические данные не возвращаются). При отмене обработки на исходную функцию исходной функции возвращает значение SQL_ERROR и SQLSTATE HY008 (операция отменена).  
  
 Если функция выполняется при **SQLCancelHandle** вызывается в другом потоке для отмены функции, это возможно для функции завершиться успешно и вернуть значение SQL_SUCCESS, прежде чем Отмена вступили в силу. Вызов **SQLCancelHandle** не действует, если операция завершена, прежде чем **SQLCancelHandle** смогла отменить операцию.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Отмена функции работающего асинхронно на дескриптор инструкции, Отмена функцию в оператор, требуются данные, либо отмены функции, работающей на инструкцию в другом потоке.|[Функция SQLCancel](../../../odbc/reference/syntax/sqlcancel-function.md)|  
  
## <a name="see-also"></a>См. также  
 [Справочник по API ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)   
 [Асинхронное выполнение (метод опроса)](../../../odbc/reference/develop-app/asynchronous-execution-polling-method.md)
