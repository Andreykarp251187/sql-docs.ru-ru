---
title: Функция S'LКансканхонхлик (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
f1_keywords:
- SQLCancelHandle
helpviewer_keywords:
- SQLCancelHandle function [ODBC]
ms.assetid: 16049b5b-22a7-4640-9897-c25dd0f19d21
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 059ed283032feb96ca5e6b12520682ccb034752a
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81299669"
---
# <a name="sqlcancelhandle-function"></a>Функция SQLCancelHandle
**Соответствия**  
 Представлена версия: ODBC 3.8  
  
 Соответствие стандартам: Нет  
  
 Ожидается, что большинство драйверов ODBC 3.8 (и более поздних) будут выполнять эту функцию. Если водитель этого не делает, вызов на **s'LCancelHandle** с ручкой соединения в параметре *ручки* вернется SQL_ERROR с S'LSTATE IM001 и сообщением 'Driver не поддерживает эту функцию'' Звонок в **S'LCancelHandle** с ручкой оператора, так как параметр *ручки* будет отображен к вызову **на S'LCancel** менеджером драйвера и может быть обработан, если водитель реализует **S'L.** Приложение может использовать **S'LGetFunctions,** чтобы определить, поддерживает ли драйвер **S'LКансмотив.**  
  
 **Сводка**  
 **SLCancelHandle** отменяет обработку соединения или оператора. Менеджер драйверов нанес вызов на вызов в **S'LCancel,** когда *HandleType* находится SQL_HANDLE_STMT. **SQLCancelHandle**  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLCancelHandle(  
      SQLSMALLINT  HandleType,  
      SQLHANDLE    Handle);  
```  
  
## <a name="arguments"></a>Аргументы  
 *HandleType*  
 (Вход) Тип ручки, на которой можно обработать cacel. Допустимые значения являются SQL_HANDLE_DBC или SQL_HANDLE_STMT.  
  
 *Дескриптор*  
 (Вход) Ручка, на которой можно отменить обработку.  
  
 Если *ручка* не является действительной ручкой типа, указанной *HandleType,* **s'LCancelHandle** возвращается SQL_INVALID_HANDLE.  
  
## <a name="returns"></a>Результаты  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_ERROR или SQL_INVALID_HANDLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **S'LCancelHandle** возвращается SQL_ERROR или SQL_SUCCESS_WITH_INFO, связанное с этим значение S'LSTATE можно получить, позвонив по **телефону S'LGetDiagRec** с *помощью HandleType* SQL_HANDLE_STMT и *ручки* оператора или *ручки ручк* SQL_HANDLE_DBCи связи. *Handle*  
  
 В следующей таблице перечислены значения S'LSTATE, обычно возвращаемые **S'LCancelHandle,** и разъясняются каждое из них в контексте этой функции; нотация "(DM)" предшествует описаниям S'LSTATEs, возвращенным менеджером драйвера. Код возврата, связанный с каждым значением S'LSTATE, является SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Error|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Информационное сообщение, конкретное для водителя. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|HY000|Общая ошибка|Произошла ошибка, в соответствии с которой не было конкретного S'LSTATE и для которой не было определено конкретное осуществление СЗЛСТАТ. Сообщение об ошибке, возвращенное [S'LGetDiagRec](../../../odbc/reference/syntax/sqlgetdiagrec-function.md) в буфере * \*MessageText,* описывает ошибку и ее причину.|  
|HY001|Ошибка распределения памяти|Водитель не смог выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY010|Ошибка последовательности функций|Асинхронно выполнение, связанные с выполнением функции, связанные с выполнением, была вызвана для одной из декейок оператора, связанных с *ручкой,* и *HandleType* был установлен для SQL_HANDLE_DBC. Асинхронная функция по-прежнему исполнялась, когда был вызван **S'LКанстриктер.**<br /><br /> (DM) Аргумент *HandleType* был SQL_HANDLE_STMT; асинхронно исполняющая функция была вызвана на связанную ручку соединения; и функция по-прежнему выполнения, когда эта функция была вызвана.<br /><br /> (DM) **S'LExecute**, **S'LExecDirect**, или **S'LMoreResults** был вызван для одной из декретов оператора, связанных с *ручкой* и *HandleType* был установлен на SQL_HANDLE_DBC, и вернулся SQL_PARAM_DATA_AVAILABLE. Эта функция была вызвана до того, как данные были извлечены для всех потоковых параметров.<br /><br /> **S'LBrowseConnect** был вызван для *ConnectionHandle*, и вернулся SQL_NEED_DATA. Эта функция была вызвана до завершения процесса просмотра.|  
|HY013|Ошибка управления памятью|Вызов функции не может быть обработан, поскольку основные объекты памяти не могут быть доступны, возможно, из-за низких условий памяти.|  
|HY092|Недействительный идентификатор атрибута/опциона|*HandleType* был установлен на SQL_HANDLE_ENV или SQL_HANDLE_DESC.|  
|HY117|Подключение приостанавливается из-за неизвестного состояния транзакции. Разрешены только отключить и прочитать только функции.|(DM) Для получения дополнительной информации о приостановленном состоянии, [см.](../../../odbc/reference/syntax/sqlendtran-function.md)|  
|HYT01|Срок истечения времени подключения|Период тайм-аута соединения истек до того, как источник данных ответил на запрос. Период тайм-аута соединения устанавливается через **S'LSetConnectAttr,** SQL_ATTR_CONNECTION_TIMEOUT.|  
|IM001|Драйвер не поддерживает эту функцию|(DM) Драйвер, связанный с *ручкой,* не поддерживает функцию.|  
  
 Если **sLCancelHandle** вызывается с *набором HandleType* для SQL_HANDLE_STMT, он может вернуть любой S'Lstate, который может быть возвращен функцией **S'LCancel.**  
  
## <a name="comments"></a>Комментарии  
 Эта функция аналогична **S'LCancel,** но может принимать либо ручку соединения или оператора в качестве параметра, а не только ручку оператора. Менеджер драйверов нанес вызов на вызов в **S'LCancel,** когда *HandleType* находится SQL_HANDLE_STMT. **SQLCancelHandle** Это позволяет приложениям использовать **S'LCancelHandle** для отмены операций оператора, даже если драйвер не реализует **S'LCancelHandle.**  
  
 Для получения более подробной информации об отмене операции [оператора,](../../../odbc/reference/syntax/sqlcancel-function.md)см.  
  
 Если не выполняется никаких операций по *обработке* вызова в **S'LCancelHandle,** это не действует.  
  
 **На** ручке соединения может отменить следующие типы обработки:  
  
-   Функция, работая асинхронно на соединении.  
  
-   Функция, работана на ручке соединения на другом потоке.  
  
 При вызове **S'LКансонхлик для** отмены функции, работая асинхронно в связи, диагностические записи, размещенные **S'LCancelHandle,** прилагаются к тем, которые возвращаются в результате отмены операции; **Однако при** отмене функции, работающей на подключении на другом потоке, не возвращается диагностические записи.  
  
 Для **SQLCancelHandle** отмены **s'LEndTran** соединение может привести к приостановке подключения. Для получения более подробной [SQLEndTran Function](../../../odbc/reference/syntax/sqlendtran-function.md)информации о приостановленном состоянии см.  
  
> [!NOTE]  
>  Для получения информации о том, как использовать **S'LCancelHandle** в приложении, которое будет развернуто на операционной системе Windows старше Windows 7, [см.](../../../odbc/reference/develop-app/compatibility-matrix.md)  
  
#### <a name="canceling-connection-related-asynchronous-processing"></a>Отмена асинхронной обработки, связанной с подключением  
 Если функция возвращается SQL_STILL_EXECUTING, приложение может вызвать **S'LCancelHandle** для отмены операции. Если запрос на отмену будет успешным, SQL_SUCCESS возвращается **s'LCancelHandle.** Это не означает, что исходная функция была отменена; он указывает, что запрос на отмену был обработан. Водитель и источник данных определяют, когда или если операция отменена. Приложение должно продолжать вызывать исходную функцию до тех пор, пока код возврата не будет SQL_STILL_EXECUTING. Если исходная функция была отменена, код возврата SQL_ERROR и S'LSTATE HY008 (Операция отменена). Если исходная функция завершила нормальную обработку (не была отменена), код возврата SQL_SUCCESS или SQL_SUCCESS_WITH_INFO, или SQL_ERROR и S'LSTATE, кроме HY008 (Операция отменена), если исходная функция не выполнена.  
  
#### <a name="canceling-functions-executing-on-another-thread"></a>Отмена функций выполнения на другой нити  
 В многопоточном приложении приложение может отменить операцию, которая выполняется на другом потоке. Чтобы отменить операцию, приложение вызывает **S'LКанскурхель** с ручкой, используемой функцией, но на другом потоке. Водитель и операционная система определяют, как отменяется операция. Код возврата **S'LCancelHandle** указывает, обработал ли водитель запрос, вернув либо SQL_SUCCESS, либо SQL_ERROR (диагностическая информация не возвращается). Если обработка исходной функции отменена, исходная функция возвращается SQL_ERROR и S'LSTATE HY008 (Операция отменена).  
  
 Если функция выполняется, когда **sLCancelHandle** вызывается на другой поток, чтобы отменить функцию, возможно, чтобы функция успешно и возврат SQL_SUCCESS до отмены может ввести в силу. Вызов в **S'LКансканхлик** не эффектирует, если операция завершена до того, как **компания S'LCancelHandle** смогла отменить операцию.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Отмена функции, работающей асинхронно на ручке оператора, отмена функции оператора, которая нуждается в данных, или отмена функции, работающей на отчете на другом потоке.|[Функция SQLCancel](../../../odbc/reference/syntax/sqlcancel-function.md)|  
  
## <a name="see-also"></a>См. также:  
 [Справка aPI ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовка ODBC](../../../odbc/reference/install/odbc-header-files.md)   
 [Асинхронное исполнение (Метод опроса)](../../../odbc/reference/develop-app/asynchronous-execution-polling-method.md)
