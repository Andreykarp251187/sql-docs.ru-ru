---
title: Функция S'LInstallDriverDriverManager (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLInstallDriverManager
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLInstallDriverManager
helpviewer_keywords:
- SQLInstallDriverManager function [ODBC]
ms.assetid: aebc439b-fffd-4d98-907a-0163f79aee8d
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 0788de0493439a360c0446733b31606a02e12422
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81302115"
---
# <a name="sqlinstalldrivermanager-function"></a>Функция SQLInstallDriverManager
**Соответствия**  
 Версия Введена: ODBC 1.0: Обезображенный в Windows XP Service Pack 2, Windows Server 2003 Service Pack 1, а затем операционные системы  
  
 **Сводка**  
 **SLInstallDriverManager** возвращает путь целевого каталога для установки основных компонентов ODBC. Программа вызова должна скопировать файлы менеджера драйвера в целевой каталог.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
BOOL SQLInstallDriverManager(  
     LPSTR    lpszPath,  
     WORD     cbPathMax,  
     WORD *   pcbPathOut);  
```  
  
## <a name="arguments"></a>Аргументы  
 *lpszPath*  
 (Выход) Путь целевого каталога установки.  
  
 *cbPathMax*  
 (Вход) Длина *lpszPath*. Это должно быть по крайней мере _MAX_PATH байтов.  
  
 *pcbPathOut*  
 (Выход) Общее количество байтов (за исключением байт-навили) возвращается в *lpszPath*. Если количество байтов, доступных для возврата, больше или равно *cbPathMax,* путь в *lpszPath* усечен до *cbPathMax* за вычетом символа нулевого прекращения. Аргумент *pcbPathOut* может быть нулевым указателем.  
  
## <a name="returns"></a>Результаты  
 Функция возвращает TRUE, если она успешна, FALSE, если она не удается.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **S'LInstallDriverManager** возвращает FALSE, связанное * \*значение pfErrorCode* можно получить, позвонив по **телефону sLInstallerError.** В следующей таблице перечислены * \*значения pfErrorCode,* которые могут быть возвращены **S'LInstallerError,** и приведены в изъяны каждое из них в контексте этой функции.  
  
|*\*pfErrorCode*|Error|Описание|  
|---------------------|-----------|-----------------|  
|ODBC_ERROR_GENERAL_ERR|Общая ошибка установки|Произошла ошибка, для которой не было конкретной ошибки установки.|  
|ODBC_ERROR_INVALID_BUFF_LEN|Недействительная длина буфера|Аргумент *lpszPath* не был достаточно большим, чтобы содержать путь вывода. Буфер содержит усеченный путь.<br /><br /> Аргумент *cbPathMax* был менее _MAX_PATH.|  
|ODBC_ERROR_USAGE_UPDATE_FAILED|Не удалось приравливание или decrement количество использования компонента|Установщик не смог нарастанить количество основных компонентов ODBC.|  
|ODBC_ERROR_OUT_OF_MEM|Недостаточно памяти|Установщик не мог выполнить функцию из-за отсутствия памяти.|  
  
## <a name="comments"></a>Комментарии  
 **SLInstallDriverManager** призван авердия для возврата пути для компонентов odBC ядра и увеличение количества использования компонентов в системе информации. Если версия диспетчера драйвера уже существует, но количество использования компонентов для драйвера не существует, значение количества нового компонента устанавливается на 2.  
  
 Программа настройки приложения отвечает за физическое копирование основных файлов компонентов и поддержание количества использования файлов. Если файл основного компонента ранее не был установлен, программа настройки приложения должна скопировать файл и создать количество использования файла. Если файл был ранее установлен, программа настройки просто наращает количество использования файла.  
  
 Если старая версия менеджера драйвера была ранее установлена программой настройки приложения, основные компоненты должны быть неустановлены, а затем переустановлены, так что количество использования основного компонента является действительным. **Сначала** следует позвонить для decrement, чтобы исключить количество использования компонентов. Затем следует призвать **slInstallDriverManager** для приращения количества использования компонентов. Программа настройки приложения должна заменить старые файлы компонентов ядра новыми файлами. Количество использования файлов останется прежним, и другие приложения, которые использовали старые файлы ядра версии, теперь будут использовать новые файлы версий.  
  
 При свежей установке основных компонентов ODBC, драйверов и переводчиков программа настройки приложения должна вызывать следующие функции в последовательности: **S'LInstallDriverManager**, **S'LInstallDriverEx**, **S'LConfigDriver** (с *ODBC_INSTALL_DRIVER),* а затем **S'LInstallTranslatorTranslatorEx.** При удалении основных компонентов, драйверов и переводчиков программа настройки приложения должна вызывать следующие функции последовательно: **S'LRemoveTranslator,** **S'LRemoveDriver**, а затем **S'LRemoveDriver.** Эти функции должны быть вызваны в этой последовательности. При обновлении всех компонентов все функции удаления должны вызываться последовательно, а затем все функции установки должны вызываться последовательно.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Добавление, изменение или удаление драйвера|[СЗЛКонзигДрайвер](../../../odbc/reference/syntax/sqlconfigdriver-function.md)|  
|Установка драйвера|[СЗЛУстантЛисонДрайверЭкс](../../../odbc/reference/syntax/sqlinstalldriverex-function.md)|  
|Установка переводчика|[СЗЛУстантинТрансрекс](../../../odbc/reference/syntax/sqlinstalltranslatorex-function.md)|  
|Удаление драйвера|[СЗЛЛиУМДрайвер](../../../odbc/reference/syntax/sqlremovedriver-function.md)|  
|Удаление менеджера драйвера|[СЗЛУдалениеДрайверМенеджер](../../../odbc/reference/syntax/sqlremovedrivermanager-function.md)|  
|Удаление переводчика|[СЗЛУдалитьПереводчик](../../../odbc/reference/syntax/sqlremovetranslator-function.md)|
