---
title: СЗЛУправлениеДатаИсточники (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLManageDataSources
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLManageDataSources
helpviewer_keywords:
- SQLManageDataSources [ODBC]
ms.assetid: ac6d186f-b394-406c-94c4-c6331d1ca468
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 3b572a861af3479e1543be9fda9598cc7e25d36c
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81290222"
---
# <a name="sqlmanagedatasources"></a>SQLManageDataSources
**Соответствия**  
 Представлена версия: ODBC 2.0  
  
 **Сводка**  
 **SLManageDataSources** отображает диалоговое окно, с помощью которого пользователи могут настроить, добавить и удалить источники данных в системной информации.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
BOOL SQLManageDataSources(  
     HWND     hwnd);  
```  
  
## <a name="arguments"></a>Аргументы  
 *Hwnd*  
 (Вход) Ручка родительского окна.  
  
## <a name="returns"></a>Результаты  
 **S'LManageDataSources** возвращает FALSE, если *hwnd* не является действительной ручкой окна. В противном случае возвращается значение TRUE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **S'LManageDataSources** возвращает FALSE, связанное * \*значение pfErrorCode* можно получить, позвонив по **телефону S'LInstallerError.** В следующей таблице перечислены * \*значения pfErrorCode,* которые могут быть возвращены **S'LInstallerError,** и приведены в изъяны каждое из них в контексте этой функции.  
  
|*\*pfErrorCode*|Error|Описание|  
|---------------------|-----------|-----------------|  
|ODBC_ERROR_GENERAL_ERR|Общая ошибка установки|Произошла ошибка, для которой не было конкретной ошибки установки.|  
|ODBC_ERROR_REQUEST_FAILED|*Запрос* не удался|Вызов на **ConfigDSN** не удалось.|  
|ODBC_ERROR_INVALID__HWND|Недействительная ручка окна|Аргумент *hwnd* был недействительным или NULL.|  
|ODBC_ERROR_OUT_OF_MEM|Недостаточно памяти|Установщик не мог выполнить функцию из-за отсутствия памяти.|  
  
## <a name="managing-data-sources"></a>Управление источниками данных  
 **SLManageDataSources** первоначально отображает диалоговый ящик **администратора ODBC Data Source,** как показано на следующей иллюстрации.  
  
 ![Диалоговое окно администратора источника данных ODBC](../../../odbc/reference/syntax/media/ch23e.gif "CH23E")  
  
 В диалоговом поле отображаются источники данных, перечисленные в системе информации под тремя вкладками: **User DSN,** **System DSN**и **File DSN.** Если пользователь дважды щелкает к источнику данных или выбирает источник данных и кликов **накидку,** **S'LManageDataSources** вызывает **ConfigDSN** в настройке DLL с ODBC_CONFIG_DSN опцией.  
  
 Если пользователь нажимает **Добавить**, **S'LManageDataSources** отображает Создание нового источника **данных** диалоговое окно, показано в следующей иллюстрации.  
  
 ![Диалоговое окно создания нового источника данных](../../../odbc/reference/syntax/media/ch23f.gif "CH23F")  
  
 В диалоговом поле отображается список установленных драйверов. Если пользователь дважды щелкает водителем или выбирает драйвер и нажимает **OK,** **S'LManageDataSources** вызывает **ConfigDSN** в настройке DLL и передает ему ODBC_ADD_DSN опцию.  
  
 Если пользователь выбирает источник данных и нажимает **удалить,** **S'LManageDataSources** спрашивает, хочет ли пользователь удалить источник данных. Если пользователь нажимает **Да,** **S'LManageDataSources** вызывает **ConfigDSN** в настройке DLL с ODBC_REMOVE_DSN опцией.  
  
 Для добавления или удаления источника данных пользователя, системного источника данных или источника данных файла используется диалоговый ящик **Create New Data.**  
  
## <a name="user-dsns"></a>Пользователь DSNs  
 DSNs, созданные для отдельных пользователей, будут называться Пользовательскими DSNs, чтобы отличить их от системных DSN. DSNs-пользователей регистрируются следующим образом в информации системы:  
  
 `HKEY_CURRENT_USERS`  
  
 `SOFTWARE`  
  
 `ODBC`  
  
 `Odbc.ini`  
  
## <a name="system-dsns"></a>Система DSNs  
 Диалоговый ящик **Create New Data Source** позволяет добавлять источник системных данных на локальном компьютере или удалять его или устанавливать конфигурацию для источника системных данных.  
  
 Источник данных, настроенный с именем источника данных системы (DSN), может использоваться более чем одним пользователем на одной машине. Он также может быть использован общесистемной службой, которая затем может получить доступ к источнику данных, даже если пользователь не входит в систему машины.  
  
 Система DSN зарегистрирована в HKEY_LOCAL_MACHINE ввода в системе информации, а не в HKEY_CURRENT_USER входе. Он не привязан к одному пользователю, который входит в систему с его или ее конкретное имя пользователя и пароль, но может быть использован любым пользователем этой машины или автоматической системной службы. Система DSN, однако, привязана к одной машине. Он не поддерживает возможность использования удаленных DSN между машинами. Системные DSN регистрируются следующим образом в системной информации:  
  
 HKEY_LOCAL_MACHINE SOFTWARE ODBC Odbc.ini  
  
## <a name="file-dsns"></a>Файл DSN  
 Источник данных файла не имеет имени источника данных, как и источник данных машины, и не зарегистрирован ни на одном пользователе или машине. Информация о подключении к этому источнику данных содержится в файле .dsn, который может быть скопирован на любую машину. Источник данных файла может быть добыт, и в этом случае файл .dsn находится в сети и может использоваться одновременно несколькими пользователями в сети до тех пор, пока пользователь имеет соответствующий драйвер установлен. Источник данных файла также может быть недораздельным, и в этом случае он может быть использован только на одной машине.  
  
 Для получения дополнительной информации об источниках данных файла [см. Подключение с использованием источников файлов](../../../odbc/reference/develop-app/connecting-using-file-data-sources.md)или см. [SQLDriverConnect](../../../odbc/reference/syntax/sqldriverconnect-function.md)  
  
## <a name="managing-drivers"></a>Управление драйверами  
 Если пользователь нажимает на вкладку **Драйверы** в диалоговом окне администратора источников **данных ODBC,** **S'LManageDataSources** отображает список драйверов ODBC, установленных в системе, а также информацию о драйверах. Отображаемые даты — это дата создания драйвера, как показано на следующей иллюстрации.  
  
 ![Администратор источника данных ODBC: вкладка драйверов](../../../odbc/reference/syntax/media/ch23g.gif "ch23g")  
  
## <a name="tracing-options"></a>Параметры трассировки  
 Если пользователь нажимает на вкладку **Трассировка** в диалоговом окне администратора источников **данных ODBC Data,** **S'LManageDataSources** отображает параметры отслеживания, как показано на следующей иллюстрации.  
  
 ![Администратор источника данных ODBC: вкладка трассировок](../../../odbc/reference/syntax/media/ch23h.gif "Ch23h")  
  
 Если пользователь нажимает **кнопку Start Tracing Now,** а затем нажимает **OK,** **S'LManageDataSources** позволяет осуществлять отслеживание вручную для всех приложений, работающих на машине.  
  
 Если пользователь указывает имя файла трассировки в текстовом поле **Путь журнала,** а затем нажимает **OK,** **S'LManageDataSources** устанавливает ключевое слово **TraceFile** в разделе «ODBC» системной информации на указанное имя.  
  
> [!IMPORTANT]  
>  Поддержка Visual Studio Analyzer была удалена с Windows 8 (Visual Studio Analyzer была включена только в старые версии Visual Studio.). Для альтернативного механизма устранения неполадок используйте отслеживание BID.  
  
 Если пользователь нажимает **Start Visual Studio Analyzer,** а затем нажимает **OK,** visual Studio Analyzer включен. Он остается включенным до тех пор, пока **stop Visual Studio Analyzer** не нажат.  
  
 Для получения дополнительной информации [Tracing](../../../odbc/reference/develop-app/tracing.md)о розыске см. Для получения дополнительной информации о **ключевых** словах Trace и **TraceFile** [см.](../../../odbc/reference/install/odbc-subkey.md)  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Создание источников данных|[СЗЛСоздатьДатаИсточник](../../../odbc/reference/syntax/sqlcreatedatasource-function.md)|
