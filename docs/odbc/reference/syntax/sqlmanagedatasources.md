---
title: SQLManageDataSources | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLManageDataSources
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLManageDataSources
helpviewer_keywords:
- SQLManageDataSources [ODBC]
ms.assetid: ac6d186f-b394-406c-94c4-c6331d1ca468
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 529c503bc10d3ed0b69a4c280c7fa63e72893f8f
ms.sourcegitcommit: 7a3243c45830cb3f49a7fa71c2991a9454fd6f5a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/11/2019
ms.locfileid: "65536566"
---
# <a name="sqlmanagedatasources"></a>SQLManageDataSources
**Соответствие стандартам**  
 Представленные версии: ODBC 2.0  
  
 **Сводка**  
 **SQLManageDataSources** отображает диалоговое окно, с помощью которого пользователи могут настроить, добавлять и удалять источники данных в сведения о системе.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
BOOL SQLManageDataSources(  
     HWND     hwnd);  
```  
  
## <a name="arguments"></a>Аргументы  
 *HWND*  
 [Вход] Дескриптор родительского окна.  
  
## <a name="returns"></a>Возвращает  
 **SQLManageDataSources** возвращает FALSE, если *hwnd* не на допустимый дескриптор окна. В противном случае возвращается значение TRUE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLManageDataSources** возвращает значение FALSE, связанным  *\*pfErrorCode* значение можно получить, вызвав **SQLInstallerError**. В следующей таблице перечислены  *\*pfErrorCode* значения, которые могут быть возвращены **SQLInstallerError** и объясняется каждый из них в контексте этой функции.  
  
|*\*pfErrorCode*|Ошибка|Описание|  
|---------------------|-----------|-----------------|  
|ODBC_ERROR_GENERAL_ERR|Ошибки общие установщика|Произошла ошибка для которой нет ошибок определенных установщика.|  
|ODBC_ERROR_REQUEST_FAILED|*Запросить* сбой|Вызов **ConfigDSN** не удалось.|  
|ODBC_ERROR_INVALID__HWND|Недопустимый дескриптор окна|*Hwnd* аргумент был недопустимым, или значение NULL.|  
|ODBC_ERROR_OUT_OF_MEM|Недостаточно памяти|Программа установки не удалось выполнить функцию из-за нехватки памяти.|  
  
## <a name="managing-data-sources"></a>Управление источниками данных  
 **SQLManageDataSources** изначально отображает **администратор источников данных ODBC** диалоговое окно, как показано на следующем рисунке.  
  
 ![Диалоговое окно администратора источника данных ODBC](../../../odbc/reference/syntax/media/ch23e.gif "CH23E")  
  
 В диалоговом окне отображается источников данных, перечисленных в сведениях о системе трех вкладках: **DSN пользователя**, **системное имя DSN**, и **файл DSN**. Если пользователь дважды щелкает источника данных или выбирает источник данных и нажимает **Настройка**, **SQLManageDataSources** вызовы **ConfigDSN** в программе установки библиотеки DLL с ODBC_CONFIG_ Параметр имени DSN.  
  
 Если пользователь нажимает кнопку **добавить**, **SQLManageDataSources** отображает **Создание нового источника данных** диалоговое окно, показанное на следующем рисунке.  
  
 ![Создать новый источник данных-диалоговое окно](../../../odbc/reference/syntax/media/ch23f.gif "CH23F")  
  
 Диалоговое окно отображает список установленных драйверов. Если пользователь дважды щелкает драйвер или выбирает драйвер и щелкает **ОК**, **SQLManageDataSources** вызовы **ConfigDSN** в DLL-файлов установки и передает его параметр ODBC_ADD_DSN.  
  
 Если пользователь выбирает источник данных и нажимает **удалить**, **SQLManageDataSources** запрашивает ли пользователь хочет удалить источник данных. Если пользователь нажимает кнопку **Да**, **SQLManageDataSources** вызовы **ConfigDSN** в DLL-файлов установки с параметром значение ODBC_REMOVE_DSN.  
  
 **Создание нового источника данных** диалоговое окно используется для добавления или удаления источника данных, системный источник данных или источника данных.  
  
## <a name="user-dsns"></a>Пользовательские имена DSN  
 Источники данных, созданные для отдельных пользователей будет вызываться пользовательских источников данных, чтобы отличать их от системных имен DSN. Пользовательские имена DSN, регистрируются в сведения о системе следующим образом:  
  
 `HKEY_CURRENT_USERS`  
  
 `SOFTWARE`  
  
 `ODBC`  
  
 `Odbc.ini`  
  
## <a name="system-dsns"></a>Системных имен DSN  
 **Создание нового источника данных** диалоговое окно позволяет добавить системный источник данных на локальном компьютере или удалите один или задать конфигурацию для источника данных.  
  
 Настройка с помощью системы имя источника данных (DSN) источника данных используется более чем одним пользователем, на одном компьютере. Он также может использоваться службой всей системы, которая затем могут получить доступ к источнику данных, даже если пользователь не вошел в систему на компьютере.  
  
 Системный источник данных зарегистрирован в HKEY_LOCAL_MACHINE записи в сведениях о системе, а не в HKEY_CURRENT_USER записи. Он не привязан к одного пользователя, который входит в систему с его именем конкретного пользователя и пароль, но может использоваться любым пользователем этого компьютера или с помощью службы автоматического всей системы. Системный DSN тем не менее, привязаны к одной машины. Он не поддерживает возможность использования удаленных источников данных между компьютерами. Системных имен DSN, регистрируются в сведениях о системе следующим образом:  
  
 HKEY_LOCAL_MACHINE    SOFTWARE       ODBC          Odbc.ini  
  
## <a name="file-dsns"></a>Файловые источники данных  
 Источника данных имеет имя источника данных, так как не машинные источники данных и не зарегистрирована для любого одного пользователя или компьютера. Сведения о подключении для этого источника данных содержится в файле .dsn, который можно скопировать на любой компьютер. Файл источника данных может быть совместного использования, в этом случае файл .dsn находится в сети и может использоваться одновременно несколькими пользователями в сети до тех пор, пока у пользователя есть установлены соответствующие драйверы. Источника данных может также быть непригодные для совместного использования, в этом случае он может использоваться только на одном компьютере.  
  
 Дополнительные сведения о файловых источников данных, см. в разделе [подключение с использованием файловых источников данных](../../../odbc/reference/develop-app/connecting-using-file-data-sources.md), или см. в разделе [SQLDriverConnect](../../../odbc/reference/syntax/sqldriverconnect-function.md).  
  
## <a name="managing-drivers"></a>Управление драйверами  
 Если пользователь нажимает кнопку **драйверы** вкладке **администратор источников данных ODBC** диалоговом окне **SQLManageDataSources** отображается список драйверов ODBC, установленных в системе, а также сведения о драйверах. Дата отображается это дата создания драйвера, как показано на следующем рисунке.  
  
 ![Вкладку "драйверы администратор источников данных ODBC"](../../../odbc/reference/syntax/media/ch23g.gif "ch23g")  
  
## <a name="tracing-options"></a>Параметры трассировки  
 При нажатии кнопки **трассировки** вкладке **администратор источников данных ODBC** диалоговом окне **SQLManageDataSources** отображает параметры трассировки, как показано в следующем иллюстрации.  
  
 ![Вкладка трассировок администратор источников данных ODBC](../../../odbc/reference/syntax/media/ch23h.gif "Ch23h")  
  
 Если пользователь нажимает кнопку **запустить трассировку** и щелкает **ОК**, **SQLManageDataSources** включает трассировку вручную для всех приложений, запущенных на компьютере.  
  
 Если пользователь указывает имя файла трассировки в **файл журнала путь** текстовое поле, а затем нажимает кнопку **ОК**, **SQLManageDataSources** задает **TraceFile** ключевое слово в разделе [ODBC], информация о системе для указанного имени.  
  
> [!IMPORTANT]  
>  Поддержка Visual Studio Analyzer была удалена, начиная с Windows 8 (Visual Studio Analyzer была включена только в более ранних версиях Visual Studio.). Устранение неполадок механизм альтернативные способы используйте трассировка встроенных средств диагностики.  
  
 Если пользователь нажимает кнопку **запуска анализатора** и щелкает **ОК**, Visual Studio Analyzer включен. Она остается включенной до **остановить Visual Studio Analyzer** нажатии.  
  
 Дополнительные сведения о трассировке см. в разделе [трассировки](../../../odbc/reference/develop-app/tracing.md). Дополнительные сведения о **трассировки** и **TraceFile** ключевые слова, см. в разделе [подраздел ODBC](../../../odbc/reference/install/odbc-subkey.md).  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Создание источников данных|[SQLCreateDataSource](../../../odbc/reference/syntax/sqlcreatedatasource-function.md)|
