---
title: Функция Склкомплетеасинк | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
f1_keywords:
- SQLCompleteAsync
helpviewer_keywords:
- SQLCompleteAsync function [ODBC]
ms.assetid: 1b97c46a-d2e5-4540-8239-9d975e5321c6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 4e09d61ef516e846798dd3af2d07dafa78af4605
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "81299659"
---
# <a name="sqlcompleteasync-function"></a>Функция SQLCompleteAsync
**Соответствия**  
 Введенная версия: ODBC 3,8  
  
 Соответствие стандартам: нет  
  
 **Сводка**  
 **Склкомплетеасинк** можно использовать для определения завершения асинхронной функции с помощью обработки на основе уведомлений или опроса. Дополнительные сведения об асинхронных операциях см. в разделе [асинхронное выполнение](../../../odbc/reference/develop-app/asynchronous-execution.md).  
  
 **Склкомплетеасинк** реализован только в ДИСПЕТЧЕРЕ драйверов ODBC.  
  
 В режиме асинхронной обработки на основе уведомлений **склкомплетеасинк** должен вызываться после того, как диспетчер драйверов создает объект события, используемый для уведомления. **Склкомплетеасинк** завершает асинхронную обработку, а асинхронная функция создаст код возврата.  
  
 В режиме асинхронной обработки на основе опроса **склкомплетеасинк** является альтернативой вызову исходной асинхронной функции без необходимости указания аргументов в исходном вызове асинхронной функции. **Склкомплетеасинк** можно использовать независимо от того, включена ли библиотека курсоров ODBC.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLCompleteAsync(  
      SQLSMALLINT HandleType,  
      SQLHANDLE   Handle,  
      RETCODE *   AsyncRetCodePtr);  
```  
  
## <a name="arguments"></a>Аргументы  
 *HandleType*  
 Входной Тип маркера, для которого завершается асинхронная обработка. Допустимые значения: SQL_HANDLE_DBC или SQL_HANDLE_STMT.  
  
 *Дескриптор*  
 Входной Маркер, по которому завершается асинхронная обработка. Если *Handle* не является допустимым маркером типа, указанного параметром *параметром handletype*, **склкомплетеасинк** возвращает SQL_INVALID_HANDLE.  
  
 Если *Handle* не является допустимым маркером типа, указанного параметром *параметром handletype*, **склкомплетеасинк** возвращает SQL_INVALID_HANDLE.  
  
 *асинкреткодептр*  
 Проверки Указатель на буфер, который будет содержать код возврата асинхронного API. Если *асинкреткодептр* имеет значение null, **склкомплетеасинк** возвращает SQL_ERROR.  
  
## <a name="returns"></a>Результаты  
 SQL_SUCCESS, SQL_ERROR, SQL_NO_DATA или SQL_INVALID_HANDLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Если **склкомплетеасинк** возвращает SQL_SUCCESS, приложение должно получить код возврата асинхронной функции из буфера, на который указывает *асинкреткодептр*. Связанное значение SQLSTATE, если таковое имеется, можно получить, вызвав **SQLGetDiagRec** с *параметром handletype* SQL_HANDLE_STMT и маркером инструкции или *параметром handletype* SQL_HANDLE_DBC и маркером соединения. Эти диагностические записи связаны с асинхронной функцией, а не с этой функцией **склкомплетеасинк** .  
  
 **Склкомплетеасинк** возвращает код, отличный от SQL_SUCCESS, чтобы указать, что **склкомплетеасинк** не вызывается правильно. В этом случае **склкомплетеасинк** не будет публиковать диагностическую запись. Возможные коды возврата:  
  
-   SQL_INVALID_HANDLE: маркер, указанный *параметром handletype* и *Handle* , не является допустимым маркером.  
  
-   SQL_ERROR: *асинкреткодептр* имеет значение null или асинхронная обработка для этого маркера не включена.  
  
-   SQL_NO_DATA: в режиме уведомления асинхронная операция не выполняется или диспетчер драйверов не уведомил приложение. В режиме опроса асинхронная операция не выполняется.  
  
## <a name="comments"></a>Комментарии  
 В режиме асинхронной обработки на основе опроса *асинкреткодептр* может быть SQL_STILL_EXECUTING, когда **склкомплетеасинк** возвращает SQL_SUCCESS. Приложение должно выполнять опрос до тех пор, пока *асинкреткодептр* не SQL_STILL_EXECUTING. В режиме асинхронной обработки на основе уведомлений *асинкреткодептр* никогда не будет SQL_STILL_EXECUTING.  
  
## <a name="see-also"></a>См. также:  
 [Асинхронное выполнение (метод опроса)](../../../odbc/reference/develop-app/asynchronous-execution-polling-method.md)
