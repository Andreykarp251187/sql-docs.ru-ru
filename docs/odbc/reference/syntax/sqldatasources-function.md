---
title: Функция S'LDataИсточники (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLDataSources
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLDataSources
helpviewer_keywords:
- SQLDataSources function [ODBC]
ms.assetid: 3f63b1b4-e70e-44cd-96c6-6878d50d0117
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: b56a6c25e54897e67beaf39d3b7797ac45391d7b
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81301184"
---
# <a name="sqldatasources-function"></a>Функция SQLDataSources
**Соответствия**  
 Представлена версия: Соответствие стандартам ODBC 1.0: ISO 92  
  
 **Сводка**  
 **S'LDataSources** возвращает информацию об источнике данных. Эта функция выполняется только менеджером драйвера.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLDataSources(  
     SQLHENV          EnvironmentHandle,  
     SQLUSMALLINT     Direction,  
     SQLCHAR *        ServerName,  
     SQLSMALLINT      BufferLength1,  
     SQLSMALLINT *    NameLength1Ptr,  
     SQLCHAR *        Description,  
     SQLSMALLINT      BufferLength2,  
     SQLSMALLINT *    NameLength2Ptr);  
```  
  
## <a name="arguments"></a>Аргументы  
 *Окружающая средаРучка*  
 (Вход) Ручка окружающей среды.  
  
 *Направление*  
 (Вход) Определяет, о каком источнике данных возвращается диспетчер драйверов. Возможны следующие варианты:  
  
 SQL_FETCH_NEXT (чтобы получить следующее имя источника данных в списке), SQL_FETCH_FIRST (чтобы получить с начала списка), SQL_FETCH_FIRST_USER (чтобы получить первого пользователя DSN), или SQL_FETCH_FIRST_SYSTEM (для получения первой системы DSN).  
  
 Когда *Направление* настроено на SQL_FETCH_FIRST, последующие вызовы на **S'LDataSources** с *направлением,* установленным для SQL_FETCH_NEXT возврата как пользователей, так и системы DSN. Когда *Направление* настроено на SQL_FETCH_FIRST_USER, все последующие вызовы на **S'LDataSources** с *направлением,* установленным для SQL_FETCH_NEXT возврата только пользователей DSNs. Когда *Направление* настроено на SQL_FETCH_FIRST_SYSTEM, все последующие вызовы на **S'LDataSources** с *направлением,* установленным на SQL_FETCH_NEXT возврата только системы DSNs.  
  
 *ServerName*  
 (Выход) Указатель на буфер, в котором можно вернуть имя источника данных.  
  
 Если *ServerName* является NULL, *NameLength1Ptr* по-прежнему возвращает общее количество символов (за исключением символа с нулевым прекращением для данных символов), доступных для возврата в буфере, на который указывает *ServerName.*  
  
 *БуферДлин1*  
 (Вход) Длина буфера*ServerName* в символах; это не должно быть длиннее, чем SQL_MAX_DSN_LENGTH плюс символ нулевого прекращения.  
  
 *NameLength1Ptr*  
 (Выход) Указатель на буфер, в котором можно вернуть общее количество символов (за исключением символа нулевого прекращения), доступного для возврата в \* *ServerName*. Если количество символов, доступных для возврата, больше или равно *BufferLength1,* имя источника данных в \* *ServerName* усечено до *BufferLength1* за вычетом длины символа с нулевым прекращением.  
  
 *Описание*  
 (Выход) Указатель на буфер, в котором можно вернуть описание драйвера, связанного с источником данных. Например, dBASE или сервер S'L.  
  
 Если *Описание* NULL, *NameLength2Ptr* по-прежнему возвращает общее количество символов (за исключением символа с нулевым прекращением для данных символов), доступного для возврата в буфере, на который указывает *Описание.*  
  
 *БуферДлин2*  
 (Вход) Длина в символах буфера*описания.*  
  
 *NameLength2Ptr*  
 (Выход) Указатель на буфер, в котором можно вернуть общее количество символов (за исключением символа нулевого прекращения), доступного для возврата в \* *описании*. Если количество символов, доступных для возврата, больше или равно *описанию BufferLength2,* описание драйвера в \* *Описании* усечено до *BufferLength2* минус длина персонажа с нулевым прекращением.  
  
## <a name="returns"></a>Результаты  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_NO_DATA, SQL_ERROR или SQL_INVALID_HANDLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **S'LDataSources** возвращается либо SQL_ERROR, либо SQL_SUCCESS_WITH_INFO, связанное с этим значение S'LSTATE можно получить, позвонив по **телефону s'LGetDiagRec** с *помощью handleType* of SQL_HANDLE_ENV и *ручкой* *environmentHandle.* В следующей таблице перечислены значения S'LSTATE, обычно возвращаемые **S'LDataSources,** и разъясняется каждая из них в контексте этой функции; нотация "(DM)" предшествует описаниям S'LSTATEs, возвращенным менеджером драйвера. Код возврата, связанный с каждым значением S'LSTATE, является SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Error|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|(DM) Драйвер менеджер-специфическое информационное сообщение. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|01004|Строковые данные, правые усеченные|(DM) Буфер \* *ServerName* не был достаточно большим, чтобы вернуть полное имя источника данных. Таким образом, название было усечено. Длина всего имени источника данных \*возвращается в *NameLength1Ptr*. (Функция возвращает SQL_SUCCESS_WITH_INFO.)<br /><br /> (DM) \* *Описание* буфера не было достаточно большим, чтобы вернуть полное описание драйвера. Таким образом, описание было усечено. Длина непросеченного описания источника данных возвращается в*nameLength2Ptr*. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|HY000|Общая ошибка|(DM) Произошла ошибка, в соответствии с которой не было конкретного S'LSTATE и для которой не было определено конкретное осуществление СЗЛСТАТ. Сообщение об ошибке, возвращенное **S'LGetDiagRec** в * \*буфере MessageText,* описывает ошибку и ее причину.|  
|HY001|Ошибка распределения памяти|(DM) Менеджер драйвера не смог выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY010|Ошибка последовательности функций|(DM) **S'LExecute**, **S'LExecDirect**, или **S'LMoreResults** был вызван для *statementHandle* и вернулся SQL_PARAM_DATA_AVAILABLE. Эта функция была вызвана до того, как данные были извлечены для всех потоковых параметров.|  
|HY013|Ошибка управления памятью|Вызов функции не может быть обработан, поскольку основные объекты памяти не могут быть доступны, возможно, из-за низких условий памяти.|  
|HY090|Недействительная длина строки или буфера|(DM) Значение, указанное для аргумента *BufferLength1,* было меньше 0.<br /><br /> (DM) Значение, указанное для аргумента *BufferLength2,* было меньше 0.|  
|HY103|Недействительный код поиска|(DM) Значение, указанное для аргумента *Направление* не было равен SQL_FETCH_FIRST, SQL_FETCH_FIRST_USER, SQL_FETCH_FIRST_SYSTEM или SQL_FETCH_NEXT.|  
|HY117|Подключение приостанавливается из-за неизвестного состояния транзакции. Разрешены только отключить и прочитать только функции.|(DM) Для получения дополнительной информации о приостановленном состоянии, [см.](../../../odbc/reference/syntax/sqlendtran-function.md)|  
  
## <a name="comments"></a>Комментарии  
 Поскольку **S'LDataSources** реализован в менеджере драйверов, он поддерживается для всех водителей, независимо от соответствия определенным требованиям драйвера.  
  
 Приложение может вызывать **S'LDataSources** несколько раз, чтобы получить все имена источников данных. Менеджер драйвера извлекает эту информацию из системной информации. Когда больше нет имен источников данных, менеджер драйвера возвращает SQL_NO_DATA. Если **S'LDataSources** вызывается с SQL_FETCH_NEXT сразу же после того, как он возвращается SQL_NO_DATA, он вернет имя первого источника данных. Для получения информации о том, как приложение использует информацию, возвращенную **S'LDataSources,** [см.](../../../odbc/reference/develop-app/choosing-a-data-source-or-driver.md)  
  
 Если SQL_FETCH_NEXT передается **в S'LDataSources** при первом вызове, он вернет имя первого источника данных.  
  
 Драйвер определяет, как имена источников данных отображаются к фактическим источникам данных.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Обнаружение и перечисление значений, необходимых для подключения к источнику данных|[Функция SQLBrowseConnect](../../../odbc/reference/syntax/sqlbrowseconnect-function.md)|  
|Подключение к источнику данных|[Функция S'LConnect](../../../odbc/reference/syntax/sqlconnect-function.md)|  
|Подключение к источнику данных с помощью строки соединения или диалогового окна|[Функция SQLDriverConnect](../../../odbc/reference/syntax/sqldriverconnect-function.md)|  
|Возвращение описания и атрибутики драйвера|[Функция SQLDrivers](../../../odbc/reference/syntax/sqldrivers-function.md)|  
  
## <a name="see-also"></a>См. также:  
 [Справка aPI ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)
