---
title: Функция SQLDataSources | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLDataSources
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLDataSources
helpviewer_keywords:
- SQLDataSources function [ODBC]
ms.assetid: 3f63b1b4-e70e-44cd-96c6-6878d50d0117
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 9207dde54a14e345e99d3c04d4cb66622d85972e
ms.sourcegitcommit: 7a3243c45830cb3f49a7fa71c2991a9454fd6f5a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/11/2019
ms.locfileid: "65537639"
---
# <a name="sqldatasources-function"></a>Функция SQLDataSources
**Соответствие стандартам**  
 Представленные версии: Соответствие стандартам 1.0 ODBC: ISO-92  
  
 **Сводка**  
 **SQLDataSources** возвращает сведения об источнике данных. Эта функция реализуется только диспетчером драйверов.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLDataSources(  
     SQLHENV          EnvironmentHandle,  
     SQLUSMALLINT     Direction,  
     SQLCHAR *        ServerName,  
     SQLSMALLINT      BufferLength1,  
     SQLSMALLINT *    NameLength1Ptr,  
     SQLCHAR *        Description,  
     SQLSMALLINT      BufferLength2,  
     SQLSMALLINT *    NameLength2Ptr);  
```  
  
## <a name="arguments"></a>Аргументы  
 *EnvironmentHandle*  
 [Вход] Дескриптор среды.  
  
 *Направление*  
 [Вход] Определяет, какой источник данных диспетчера драйверов возвращает сведения о. Возможны следующие варианты:  
  
 SQL_FETCH_NEXT (для выборки следующего имя источника данных в списке), SQL_FETCH_FIRST (извлекаемых из начала списка), SQL_FETCH_FIRST_USER (для выборки первого пользовательское имя источника данных) или SQL_FETCH_FIRST_SYSTEM (для получения первого системное имя DSN).  
  
 Когда *направление* присваивается SQL_FETCH_FIRST, последующие вызовы **SQLDataSources** с *направление* набора для SQL_FETCH_NEXT возвращают пользовательских и системных источников данных. При *направление* присваивается SQL_FETCH_FIRST_USER, все последующие вызовы **SQLDataSources** с *направление* набора для SQL_FETCH_NEXT возвращают только пользовательских источников данных. Когда *направление* присваивается SQL_FETCH_FIRST_SYSTEM, все последующие вызовы **SQLDataSources** с *направление* набора для SQL_FETCH_NEXT возвращают только системных источников данных.  
  
 *ServerName*  
 [Выход] Указатель на буфер, в которую будет возвращено имя источника данных.  
  
 Если *ServerName* имеет значение NULL, *NameLength1Ptr* по-прежнему возвращает общее число символов (включая знак завершения null для символьных данных) для возврата в буфере, на которые указывают *ServerName*.  
  
 *BufferLength1*  
 [Вход] Длина **ServerName* буфера в символах; это не обязательно быть длиннее SQL_MAX_DSN_LENGTH, а также знак завершения null.  
  
 *NameLength1Ptr*  
 [Выход] Указатель на буфер, в которую будет возвращено общее число символов (за исключением знака завершения null) для возврата в \* *ServerName*. Если количество символов, доступных для возврата больше или равно *BufferLength1*, имя источника данных в \* *ServerName* усекается до *BufferLength1* минус длина знак завершения null.  
  
 *Описание*  
 [Выход] Указатель на буфер, в которую будет возвращен Описание драйвера, связанного с источником данных. Например файлу dBASE или SQL Server.  
  
 Если *описание* имеет значение NULL, *NameLength2Ptr* по-прежнему возвращает общее число символов (включая знак завершения null для символьных данных) для возврата в буфере, на которые указывают *Описание*.  
  
 *BufferLength2*  
 [Вход] Длина в символах **описание* буфера.  
  
 *NameLength2Ptr*  
 [Выход] Указатель на буфер, в которую будет возвращено общее число символов (за исключением знака завершения null) для возврата в \* *описание*. Если количество символов, доступных для возврата больше или равно *BufferLength2*, описание драйвера в \* *описание* усекается до *BufferLength2*  минус длина знак завершения null.  
  
## <a name="returns"></a>Возвращает  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_NO_DATA, SQL_ERROR, or SQL_INVALID_HANDLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLDataSources** возвращает значение SQL_ERROR или SQL_SUCCESS_WITH_INFO, можно получить путем вызова связанного значения SQLSTATE **SQLGetDiagRec** с *HandleType*из SQL_HANDLE_ENV и *обрабатывать* из *EnvironmentHandle*. В следующей таблице перечислены значения SQLSTATE, обычно возвращаемые при помощи **SQLDataSources** и объясняется каждый из них в контексте этой функции; описания SQLSTATE, возвращаемых диспетчером драйверов предшествует обозначение «(DM)». Возвращается связанный с каждого значения SQLSTATE значение SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Ошибка|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|(DM) конкретного диспетчера драйверов информационное сообщение. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|01004|Усечение данных строки справа|(DM) буфера \* *ServerName* не был достаточно велик для того, чтобы вернуть имя источника данных. Таким образом имя усечено. Длина имени источника данных возвращается в \* *NameLength1Ptr*. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).<br /><br /> (DM) буфера \* *описание* не было достаточно крупным для возврата описания завершения драйвера. Таким образом описание были усечены. Длина описания источника неусеченный данных возвращается в **NameLength2Ptr*. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|HY000|Общая ошибка|(DM) произошла ошибка для которой было нет конкретных SQLSTATE и для которого был определен SQLSTATE не зависящие от реализации. Сообщение об ошибке, возвращенные **SQLGetDiagRec** в  *\*MessageText* буфера описывает ошибку и его причины.|  
|HY001|Ошибка выделения памяти|Диспетчер драйверов (DM) не удалось выделить память, необходимая для поддержки выполнения или завершения функции.|  
|HY010|Ошибка последовательности функций|(DM) **SQLExecute**, **SQLExecDirect**, или **SQLMoreResults** был вызван для *StatementHandle* и возвращается SQL_PARAM_DATA_ ДОСТУПНО. Прежде чем данные были получены для всех параметров потоковой вызове этой функции.|  
|HY013|Ошибка управления памятью|Не удалось обработать вызов функции, так как базовые объекты памяти оказываются недоступны, возможно из-за нехватки памяти.|  
|HY090|Недопустимая длина строки или буфера|(DM) значение, указанное для аргумента *BufferLength1* меньше 0.<br /><br /> (DM) значение, указанное для аргумента *BufferLength2* меньше 0.|  
|HY103|Недопустимый код получения|(DM) значение, указанное для аргумента *направление* не равно SQL_FETCH_FIRST, SQL_FETCH_FIRST_USER, SQL_FETCH_FIRST_SYSTEM или SQL_FETCH_NEXT.|  
|HY117|Подключение будет приостановлена из-за состояние транзакции неизвестно. Только отключиться и разрешены функции, доступные только для чтения.|(DM) Дополнительные сведения о состоянии приостановки, см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).|  
  
## <a name="comments"></a>Комментарии  
 Так как **SQLDataSources** реализуется в диспетчер драйверов, она будет поддерживать все драйверы независимо от того, соответствие стандартам конкретного драйвера.  
  
 Приложение может вызвать **SQLDataSources** несколько раз, чтобы получить все имена источников данных. Диспетчер драйверов получает эти сведения из сведений о системе. Если нет дополнительные имена источников данных, диспетчер драйверов вернет значение SQL_NO_DATA. Если **SQLDataSources** вызывается с SQL_FETCH_NEXT сразу же после его вернет значение SQL_NO_DATA, возвращается имя первого источника данных. Сведения о том, как приложение использует сведения, возвращаемые функцией **SQLDataSources**, см. в разделе [Выбор источника данных или драйвера](../../../odbc/reference/develop-app/choosing-a-data-source-or-driver.md).  
  
 Если передается SQL_FETCH_NEXT **SQLDataSources** первый раз, он вызывается, возвращается имя первого источника данных.  
  
 Драйвер определяет сопоставление имен источников данных к источникам данных.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Обнаружение и список значений, необходимых для подключения к источнику данных|[Функция SQLBrowseConnect](../../../odbc/reference/syntax/sqlbrowseconnect-function.md)|  
|Подключение к источнику данных|[Функция SQLConnect](../../../odbc/reference/syntax/sqlconnect-function.md)|  
|Подключение к источнику данных с помощью соединения строки или в диалоговом окне|[Функция SQLDriverConnect](../../../odbc/reference/syntax/sqldriverconnect-function.md)|  
|Возврат описания драйверов и атрибуты|[Функция SQLDrivers](../../../odbc/reference/syntax/sqldrivers-function.md)|  
  
## <a name="see-also"></a>См. также  
 [Справочник по API ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)
