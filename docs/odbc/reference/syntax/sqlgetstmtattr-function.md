---
title: Функция СЗЛГетстматтр Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLGetStmtAttr
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLGetStmtAttr
helpviewer_keywords:
- SQLGetStmtAttr function [ODBC]
ms.assetid: e321d460-e997-4527-aee6-207cf5a498e9
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 89e7c75b412a6358806017102915989a8370dd43
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81303308"
---
# <a name="sqlgetstmtattr-function"></a>SQLGetStmtAttr, функция
**Соответствия**  
 Представлена версия: Соответствие стандартам ODBC 3.0: ISO 92  
  
 **Сводка**  
 **S'LGetStmtAttr** возвращает текущую настройку атрибута оператора.  
  
> [!NOTE]  
>  Для получения дополнительной информации о том, что менеджер драйверов карты эту функцию, когда ODBC 3. *приложение x* работает с ODBC 2. *х* драйвер, см [Отображение функции замены для обратной совместимости приложений.](../../../odbc/reference/develop-app/mapping-replacement-functions-for-backward-compatibility-of-applications.md)  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLGetStmtAttr(  
     SQLHSTMT        StatementHandle,  
     SQLINTEGER      Attribute,  
     SQLPOINTER      ValuePtr,  
     SQLINTEGER      BufferLength,  
     SQLINTEGER *    StringLengthPtr);  
```  
  
## <a name="arguments"></a>Аргументы  
 *Обработка заявления*  
 (Вход) Ручка оператора.  
  
 *Атрибут*  
 (Вход) Атрибут для извлечения.  
  
 *ValuePtr*  
 (Выход) Указатель на буфер, в котором можно вернуть значение атрибута, указанное в *Attribute.*  
  
 Если *ValuePtr* является NULL, *StringLengthPtr* по-прежнему возвращает общее количество байтов (за исключением символа нулевого прекращения для данных символов), доступного для возврата в буфере, на который указывает *ValuePtr.*  
  
 *BufferLength*  
 (Вход) Если *Attribute* является атрибутом, определяемым ODBC, а *ValuePtr* указывает на \*строку символов или бинарный буфер, этот аргумент должен быть длиной *ValuePtr.* Если *Attribute* является атрибутом, \*определяемым ODBC, а *ValuePtr* — неопределенным, *BufferLength* игнорируется. Если значение, возвращенное в * \*ValuePtr,* является строкой Unicode (при вызове **S'LGetStmtAttrW),** аргумент *BufferLength* должен быть четным числом.  
  
 Если *атрибут* является атрибутом, определяемым драйвером, приложение указывает характер атрибута менеджеру драйвера, установив аргумент *BufferLength.* *BufferLength* может иметь следующие значения:  
  
-   Если * \*ValuePtr* является указателем на строку персонажа, то *BufferLength* — это длина строки или SQL_NTS.  
  
-   Если * \*ValuePtr* является указателем на двоичный буфер, то приложение помещает результат SQL_LEN_BINARY_ATTR *(длина)* макроса в *BufferLength.* Это ставит отрицательное значение в *BufferLength*.  
  
-   Если * \*ValuePtr* является указателем на значение, кроме строки персонажа или двоичной строки, то *BufferLength* должен иметь значение SQL_IS_POINTER.  
  
-   Если * \*ValuePtr* содержит тип данных с фиксированной длиной, то *BufferLength* является SQL_IS_INTEGER или SQL_IS_UINTEGER, в случае необходимости.  
  
 *СтрунныйДлинПтр*  
 (Выход) Указатель на буфер, в котором для возврата общего числа байтов (за исключением символа нулевого прекращения), доступного для возврата в * \*ValuePtr.* Если *ValuePtr* является нулевой указатель, длина не возвращается. Если значение атрибута является строкой символов, а количество байтов, доступных для возврата, больше или равно *BufferLength,* данные в * \*ValuePtr* усечены до *BufferLength* минус длина символа с нулевым прекращением и сведена на нет пилотом.  
  
## <a name="returns"></a>Результаты  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_ERROR или SQL_INVALID_HANDLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **S'LGetStmtAttr** возвращается SQL_ERROR или SQL_SUCCESS_WITH_INFO, связанная с этим стоимость S'LSTATE может быть получена, позвонив по **телефону S'LGetDiagRec** с *помощью handleType* of SQL_HANDLE_STMT и *ручки* *выписки.* В следующей таблице перечислены значения S'LSTATE, обычно возвращаемые **S'LGetStmtAttr,** и разъясняются каждое из них в контексте этой функции; нотация "(DM)" предшествует описаниям S'LSTATEs, возвращенным менеджером драйвера. Код возврата, связанный с каждым значением S'LSTATE, является SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Error|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Информационное сообщение, конкретное для водителя. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|01004|Строковые данные, правые усеченные|Данные, возвращенные в * \*ValuePtr,* были усечены как *BufferLength* за вычетом длины символа с нулевым прекращением. Длина непросеченного значения строки возвращается в*строке ДлинаPtr*. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|24 000|Недопустимое состояние курсора|Аргумент *Attribute* был SQL_ATTR_ROW_NUMBER и курсор не был открыт, или курсор был расположен до начала набора результатов или после окончания набора результатов.|  
|HY000|Общая ошибка|Произошла ошибка, в соответствии с которой не было конкретного S'LSTATE и для которой не было определено конкретное осуществление СЗЛСТАТ. Сообщение об ошибке, возвращенное **S'LGetDiagRec** в аргументе *MessageText* описывает ошибку и ее причину.|  
|HY001|Ошибка распределения памяти|Водитель не смог выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY010|Ошибка последовательности функций|(DM) Асинхронно функция выполнения была вызвана для ручки соединения, которая связана с *StatementHandle.* Эта асинхронная функция по-прежнему исполнялась, когда была вызвана функция **S'LGetStmtAttr.**<br /><br /> (DM) Асинхронно выполнение функции был вызван для *StatementHandle* и по-прежнему выполнения, когда эта функция была вызвана.<br /><br /> (DM) **S'LExecute**, **S'LExecDirect**, **S'LBulkOperations**, или **S'LSetPos** был вызван для *statementHandle* и вернулся SQL_NEED_DATA. Эта функция была вызвана до отправки данных для всех параметров или столбцов данных.|  
|HY013|Ошибка управления памятью|Вызов функции не может быть обработан, поскольку основные объекты памяти не могут быть доступны, возможно, из-за низких условий памяти.|  
|HY090|Недействительная длина строки или буфера|*(DM) \*ValuePtr* является строкой символов, и BufferLength был меньше нуля, но не равна SQL_NTS.|  
|HY092|Недействительный идентификатор атрибута/опциона|Значение, указанное для аргумента *Attribute,* не было действительным для версии ODBC, поддерживаемой водителем.|  
|HY109|Положение недействительного курсора|Аргумент *Attribute* был SQL_ATTR_ROW_NUMBER и строка была удалена или не может быть извлечена.|  
|HY117|Подключение приостанавливается из-за неизвестного состояния транзакции. Разрешены только отключить и прочитать только функции.|(DM) Для получения дополнительной информации о приостановленном состоянии, [см.](../../../odbc/reference/syntax/sqlendtran-function.md)|  
|HYC00|Дополнительная функция не реализована|Значение, указанное для аргумента *Attribute,* было допустимой атрибутом оператора ODBC для версии ODBC, поддерживаемой водителем, но не была поддержана водителем.|  
|HYT01|Срок истечения времени подключения|Период тайм-аута соединения истек до того, как источник данных ответил на запрос. Период тайм-аута соединения устанавливается через **S'LSetConnectAttr,** SQL_ATTR_CONNECTION_TIMEOUT.|  
|IM001|Драйвер не поддерживает эту функцию|(DM) Драйвер, соответствующий *statementHandle,* не поддерживает функцию.|  
  
## <a name="comments"></a>Комментарии  
 Для получения общей информации [Statement Attributes](../../../odbc/reference/develop-app/statement-attributes.md)об атрибутах оператора см.  
  
 Вызов на **sLGetStmtAttr** возвращает в * \*ValuePtr* значение атрибута оператора, указанного в *Attribute.* Это значение может быть либо значением S'LULEN, либо строкой символов с нулевым завершением. Если значение является значением S-LULEN, некоторые драйверы могут написать только нижний 32-битный или 16-битный буфер и оставить бит более высокого порядка без изменений. Таким образом, приложения должны использовать буфер S'LULEN и инициализировать значение до 0, прежде чем вызывать эту функцию. Кроме того, аргументы *BufferLength* и *StringLengthPtr* не используются. Если значение является нулевой строкой, приложение определяет максимальную длину этой строки в аргументе *BufferLength,* и драйвер возвращает длину этой строки в * \*буфере StringLengthPtr.*  
  
 Разрешить приложениям, вызываемым **в s'LGetStmtAttr,** работать с ODBC 2. *x* драйверов, звонок на **S'LGetStmtAttr** отображается в менеджере драйверов в **S'LGetStmtOption.**  
  
 Следующие атрибуты оператора читаются только для чтения, поэтому могут быть получены **s'LGetStmtAttr,** но не установлены **S'LSetStmtAttr:**  
  
-   SQL_ATTR_IMP_PARAM_DESC  
  
-   SQL_ATTR_IMP_ROW_DESC  
  
-   SQL_ATTR_ROW_NUMBER  
  
 Список атрибутов, которые можно установить и извлечь, можно найти, [см.](../../../odbc/reference/syntax/sqlsetstmtattr-function.md)  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Возвращение параметра атрибута соединения|[Функция SQLGetConnectAttr](../../../odbc/reference/syntax/sqlgetconnectattr-function.md)|  
|Установка атрибута соединения|[Функция SQLSetConnectAttr](../../../odbc/reference/syntax/sqlsetconnectattr-function.md)|  
|Установка атрибута оператора|[Функция SQLSetStmtAttr](../../../odbc/reference/syntax/sqlsetstmtattr-function.md)|  
  
## <a name="see-also"></a>См. также:  
 [Справка aPI ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)
