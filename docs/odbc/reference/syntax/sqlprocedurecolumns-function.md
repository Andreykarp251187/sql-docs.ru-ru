---
title: Функция S'LProcedureКолонки (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLProcedureColumns
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLProcedureColumns
helpviewer_keywords:
- SQLProcedureColumns function [ODBC]
ms.assetid: 4ca37b28-a6df-465b-8988-d422d37fc025
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 3d81e44b116ed6f26319d31430999a61a8a17f21
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81306855"
---
# <a name="sqlprocedurecolumns-function"></a>SQLProcedureColumns, функция
**Соответствия**  
 Версия Введена: Соответствие стандартам ODBC 1.0: ODBC  
  
 **Сводка**  
 **SLProcedureColumns** возвращает список входных и выходных параметров, а также столбцы, которые составляют результат, установленный для указанных процедур. Водитель возвращает информацию в результате, установленную на указанном заявлении.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLProcedureColumns(  
     SQLHSTMT      StatementHandle,  
     SQLCHAR *     CatalogName,  
     SQLSMALLINT   NameLength1,  
     SQLCHAR *     SchemaName,  
     SQLSMALLINT   NameLength2,  
     SQLCHAR *     ProcName,  
     SQLSMALLINT   NameLength3,  
     SQLCHAR *     ColumnName,  
     SQLSMALLINT   NameLength4);  
```  
  
## <a name="arguments"></a>Аргументы  
 *Обработка заявления*  
 (Вход) Ручка оператора.  
  
 *КаталогНайм*  
 (Вход) Название каталога процедуры. Если драйвер поддерживает каталоги для некоторых процедур, но не для других, например, когда драйвер получает данные из различных DBMS, пустая строка (") означает те процедуры, которые не имеют каталогов. *CatalogName* не может содержать шаблон поиска строк.  
  
 Если атрибут SQL_ATTR_METADATA_ID оператора установлен на SQL_TRUE, *CatalogName* рассматривается как идентификатор, и его случай не является значительным. Если это SQL_FALSE, *CatalogName* является обычным аргументом; к нему относятся буквально, и его случай имеет важное значение. Для получения дополнительной информации смотрите [аргументы в каталоге функции](../../../odbc/reference/develop-app/arguments-in-catalog-functions.md).  
  
 *NameLength1*  
 (Вход) Длина в символах*каталогаName*.  
  
 *Schemaname*  
 (Вход) Шаблон строки поиска для имен схемы процедуры. Если драйвер поддерживает схемы для некоторых процедур, но не для других, например, когда драйвер получает данные из различных DBMS, пустая строка (") означает те процедуры, которые не имеют схем.  
  
 Если атрибут SQL_ATTR_METADATA_ID оператора установлен на SQL_TRUE, *SchemaName* рассматривается как идентификатор и его случай не является значительным. Если это SQL_FALSE, *SchemaName* является аргументом значения шаблона; к нему относятся буквально, и его случай имеет важное значение.  
  
 *NameLength2*  
 (Вход) Длина в символах*SchemaName*.  
  
 *ProcName*  
 (Вход) Шаблон поиска строк для имен процедур.  
  
 Если атрибут SQL_ATTR_METADATA_ID оператора установлен на SQL_TRUE, *ProcName* рассматривается как идентификатор, и его случай не является значительным. Если это SQL_FALSE, *ProcName* является аргументом значения шаблона; к нему относятся буквально, и его случай имеет важное значение.  
  
 *NameLength3*  
 (Вход) Длина в символах*ProcName*.  
  
 *ColumnName*  
 (Вход) Шаблон поиска строк для имен столбцов.  
  
 Если атрибут SQL_ATTR_METADATA_ID оператора установлен на SQL_TRUE, *ColumnName* рассматривается как идентификатор, и его случай не значителен. Если это SQL_FALSE, *ColumnName* является аргументом значения шаблона; к нему относятся буквально, и его случай имеет важное значение.  
  
 *NameLength4*  
 (Вход) Длина в символах*колонкиName*.  
  
## <a name="returns"></a>Результаты  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_STILL_EXECUTING, SQL_ERROR или SQL_INVALID_HANDLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **S'LProcedureColumns** возвращается SQL_ERROR или SQL_SUCCESS_WITH_INFO, связанное с этим значение S'LSTATE можно получить, позвони SQL_HANDLE_STMTв по **телефону S'LGetDiagRec** с *помощью* и *ручки* *выписки.* В следующей таблице перечислены значения S'LSTATE, обычно возвращаемые **S'LProcedureColumns,** и разъясняются каждое из них в контексте этой функции; нотация "(DM)" предшествует описаниям S'LSTATEs, возвращенным менеджером драйвера. Код возврата, связанный с каждым значением S'LSTATE, является SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Error|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Информационное сообщение, конкретное для водителя. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|08S01|Сбой связи|Связь между драйвером и источником данных, к которому был подключен драйвер, не сработала до завершения обработки функции.|  
|24 000|Недопустимое состояние курсора|Курсор был открыт на *statementHandle*, и **S'LFetch** или **S'LFetchScroll** был вызван. Эта ошибка возвращается менеджером-драйвером, если **S'LFetch** или **S'LFetchScroll** не вернулись SQL_NO_DATA, и возвращается драйвером, если **S'LFetch** или **S'LFetchScroll** вернулся SQL_NO_DATA.<br /><br /> Курсор был открыт на *StatementHandle,* но **S'LFetch** или **S'LFetchScroll** не были вызваны.|  
|40001|Сбой сериализации|Транзакция была отката из-за взаимоблокировки ресурсов с другой транзакцией.|  
|40003|Завершение заявления неизвестно|Связанное соединение сбой во время выполнения этой функции, и состояние транзакции не может быть определено.|  
|HY000|Общая ошибка|Произошла ошибка, в соответствии с которой не было конкретного S'LSTATE и для которой не было определено конкретное осуществление СЗЛСТАТ. Сообщение об ошибке, возвращенное **S'LError** в * \*буфере MessageText,* описывает ошибку и ее причину.|  
|HY001|Ошибка распределения памяти|Водитель не смог выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY008|Operation canceled|Асинхронная обработка была включена для *StatementHandle*. Функция была вызвана, и перед завершением выполнения, **S'LCancel** или **S'LКансортхлик** был вызван на *StatementHandle*. Затем функция была вызвана снова на *StatementHandle*.<br /><br /> Функция была вызвана, и перед завершением выполнения, **S'LCancel** или **S'LКансортхливнейра** был вызван на *StatementHandle* из другого потока в многопоточном приложении.|  
|HY009|Недействительное использование нулевой указатель|Атрибут SQL_ATTR_METADATA_ID оператора был установлен на SQL_TRUE, аргумент *CatalogName* был недействительным указателем, а SQL_CATALOG_NAME *InfoType* возвращает, что имена каталогов поддерживаются.<br /><br /> (DM) Атрибут SQL_ATTR_METADATA_ID оператора был установлен на SQL_TRUE, и *SchemaName*, *ProcName*, или *ColumnName* аргумент был нулевой указатель.|  
|HY010|Ошибка последовательности функций|(DM) Асинхронно функция выполнения была вызвана для ручки соединения, которая связана с *StatementHandle.* Эта аиншронная функция по-прежнему исполнялась, когда была вызвана функция S'LProcedureColumns.<br /><br /> (DM) **S'LExecute**, **S'LExecDirect**, или **S'LMoreResults** был вызван для *statementHandle* и вернулся SQL_PARAM_DATA_AVAILABLE. Эта функция была вызвана до того, как данные были извлечены для всех потоковых параметров.<br /><br /> (DM) Асинхронно выполнение функции (не этот) был вызван для *StatementHandle* и по-прежнему выполнения, когда эта функция была вызвана.<br /><br /> (DM) **S'LExecute**, **S'LExecDirect**, **S'LBulkOperations**, или **S'LSetPos** был вызван для *statementHandle* и вернулся SQL_NEED_DATA. Эта функция была вызвана до отправки данных для всех параметров или столбцов данных.|  
|HY090|Недействительная длина строки или буфера|(DM) Значение одного из аргументов длины имени было меньше 0, но не равно SQL_NTS.<br /><br /> Значение одного из аргументов длины имени превысило значение максимальной длины для соответствующего каталога, схемы, процедуры или названия столбца.|  
|HY117|Подключение приостанавливается из-за неизвестного состояния транзакции. Разрешены только отключить и прочитать только функции.|(DM) Для получения дополнительной информации о приостановленном состоянии, [см.](../../../odbc/reference/syntax/sqlendtran-function.md)|  
|HYC00|Дополнительная функция не реализована|Был указан каталог процедур, а драйвер или источник данных не поддерживает каталоги.<br /><br /> Была указана схема процедуры, а драйвер или источник данных не поддерживают схемы.<br /><br /> Шаблон поиска строки был указан для схемы процедуры, названия процедуры или имени столбца, и источник данных не поддерживает шаблоны поиска для одного или нескольких из этих аргументов.<br /><br /> Комбинация текущих параметров атрибутов SQL_ATTR_CONCURRENCY и SQL_ATTR_CURSOR_TYPE оператора не была поддержана драйвером или источником данных.<br /><br /> Атрибут SQL_ATTR_USE_BOOKMARKS оператора был установлен на SQL_UB_VARIABLE, а атрибут SQL_ATTR_CURSOR_TYPE оператора был установлен на тип курсора, для которого водитель не поддерживает закладки.|  
|HYT00|Время ожидания истекло|Период тайм-аута истек до того, как источник данных вернул набор результатов. Период тайм-аута устанавливается с **помощью S'LSetStmtAttr,** SQL_ATTR_QUERY_TIMEOUT.|  
|HYT01|Срок истечения времени подключения|Период тайм-аута соединения истек до того, как источник данных ответил на запрос. Период тайм-аута соединения устанавливается через **S'LSetConnectAttr,** SQL_ATTR_CONNECTION_TIMEOUT.|  
|IM001|Драйвер не поддерживает эту функцию|(DM) Драйвер, связанный с *StatementHandle,* не поддерживает функцию.|  
|IM017|Опрос отключен в асинхронном режиме уведомления|Всякий раз, когда используется модель уведомления, опрос отключается.|  
|IM018|Для завершения предыдущей асинхронной операции на этой ручке не был вызван **S'LCompleteAsync.**|Если предыдущий вызов функции на ручке возвращается SQL_STILL_EXECUTING и если режим уведомления включен, **s'LCompleteAsync** должен быть вызван на ручку, чтобы сделать пост-обработку и завершить операцию.|  
  
## <a name="comments"></a>Комментарии  
 Эта функция обычно используется перед выполнением оператора для получения информации о параметрах процедуры и столбцах, которые составляют набор результатов или наборы, возвращенные процедурой, если таковые имеется. Дополнительные сведения см. в разделе [Procedures in Visual Basic](../../../odbc/reference/develop-app/procedures-odbc.md) (Процедуры в Visual Basic).  
  
> [!NOTE]  
>  **SLProcedureColumns** не может вернуть все столбцы, используемые процедурой. Например, драйвер может возвращать только информацию о параметрах, используемых процедурой, а не о столбцах в наборе результатов, который он генерирует.  
  
 Аргументы *SchemaName,* *ProcName*и *ColumnName* принимают шаблоны поиска. Для получения дополнительной информации об [Pattern Value Arguments](../../../odbc/reference/develop-app/pattern-value-arguments.md)действительных шаблонах поиска см.  
  
> [!NOTE]  
>  Для получения дополнительной информации об общем использовании, аргументах и возвращенных данных функций каталога ODBC [см.](../../../odbc/reference/develop-app/catalog-functions.md)  
  
 **SLProcedureColumns** возвращает результаты в стандартный набор результатов, заказанный PROCEDURE_CAT, PROCEDURE_SCHEM, PROCEDURE_NAME и COLUMN_TYPE. Имена столбцов возвращаются для каждой процедуры в следующем порядке: имя значения возврата, имена каждого параметра в вызове процедуры (в порядке вызова), а затем имена каждого столбца в наборе результатов, возвращенных процедурой (в порядке столбца).  
  
 Приложения должны связывать столбцы, кондитативные по конкретному драйверу, относительно конца набора результатов. Для получения дополнительной информации смотрите [данные, возвращенные функциями каталога](../../../odbc/reference/develop-app/data-returned-by-catalog-functions.md).  
  
 Для определения фактической длины столбцов PROCEDURE_CAT, PROCEDURE_SCHEM, PROCEDURE_NAME и COLUMN_NAME приложение может позвонить в **s'LGetInfo** с вариантами SQL_MAX_CATALOG_NAME_LEN, SQL_MAX_SCHEMA_NAME_LEN, SQL_MAX_PROCEDURE_NAME_LEN и SQL_MAX_COLUMN_NAME_LEN.  
  
 Следующие столбцы были переименованы в ODBC 3. *x*. Изменения имени столбца не влияют на обратную совместимость, поскольку приложения связываются с номером столбца.  
  
|Колонка ODBC 2.0|ODBC 3. *x* колонка|  
|---------------------|-----------------------|  
|PROCEDURE_QUALIFIER|PROCEDURE_CAT|  
|ПРОЦЕДУРА _OWNER|PROCEDURE_SCHEM|  
|PRECISION|COLUMN_SIZE|  
|LENGTH|BUFFER_LENGTH|  
|SCALE|DECIMAL_DIGITS|  
|RADIX|NUM_PREC_RADIX|  
  
 Следующие столбцы были добавлены к набору результатов, возвращенных **S'LProcedureColumns** для ODBC 3. *x*:  
  
-   COLUMN_DEF  
  
-   DATETIME_CODE  
  
-   CHAR_OCTET_LENGTH  
  
-   ORDINAL_POSITION  
  
-   IS_NULLABLE  
  
 В следующей таблице перечислены столбцы в наборе результатов. Дополнительные столбцы за столбец 19 (IS_NULLABLE) могут быть определены драйвером. Приложение должно получить доступ к столбику, в зависимости от драйвера, отсчитывая от конца набора результатов, а не указывая явное обыдающееся положение. Для получения дополнительной информации смотрите [данные, возвращенные функциями каталога](../../../odbc/reference/develop-app/data-returned-by-catalog-functions.md).  
  
|Имя столбца|Номер столбца|Тип данных|Комментарии|  
|-----------------|-------------------|---------------|--------------|  
|PROCEDURE_CAT (ODBC 2.0)|1|Varchar|Название каталога процедур; NULL, если не применим к источнику данных. Если драйвер поддерживает каталоги для некоторых процедур, но не для других, например, когда драйвер получает данные из различных DBMS, он возвращает пустую строку ("") для тех процедур, которые не имеют каталогов.|  
|PROCEDURE_SCHEM (ODBC 2.0)|2|Varchar|Название схемы процедуры; NULL, если не применим к источнику данных. Если драйвер поддерживает схемы для некоторых процедур, но не для других, например, когда драйвер получает данные из различных DBMS, он возвращает пустую строку ("") для тех процедур, которые не имеют схем.|  
|PROCEDURE_NAME (ODBC 2.0)|3|Варчар не NULL|Имя процедуры. Пустая строка возвращается для процедуры, которая не имеет имени.|  
|COLUMN_NAME (ODBC 2.0)|4|Варчар не NULL|Название столбца процедуры. Драйвер возвращает пустую строку для столбца процедуры, у которого нет имени.|  
|COLUMN_TYPE (ODBC 2.0)|5|Smallint, не NULL|Определяет столбец процедуры как параметр или столбец набора результата:<br /><br /> SQL_PARAM_TYPE_UNKNOWN: Столбец процедуры является параметром, тип которого неизвестен. (ODBC 1.0)<br /><br /> SQL_PARAM_INPUT: Столбец процедуры является вхотвовым параметром. (ODBC 1.0)<br /><br /> SQL_PARAM_INPUT_OUTPUT: Столбец процедуры является параметром ввода/вывода. (ODBC 1.0)<br /><br /> SQL_PARAM_OUTPUT: Столбец процедуры является выходным параметром. (ODBC 2.0)<br /><br /> SQL_RETURN_VALUE: Столбец процедуры является значением возврата процедуры. (ODBC 2.0)<br /><br /> SQL_RESULT_COL: Столбец процедуры — это столбец набора результатов. (ODBC 1.0)|  
|DATA_TYPE (ODBC 2.0)|6|Smallint, не NULL|Тип данных S'L. Это может быть тип данных ODBC S'L или тип данных, специфичный для драйверов, с помощью s-L. Для типов дат и интервальных данных этот столбец возвращает краткие типы данных (например, SQL_TYPE_TIME или SQL_INTERVAL_YEAR_TO_MONTH). В приложении D: Типы данных ODBC S'L [можно](../../../odbc/reference/appendixes/sql-data-types.md) ознакомиться с перечном списке действительных типов данных ODBC S'L. Для получения информации о типах данных, специфичных для драйверов, просмотрите документацию водителя.|  
|TYPE_NAME (ODBC 2.0)|7|Варчар не NULL|Имя типа типа данных, зависящих от источников данных; например, "CHAR", "VARCHAR", "MONEY", "LONG VARBINARY", или "CHAR ( ) ДЛЯ BIT DATA".|  
|COLUMN_SIZE (ODBC 2.0)|8|Целое число|Размер столбца столбца процедуры на источнике данных. NULL возвращается для типов данных, где размер столбца неприменим. Для получения дополнительной информации о точности см. [Размер столбца, десятичные цифры, длина переноса Octet и размер дисплея](../../../odbc/reference/appendixes/column-size-decimal-digits-transfer-octet-length-and-display-size.md) в приложении D: Типы данных.|  
|BUFFER_LENGTH (ODBC 2.0)|9|Целое число|Длина байтов данных, передаваемых в операции **S'LGetData** или **S'LFetch,** если указано SQL_C_DEFAULT. Для числовых данных этот размер может отличаться от размера данных, хранящихся в источнике данных. Для получения дополнительной информации [в](../../../odbc/reference/appendixes/column-size-decimal-digits-transfer-octet-length-and-display-size.md)приложении D: Типы данных см.|  
|DECIMAL_DIGITS (ODBC 2.0)|10|Smallint|Десятичные цифры столбца процедуры на источнике данных. NULL возвращается для типов данных, где десятичные цифры не применимы. Для получения дополнительной информации о десятичных цифрах см. [Размер столбца, десятичные цифры, длина переноса Octet и размер дисплея](../../../odbc/reference/appendixes/column-size-decimal-digits-transfer-octet-length-and-display-size.md)в приложении D: Типы данных.|  
|NUM_PREC_RADIX (ODBC 2.0)|11|Smallint|Для численных типов данных, либо 10 или 2.<br /><br /> Если 10, значения в COLUMN_SIZE и DECIMAL_DIGITS дать количество десятичных цифр, разрешенных для столбца. Например, столбец DECIMAL (12,5) возвращает NUM_PREC_RADIX 10, COLUMN_SIZE 12 и DECIMAL_DIGITS 5; столбец FLOAT может вернуть NUM_PREC_RADIX 10, COLUMN_SIZE 15 и DECIMAL_DIGITS NULL.<br /><br /> Если 2, значения в COLUMN_SIZE и DECIMAL_DIGITS дают количество битов, разрешенных в столбце. Например, столбец FLOAT может вернуть NUM_PREC_RADIX 2, COLUMN_SIZE 53 и DECIMAL_DIGITS NULL.<br /><br /> NULL возвращается для типов данных, где NUM_PREC_RADIX не применимо.|  
|НЕОБЫДАНЫЙ (ODBC 2.0)|12|Smallint, не NULL|Принимает ли столбец процедуры значение NULL:<br /><br /> SQL_NO_NULLS: Столбец процедуры не принимает значения NULL.<br /><br /> SQL_NULLABLE: Столбец процедуры принимает значения NULL.<br /><br /> SQL_NULLABLE_UNKNOWN: Неизвестно, принимает ли столбец процедуры значения NULL.|  
|ЗАМЕЧАНИЯ (ODBC 2.0)|13|Varchar|Описание столбца процедуры.|  
|COLUMN_DEF (ODBC 3.0)|14|Varchar|Значение по умолчанию для столбца.<br /><br /> Если NULL был указан как значение по умолчанию, этот столбец является словом NULL, не заключенным в кавычки. Если значение по умолчанию не может быть представлено без усечения, этот столбец содержит TRUNCATED, без прикрытия отдельных меток котировок. Если значение по умолчанию не было указано, этот столбец является NULL.<br /><br /> Значение COLUMN_DEF может быть использовано при создании нового определения столбца, за исключением случаев, когда оно содержит значение TRUNCATED.|  
|SQL_DATA_TYPE (ODBC 3.0)|15|Smallint, не NULL|Значение типа данных S'L, как он появляется в SQL_DESC_TYPE поле дескриптора. Этот столбец совпадает с DATA_TYPE столбец, за исключением типов датиметра же и интервалов данных.<br /><br /> Для типов данных о дате и интервалах поле SQL_DATA_TYPE в наборе результатов вернется SQL_INTERVAL или SQL_DATETIME, а поле SQL_DATETIME_SUB вернет подкод для конкретного типа данных интервала или даты. [(См. Приложение D: Типы данных](../../../odbc/reference/appendixes/appendix-d-data-types.md).)|  
|SQL_DATETIME_SUB (ODBC 3.0)|16|Smallint|Код подтипа для типов дат и интервальных данных. Для других типов данных этот столбец возвращает значение NULL.|  
|CHAR_OCTET_LENGTH (ODBC 3.0)|17|Целое число|Максимальная длина байтов символа или двоичного столбца типа данных. Для всех других типов данных этот столбец возвращает значение NULL.|  
|ORDINAL_POSITION (ODBC 3.0)|18|Integer, не NULL|Для входных и выходных параметров порядковое положение параметра в определении процедуры (при увеличении порядка параметра, начиная с 1). Для возврата значения (если таковые имеется), 0 возвращается. Для столбцов, установленных результатом, ординальное положение столбца в наборе результатов, с первым столбецом в наборе результата, являясь номером 1. При наличии нескольких наборов результатов упорядоченные позиции столбцов возвращаются определенным образом.|  
|IS_NULLABLE (ODBC 3.0)|19|Varchar|"НЕТ", если столбец не включает NULLs.<br /><br /> "ДА", если столбец может включать NULLs.<br /><br /> Если допустимость значения NULL неизвестна, то этот столбец возвращает строку нулевой длины.<br /><br /> Допустимость значений NULL определяется в соответствии с правилами ISO. СУБД, совместимая с ISO SQL, не может вернуть пустую строку.<br /><br /> Значение, возвращаемое в данном столбце, отличается от значения, возвращаемого в столбце NULLABLE. (См. описание столбца NULLABLE.)|  
  
## <a name="code-example"></a>Пример кода  
 Смотрите [Процедурные вызовы](../../../odbc/reference/develop-app/procedure-calls.md).  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Привязка буфера к столбцовику в наборе результатов|[SQLBindCol, функция](../../../odbc/reference/syntax/sqlbindcol-function.md)|  
|Отмена обработки оператора|[Функция SQLCancel](../../../odbc/reference/syntax/sqlcancel-function.md)|  
|Получение одной строки или блока данных в направлении только вперед|[Функция S'LFetch](../../../odbc/reference/syntax/sqlfetch-function.md)|  
|Получение блока данных или прокрутка набора результатов|[Функция SQLFetchScroll](../../../odbc/reference/syntax/sqlfetchscroll-function.md)|  
|Возвращение списка процедур в источнике данных|[Функция SQLProcedures](../../../odbc/reference/syntax/sqlprocedures-function.md)|  
  
## <a name="see-also"></a>См. также:  
 [Справка aPI ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)
