---
title: Функция SQLSetEnvAttr | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLSetEnvAttr
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLSetEnvAttr
helpviewer_keywords:
- SQLSetEnvAttr function [ODBC]
ms.assetid: 0343241c-4b15-4d4b-aa2b-2e8ab5215cd2
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 7bf0269c76be272b30e055ae11e53940fc4873f1
ms.sourcegitcommit: 56b963446965f3a4bb0fa1446f49578dbff382e0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/11/2019
ms.locfileid: "67793147"
---
# <a name="sqlsetenvattr-function"></a>SQLSetEnvAttr, функция
**Соответствие стандартам**  
 Представленные версии: ODBC 3.0 стандартов соответствия: ISO-92  
  
 **Сводка**  
 **SQLSetEnvAttr** задает атрибуты, которые управляют аспектами сред.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLSetEnvAttr(  
     SQLHENV      EnvironmentHandle,  
     SQLINTEGER   Attribute,  
     SQLPOINTER   ValuePtr,  
     SQLINTEGER   StringLength);  
```  
  
## <a name="arguments"></a>Аргументы  
 *EnvironmentHandle*  
 [Вход] Дескриптор среды.  
  
 *Attribute*  
 [Вход] Атрибут, чтобы задать, перечисленные в «Комментарии».  
  
 *ValuePtr*  
 [Вход] Указатель на значение, которым будет связана *атрибут*. В зависимости от значения *атрибут*, *ValuePtr* будет иметь значение 32-разрядное целое число или указывает на строку нуль-символом.  
  
 *StringLength*  
 [Вход] Если *ValuePtr* указывает на строку символов или двоичный буфер, данный аргумент должен иметь длину **ValuePtr*. Для строки символьных данных этот аргумент должен содержать число байтов в строке.  
  
 Если *ValuePtr* должно быть целым числом, *StringLength* учитывается.  
  
## <a name="returns"></a>Возвращает  
 Значение SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, значение SQL_ERROR или SQL_INVALID_HANDLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **SQLSetEnvAttr** возвращает значение SQL_ERROR или SQL_SUCCESS_WITH_INFO, а связанное значение SQLSTATE можно получить, вызвав **SQLGetDiagRec** с *HandleType* из SQL_ HANDLE_ENV и *обрабатывать* из *EnvironmentHandle*. В следующей таблице перечислены значения SQLSTATE, обычно возвращаемые при помощи **SQLSetEnvAttr** и объясняется каждый из них в контексте этой функции; описания SQLSTATE, возвращаемых диспетчером драйверов предшествует обозначение «(DM)». Возвращается связанный с каждого значения SQLSTATE значение SQL_ERROR, если не указано иное. Если драйвер не поддерживает атрибут среды, ошибки могут возвращаться только во время подключения.  
  
|SQLSTATE|Ошибка|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Специфические для драйвера информационное сообщение. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|01S02|Значение параметра изменено|Драйвер не поддерживает значения, указанного в *ValuePtr* и заменить примерно такое же значение. (Функция возвращает значение SQL_SUCCESS_WITH_INFO).|  
|HY000|Общая ошибка|Произошла ошибка, для которой было нет конкретных SQLSTATE и SQLSTATE не зависящие от реализации, который был определен. Сообщение об ошибке, возвращенные **SQLGetDiagRec** в  *\*MessageText* буфера описывает ошибку и его причины.|  
|HY001|Ошибка выделения памяти|Драйвер не удалось выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY009|Недопустимое использование пустого указателя|Аргумент атрибута определенный атрибут среды, который требуется строковое значение, и *ValuePtr* аргумент был пустым указателем.|  
|HY010|Ошибка последовательности функций|(DM) на выделенного дескриптора соединения *EnvironmentHandle*.<br /><br /> (DM) **SQL_ATTR_ODBC_VERSION** не было задано с помощью **SQLSetEnvAttr** и *атрибут* не равно **SQL_ATTR_ODBC_VERSION**. Необходимо задать **SQL_ATTR_ODBC_VERSION** явным образом в том случае, если вы используете **SQLAllocHandleStd**.|  
|HY013|Ошибка управления памятью|Не удалось обработать вызов функции, так как базовые объекты памяти оказываются недоступны, возможно из-за нехватки памяти.|  
|HY024|Недопустимое значение атрибута|Дан указанный *атрибут* , недопустимое значение было указано значение в *ValuePtr*.|  
|HY090|Недопустимая длина строки или буфера|*StringLength* аргумент был, но меньше 0 не SQL_NTS.|  
|HY092|Недопустимый атрибут/идентификатор параметра|(DM) значение, указанное для аргумента *атрибут* недопустимо для версии ODBC, поддерживаемых драйвером.|  
|HY117|Подключение будет приостановлена из-за состояние транзакции неизвестно. Только отключиться и разрешены функции, доступные только для чтения.|(DM) Дополнительные сведения о состоянии приостановки, см. в разделе [функция SQLEndTran](../../../odbc/reference/syntax/sqlendtran-function.md).|  
|HYC00|Дополнительная возможность не реализована|Значение, указанное для аргумента *атрибут* был допустимым атрибутом среды ODBC, используемая версия ODBC драйвер поддерживает, но не поддерживается драйвером.<br /><br /> (DM) *атрибут* аргумент был SQL_ATTR_OUTPUT_NTS, и *ValuePtr* был SQL_FALSE.|  
  
## <a name="comments"></a>Комментарии  
 Приложение может вызвать **SQLSetEnvAttr** только в том случае, если нет дескриптора соединения выделяется в среде. Все атрибуты среды, успешно установлены приложением для среды сохраняется до **SQLFreeHandle** вызывается в среде. Более одного дескриптора среды может находиться одновременно в ODBC *3.x*.  
  
 Задать формат данных, с помощью *ValuePtr* зависит от указанного *атрибут*. **SQLSetEnvAttr** будет принимать данные атрибут в одной из двух различных форматов: строка символов с завершающим нулем, или значение 32-разрядное целое число. Формат каждого из них указан в описании атрибута.  
  
 Отсутствуют атрибуты среды, относящиеся к драйверу.  
  
 Невозможно задать атрибуты соединения с помощью вызова **SQLSetEnvAttr**. При попытке сделать это вернет SQLSTATE HY092 (недопустимый атрибута или параметра идентификатора).  
  
|*Attribute*|*ValuePtr* содержимое|  
|-----------------|-------------------------|  
|SQL_ATTR_CONNECTION_POOLING (ODBC 3.8)|Значение 32-разрядных SQLUINTEGER, включает или отключает использование пулов соединений на уровне среды. Используются следующие значения:<br /><br /> SQL_CP_OFF = соединение пул находится в отключенном состоянии. Это значение по умолчанию.<br /><br /> SQL_CP_ONE_PER_DRIVER = один пул соединений поддерживается для каждого драйвера. Каждое соединение в пул, связанный с одного драйвера.<br /><br /> SQL_CP_ONE_PER_HENV = один пул соединений поддерживается для каждой среды. Каждое соединение в пул, связанный с одной среды.<br /><br /> SQL_CP_DRIVER_AWARE = использовать функцию осведомленности пула подключений драйвера, в том случае, если он доступен. Если драйвер не поддерживает с поддержкой пула подключений, SQL_CP_DRIVER_AWARE игнорируется и используется SQL_CP_ONE_PER_HENV. Дополнительные сведения см. в разделе [Driver-Aware Connection Pooling](../../../odbc/reference/develop-app/driver-aware-connection-pooling.md). В среде, где некоторые драйверы поддерживают и некоторые драйверы не поддерживают с поддержкой пула подключений SQL_CP_DRIVER_AWARE можно включить эту функцию осведомленности пул соединений на те, которые поддерживают драйверы, но она эквивалентна параметр, чтобы SQL_CP_ONE_PER_HENV на Эти драйверы, которые не поддерживают функцию осведомленности пула подключений.<br /><br /> Пул подключений включен, вызвав **SQLSetEnvAttr** установить атрибут SQL_ATTR_CONNECTION_POOLING SQL_CP_ONE_PER_DRIVER или SQL_CP_ONE_PER_HENV. Этот вызов необходимо выполнить, прежде чем приложение выделяет общей среды для какое подключение пулов которого необходимо включить. Дескриптора среды в вызове **SQLSetEnvAttr** имеет значение null, что делает SQL_ATTR_CONNECTION_POOLING атрибут уровня процесса. После включено использование пулов соединений, затем приложение выделяет неявное общей среды путем вызова **SQLAllocHandle** с *InputHandle* аргумент значение SQL_HANDLE_ENV.<br /><br /> После того как пул подключений включен и совместно используемой среде был выбран для приложения, SQL_ATTR_CONNECTION_POOLING невозможно сбросить для этой среды, так как **SQLSetEnvAttr** вызывается с пустой среды Дескриптор, при задании этого атрибута. Если этот атрибут задан, хотя организация пулов соединений уже включен в общей среде, атрибут влияет только общими средами, которые впоследствии будут выделены.<br /><br /> Можно также для включения пула подключений в среде. Обратите внимание на следующие особенности среды организация пулов соединений:<br /><br /> — Включение подключений в пул маркер NULL является атрибутом уровня процесса. Впоследствии выделенные среды будут совместно используемой среде и будет наследовать параметр пула подключений уровня процесса.<br />-После среде выделяется, приложение по-прежнему можно изменить его параметр пула подключений.<br />— Если включено использование пулов соединений среды и соединения драйвер использует драйвер Создание пулов, среда пула занимает предпочтений.<br /><br /> SQL_ATTR_CONNECTION_POOLING реализуется внутри диспетчера драйверов. Драйвер не нужно реализовать SQL_ATTR_CONNECTION_POOLING. Этот атрибут среды можно задать ODBC 2.0 и 3.0 приложений.<br /><br /> Дополнительные сведения см. в статье [Организация пулов соединений ODBC](../../../odbc/reference/develop-app/driver-manager-connection-pooling.md).|  
|SQL_ATTR_CP_MATCH (ODBC 3.0)|32-разрядных SQLUINTEGER значение, определяющее, каким образом выбирается соединение из пула соединений. Когда **SQLConnect** или **SQLDriverConnect** является именем, диспетчер драйверов определяет какое подключение является многократно используются в пуле. Диспетчер драйверов пытается сопоставить параметры подключения в вызов и атрибуты соединения, установленные приложением ключевые слова и атрибуты соединения, подключений в пуле. Значение этого атрибута определяет уровень точности, соответствующий критериям.<br /><br /> Для задания значения этого атрибута используются следующие значения:<br /><br /> SQL_CP_STRICT_MATCH = только подключения, которые точно соответствуют параметры подключения в вызове и соединения, повторно используются атрибуты, установленный приложением. Это значение по умолчанию.<br /><br /> SQL_CP_RELAXED_MATCH = соединений с совпадающими строку подключения, можно использовать ключевые слова. Ключевые слова должны совпадать, но не все атрибуты соединения, должны совпадать.<br /><br /> Дополнительные сведения о выполнение соответствия соединения в пуле, соединение диспетчера драйверов см. в разделе [SQLConnect](../../../odbc/reference/syntax/sqlconnect-function.md). Дополнительные сведения о пуле соединений см. в разделе [организация пулов соединений ODBC](../../../odbc/reference/develop-app/driver-manager-connection-pooling.md).|  
|SQL_ATTR_ODBC_VERSION (ODBC 3.0)|32-разрядное целое число, которое определяет, существуют ли определенные функции ODBC *2.x* поведение или ODBC *3.x* поведение. Для задания значения этого атрибута используются следующие значения:<br /><br /> SQL_OV_ODBC3_80 = диспетчера драйверов и поведение приложение следующие ODBC 3.8 драйвера:<br /><br /> -Возвращает драйвер и ожидает, что ODBC *3.x* коды для date, time и timestamp.<br />-Драйвер возвращает ODBC *3.x* коды SQLSTATE, когда **SQLError**, **SQLGetDiagField**, или **SQLGetDiagRec** вызывается.<br />- *CatalogName* аргумента в вызове **SQLTables** принимает шаблон поиска.<br />-Driver Manager поддерживает возможность расширения типа данных C. Дополнительные сведения о расширяемости тип данных C, см. в разделе [типы данных C в ODBC](../../../odbc/reference/develop-app/c-data-types-in-odbc.md).<br /><br /> Дополнительные сведения см. в разделе [новые возможности ODBC 3.8](../../../odbc/reference/what-s-new-in-odbc-3-8.md).<br /><br /> Значение SQL_OV_ODBC3 = диспетчера драйверов и приложение драйвера ODBC следующие *3.x* поведение:<br /><br /> -Возвращает драйвер и ожидает, что ODBC *3.x* коды для date, time и timestamp.<br />-Драйвер возвращает ODBC *3.x* коды SQLSTATE, когда **SQLError**, **SQLGetDiagField**, или **SQLGetDiagRec** вызывается.<br />- *CatalogName* аргумента в вызове **SQLTables** принимает шаблон поиска.<br />-Диспетчер драйверов не поддерживает возможность расширения типа данных C.<br /><br /> SQL_OV_ODBC2 = диспетчера драйверов и приложение драйвера ODBC следующие *2.x* поведение. Это особенно полезно для ODBC *2.x* приложение, которое работает с ODBC *3.x* драйвера.<br /><br /> -Возвращает драйвер и ожидает, что ODBC *2.x* коды для date, time и timestamp.<br />-Драйвер возвращает ODBC *2.x* коды SQLSTATE, когда **SQLError**, **SQLGetDiagField**, или **SQLGetDiagRec** вызывается.<br />- *CatalogName* аргумента в вызове **SQLTables** не принимает шаблон поиска.<br />-Диспетчер драйверов не поддерживает возможность расширения типа данных C.<br /><br /> Приложение необходимо присвоить этому атрибуту среды, перед вызовом любой функции, которая имеет аргумент SQLHENV или вызов вернет параметром SQLSTATE HY010 (функционировать ошибка последовательности). Это специфические для драйвера, существует ли дополнительное поведение наличие этих флагов окружающей среды.<br /><br /> — Дополнительные сведения см. в разделе [объявление версии ODBC приложения](../../../odbc/reference/develop-app/declaring-the-application-s-odbc-version.md) и [изменения в поведении](../../../odbc/reference/develop-app/behavioral-changes.md).|  
|SQL_ATTR_OUTPUT_NTS (ODBC 3.0)|32-разрядное целое число, определяющее, как драйвер возвращает строковые данные. Если SQL_TRUE, драйвер возвращает строковые данные нулем. Если значение SQL_FALSE, драйвер не возвращает строковые данные нулем.<br /><br /> Этот атрибут по умолчанию задано значение SQL_TRUE. Вызов **SQLSetEnvAttr** ему значение SQL_TRUE возвращает значение SQL_SUCCESS. Вызов **SQLSetEnvAttr** ему значение SQL_FALSE возвращает значение SQL_ERROR и SQLSTATE HYC00 (дополнительная возможность не реализована).|  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Выделение дескриптора|[Функция SQLAllocHandle](../../../odbc/reference/syntax/sqlallochandle-function.md)|  
|Возвращает значение атрибута среды|[Функция SQLGetEnvAttr](../../../odbc/reference/syntax/sqlgetenvattr-function.md)|  
  
## <a name="see-also"></a>См. также  
 [Справочник по API ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)   
 [Новые возможности ODBC 3.8](../../../odbc/reference/what-s-new-in-odbc-3-8.md)
