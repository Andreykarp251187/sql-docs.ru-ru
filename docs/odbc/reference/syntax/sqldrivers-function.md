---
title: Функция S'LDrivers (англ.) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLDrivers
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLDrivers
helpviewer_keywords:
- SQLDrivers function [ODBC]
ms.assetid: 6b5b7514-e9cb-4cfd-8b7a-ab51dfab9efa
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 2496e7cd5f2abe0831c72484bed374d7aa1513ce
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81302765"
---
# <a name="sqldrivers-function"></a>Функция SQLDrivers
**Соответствия**  
 Версия Введена: Соответствие стандартам ODBC 2.0: ODBC  
  
 **Сводка**  
 **SLDrivers** перечисляет описания драйверов и ключевые слова атрибута драйвера. Эта функция выполняется только менеджером драйвера.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLDrivers(  
     SQLHENV         EnvironmentHandle,  
     SQLUSMALLINT    Direction,  
     SQLCHAR *       DriverDescription,  
     SQLSMALLINT     BufferLength1,  
     SQLSMALLINT *   DescriptionLengthPtr,  
     SQLCHAR *       DriverAttributes,  
     SQLSMALLINT     BufferLength2,  
     SQLSMALLINT *   AttributesLengthPtr);  
```  
  
## <a name="arguments"></a>Аргументы  
 *Окружающая средаРучка*  
 (Вход) Ручка окружающей среды.  
  
 *Направление*  
 (Вход) Определяет, получает ли менеджер драйвера следующее описание драйвера в списке (SQL_FETCH_NEXT) или начинается поиск с начала списка (SQL_FETCH_FIRST).  
  
 *ДрайверОписание*  
 (Выход) Указатель на буфер, в котором можно вернуть описание драйвера.  
  
 Если *DriverDescription* является NULL, *DescriptionLengthPtr* по-прежнему возвращает общее количество символов (за исключением символа с нулевым прекращением для данных символов), доступных для возврата в буфере, на который указывает *DriverDescription.*  
  
 *БуферДлин1*  
 (Вход) Длина буфера*DriverDescription* в символах.  
  
 *ОписаниеLengthPtr*  
 (Выход) Указатель на буфер, в котором можно вернуть общее количество символов (за исключением символа нулевого прекращения), доступного для возврата в \* *DriverDescription.* Если количество символов, доступных для возврата, больше или равно *описанию BufferLength1,* описание драйвера в \* *DriverDescription* усечено до *BufferLength1* минус длина персонажа с нулевым прекращением.  
  
 *Водительские атрибуты*  
 (Выход) Указатель на буфер, в котором можно вернуть список пар значений атрибутов драйвера (см. "Комментарии").  
  
 Если *DriverAttributes* является NULL, *AttributesLengthPtr* по-прежнему возвращает общее количество байтов (за исключением символа нулевого прекращения для данных символов), доступного для возврата в буфере, на который указывают *DriverAttributes.*  
  
 *БуферДлин2*  
 (Вход) Длина \*буфера *DriverAttributes* в символах. Если значение * \*DriverDescription* является строкой Unicode (при вызове **S'LDriversW),** аргумент *BufferLength* должен быть четным числом.  
  
 *АтрибутыПромтранс*  
 (Выход) Указатель на буфер, в котором можно вернуть общее количество байтов (за исключением байт-ра-на-ару), доступного для возврата в \* *DriverAttributes.* Если количество байтов, доступных для возврата, больше или равно *Парам*значения \*атрибутов в *DriverAttributes,* усечено до *BufferLength2* за вычетом длины символа нулевого прекращения.  
  
## <a name="returns"></a>Результаты  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_NO_DATA, SQL_ERROR или SQL_INVALID_HANDLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **S'LDrivers** возвращается в SQL_ERROR или SQL_SUCCESS_WITH_INFO, связанное с этим значение S'LSTATE можно получить, позвонив по **телефону s'LGetDiagRec** с *помощью HandleType* of SQL_HANDLE_ENV и *ручкой* *environmentHandle.* В следующей таблице перечислены значения S'LSTATE, обычно возвращаемые **S'LDrivers,** и приведены в контексте этой функции. нотация "(DM)" предшествует описаниям S'LSTATEs, возвращенным менеджером драйвера. Код возврата, связанный с каждым значением S'LSTATE, является SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Error|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|(DM) Драйвер менеджер-специфическое информационное сообщение. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|01004|Строковые данные, правые усеченные|(DM) Буфер \* *DriverОписание* не был достаточно большим, чтобы вернуть полное описание драйвера. Таким образом, описание было усечено. Длина полного описания драйвера \*возвращается в *DescriptionLengthPtr*. (Функция возвращает SQL_SUCCESS_WITH_INFO.)<br /><br /> (DM) Буфер \* *DriverAttributes* не был достаточно большим, чтобы вернуть полный список пар значений атрибутов. Таким образом, список был усечен. Длина непрогнанный список пар значений атрибутов возвращается в*attributesLengthPtr*. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|HY000|Общая ошибка|Произошла ошибка, в соответствии с которой не было конкретного S'LSTATE и для которой не было определено конкретное осуществление СЗЛСТАТ. Сообщение об ошибке, возвращенное **S'LGetDiagRec** в * \*буфере MessageText,* описывает ошибку и ее причину.|  
|HY001|Ошибка распределения памяти|(DM) Менеджер драйвера не смог выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY010|Ошибка последовательности функций|(DM) **S'LExecute**, **S'LExecDirect**, или **S'LMoreResults** был вызван для *statementHandle* и вернулся SQL_PARAM_DATA_AVAILABLE. Эта функция была вызвана до того, как данные были извлечены для всех потоковых параметров.|  
|HY013|Ошибка управления памятью|Вызов функции не может быть обработан, поскольку основные объекты памяти не могут быть доступны, возможно, из-за низких условий памяти.|  
|HY090|Недействительная длина строки или буфера|(DM) Значение, указанное для аргумента *BufferLength1,* было меньше 0.<br /><br /> (DM) Значение, указанное для аргумента *BufferLength2,* было меньше 0 или равно 1.|  
|HY103|Недействительный код поиска|(DM) Значение, указанное для аргумента *Направление* не было равно SQL_FETCH_FIRST или SQL_FETCH_NEXT.|  
|HY117|Подключение приостанавливается из-за неизвестного состояния транзакции. Разрешены только отключить и прочитать только функции.|(DM) Для получения дополнительной информации о приостановленном состоянии, [см.](../../../odbc/reference/syntax/sqlendtran-function.md)|  
  
## <a name="comments"></a>Комментарии  
 **SLDrivers** возвращает описание драйвера в буфере \* *DriverDescription.* Он возвращает дополнительную информацию \*о драйвере в буфере *DriverAttributes* в виде списка пар с ключевым и значением. Все ключевые слова, перечисленные в системе информации для драйверов будут возвращены для всех драйверов, за исключением **CreateDSN**, который используется для быстрого создания источников данных и, следовательно, является необязательным. Каждая пара завершается с нулевым байтом, и полный список завершается с нулевым байтом (т.е. два нулевых байта отмечают конец списка). Например, драйвер на основе файлов, использующий c синтаксис, может вернуть следующий список атрибутов («З0» представляет нулевой символ):  
  
```  
FileUsage=1\0FileExtns=*.dbf\0\0  
```  
  
 Если \* *DriverAttributes* не достаточно велик, чтобы держать весь список, список усечен, **S'LDrivers** возвращает S'LSTATE 01004 (данные усечены), и длина списка (за исключением окончательного нулевого прекращения байт) возвращается в*атрибутикеLengthPtr*.  
  
 Ключевые слова атрибута драйвера добавляются из системной информации при установке драйвера. Для получения дополнительной информации [см.](../../../odbc/reference/install/installing-odbc-components.md)  
  
 Приложение может звонить в **S'LDrivers** несколько раз, чтобы получить все описания драйверов. Менеджер драйвера извлекает эту информацию из системной информации. Когда больше нет описания драйверов, **S'LDrivers** возвращается SQL_NO_DATA. Если **S'LDrivers** вызывается с SQL_FETCH_NEXT сразу же после того, как он возвращается SQL_NO_DATA, он возвращает первое описание драйвера. Для получения информации о том, как приложение использует информацию, возвращенную **S'LDrivers,** [см.](../../../odbc/reference/develop-app/choosing-a-data-source-or-driver.md)  
  
 Если SQL_FETCH_NEXT передается **в S'LDrivers** в первый раз, когда она называется, **S'LDrivers** возвращает имя первого источника данных.  
  
 Поскольку **S'LDrivers** реализован в менеджере драйверов, он поддерживается для всех водителей, независимо от соответствия определенным требованиям водителя.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Обнаружение и перечисление значений, необходимых для подключения к источнику данных|[Функция SQLBrowseConnect](../../../odbc/reference/syntax/sqlbrowseconnect-function.md)|  
|Подключение к источнику данных|[Функция S'LConnect](../../../odbc/reference/syntax/sqlconnect-function.md)|  
|Возвращение имен источников данных|[Функция SQLDataSources](../../../odbc/reference/syntax/sqldatasources-function.md)|  
|Подключение к источнику данных с помощью строки соединения или диалогового окна|[Функция SQLDriverConnect](../../../odbc/reference/syntax/sqldriverconnect-function.md)|  
  
## <a name="see-also"></a>См. также:  
 [Справка aPI ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)
