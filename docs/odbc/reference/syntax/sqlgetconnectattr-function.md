---
title: Функция S'LGetConnectattr Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
apiname:
- SQLGetConnectOption
apilocation:
- sqlsrv32.dll
apitype: dllExport
f1_keywords:
- SQLGetConnectAttr
helpviewer_keywords:
- SQLGetConnectAttr function [ODBC]
ms.assetid: 2cb4ffa8-19d3-4664-8c2f-6682cdcc3f33
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: e6076f14ff0c33fec38b99e9c43b8a688970a7a9
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81285634"
---
# <a name="sqlgetconnectattr-function"></a>Функция SQLGetConnectAttr
**Соответствия**  
 Представлена версия: Соответствие стандартам ODBC 3.0: ISO 92  
  
 **Сводка**  
 **S'LGetConnectAttr** возвращает текущую настройку атрибута соединения.  
  
> [!NOTE]
>  Для получения дополнительной информации о том, что менеджер *.x* драйвера драйвера драйвера *.x* управления драйвером, [см.](../../../odbc/reference/develop-app/mapping-replacement-functions-for-backward-compatibility-of-applications.md)  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
  
SQLRETURN SQLGetConnectAttr(  
     SQLHDBC        ConnectionHandle,  
     SQLINTEGER     Attribute,  
     SQLPOINTER     ValuePtr,  
     SQLINTEGER     BufferLength,  
     SQLINTEGER *   StringLengthPtr);  
```  
  
## <a name="arguments"></a>Аргументы  
 *ПодключениеРучка*  
 [Input] Дескриптор подключения  
  
 *Атрибут*  
 (Вход) Атрибут для извлечения.  
  
 *ValuePtr*  
 (Выход) Указатель на память, в котором можно вернуть текущее значение атрибута, указанное *Attribute.* Для атрибутов типа integer некоторые драйверы могут писать только нижний 32-битный или 16-битный буфер и оставлять бит более высокого порядка без изменений. Таким образом, приложения должны использовать буфер S'LULEN и инициализировать значение до 0, прежде чем вызывать эту функцию.  
  
 Если *ValuePtr* является NULL, *StringLengthPtr* по-прежнему возвращает общее количество байтов (за исключением символа нулевого прекращения для данных символов), доступного для возврата в буфере, на который указывает *ValuePtr.*  
  
 *BufferLength*  
 (Вход) Если *Attribute* является атрибутом, определяемым ODBC, а *ValuePtr* указывает на \*строку символов или бинарный буфер, этот аргумент должен быть длиной *ValuePtr.* Если *Attribute* является атрибутом, \*определяемым ODBC, а *ValuePtr* — неопределенным, *BufferLength* игнорируется. Если значение в * \*ValuePtr* является строкой Unicode (при вызове **S'LGetConnectAttrW),** аргумент *BufferLength* должен быть четным числом.  
  
 Если *атрибут* является атрибутом, определяемым драйвером, приложение указывает характер атрибута менеджеру драйвера, установив аргумент *BufferLength.* *BufferLength* может иметь следующие значения:  
  
-   Если * \*ValuePtr* является указателем на строку персонажа, *BufferLength* — это длина строки.  
  
-   Если * \*ValuePtr* является указателем на двоичный буфер, приложение помещает результат SQL_LEN_BINARY_ATTR *(длина)* макроса в *BufferLength.* Это ставит отрицательное значение в *BufferLength*.  
  
-   Если * \*ValuePtr* является указателем на значение, кроме строки символов или двоичной строки, *BufferLength* должен иметь значение SQL_IS_POINTER.  
  
-   Если * \*ValuePtr* содержит тип данных с фиксированной длиной, *BufferLength* либо SQL_IS_INTEGER, либо SQL_IS_UINTEGER, если это необходимо.  
  
 *СтрунныйДлинПтр*  
 (Выход) Указатель на буфер, в котором для возврата общего числа байтов (за исключением символа нулевого прекращения), доступного для возврата в \* *ValuePtr.* Если \* *ValuePtr* является нулевой указатель, длина не возвращается. Если значение атрибута является строкой символа, а количество байтов, доступных для возврата, больше, чем *BufferLength* минус длина символа нулевого прекращения, данные в * \*ValuePtr* усечены до *BufferLength* минус длина символа с нулевым прекращением и сведены к нулю.  
  
## <a name="returns"></a>Результаты  
 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, SQL_NO_DATA, SQL_ERROR или SQL_INVALID_HANDLE.  
  
## <a name="diagnostics"></a>Диагностика  
 Когда **s'LGetConnectAttr** возвращается SQL_ERROR или SQL_SUCCESS_WITH_INFO, связанное с этим значение S'LSTATE можно получить из структуры диагностических данных, позвонив по **телефону S'LGetDiagRec** с *помощью HandleType* SQL_HANDLE_DBC и *ручки* *ConnectionHandle.* В следующей таблице перечислены значения S'LSTATE, обычно возвращаемые **S'LGetConnectAttr,** и приведены в изъяны каждое из них в контексте этой функции; нотация "(DM)" предшествует описаниям S'LSTATEs, возвращенным менеджером драйвера. Код возврата, связанный с каждым значением S'LSTATE, является SQL_ERROR, если не указано иное.  
  
|SQLSTATE|Error|Описание|  
|--------------|-----------|-----------------|  
|01000|Общее предупреждение|Информационное сообщение, конкретное для водителя. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|01004|Строковые данные, правые усеченные|Данные, \*возвращенные в *ValuePtr,* были усечены как *BufferLength* за вычетом длины символа с нулевым прекращением. Длина непросеченного значения строки возвращается в*строке ДлинаPtr*. (Функция возвращает SQL_SUCCESS_WITH_INFO.)|  
|08003|Подключение не открыто|(DM) Было указано значение *атрибута,* требуное открытого соединения.|  
|08S01|Сбой связи|Связь между драйвером и источником данных, к которому был подключен драйвер, не сработала до завершения обработки функции.|  
|HY000|Общая ошибка|Произошла ошибка, в соответствии с которой не было конкретного S'LSTATE и для которой не было определено конкретное осуществление СЗЛСТАТ. Сообщение об ошибке, возвращенное из структуры диагностических данных аргументом *MessageText* в **S'LGetDiagField** описывает ошибку и ее причину.|  
|HY001|Ошибка распределения памяти|Водитель не смог выделить память, необходимую для поддержки выполнения или завершения функции.|  
|HY010|Ошибка последовательности функций|(DM) **S'LBrowseConnect** был вызван для *ConnectionHandle* и вернулся SQL_NEED_DATA. Эта функция была вызвана до того, как **s'LBrowseConnect** вернулся SQL_SUCCESS_WITH_INFO или SQL_SUCCESS.<br /><br /> (DM) **S'LExecute**, **S'LExecDirect**, или **S'LMoreResults** был вызван для *ConnectionHandle* и вернулся SQL_PARAM_DATA_AVAILABLE. Эта функция была вызвана до того, как данные были извлечены для всех потоковых параметров.|  
|HY013|Ошибка управления памятью|Вызов функции не может быть обработан, поскольку основные объекты памяти не могут быть доступны, возможно, из-за низких условий памяти.|  
|HY090|Недействительная длина строки или буфера|(DM) * \*ValuePtr* является строкой символов, и BufferLength был меньше нуля, но не равен SQL_NTS.|  
|HY092|Недействительный идентификатор атрибута/опциона|Значение, указанное для аргумента *Attribute,* не было действительным для версии ODBC, поддерживаемой водителем.|  
|HY114|Драйвер не поддерживает выполнение асинхронных функций уровня соединения|(DM) Приложение пыталось включить асинхронное выполнение функции с SQL_ATTR_ASYNC_DBC_FUNCTIONS_ENABLE для драйвера, который не поддерживает асинхронные операции соединения.|  
|HY117|Подключение приостанавливается из-за неизвестного состояния транзакции. Разрешены только отключить и прочитать только функции.|(DM) Для получения дополнительной информации о приостановленном состоянии, [см.](../../../odbc/reference/syntax/sqlendtran-function.md)|  
|HYC00|Дополнительная функция не реализована|Значение, указанное для аргумента *Attribute,* было действительным атрибутом соединения ODBC для версии ODBC, поддерживаемой водителем, но не была поддержана водителем.|  
|HYT01|Срок истечения времени подключения|Период тайм-аута соединения истек до того, как источник данных ответил на запрос. Период тайм-аута соединения устанавливается через **S'LSetConnectAttr,** SQL_ATTR_CONNECTION_TIMEOUT.|  
|IM001|Драйвер не поддерживает эту функцию|(DM) Драйвер, соответствующий *ConnectionHandle,* не поддерживает функцию.|  
  
## <a name="comments"></a>Комментарии  
 Для получения общей информации [Connection Attributes](../../../odbc/reference/develop-app/connection-attributes.md)об атрибутах соединения см.  
  
 Список атрибутов, которые могут быть установлены, можно установить, [см.](../../../odbc/reference/syntax/sqlsetconnectattr-function.md) Обратите внимание, что если *атрибут* определяет атрибут, возвращающем строку, *ValuePtr* должен быть указателем на буфер для строки. Максимальная длина возвращенной строки, включая символ нулевого прекращения, будет *bufferLength* bytes.  
  
 В зависимости от атрибута, приложение не должно установить соединение перед вызовом **S'LGetConnectAttr.** Однако, если **s'LGetConnectAttr** вызывается и указанный атрибут не имеет значения по умолчанию и не был установлен предыдущим вызовом на **S'LSetConnectAttr,** **S'LGetConnectAttr** вернется SQL_NO_DATA.  
  
 Если *Attribute* является SQL_ATTR_ TRACE или SQL_ATTR_ TRACEFILE, *ConnectionHandle* не должен быть действительным, а **S'LGetConnectAttr** не вернется SQL_ERROR или SQL_INVALID_HANDLE если *ConnectionHandle* недействителен. Эти атрибуты применимы ко всем соединениям. **S'LGetConnectAttr** вернет SQL_ERROR или SQL_INVALID_HANDLE, если другой аргумент недействителен.  
  
 Несмотря на то, что приложение может устанавливать атрибуты оператора с помощью **S'LSetConnectAttr,** приложение не может использовать **s'LGetConnectAttr** для извлечения значений атрибутов оператора; для получения параметра атрибутов оператора необходимо вызвать **s'LGetStmtAttr.**  
  
 Как SQL_ATTR_AUTO_IPD, так и SQL_ATTR_CONNECTION_DEAD атрибуты подключения могут быть возвращены по вызову в **S'LGetConnectAttr,** но не могут быть установлены путем вызова в **S'LSetConnectAttr.**  
  
> [!NOTE]  
>  Существует нет асинхронной поддержки для **S'LGetConnectAttr**. При реализации **S'LGetConnectAttr**драйвер может повысить производительность, свести к минимуму количество раз, когда информация отправляется или запрашивается с сервера.  
  
## <a name="related-functions"></a>Связанные функции  
  
|Сведения о|См.|  
|---------------------------|---------|  
|Возвращение атрибута оператора|[Функция SQLGetStmtAttr](../../../odbc/reference/syntax/sqlgetstmtattr-function.md)|  
|Установка атрибута соединения|[Функция SQLSetConnectAttr](../../../odbc/reference/syntax/sqlsetconnectattr-function.md)|  
|Установка атрибута среды|[Функция SQLSetEnvAttr](../../../odbc/reference/syntax/sqlsetenvattr-function.md)|  
|Установка атрибута оператора|[Функция SQLSetStmtAttr](../../../odbc/reference/syntax/sqlsetstmtattr-function.md)|  
  
## <a name="see-also"></a>См. также:  
 [Справка aPI ODBC](../../../odbc/reference/syntax/odbc-api-reference.md)   
 [Файлы заголовков ODBC](../../../odbc/reference/install/odbc-header-files.md)
