---
title: Уведомление о завершении асинхронной функции (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
ms.assetid: 336565da-4203-4745-bce2-4f011c08e357
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: a453967f2ffdda4af2a44429737f700f4a994cf8
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81287824"
---
# <a name="notification-of-asynchronous-function-completion"></a>Уведомление о выполнении асинхронной функции
В SDK Windows 8 ODBC добавил механизм уведомления приложений при завершении асинхронной операции, который мы будем называть «уведомлением о завершении». [(См. Асинхронное исполнение (метод уведомления)](../../../odbc/reference/develop-app/asynchronous-execution-notification-method.md) для получения дополнительной информации.) Эта тема обсуждает некоторые вопросы для разработчиков драйверов.  
  
## <a name="the-interface-between-the-driver-manager-and-driver"></a>Интерфейс между менеджером драйвера и водителем  
 Менеджер драйвера внутренне обеспечивает функцию обратного вызова [S'LAsyncNotificationCallBack.](../../../odbc/reference/develop-driver/sqlasyncnotificationcallback-function.md) **S'LAsyncNotificationCallBack** может быть вызван только драйвером - приложение не может напрямую позвонить ему. Водитель вызывает **S'LAsyncNotificationCallBack** всякий раз, когда новые данные, полученные с сервера после последнего возвращения SQL_STILL_EXECUTING.  
  
 Менеджер драйвера предоставляет механизм обратного вызова, чтобы водитель мог уведомить менеджера драйвера, когда был достигнут определенный прогресс в проведении асинхронной операции после того, как соответствующая функция возвращает SQL_STILL_EXECUTING  
  
 Менеджер драйвера устанавливает SQL_ATTR_ASYNC_DBC_NOTIFICATION_CALLBACK атрибут на ручке соединения драйвера с указателем функции, не относящемуся к нулю, который является типом SQL_ASYNC_NOTIFICATION_CALLBACK, для того, чтобы водитель работал в режиме уведомления для любых асинхронных операций на этой ручке. Аналогичным образом, менеджер драйвера устанавливает SQL_ATTR_ASYNC_STMT_NOTIFICATION_CALLBACK атрибут на ручке оператора драйвера с помощью указателя функции, не являвшейся NULL, который также является SQL_ASYNC_NOTIFICATION_CALLBACK типа, для того, чтобы водитель работал в режиме уведомления для любых асинхронных операций на этой ручке.  
  
 Если асинхронная операция выполняется на рукоятке драйвера, асинхронные функции драйвера должны работать в стиле, не блокирующем. Если операция не может быть выполнена немедленно, функция драйвера должна вернуться SQL_STILL_EXECUTING. Это требование верно как для режима опроса, так и для режима уведомления.  
  
 Если ручка находится в асинхронном режиме уведомления, водитель должен вызвать функцию обратного вызова уведомлений, адрес которой является значением для SQL_ATTR_ASYNC_DBC_NOTIFICATION_CALLBACK или SQL_ATTR_ASYNC_STMT_NOTIFICATION_CALLBACK атрибута, один раз после возвращения SQL_STILL_EXECUTING. Другими словами, один возвращающийся SQL_STILL_EXECUTING должен быть сопряжен с одним вызовом функции обратного вызова. Драйвер должен использовать текущее значение SQL_ATTR_ASYNC_DBC_NOTIFICATION_CONTEXT или SQL_ATTR_ASYNC_STMT_NOTIFICATION_CONTEXT атрибута обработки в качестве значения для параметра функции обратного вызова *pContext.*  
  
 Водитель не должен вызывать обратно в потоке, который вызывает функцию драйвера; нет никаких оснований уведомлять о прогрессе до возвращения функции. Драйвер должен использовать свой собственный поток для обратного вызова. Менеджер драйвера не будет использовать поток обратного вызова драйвера для выполнения обширной логики обработки.  
  
 Менеджер драйвера снова вызовет исходную функцию после того, как водитель перезвонит. Менеджер драйвера может использовать поток, который не является ни потоком приложения, ни потоком драйвера. Если драйвер использует некоторую информацию, связанную с потоком (например, маркер безопасности или идентификатор пользователя), то драйвер должен сохранить требуемую информацию в первоначальном асинхронном вызове и использовать сохраненное значение до завершения всей асинхронной операции. Как правило, только **S'LDriverConnect**, **S'LConnect**, или **S'LBrowseConnect** необходимо использовать такую информацию.  
  
## <a name="see-also"></a>См. также:  
 [Разработка драйвера ODBC](../../../odbc/reference/develop-driver/developing-an-odbc-driver.md)
