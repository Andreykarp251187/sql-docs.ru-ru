---
title: Уведомление о завершении асинхронной функции | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
ms.assetid: 336565da-4203-4745-bce2-4f011c08e357
author: MightyPen
ms.author: genemi
ms.openlocfilehash: de3496661f2ab329e5bf662a9cb8fa749cb81bfc
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "68129322"
---
# <a name="notification-of-asynchronous-function-completion"></a>Уведомление о выполнении асинхронной функции
В пакете SDK для Windows 8 ODBC добавлен механизм для уведомления приложений при завершении асинхронной операции, который мы будем подразумевать «уведомления после завершения». (См. в разделе [асинхронное выполнение (метод уведомления)](../../../odbc/reference/develop-app/asynchronous-execution-notification-method.md) подробнее.) В этом разделе рассматриваются некоторые из проблем для разработчиков драйверов.  
  
## <a name="the-interface-between-the-driver-manager-and-driver"></a>Интерфейс между диспетчера драйверов и драйверов  
 Диспетчер драйверов внутренне предоставляет функцию обратного вызова [функция SQLAsyncNotificationCallback](../../../odbc/reference/develop-driver/sqlasyncnotificationcallback-function.md). **SQLAsyncNotificationCallback** может вызываться только с помощью драйвера — приложение не может напрямую вызывать его. Драйвер вызывает **SQLAsyncNotificationCallback** каждый раз, когда новые данные получил от сервера после последнего возвращение SQL_STILL_EXECUTING.  
  
 Диспетчер драйверов предоставляет механизм обратного вызова, чтобы драйвер может уведомлять диспетчера драйверов некоторые прогресса в выполнении асинхронной операции после соответствующей функции возвращает значение SQL_STILL_EXECUTING  
  
 Диспетчер драйверов задает атрибут SQL_ATTR_ASYNC_DBC_NOTIFICATION_CALLBACK на дескрипторе соединений драйвер с помощью указателя функции отличное от NULL, которые имеют тип SQL_ASYNC_NOTIFICATION_CALLBACK для драйвера для работы в режиме уведомлений для любой асинхронный операции над этот дескриптор. Аналогичным образом диспетчер драйверов задает атрибут SQL_ATTR_ASYNC_STMT_NOTIFICATION_CALLBACK маркер инструкции драйвер указатель функции, отличных от NULL, который также является типом SQL_ASYNC_NOTIFICATION_CALLBACK, для работы в режиме уведомлений для драйвера Все асинхронные операции на этот дескриптор.  
  
 Если асинхронная операция выполняется на дескриптор драйвера, функции асинхронной драйверов должны работать в стиле без блокировки. Если операция не завершается немедленно, драйвер функция должна возвращать значение SQL_STILL_EXECUTING. Это требование справедливо для опроса и режим уведомлений.  
  
 Если дескриптор в асинхронном режиме уведомлений, драйвер должен вызывать функцию ответного вызова уведомлений, адрес которого является значение атрибута SQL_ATTR_ASYNC_DBC_NOTIFICATION_CALLBACK или SQL_ATTR_ASYNC_STMT_NOTIFICATION_CALLBACK, один раз после Возвращает значение SQL_STILL_EXECUTING. Другими словами один возвращаемый SQL_STILL_EXECUTING должны быть связаны с помощью одного вызова функции обратного вызова уведомления. Драйвер следует использовать текущее значение атрибута дескриптор SQL_ATTR_ASYNC_DBC_NOTIFICATION_CONTEXT или SQL_ATTR_ASYNC_STMT_NOTIFICATION_CONTEXT как значение для параметра вызова назад функции *pContext*.  
  
 Драйвер не должен выполнить обратный вызов в потоке, который вызывает функцию драйвера; Нет причин для уведомления о ходе выполнения до выполнения возврата функцией. Драйвер должен использовать свой собственный поток для обратного вызова. Диспетчер драйверов не будет использовать поток драйвера обратного вызова для выполнения логики интенсивной обработки.  
  
 Диспетчер драйверов вызывает исходную функцию еще раз после драйвер выполняет обратный вызов. Диспетчер драйверов может использовать поток, который не является ни поток приложения, ни поток драйвера. Если драйвер использует некоторые сведения, связанные с потоком (например, маркер или пользователя идентификатором безопасности), драйвер следует сохранить необходимые сведения в первоначальном вызове асинхронных и использовать сохраненные значения перед совершенно асинхронной операции завершается. Как правило только **SQLDriverConnect**, **SQLConnect**, или **SQLBrowseConnect** должны использовать подобную информацию.  
  
## <a name="see-also"></a>См. также  
 [Разработка драйвера ODBC](../../../odbc/reference/develop-driver/developing-an-odbc-driver.md)
