---
title: Уведомление о завершении асинхронной функции | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
ms.assetid: 336565da-4203-4745-bce2-4f011c08e357
author: MightyPen
ms.author: genemi
ms.openlocfilehash: de3496661f2ab329e5bf662a9cb8fa749cb81bfc
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68129322"
---
# <a name="notification-of-asynchronous-function-completion"></a>Уведомление о выполнении асинхронной функции
В пакете SDK для Windows 8 ODBC добавил механизм для уведомления приложений о завершении асинхронной операции, которую мы будем называть "уведомление о завершении". (Дополнительные сведения см. в разделе [асинхронное выполнение (метод уведомления)](../../../odbc/reference/develop-app/asynchronous-execution-notification-method.md) .) В этом разделе обсуждаются некоторые проблемы, связанные с разработчиками драйверов.  
  
## <a name="the-interface-between-the-driver-manager-and-driver"></a>Интерфейс между диспетчером драйверов и драйвером  
 Диспетчер драйверов внутренне предоставляет функцию обратного вызова [Скласинкнотификатионкаллбакк функции](../../../odbc/reference/develop-driver/sqlasyncnotificationcallback-function.md). **Скласинкнотификатионкаллбакк** может вызываться только драйвером. приложение не может напрямую вызвать его. Драйвер вызывает **скласинкнотификатионкаллбакк** каждый раз при получении новых данных с сервера после последнего возврата SQL_STILL_EXECUTING.  
  
 Диспетчер драйверов предоставляет механизм обратного вызова, чтобы драйвер мог уведомить диспетчер драйверов о ходе выполнения асинхронной операции после возврата соответствующей функции SQL_STILL_EXECUTING  
  
 Диспетчер драйверов устанавливает атрибут SQL_ATTR_ASYNC_DBC_NOTIFICATION_CALLBACK для обработчика подключения драйвера с помощью указателя функции, отличного от NULL, который имеет тип SQL_ASYNC_NOTIFICATION_CALLBACK, чтобы драйвер работал в режиме уведомления для любых асинхронных операции с этим обработчиком. Аналогичным образом диспетчер драйверов устанавливает атрибут SQL_ATTR_ASYNC_STMT_NOTIFICATION_CALLBACK в обработчике операторов драйвера с указателем на функцию, не РАВНым NULL, который также имеет тип SQL_ASYNC_NOTIFICATION_CALLBACK, чтобы драйвер работал в режиме уведомления для любые асинхронные операции с этим обработчиком.  
  
 Если асинхронная операция выполняется с помощью обработчика драйвера, то функции асинхронных драйверов должны работать в неблокирующем стиле. Если операция не может завершиться немедленно, функция драйвера должна возвращать SQL_STILL_EXECUTING. Это требование справедливо и для режима опроса, и для режима уведомления.  
  
 Если обработчик находится в асинхронном режиме уведомления, драйвер должен вызвать функцию обратного вызова уведомлений, адрес которой является значением атрибута SQL_ATTR_ASYNC_DBC_NOTIFICATION_CALLBACK или SQL_ATTR_ASYNC_STMT_NOTIFICATION_CALLBACK, один раз после Возврат SQL_STILL_EXECUTING. Иными словами, один возвращаемый SQL_STILL_EXECUTING должен быть связан с одним вызовом функции обратного вызова уведомления. Драйвер должен использовать текущее значение атрибута SQL_ATTR_ASYNC_DBC_NOTIFICATION_CONTEXT или SQL_ATTR_ASYNC_STMT_NOTIFICATION_CONTEXT Handle в качестве значения параметра функции обратного вызова *пконтекст*.  
  
 Драйвер не должен выполнять обратный вызов в потоке, который вызывает функцию драйвера; нет причин уведомлять о ходе выполнения до возвращения функции. Драйвер должен использовать собственный поток для обратного вызова. Диспетчер драйверов не будет использовать поток обратного вызова драйвера для выполнения расширенной логики обработки.  
  
 Диспетчер драйверов снова вызовет исходную функцию после того, как драйвер вызовет обратно. Диспетчер драйверов может использовать поток, который не является ни потоком приложения, ни потоком драйвера. Если драйвер использует некоторые сведения, связанные с потоком (например, маркер безопасности или идентификатор пользователя), драйвер должен сохранить необходимую информацию в первоначальном асинхронном вызове и использовать сохраненное значение перед всей асинхронной операцией. завершения. Как правило, только **SQLDriverConnect**, **SQLConnect**или **SQLBrowseConnect** должны использовать информацию такого рода.  
  
## <a name="see-also"></a>См. также:  
 [Разработка драйвера ODBC](../../../odbc/reference/develop-driver/developing-an-odbc-driver.md)
