---
title: Обновление 3,5 Драйвер ат-драйвер 3,8 Драйвер (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
ms.assetid: ffba36ac-d22e-40b9-911a-973fa9e10bd3
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: dcd01d050e806b733d75c54058945d367a33d6a7
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81294435"
---
# <a name="upgrading-a-35-driver-to-a-38-driver"></a>Обновление драйвера с версии 3.5 до 3.8
Эта тема содержит руководящие принципы и соображения для обновления драйвера ODBC 3.5 до драйвера ODBC 3.8.  
  
##### <a name="version-numbers"></a>Номера версий  
 Следующие руководящие принципы относятся к номерам версий:  
  
-   Водитель должен поддерживать SQL_OV_ODBC3_80 для SQL_ATTR_ODBC_VERSION, возвращая SQL_ERROR для значений, не вовех SQL_OV_ODBC2, SQL_OV_ODBC3 и SQL_OV_ODBC3_80. Будущие версии менеджера драйвера предполагают, что драйвер поддерживает уровень соответствия ODBC, если водитель возвращается SQL_SUCCESS от [функции S'LSetEnvAttr.](../../../odbc/reference/syntax/sqlsetenvattr-function.md)  
  
-   Водитель версии 3.8 должен вернуть 03.80 из **S'LGetInfo,** когда SQL_DRIVER_ODBC_VER передается *InfoType*. Однако старые менеджеры драйверов, которые были включены в старые версии Microsoft Windows, будут относиться к водителю как к драйверу версии 3.5 и выдают предупреждение.  
  
     В Windows 7 версия Driver Manager составляет 03,80. В Windows 8 версия диспетчера драйверов составляет 03,81 с помощью SQL_DM_VER S'LGetInfo (параметр*InfoType).* SQL_ODBC_VER сообщает о версии как 03.80 как в Windows 7 и Windows 8.  
  
##### <a name="driver-specific-c-data-types"></a>Типы данных драйвера-специфического C  
 Водитель может настроить типы данных C, когда он работает с версией 3.8 ODBC приложения. (Для получения дополнительной информации см. [Типы данных C в ODBC](../../../odbc/reference/develop-app/c-data-types-in-odbc.md).) Однако для драйвера 3.8 не требуется реализовать какие-либо типы C, специфичные для драйвера. Но водитель должен по-прежнему выполнять проверку диапазона типов C; Менеджер драйвера не будет делать этого для 3,8 водителей. Для облегчения разработки драйвера значение конкретного драйвера, типа данных C может быть определено в следующем формате:  
  
```  
SQL_DRIVER_C_TYPE_BASE+0, SQL_DRIVER_C_TYPE_BASE+1  
```  
  
##### <a name="driver-specific-data-types-descriptor-types-information-types-diagnostic-types-and-attributes"></a>Типы данных, специфические для драйверов, типы дескрипторов, типы информации, диагностические типы и атрибуты  
 При разработке нового драйвера следует использовать диапазон, характерный для драйвера, для типов данных, типов дескрипторов, типов информации, диагностических типов и атрибутов. Диапазоны, к онропримуя водителю, и значения базового типа обсуждаются в [типах данных драйверов, типах дескрипторов, типов информации, диагностических типов и атрибутов.](../../../odbc/reference/develop-app/driver-specific-data-types-descriptor-information-diagnostic.md)  
  
##### <a name="connection-pooling"></a>Объединение подключений в пул  
 Для лучшего управления объединением соединений ODBC 3.8 вводит атрибут SQL_ATTR_RESET_CONNECTION соединения в **S'LSetConnectAttr.** SQL_RESET_CONNECTION_YES является единственным допустимое значение для этого атрибута. SQL_ATTR_RESET_CONNECTION будет установлен непосредственно перед тем, как менеджер драйвера размещает соединение в пуле соединения, что позволит водителю сбросить другие атрибуты соединения к их значениям по умолчанию.  
  
 Чтобы избежать ненужной связи с сервером, водитель может отложить сброс атрибута соединения до следующего сообщения с удаленным сервером после повторного использования соединения из пула.  
  
 Обратите внимание, что SQL_ATTR_RESET_CONNECTION используется только в общении между менеджером водителя и водителем. Приложение не может настроить этот атрибут напрямую. Все драйверы версии 3.8 должны реализовать этот атрибут соединения.  
  
##### <a name="streamed-output-parameters"></a>Параметры потокового вывода  
 Версия ODBC 3.8 вводит параметры потокового вывода, более масштабируемый способ получения параметров вывода. (Для получения дополнительной [информации см.](../../../odbc/reference/develop-app/retrieving-output-parameters-using-sqlgetdata.md) Для поддержки этой функции драйвер должен установить SQL_GD_OUTPUT_PARAMS в значении возврата, когда SQL_GETDATA_EXTENSIONS *infoType* в вызове **S'LGetInfo.** Поддержка типа S'L с streamed параметрами вывода должна быть реализована в драйвере. Менеджер драйвера не генерирует ошибку для недействительного типа S'L. Типы S'L, поддерживающие параметры потокового вывода, определяются в драйвере.  
  
 Водитель должен вернуться SQL_ERROR, если приложение использовало **S'LGetData** для получения параметра, который не совпадает с параметром, возвращенным **S'LParamData.**  
  
##### <a name="asynchronous-execution-for-connection-operations-polling-method"></a>Асинхронное выполнение для операций соединения (метод опроса)  
 Драйвер может обеспечить асинхронную поддержку различных операций соединения.  
  
 Начиная с Windows 7, ODBC поддерживает метод опроса (для получения дополнительной информации [см. Asynchronous Execution (метод опроса).](../../../odbc/reference/develop-app/asynchronous-execution-polling-method.md) Для драйвера ODBC версии 3.8 не требуется осуществлять асинхронные операции на ручках соединения. Даже если драйвер не выполняет асинхронные операции на ручках соединения, водитель должен все равно реализовать SQL_ASYNC_DBC_FUNCTIONS *InfoType* и возврат **SQL_ASYNC_DBC_NOT_CAPABLE.**  
  
 При включении асинхронных операций соединения время выполнения операции соединения — это общее время всех повторных вызовов. Если последний повторный вызов происходит после того, как общее время превысило значение, установленное атрибутом SQL_ATTR_CONNECTION_TIMEOUT подключения, а операция не завершена, водитель возвращает SQL_ERROR и регистрирует диагностическую запись с помощью S'LState HYT01 и сообщением "Время подключения истекло". Если операция завершена, тайм-аут отсутствует.  
  
##### <a name="sqlcancelhandle-function"></a>Функция SQLCancelHandle  
 ODBC 3.8 поддерживает [функцию S'LCancelHandle,](../../../odbc/reference/syntax/sqlcancelhandle-function.md)которая используется для отмены как операций подключения, так и операций оператора. Драйвер, **поддерживающий S'LКансонхлик,** должен экспортировать функцию. Драйвер не должен отменять любую функцию синхронного или асинхронного соединения, которая выполняется, если приложение вызывает **S'LCancel** или **S'LCancelHandle** на ручке оператора. Аналогичным образом, драйвер не должен отменять любую функцию синхронного или асинхронного оператора, которая выполняется, если приложение вызывает **S'LCancelHandle** на ручке соединения. Кроме того, драйвер не должен отменять операцию просмотра **(S'LBrowseConnect** возвращает SQL_NEED_DATA), если приложение вызывает **S'LCancelHandle** на ручке соединения. В этих случаях водитель должен вернуть HY010, "ошибка последовательности функций".  
  
 Не требуется одновременно поддерживать операции по асинхронной связи и асинхронное соединение. **SQLCancelHandle** Водитель может поддерживать асинхронные операции соединения, но не **S'LКансортикрев,** или наоборот.  
  
##### <a name="suspended-connections"></a>Приостановленные подключения  
 Менеджер драйвера ODBC 3.8 может поместить соединение в приостановленное состояние. Приложение вызовет **S'LDisconnect** для выпуска ресурсов, связанных с соединением. В этом случае водитель должен попытаться высвободить как можно больше ресурсов, не проверяя состояние соединения. Для получения более подробной [SQLEndTran Function](../../../odbc/reference/syntax/sqlendtran-function.md)информации о приостановленном состоянии см.  
  
##### <a name="driver-aware-connection-pooling"></a>Организация пулов соединений с учетом драйвера  
 ODBC в Windows 8 позволяет водителям настроить поведение пула соединения. Для получения дополнительной [Driver-Aware Connection Pooling](../../../odbc/reference/develop-app/driver-aware-connection-pooling.md)информации см.  
  
##### <a name="asynchronous-execution-notification-method"></a>Асинхронное выполнение (метод уведомления)  
 ODBC 3.8 поддерживает метод уведомления для асинхронных операций, доступный начиная с Windows 8. Для получения дополнительной информации [см.](../../../odbc/reference/develop-app/asynchronous-execution-notification-method.md)  
  
## <a name="see-also"></a>См. также:  
 [Разработка драйвера ODBC](../../../odbc/reference/develop-driver/developing-an-odbc-driver.md)   
 [Драйверы ODBC от Microsoft](../../../odbc/microsoft/microsoft-supplied-odbc-drivers.md)   
 [Новые возможности ODBC 3.8](../../../odbc/reference/what-s-new-in-odbc-3-8.md)
