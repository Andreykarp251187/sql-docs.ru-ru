---
title: Обработка инструкции SQL | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- sending SQL statements to DBMS [ODBC]
- SQL statements [ODBC], processing
- SQL [ODBC], processing statements
- statement processing [ODBC]
- SQL statements [ODBC]
- ODBC [ODBC], SQL
ms.assetid: 96270c4f-2efd-4dc1-a985-ed7fd5658db2
author: MightyPen
ms.author: genemi
ms.openlocfilehash: dfbf23f0be369ae540dac33d33a3e3c1505d5ebe
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "68076284"
---
# <a name="processing-a-sql-statement"></a>Обработка инструкции SQL
Прежде чем обсуждать методики использования SQL программным способом, необходимо обсудить обработку инструкции SQL. Эти шаги являются общими для всех трех методов, хотя каждый метод выполняет их в разное время. На следующем рисунке показаны этапы обработки инструкции SQL, которые обсуждаются в оставшейся части этого раздела.  
  
 ![Шаги для обработки инструкции SQL](../../odbc/reference/media/pr01.gif "pr01")  
  
 Чтобы обработать инструкцию SQL, СУБД выполняет следующие пять шагов:  
  
1.  СУБД сначала анализирует инструкцию SQL. Она разбивает оператор на отдельные слова, называемые токенами, и гарантирует, что оператор имеет допустимую глагол и допустимые предложения, и т. д. На этом шаге могут быть обнаружены синтаксические ошибки и опечатки.  
  
2.  СУБД проверяет инструкцию. Он проверяет инструкцию по системному каталогу. Есть ли в базе данных все таблицы с именем в инструкции? Существуют ли все столбцы и являются ли имена столбцов неоднозначными? У пользователя есть необходимые привилегии для выполнения инструкции? На этом шаге могут быть обнаружены некоторые семантические ошибки.  
  
3.  СУБД создает план доступа для инструкции. План доступа — это двоичное представление шагов, необходимых для выполнения инструкции. Это эквивалент исполняемого кода СУБД.  
  
4.  СУБД оптимизирует план доступа. В нем рассматриваются различные способы выполнения плана доступа. Можно ли использовать индекс для ускорения поиска? Следует ли СУБД сначала применить условие поиска к таблице A, а затем присоединить ее к таблице B или начать с объединения и использовать условие поиска позже? Можно ли избежать последовательного поиска в таблице до подмножества таблицы? После изучения альтернативы СУБД выбирает один из них.  
  
5.  СУБД выполняет инструкцию, запустив план доступа.  
  
 Шаги, используемые для обработки инструкции SQL, зависят от требуемого объема доступа к базе данных и времени их выполнения. Анализ инструкции SQL не требует доступа к базе данных и может выполняться очень быстро. Оптимизация, с другой стороны, является очень ресурсоемким процессом и требует доступа к системному каталогу. Для сложного многотабличного запроса оптимизатор может исследовать тысячи различных способов выполнения одного и того же запроса. Однако стоимость выполнения запроса неэффективно обычно настолько высока, что время, затраченное на оптимизацию, больше, чем увеличение скорости выполнения запроса. Это еще более важно, если для выполнения повторяющихся запросов можно использовать один и тот же оптимизированный план доступа.
