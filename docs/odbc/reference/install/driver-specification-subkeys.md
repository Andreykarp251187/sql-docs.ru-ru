---
description: Подразделы спецификаций драйверов
title: Подразделы спецификации драйвера | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- subkeys [ODBC], driver specification subkeys
- driver specification subkeys [ODBC]
- registry entries for components [ODBC], driver specification subkeys
- drivers subkey [ODBC]
ms.assetid: b4d802ef-b199-4e64-b7a5-6f2b3e5e2c80
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: a363335931723e33a6461b86395494153491d328
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88499787"
---
# <a name="driver-specification-subkeys"></a>Подразделы спецификаций драйверов
Каждый драйвер, указанный в подразделе драйверы ODBC, имеет собственный подраздел. Этот подраздел имеет то же имя, что и соответствующее значение в подразделе драйверов ODBC. В параметрах этого подраздела перечислены полные пути к библиотекам DLL установки драйверов и драйверов, значения ключевых слов драйвера, возвращаемых функцией **SQLDrivers**, и счетчик использования. Форматы значений представлены в следующей таблице.  
  
|Имя|Тип данных|Данные|  
|----------|---------------|----------|  
|апилевел|REG_SZ|**0** &#124; **1** &#124; **2**|  
|коннектфунктионс|REG_SZ|{**Y**&#124;**n**} {**y**&#124;**n**} {**y**&#124;**n**}|  
|креатедсн|REG_SZ|*Описание драйвера*|  
|Драйвер|REG_SZ|*Driver-DLL-путь*|  
|DriverODBCVer|REG_SZ|*NN. NN*|  
|филикстнс|REG_SZ|**\*.** *File-extension1*[**, \* .** *File-extension2*] ...|  
|филеусаже|REG_SZ|**0** &#124; **1** &#124; **2**|  
|Настройка|REG_SZ|*Setup-DLL-путь*|  
|скллевел|REG_SZ|**0** &#124; **1** &#124; **2**|  
|усажекаунт|REG_DWORD|*count*|  
  
 Использование каждого ключевого слова показано в следующей таблице.  
  
|Ключевое слово|Использование|  
|-------------|-----------|  
|**апилевел**|Число, указывающее уровень соответствия интерфейса ODBC, поддерживаемый драйвером:<br /><br /> 0 = нет<br /><br /> 1 = уровень 1 поддерживается<br /><br /> 2 = поддерживается уровень 2<br /><br /> Оно должно быть таким же, как и значение, возвращаемое для параметра SQL_ODBC_INTERFACE_CONFORMANCE в **SQLGetInfo**.|  
|**креатедсн**|Имя одного или нескольких источников данных, создаваемых при установке драйвера. Сведения о системе должны включать один раздел с описанием источника данных для каждого источника данных, указанного с помощью ключевого слова **креатедсн** . Эти разделы не должны включать ключевое слово **Driver** , так как оно указано в разделе Спецификация драйвера, но должно содержать достаточно информации для функции **ConfigDSN** в библиотеке DLL установки драйвера, чтобы создать спецификацию источника данных без отображения каких-либо диалоговых окон. Сведения о формате раздела спецификация источника данных см. в разделе [подразделы спецификации источника данных](../../../odbc/reference/install/data-source-specification-subkeys.md).|  
|**коннектфунктионс**|Строка из трех символов, указывающая, поддерживает ли драйвер **SQLConnect**, **SQLDriverConnect**и **SQLBrowseConnect**. Если драйвер поддерживает **SQLConnect**, первый символ — «Y»; в противном случае — "N". Если драйвер поддерживает **SQLDriverConnect**, второй символ — «Y»; в противном случае — "N". Если драйвер поддерживает **SQLBrowseConnect**, третий символ — «Y»; в противном случае — "N". Например, если драйвер поддерживает **SQLConnect** и **SQLDriverConnect** , но не **SQLBrowseConnect**, строка из трех символов будет иметь значение "ИИН".|  
|**DriverODBCVer**|Символьная строка с версией ODBC, поддерживаемой драйвером. Версия имеет формат *nn. NN*, где первые две цифры — основной номер версии, а следующие две цифры — дополнительный номер версии. Для версии ODBC, описанной в этом руководстве, драйвер должен вернуть значение "03,00".<br /><br /> Оно должно быть таким же, как и значение, возвращаемое для параметра SQL_DRIVER_ODBC_VER в **SQLGetInfo**.|  
|**филикстнс**|Для драйверов на основе файлов — разделенный запятыми список расширений файлов, которые может использовать драйвер. Например, драйверу dBASE может быть задано значение \* . dbf и драйвер форматированного текстового файла. \* txt, \* . csv. Пример того, как приложение может использовать эти сведения, см. в разделе ключевое слово **филеусаже** .|  
|**филеусаже**|Число, указывающее на то, как файловый драйвер непосредственно обрабатывает файлы в источнике данных.<br /><br /> 0 = Драйвер не является драйвером на основе файлов. Например, драйвер ORACLE — это драйвер на основе СУБД.<br /><br /> 1 = драйвер на основе файлов рассматривает файлы в источнике данных как таблицы. Например, драйвер xbase обрабатывает каждый файл xbase как таблицу.<br /><br /> 2 = драйвер на основе файлов обрабатывает файлы в источнике данных как каталог. Например, драйвер Microsoft® Access обрабатывает каждый файл Microsoft Access как полную базу данных.<br /><br /> Приложение может использовать его для определения того, как пользователи будут выбирать данные. Например, пользователи xbase и Paradox часто считают данные хранимыми в файлах, тогда как пользователи ORACLE и Microsoft Access обычно считают данные хранимыми в таблицах.<br /><br /> Когда пользователь выбирает **Открыть файл данных** из меню **файл** , приложение может отобразить диалоговое окно **Открыть общий файл Windows** . Список типов файлов будет использовать расширения файлов, заданные с помощью ключевого слова **филикстнс** , для драйверов, которые задают значение **филеусаже** , равное 1, и значение Y в качестве второго символа значения ключевого слова **коннектфунктионс** . После того как пользователь выберет файл, приложение вызовет **SQLDriverConnect** с ключевым словом **Driver** , а затем выполнит инструкцию **SELECT \* FROM *Table-name* ** .<br /><br /> Когда пользователь выбирает **Импорт данных** из меню " **файл** ", приложение может отобразить список описаний для драйверов, которые указывают значение **филеусаже** 0 или 2, а "Y" как второй символ в значении ключевого слова **коннектфунктионс** . После того как пользователь выберет драйвер, приложение вызовет **SQLDriverConnect** с ключевым словом **Driver** , а затем выводит пользовательское диалоговое окно **Выбор таблицы** .|  
|**скллевел**|Число, указывающее грамматику SQL-92, поддерживаемую драйвером:<br /><br /> 0 = запись SQL-92<br /><br /> 1 = переход на FIPS127-2<br /><br /> 2 = промежуточный SQL-92<br /><br /> 3 = SQL-92 Full<br /><br /> Оно должно быть таким же, как и значение, возвращаемое для параметра SQL_SQL_CONFORMANCE в **SQLGetInfo**.|  
  
 Дополнительные сведения о счетчиках использования см. в разделе [Использование подсчета использования](../../../odbc/reference/install/usage-counting.md) ранее.  
  
 Приложения не должны устанавливать счетчик использования. Этот счетчик будет поддерживаться в ODBC.  
  
 Например, предположим, что драйвер для форматированных текстовых файлов имеет библиотеку DLL драйвера с именем Text.dll, отдельную библиотеку DLL установки драйвера с именем Txtsetup.dll и была установлена три раза. Если драйвер поддерживает уровень соответствия API уровня 1, поддерживает минимальный уровень соответствия грамматики SQL, обрабатывает файлы как таблицы и может использовать файлы с расширениями txt и CSV, значения в подразделе Text могут выглядеть следующим образом:  
  
```  
APILevel : REG_SZ : 1  
ConnectFunctions : REG_SZ : YYN  
Driver : REG_SZ : C:\WINDOWS\SYSTEM32\TEXT.DLL  
DriverODBCVer : REG_SZ : 03.00.00  
FileExtns : REG_SZ : *.txt,*.csv  
FileUsage : REG_SZ : 1  
Setup : REG_SZ : C:\WINDOWS\SYSTEM32\TXTSETUP.DLL  
SQLLevel : REG_SZ : 0  
UsageCount : REG_DWORD : 0x3  
```
