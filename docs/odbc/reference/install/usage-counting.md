---
title: Подсчет использования (ru) Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- usage counts [ODBC]
- file usage counts [ODBC]
- installing ODBC components [ODBC], usage counts
- subkeys [ODBC], usage counts
ms.assetid: 0678aee9-8256-463c-89dd-77b1a0dfdd60
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 8d516a591bfde47522c0ccfe08bd2bd706218e07
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81296024"
---
# <a name="usage-counting"></a>Подсчет использования
> [!NOTE]  
>  Начиная с Windows XP и Windows Server 2003, ODBC включен в систему работы Windows. Вы должны только явно установить ODBC на более ранних версиях Windows.  
  
 В реестре сохраняются два типа подсчетов использования: количество использования компонентов и один или несколько факультативных подсчетов использования файлов. Количество использования компонентов помогает установщику DLL поддерживать записи в реестре. Он хранится в значении UseCount под подкилами ODBC Core, драйвером и переводчиком. Для формата значения UseCount и более подробной [Registry Entries for ODBC Components](../../../odbc/reference/install/registry-entries-for-odbc-components.md)информации об этих подключаемых ключах см.  
  
 Когда компонент впервые установлен, установщик DLL создает подключку для него и устанавливает данные для значения UseCount в этом подключке до 1. Когда компонент устанавливается снова, установщик DLL приращает количество использования. При удалении компонента установщик DLL присчитывает количество использования. Если количество использования падает до 0, установщик DLL удаляет подключку для компонента.  
  
> [!CAUTION]  
>  Приложение не должно физически удалять файлы менеджера драйверов, когда количество использования компонента и количество использования файла достигает нуля.  
  
 Подсчеты использования файлов помогают определить, когда файл должен быть фактически скопирован или удален, в отличие от приращения или decrementing количество использования. Это важно, поскольку компоненты ODBC и, следовательно, файлы в компонентах ODBC являются общими и могут быть установлены или удалены различными приложениями. Приложение может удалять файлы драйверов и переводчика, если количество использования компонентов и количество использования файла достигает нуля. Однако файлы менеджера драйверов не должны удаляться, когда количество и количество использования файлов достигли нуля, поскольку эти файлы могут использоваться другими приложениями, которые не увеличили количество использования файлов.  
  
> [!NOTE]  
>  Количество использования файлов не является обязательным в Microsoft® WindowsNT®/Windows2000.  
  
 Количество использования файлов поддерживается программой настройки после того, как она вызывает **S'LInstallDriverDriver**, **S'LInstallDriverEx**, **S'LInstallTranslatorEx**, **S'LRemoveDriver,** **S'LRemoveDriver , S'LRemoveDriver**, или **S'LRemoveTranslator**.  
  
 При первом установке компонента программа настройки или DLL установки создает значение под следующим ключом для каждого файла в этом компоненте, которого еще нет в системе:  
  
> [!NOTE]  
>  HKEY_LOCAL_MACHINE  
>   
>  SOFTWARE  
>   
>  Microsoft  
>   
>  Windows  
>   
>  CurrentVersion  
>   
>  Общие Dlls  
  
 Он устанавливает данные для этих значений до 1 и копирует файл в систему. При повторном установке компонента программа настройки или установка DLL приращает количество использования. Когда компонент удаляется, программа настройки или установщик DLL дередирует количество использования. Если количество использования падает до 0, программа настройки или DLL установки удаляет значение для файла и, если компонент является драйвером или переводчиком, удаляет файл. Файлы менеджера драйверов не должны быть удалены.  
  
 Формат значения количества использования файла отображается в следующей таблице.  
  
|Имя|Тип данных|Данные|  
|----------|---------------|----------|  
|*полный путь*|REG_DWORD|*count*|  
  
 Например, предположим, что драйвер для Informix использует файлы Infrmx32.dll и Infrmx32.hlp, и предположим, что этот драйвер был установлен дважды. Значения подключки SharedDlls для драйвера Informix будут следующими:  
  
```  
C:\WINDOWS\SYSTEM32\INFRMX32.DLL : REG_DWORD : 0x2  
C:\WINDOWS\SYSTEM32\INFRMX32.HLP : REG_DWORD : 0x2  
```
