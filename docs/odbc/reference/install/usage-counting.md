---
title: Подсчет использования | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- usage counts [ODBC]
- file usage counts [ODBC]
- installing ODBC components [ODBC], usage counts
- subkeys [ODBC], usage counts
ms.assetid: 0678aee9-8256-463c-89dd-77b1a0dfdd60
author: MightyPen
ms.author: genemi
ms.openlocfilehash: edf9976dd3e5d890b46919808e896a8e81a0cd93
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "68093793"
---
# <a name="usage-counting"></a>Подсчет использования
> [!NOTE]  
>  Начиная с Windows XP и Windows Server 2003, ODBC включена в операционную систему Windows. ODBC следует только явным образом установить в более ранних версиях Windows.  
  
 Два вида счетчики использования хранятся в реестре для каждого компонента: учет использования компонента и один или несколько счетчиков использования необязательного файла. Счетчик использования компонента помогает установщик DLL Ведение записей реестра. Они хранятся в значении UsageCount базовый ODBC, драйвер и подразделов translator. Формат значения UsageCount и Дополнительные сведения об этих подразделов, см. в разделе [записи реестра для компонентов ODBC](../../../odbc/reference/install/registry-entries-for-odbc-components.md).  
  
 При первой установке компонента установщика DLL создает подраздел для него и задает значение UsageCount в этом разделе 1. При повторной установки компонента установщика DLL увеличивает счетчик использования. При удалении компонента установщика DLL уменьшает использование счетчик. Если счетчик использования становится равным 0, то установщик DLL удаляет подраздел для компонента.  
  
> [!CAUTION]  
>  Приложения не должен физически удалить файлы диспетчера драйверов, когда счетчик использования компонента и счетчик использования файла достигнет нуля.  
  
 Использование файла счетчики помогают определить, когда файл должен фактически скопированы или удалены как отличие от увеличения и уменьшения счетчик использования. Это важно, поскольку компонентов ODBC и поэтому файлы компонентов ODBC, являются общими и можно установить или удалить с помощью разнообразных приложений. Приложение можно удалить файлы драйверов и перевода, если счетчик использования компонента и счетчик использования файла достигнет нуля. Диспетчер драйверов файлы следует, однако, удаляться при счетчик использования компонента и счетчик использования файла стал равным нулю, так как эти файлы могут использоваться другими приложениями, которые не имеют увеличивается счетчик использования файла.  
  
> [!NOTE]  
>  Счетчики использования файла являются необязательными в Microsoft® WindowsNT®/Windows 2000.  
  
 Счетчики использования файла поддерживаются программой установки, после вызова **SQLInstallDriverManager**, **SQLInstallDriverEx**, **SQLInstallTranslatorEx**, **SQLRemoveDriverManager**, **SQLRemoveDriver**, или **SQLRemoveTranslator**.  
  
 При первой установке компонента программы установки или установщика библиотеки DLL создает значение в следующем разделе, для каждого файла в этом компоненте, которого еще нет в системе:  
  
> [!NOTE]  
>  HKEY_LOCAL_MACHINE  
>   
>  ПРОГРАММНОЕ ОБЕСПЕЧЕНИЕ  
>   
>  Майкрософт  
>   
>  Windows  
>   
>  CurrentVersion  
>   
>  SharedDlls  
  
 Он задает данные для этих значений 1 и копирует файл в системе. При повторной установки компонента программы установки или установщика DLL увеличивает счетчики использования. При удалении компонента установки программы или установщика уменьшает DLL использование счетчиков. Если любой счетчик использования становится равным 0, программа установки или установщика DLL удаляет значение для файла и удаляет файл, если компонент драйвера или переводчика. Не следует ли удалять файлы диспетчера драйверов.  
  
 В следующей таблице показан формат значения счетчика использования файла.  
  
|Имя|Тип данных|Data|  
|----------|---------------|----------|  
|*Full-path*|REG_DWORD|*count*|  
  
 Например предположим, что драйвер для Informix используются файлы Infrmx32.dll и Infrmx32.hlp и Предположим, что этот драйвер был установлен дважды. Значения в подразделе SharedDlls Informix драйвера будет выглядеть следующим образом:  
  
```  
C:\WINDOWS\SYSTEM32\INFRMX32.DLL : REG_DWORD : 0x2  
C:\WINDOWS\SYSTEM32\INFRMX32.HLP : REG_DWORD : 0x2  
```
