---
title: Диспетчер драйверов | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver manager [ODBC]
- ODBC architecture [ODBC], driver manager
- driver manager [ODBC], about driver manager
- ODBC driver manager [ODBC]
ms.assetid: 559e4de1-16c9-4998-94f5-6431122040cd
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 659678451c368df0b6a213e54cf7edaedfc29bd1
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "68039336"
---
# <a name="the-driver-manager"></a>Диспетчер драйверов
*Диспетчера драйверов* — это библиотека, управляет связью между приложениями и драйверами. Например на платформах Microsoft® Windows®, диспетчер драйверов является библиотеку динамической компоновки (DLL), который записывается корпорацией Майкрософт и может свободно распространяться пользователями распространяемого пакета SDK MDAC 2.8 с пакетом обновления 1.  
  
 Диспетчер драйверов существует главным образом для удобства программисты и решает ряд проблем, общими для всех приложений. К ним относятся определения, какой драйвер следует загрузить на основании имени источника данных, загрузка и выгрузка драйверов и вызов функций в драйверах.  
  
 Чтобы узнать, почему второй проблемы, рассмотрите возможность что произойдет, если приложение функции в драйвере непосредственного вызова. Если приложение было напрямую связанных с конкретный драйвер, его длина будет для построения таблицы указателей на функции в этот драйвер и вызывать эти функции, указателем. Используя тот же код для более одного драйвера одновременно добавить еще один уровень сложности. Приложение сначала пришлось бы установить указатель на функцию указывал на правильное функции в драйвер и затем вызвать функцию по этому указателю.  
  
 Диспетчер драйверов решает эту проблему, предоставляя единое расположение для вызова каждой функции. Приложение связано диспетчера драйверов и вызовы функций ODBC в диспетчер драйверов не драйвер. Приложение идентифицирует целевой источник драйвера и данных с помощью *дескриптора соединения*. При загрузке драйвера, диспетчер драйверов создает таблицу из указателей на функции в этот драйвер. Он использует дескриптора соединения, передаваемыми приложением, чтобы найти адрес функции в драйвере целевой объект и вызывает эту функцию по адресу.  
  
 В большинстве случаев диспетчер драйверов просто передает вызовы функций из приложения в соответствующий драйвер. Тем не менее, он также реализует некоторые функции (**SQLDataSources**, **SQLDrivers**, и **SQLGetFunctions**) и выполняет проверку основных ошибок. Например диспетчер драйверов проверяет, что маркеры не пустые указатели, что функции вызываются в правильном порядке, и что определенные аргументы функции являются допустимыми. Описание ошибки проверки диспетчером драйверов, см. в справочном разделе для каждой функции и [приложении б: Таблицы перехода состояния ODBC](../../odbc/reference/appendixes/appendix-b-odbc-state-transition-tables.md).  
  
 Последняя основная роль диспетчера драйверов Загрузка и выгрузка драйверов. Приложение загружает и выгружает только диспетчера драйверов. Когда он хочет использовать конкретный драйвер, он вызывает функцию подключения (**SQLConnect**, **SQLDriverConnect**, или **SQLBrowseConnect**) в диспетчере драйверов с указанием имя конкретного источника данных или драйвера, например «Бухгалтерия» или «SQL Server». С помощью этого имени, диспетчер драйверов ищет имя файла драйвера, например Sqlsrvr.dll к источнику данных. Затем он загружает драйвер (если он еще не загружено), хранится адрес каждой функции в драйвере и вызывает функцию подключения в драйвере, который затем инициализирует себя и подключается к источнику данных.  
  
 После завершения приложения с помощью драйвера, он вызывает **SQLDisconnect** диспетчера драйверов. Диспетчер драйверов вызывает эту функцию в драйвер, который отключает от источника данных. Тем не менее диспетчер драйверов хранит драйвер в памяти в случае, если приложение выполняет повторное подключение к нему. Он выгружает драйвер только в том случае, когда приложение освобождает соединения, используемого драйвером или использует соединение для другой драйвер, и другие соединения не использовать драйвер. Полное описание роли диспетчера драйверов в Загрузка и выгрузка драйверов, см. в разделе [роль диспетчера драйверов в процессе подключения](../../odbc/reference/develop-app/driver-manager-s-role-in-the-connection-process.md).
