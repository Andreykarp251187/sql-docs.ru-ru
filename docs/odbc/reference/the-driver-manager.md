---
title: Менеджер драйверов Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver manager [ODBC]
- ODBC architecture [ODBC], driver manager
- driver manager [ODBC], about driver manager
- ODBC driver manager [ODBC]
ms.assetid: 559e4de1-16c9-4998-94f5-6431122040cd
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 686a2b9673fb392f969a42f4cc86dd95a95668a6
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81286798"
---
# <a name="the-driver-manager"></a>Диспетчер драйверов
*Driver Manager* — это библиотека, управляя связью между приложениями и драйверами. Например, на платформах Microsoft® Windows® driver Manager — это библиотека динамических ссылок (DLL), которая написана корпорацией Майкрософт и может быть перераспределена пользователями перераспределяемого MDAC 2.8 SPK.  
  
 Менеджер драйвера существует главным образом как удобство для авторов приложений и решает ряд проблем, общих для всех приложений. Они включают определение того, какой драйвер загружать на основе имени источника данных, загрузка и разгрузка драйверов, а также вызов функций в драйверах.  
  
 Чтобы понять, почему последнее является проблемой, подумайте, что произойдет, если приложение вызывает функции в драйвере напрямую. Если приложение не связано непосредственно с конкретным драйвером, ему придется создать таблицу указателей на функции в этом драйвере и вызвать эти функции по указателю. Использование одного и того же кода для нескольких драйверов одновременно добавит еще один уровень сложности. Приложение сначала должно установить указатель функции, чтобы указать на правильную функцию в правильном драйвере, а затем вызвать функцию через этот указатель.  
  
 Менеджер драйвера решает эту проблему, предоставляя одно место для вызова каждой функции. Приложение связано с менеджером драйвера и вызывает функции ODBC в менеджере драйвера, а не в драйвере. Приложение идентифицирует целевой драйвер и источник данных с *помощью ручки соединения.* Когда он загружает драйвер, менеджер драйвера создает таблицу указателей на функции в этом драйвере. Он использует ручку соединения, передаваемую приложением, чтобы найти адрес функции в целевом драйвере и вызывает эту функцию по адресу.  
  
 По большей части, менеджер драйвера просто передает функциональные вызовы из приложения правильному водителю. Тем не менее, он также реализует некоторые функции **(S'LDataSources**, **S'LDrivers**, и **S'LGetФункции)** и выполняет основную проверку ошибок. Например, менеджер драйвера проверяет, что ручки не являются нулевыми указателями, что функции называются в правильном порядке, и что некоторые аргументы функции являются действительными. Полное описание ошибок, проверенных менеджером драйвера, см. [Appendix B: ODBC State Transition Tables](../../odbc/reference/appendixes/appendix-b-odbc-state-transition-tables.md)  
  
 Окончательная главная роль менеджера драйвера – это погрузка и разгрузка драйверов. Приложение загружает и выгружает только менеджер драйвера. Когда он хочет использовать определенный драйвер, он вызывает функцию подключения **(S'LConnect**, **S'LDriverConnect**, или **S'LBrowseConnect)** в менеджере драйвера и указывает имя конкретного источника данных или драйвера, например ,Бухгалтерский учет» или «Сервер S'L». Используя это имя, менеджер драйвера выполняет поиск информации об источнике данных для имени файла драйвера, например Sqlsrvr.dll. Затем он загружает драйвер (при условии, что он еще не загружен), хранит адрес каждой функции в драйвере и вызывает функцию соединения в драйвере, который затем инициализирует сяочить и подключается к источнику данных.  
  
 Когда приложение выполняется с помощью драйвера, оно вызывает **S'LDisconnect** в менеджере драйвера. Менеджер драйвера вызывает эту функцию в драйвере, который отключается от источника данных. Тем не менее, менеджер драйвера сохраняет драйвер в памяти в случае, если приложение воссоединяется с ним. Он разгружает драйвер только тогда, когда приложение освобождает соединение, используемое водителем, или использует соединение для другого драйвера, и никакие другие соединения не используют драйвер. Полное описание роли менеджера драйвера в погрузке [Driver Manager's Role in the Connection Process](../../odbc/reference/develop-app/driver-manager-s-role-in-the-connection-process.md)и разгрузке драйверов см.
