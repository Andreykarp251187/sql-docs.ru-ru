---
description: Диспетчер драйверов
title: Диспетчер драйверов | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver manager [ODBC]
- ODBC architecture [ODBC], driver manager
- driver manager [ODBC], about driver manager
- ODBC driver manager [ODBC]
ms.assetid: 559e4de1-16c9-4998-94f5-6431122040cd
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 70508eba3f5fce81c6f6185f0ec6befbe0d33b26
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88428876"
---
# <a name="the-driver-manager"></a>Диспетчер драйверов
*Диспетчер драйверов* — это библиотека, которая управляет взаимодействием между приложениями и драйверами. Например, на платформах Microsoft® Windows® Диспетчер драйверов — это библиотека динамической компоновки (DLL), которая пишется корпорацией Майкрософт и может распространяться пользователями распространяемого пакета SDK для MDAC 2,8 с пакетом обновления 1 (SP1).  
  
 Диспетчер драйверов в основном используется для средств записи приложений и решает ряд проблем, характерных для всех приложений. К ним относятся определение драйвера для загрузки на основе имени источника данных, загрузки и выгрузки драйверов, а затем вызов функций в драйверах.  
  
 Чтобы узнать, почему в последнем случае возникает проблема, рассмотрите, что произойдет, если приложение вызывает функции непосредственно в драйвере. Если приложение не было напрямую связано с определенным драйвером, пришлось бы создать таблицу указателей на функции в этом драйвере и вызвать эти функции по указателю. Использование одного и того же кода для нескольких драйверов в каждый момент времени приведет к тому, что будет еще один уровень сложности. В приложении сначала необходимо установить указатель на функцию, указывающий на правильную функцию в правильном драйвере, а затем вызвать функцию через этот указатель.  
  
 Диспетчер драйверов решает эту проблему, предоставляя единое место для вызова каждой функции. Приложение связано с диспетчером драйверов и вызывает функции ODBC в диспетчере драйверов, а не драйвере. Приложение определяет целевой драйвер и источник данных с помощью *маркера подключения*. При загрузке драйвера диспетчер драйверов создает таблицу указателей на функции в этом драйвере. Он использует полученный приложением маркер соединения для поиска адреса функции в целевом драйвере и вызывает эту функцию по адресу.  
  
 В большинстве случаев диспетчер драйверов просто передает вызовы функций из приложения в правильный драйвер. Однако он также реализует некоторые функции (**SQLDataSources**, **SQLDrivers**и **SQLGetFunctions**) и выполняет базовую проверку на наличие ошибок. Например, диспетчер драйверов проверяет, что дескрипторы не равны NULL, эти функции вызываются в правильном порядке и что некоторые аргументы функции являются допустимыми. Полное описание ошибок, проверенных диспетчером драйверов, см. в разделе справки по каждой функции и [приложении б: таблицы переходов состояния ODBC](../../odbc/reference/appendixes/appendix-b-odbc-state-transition-tables.md).  
  
 Финальной основной ролью диспетчера драйверов является загрузка и выгрузка драйверов. Приложение загружает и выгружает только диспетчер драйверов. Когда требуется использовать определенный драйвер, он вызывает функцию подключения (**SQLConnect**, **SQLDriverConnect**или **SQLBrowseConnect**) в диспетчере драйверов и указывает имя определенного источника данных или драйвера, например "Бухгалтерия" или "SQL Server". Используя это имя, диспетчер драйверов ищет в источнике данных имя файла драйвера, например Sqlsrvr.dll. Затем он загружает драйвер (если он еще не загружен), сохраняет адрес каждой функции в драйвере и вызывает функцию подключения в драйвере, который затем инициализирует себя и подключается к источнику данных.  
  
 Когда приложение выполняется с помощью драйвера, оно вызывает **SQLDisconnect** в диспетчере драйверов. Диспетчер драйверов вызывает эту функцию в драйвере, который отключается от источника данных. Однако диспетчер драйверов сохраняет драйвер в памяти в случае, если приложение повторно подключается к нему. Он выгружает драйвер только в том случае, если приложение освобождает подключение, используемое драйвером, или использует подключение для другого драйвера, а другие соединения не используют драйвер. Полное описание роли диспетчера драйверов при загрузке и выгрузке драйверов см. [в разделе роль диспетчера драйверов в процессе подключения](../../odbc/reference/develop-app/driver-manager-s-role-in-the-connection-process.md).
