---
title: Решение ODBC Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- ODBC [ODBC], database access
- SQL [ODBC], database access
- database access [ODBC]
- standardizing database access [ODBC], using ODBC
ms.assetid: 34b80790-e010-4b90-8eaa-03189f5d8986
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 2b35883ff4d621f0ecc092020ad744455281dd63
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81286757"
---
# <a name="the-odbc-solution"></a>Решение ODBC
Вопрос заключается в том, как ODBC стандартизирует доступ к базе данных? Есть два архитектурных требования:  
  
-   Приложения должны иметь доступ к нескольким DBMS, используя один и тот же исходный код без перекомпиляции или пересвязи.  
  
-   Приложения должны иметь доступ к нескольким DBMS одновременно.  
  
 И есть еще один вопрос, в связи с реальностью рынка:  
  
-   Какие функции DBMS следует разоблачать ODBC? Только функции, которые являются общими для всех DBMSs или любой функции, которая доступна в любом DBMS?  
  
 ODBC решает эти проблемы следующим образом:  
  
-   **ODBC — это интерфейс уровня вызова.** Чтобы решить проблему доступа приложений к нескольким DBMS с использованием одного и того же исходного кода, ODBC определяет стандартный CLI. Это содержит все функции в спецификациях CLI от Open Group и ISO/IEC и предоставляет дополнительные функции, обычно требуемые приложениями.  
  
     Для каждого DBMS, поддерживающего ODBC, требуется другая библиотека или драйвер. Драйвер реализует функции в API ODBC. Для использования другого драйвера приложение не нуждается в перекомпилировании или повторном переподключении. Вместо этого приложение просто загружает новый драйвер и вызывает функции в нем. Чтобы получить доступ к нескольким DBMS одновременно, приложение загружает несколько драйверов. То, как поддерживаются драйверы, является специфическим для операционной системы. Например, на операционной системе Microsoft® Windows® драйверы — это библиотеки динамических ссылок (DLL).  
  
-   **ODBC определяет стандартную грамматику S'L.** В дополнение к стандартному интерфейсу уровня вызова, ODBC определяет стандартную грамматику S'L. Эта грамматика основана на спецификации Open Group S'L CAE. Различия между двумя грамматиками незначительны и в первую очередь из-за различий между грамматикой СЗЛ, требуемой встроенным S'L (Open Group) и CLI (ODBC). Есть также некоторые расширения грамматики, чтобы разоблачить широко доступные языковые функции, не охваченные грамматикой Open Group.  
  
     Приложения могут отправлять заявления с использованием грамматики ODBC или DBMS. Если в выписке используется грамматика ODBC, которая отличается от грамматики DBMS, драйвер преобразует ее перед отправкой в источник данных. Тем не менее, такие преобразования редки, потому что большинство DBMSужейужей т.д. уже используют стандартную грамматику S'L.  
  
-   **ODBC предоставляет менеджеру драйверов для управления одновременным доступом к нескольким DBMS.** Хотя использование драйверов решает проблему одновременного доступа к нескольким DBMS, код для этого может быть сложным. Приложения, предназначенные для работы со всеми драйверами, не могут быть статически связаны с любыми драйверами. Вместо этого они должны загружать драйверы во время выполнения и вызывать функции в них через таблицу указателей функций. Ситуация усложняется, если приложение использует несколько драйверов одновременно.  
  
     Вместо того, чтобы заставлять каждое приложение делать это, ODBC предоставляет менеджер драйвера. Менеджер драйверов реализует все функции ODBC - в основном как сквозные звонки на функции ODBC в драйверах - и статически связан с приложением или загружается приложением во время выполнения. Таким образом, приложение называет функции ODBC по имени в менеджере драйвера, а не указателем в каждом драйвере.  
  
     Когда приложению нужен конкретный драйвер, оно сначала запрашивает ручку соединения, с помощью которой можно идентифицировать водителя, а затем просит, чтобы менеджер водителя загружал водителя. Менеджер драйвера загружает драйвер и сохраняет адрес каждой функции в драйвере. Чтобы вызвать функцию ODBC в драйвере, приложение вызывает эту функцию в менеджере драйвера и передает ручку соединения для драйвера. Затем менеджер драйвера вызывает функцию, используя адрес, который он хранил ранее.  
  
-   **ODBC предоставляет значительное количество функций DBMS, но не требует, чтобы драйверы поддерживали все из них.** Если ODBC подвергается только функции, которые являются общими для всех DBMSs, было бы мало пользы; в конце концов, причина так много различных DBMSs существуют сегодня является то, что они имеют различные функции. Если ODBC обнажил каждую функцию, доступную в любом DBMS, драйверы не смогут ее реализовать.  
  
     Вместо этого ODBC предоставляет значительное количество функций - больше, чем поддерживается большинством DBMS, - но требует, чтобы драйверы реализовывались только подмножеством этих функций. Драйверы реализуют оставшиеся функции только в том случае, если они поддерживаются базовым DBMS или если они хотят подражать им. Таким образом, приложения могут быть написаны для использования функций одного DBMS в качестве подверженных драйвером для этого DBMS, использовать только те функции, которые используются всеми DBMSs, или проверить на поддержку конкретной функции и реагировать соответствующим образом.  
  
     Таким образом, приложение может определить, какие функции драйвера и поддержки DBMS, ODBC предоставляет две функции **(S'LGetInfo** и **S'LGetFunctions),** которые возвращают общую информацию о возможностях драйвера и DBMS и список функций, которые поддерживает драйвер. ODBC также определяет уровни соответствия aPI и S'L грамматике, в которых указаны широкие диапазоны функций, поддерживаемых драйвером. Для получения дополнительной информации [см.](../../odbc/reference/develop-app/conformance-levels.md)  
  
     Важно помнить, что ODBC определяет общий интерфейс для всех функций, которые он предоставляет. Из-за этого приложения содержат определенный код, а не код DBMS, и могут использовать любые драйверы, которые предоставляют эти функции. Одним из преимуществ этого является то, что приложения не нуждаются в обновлении, когда функции, поддерживаемые DBMS, расширяются; вместо этого, когда установлен обновленный драйвер, приложение автоматически использует функции, поскольку его код специфичен, а не для драйвера или DBMS-специфическим.
