---
title: Решение ODBC | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- ODBC [ODBC], database access
- SQL [ODBC], database access
- database access [ODBC]
- standardizing database access [ODBC], using ODBC
ms.assetid: 34b80790-e010-4b90-8eaa-03189f5d8986
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 5adf32800f4c2bc2b4a0874ca7efc22f04ffd110
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "63200473"
---
# <a name="the-odbc-solution"></a>Решение ODBC
Вопрос, затем, в том, как ODBC does стандартизировать доступа к базе данных? Есть два архитектурных требования:  
  
-   Приложения должны иметь возможность доступа к несколько СУБД, с помощью того же исходного кода без повторной компиляции или повторного связывания.  
  
-   Приложения должны иметь возможность одновременно получить доступ к нескольким СУБД.  
  
 И еще один вопрос, из-за реальности marketplace:  
  
-   Какие возможности СУБД должны предоставлять ODBC? Только функции, которые являются общими для всех СУБД или любые функции, которая доступна в любой СУБД?  
  
 ODBC решает эти проблемы следующим образом:  
  
-   **ODBC — это интерфейс уровня вызова.** Чтобы решить проблему, как приложения получают доступ к нескольким СУБД, с помощью того же исходного кода, ODBC определяет стандартный интерфейс командной строки. Содержит все функции в спецификациях CLI из Open Group и ISO/IEC и обеспечивает дополнительные функции, обычно необходимые приложениям.  
  
     Другая библиотека или драйвер, является обязательным для каждого СУБД, поддерживающий ODBC. Драйвер реализует функции в API-Интерфейс ODBC. Чтобы использовать другой драйвер, приложение требует повторной компиляции или обновить ссылки. Вместо этого приложение просто загружает новый драйвер и вызывает его функции. Чтобы одновременно получить доступ к нескольким СУБД, приложение загружает несколько драйверов. Как драйверы поддерживаются операционной системой. Например в операционной системе Microsoft® Windows®, драйверы, библиотеки динамической компоновки (DLL).  
  
-   **ODBC определяет стандартный грамматику SQL.** Помимо стандартный интерфейс уровня вызова ODBC определяет стандартный грамматику SQL. Данной грамматикой основана на спецификации Open CAE SQL группы. Различия между двумя грамматики минимальны и главным образом из-за различия между грамматику SQL, требующегося embedded SQL (Open Group) и интерфейса командной строки (ODBC). Кроме того, существуют также некоторые расширения к предоставлять обычно доступных языковые функции, не охваченных грамматики Open Group грамматике.  
  
     Приложения могут отправлять инструкции, применяя грамматику ODBC или СУБД. Если в операторе используется ODBC грамматики, который отличается от СУБД синтаксису, драйвер преобразует его перед их отправкой к источнику данных. Тем не менее такие преобразования встречаются редко, так как большинство СУБД уже использовать стандартный синтаксис SQL.  
  
-   **ODBC предоставляет диспетчер драйверов для управления одновременный доступ к нескольким СУБД.** Несмотря на то, что драйверы решает проблемы доступа к СУБД несколько одновременно, код для этого могут быть сложными. Приложения, предназначенные для работы с все драйверы не может быть статически связан с все драйверы. Вместо этого необходимо загрузить драйверы устройства во время выполнения и вызывать функции в их через таблицу указателей функций. Ситуация становится более сложным в том случае, если приложение использует несколько драйверов, одновременно.  
  
     Каждое приложение, чтобы сделать это, ODBC предоставляя диспетчера драйверов. Диспетчер драйверов реализует все функции ODBC - в основном как сквозной вызовов функций ODBC в драйверах - и является статически связанный с приложением или загружена приложением во время выполнения. Таким образом приложение вызывает функции ODBC, по имени диспетчера драйверов, а не по указателю в каждого драйвера.  
  
     Если приложению нужен конкретный драйвер, сначала запрашивает дескриптор соединения с помощью которой определяется драйвера и запросов, что диспетчер драйверов загрузки драйвера. Диспетчер драйверов загружает драйвер и сохраняет адрес каждой функции в драйвере. Для вызова функции ODBC в драйвере, приложение вызывает эту функцию в диспетчере драйверов и передает дескриптор подключения для драйвера. Затем диспетчер драйверов вызывает функцию с помощью адреса, сохраненную ранее.  
  
-   **ODBC предоставляет значительное количество возможности СУБД, но не требует драйверов для поддержки всех из них.** Если ODBC предоставляется только функции, которые являются общими для всех СУБД, можно использовать; в конце концов причина, сегодня существует множество разных СУБД является наличие различных функций. Если все функции, которая доступна в любой СУБД ODBC, может быть организовано драйверы для реализации.  
  
     Вместо этого предоставляет значительное количество функций – более чем поддерживаются большинство СУБД - ODBC, но требуются драйверы для реализации только подмножество этих функций. Драйверы реализации остальных компонентов, только в том случае, если они поддерживаются базовой СУБД, или если они планируют их эмуляции. Таким образом приложения могут быть написаны для функции единого сервера СУБД благодаря тому, что предоставляемые драйвер БАЗАМИ, использовать только те функции, используемые все СУБД, а также наличие поддержки определенного компонента и реагировать соответствующим образом.  
  
     Приложение может определить, какие функции драйвера и СУБД поддерживает, ODBC предоставляет две функции (**SQLGetInfo** и **SQLGetFunctions**), которые возвращают Общие сведения о драйвере и СУБД возможности и список функций, драйвер поддерживает. ODBC также определяет API и SQL уровни соответствия грамматики, которые указывают широкий диапазон функций, поддерживаемых драйвером. Дополнительные сведения см. в разделе [уровни соответствия](../../odbc/reference/develop-app/conformance-levels.md).  
  
     Это важно помнить, что ODBC определяет общий интерфейс для всех функций, которые он предоставляет. По этой причине приложения содержат определенные функции код, не зависящие от СУБД и можно использовать драйверы, которые предоставляют эти возможности. Одно преимущество в том, что приложения не должны обновляться при улучшены возможности, поддерживаемые различными СУБД; Вместо этого при установке обновленного драйвера, приложение автоматически использует функции потому что его код определенные функции, не относящиеся к драйверу или СУБД.
