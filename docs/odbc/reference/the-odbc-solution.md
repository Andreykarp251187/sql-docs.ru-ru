---
title: Решение ODBC | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- ODBC [ODBC], database access
- SQL [ODBC], database access
- database access [ODBC]
- standardizing database access [ODBC], using ODBC
ms.assetid: 34b80790-e010-4b90-8eaa-03189f5d8986
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 2b35883ff4d621f0ecc092020ad744455281dd63
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "81286757"
---
# <a name="the-odbc-solution"></a>Решение ODBC
Вопрос в том, как ODBC стандартизация доступа к базе данных? Существует два требования к архитектуре:  
  
-   Приложения должны иметь возможность доступа к нескольким СУБД, используя один и тот же исходный код без перекомпиляции или повторной компоновки.  
  
-   Приложения должны иметь возможность одновременного доступа к нескольким СУБД.  
  
 И есть еще один вопрос из-за Marketplace:  
  
-   Какие функции СУБД должны предоставлять ODBC? Только те функции, которые являются общими для всех СУБД или любой функции, доступной в любой СУБД?  
  
 ODBC решает эти проблемы следующим образом.  
  
-   **ODBC — это интерфейс уровня вызова.** Чтобы решить проблему того, как приложения обращаются к нескольким СУБД с помощью одного и того же исходного кода, ODBC определяет стандартную CLI. Он содержит все функции в спецификациях CLI из Open Group и ISO/IEC и предоставляет дополнительные функции, которые обычно требуются приложениям.  
  
     Для каждой СУБД, поддерживающей ODBC, требуется другая библиотека или драйвер. Драйвер реализует функции в API ODBC. Для использования другого драйвера приложение не нуждается в повторной компиляции или повторной компоновке. Вместо этого приложение просто загружает новый драйвер и вызывает в нем функции. Для одновременного доступа к нескольким СУБД приложение загружает несколько драйверов. Поддержка драйверов зависит от операционной системы. Например, в операционной системе Microsoft® Windows® драйверами являются библиотеки динамической компоновки (DLL).  
  
-   **ODBC определяет стандартную грамматику SQL.** В дополнение к стандартному интерфейсу уровня вызовов ODBC определяет стандартную грамматику SQL. Эта грамматика основана на спецификации Open Group SQL автоматизированного конструирования. Различия между двумя грамматиками являются небольшими и главными из-за различий между грамматикой SQL, необходимой внедренным SQL (Open Group) и интерфейсом командной строки (ODBC). Кроме того, в грамматику есть некоторые расширения для предоставления наиболее доступных возможностей языка, не охваченных грамматикой Open Group.  
  
     Приложения могут отправлять инструкции с использованием грамматики ODBC или DBMS. Если инструкция использует грамматику ODBC, которая отличается от грамматики для конкретной СУБД, драйвер преобразует его перед отправкой в источник данных. Однако такие преобразования редки, поскольку большинство СУБД уже используют стандартную грамматику SQL.  
  
-   **ODBC предоставляет диспетчер драйверов для управления одновременным доступом к нескольким СУБД.** Хотя использование драйверов решает проблему одновременного доступа к нескольким СУБД, код для этого может быть сложным. Приложения, предназначенные для работы со всеми драйверами, не могут быть статически связаны с драйверами. Вместо этого они должны загружать драйверы во время выполнения и вызывать функции в них через таблицу указателей функций. Ситуация станет более сложной, если приложение использует несколько драйверов одновременно.  
  
     Вместо принудительного выполнения этого для каждого приложения ODBC предоставляет диспетчер драйверов. Диспетчер драйверов реализует все функции ODBC в основном как сквозные вызовы функций ODBC в драйверах. он статически связывается с приложением или загружается приложением во время выполнения. Таким же, приложение вызывает функции ODBC по имени в диспетчере драйверов, а не по указателю в каждом драйвере.  
  
     Когда приложению требуется определенный драйвер, сначала запрашивается обработчик соединения, с помощью которого определяется драйвер, а затем запрашивается загрузка драйвера диспетчером драйверов. Диспетчер драйверов загружает драйвер и сохраняет адрес каждой функции в драйвере. Для вызова функции ODBC в драйвере приложение вызывает эту функцию в диспетчере драйверов и передает маркер подключения для драйвера. Затем Диспетчер драйверов вызывает функцию, используя адрес, сохраненный ранее.  
  
-   **ODBC предоставляет значительное количество функций СУБД, но не требует, чтобы драйверы поддерживали их все.** Если ODBC раскрывают только те функции, которые являются общими для всех СУБД, это будет нередкое использование. в конце концов, причина, по которой существует множество различных СУБД, состоит в том, что они имеют различные функции. Если ODBC имеет доступ ко всем функциям, доступным в любой СУБД, драйверы могут реализовываться невозможным.  
  
     Вместо этого ODBC предоставляет значительное количество функций — больше, чем поддерживается большинством СУБД, но требует наличия драйверов для реализации только подмножества этих функций. Драйверы реализуют оставшиеся компоненты только в том случае, если они поддерживаются базовой СУБД или если они решили эмулировать их. Таким образом, приложения могут быть написаны для использования функций одной СУБД, предоставляемой драйвером для этой СУБД, для использования только тех функций, которые используются всеми СУБД, или для проверки поддержки определенной функции и реагирования на них.  
  
     Чтобы приложение могла определить, какие функции поддерживает драйвер и СУБД, ODBC предоставляет две функции (**SQLGetInfo** и **SQLGetFunctions**), которые возвращают общие сведения о драйвере и возможностях СУБД, а также список функций, поддерживаемых драйвером. ODBC также определяет уровни соответствия синтаксиса API и грамматики SQL, которые определяют широкий диапазон функций, поддерживаемых драйвером. Дополнительные сведения см. в разделе [уровни соответствия](../../odbc/reference/develop-app/conformance-levels.md).  
  
     Важно помнить, что ODBC определяет общий интерфейс для всех предоставляемых им функций. По этой причине приложения содержат код, зависящий от функции, а не код СУБД, и могут использовать любые драйверы, предоставляющие эти функции. Одно из преимуществ этого заключается в том, что приложения не нуждаются в обновлении, если функции, поддерживаемые СУБД, улучшены; Вместо этого при установке обновленного драйвера приложение автоматически использует эти функции, поскольку его код зависит от конкретного компонента, а не от конкретного драйвера или СУБД.
