---
title: Динамический SQL | Документация Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL [ODBC], embedded SQL
- SQL statements [ODBC], dynamic SQL
- SQL statements [ODBC], embedded SQL
- dynamic SQL [ODBC]
- SQL [ODBC], dynamic SQL
- embedded SQL [ODBC]
ms.assetid: 0bfb9ab7-9c15-4433-93bc-bad8b6c9d287
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: cbecd1d6db1d5ed77082253f6a6a57a96ceec4d1
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "62628700"
---
# <a name="dynamic-sql"></a>Динамические инструкции SQL
Несмотря на то, что статический SQL работает также во многих ситуациях, имеется класс приложений, в которых доступ к данным не удается определить заранее. Например предположим, что электронную таблицу позволяет пользователю ввести запрос, который электронную таблицу отправляет СУБД для получения данных. Содержимое этого запроса очевидно, что не может быть известен программист при записи в электронную.  
  
 Чтобы решить эту проблему, электронной таблицы используется форма embedded SQL, под названием динамического SQL. В отличие от статическими инструкциями SQL, которые жестко закодированы в программе, можно создать во время выполнения динамических инструкций SQL и поместить в строковой переменной узла. Затем они отправляются для СУБД для обработки. Поскольку СУБД необходимо создать план доступа во время выполнения для динамических инструкций SQL, динамического SQL обычно медленнее, чем статического SQL. При компиляции программы, содержащей динамические инструкции SQL, динамических инструкций SQL не удаляются из программы, как и статического SQL. Вместо этого они заменяются вызов функции, которая передает инструкцию для СУБД; обычно обрабатываются статическими инструкциями SQL в одной программе.  
  
 Самый простой способ выполнения динамической инструкции SQL — с помощью инструкции НЕМЕДЛЕННОЕ выполнение. Эта инструкция передает СУБД для компиляции и выполнения инструкции SQL.  
  
 Одним из недостатков НЕМЕДЛЕННОЕ выполнение инструкции является то, что СУБД должен проходить через каждый из пяти шагов обработки инструкции SQL каждый раз при выполнении инструкции. Накладные расходы на этот процесс может быть значительно, если многие операторы выполняются динамически, и слишком затратно, если эти операторы похожи. Чтобы решить эту проблему, динамического SQL предоставляет оптимизированной формой выполнением, которые называются подготовленное выполнение, который выполняет указанные ниже действия:  
  
1.  Программа создает инструкцию SQL в буфере, так же, как для НЕМЕДЛЕННОГО ВЫПОЛНЕНИЯ инструкции. Вместо хост-переменных знак вопроса (?) может быть заменен для константы в любом месте текста инструкции, чтобы указать, что значение для константы предоставляемого позже. Вопросительный знак вызывается как маркер параметра.  
  
2.  Программа передает инструкции SQL в СУБД с помощью инструкции PREPARE, какие запросы, что СУБД синтаксический анализ, проверка и оптимизировать инструкцию и создание выполнения планирование. Затем программа использует инструкцию EXECUTE (не ВЫПОЛНЯТЬ НЕМЕДЛЕННОЕ инструкции) для выполнения инструкции PREPARE позже. Он передает значения параметров для инструкции через специальную структуру данных называется SQLDA или области данных SQL.  
  
3.  Программа может использовать инструкцию EXECUTE, указав различными значениями параметров, каждый раз при выполнении динамической инструкции.  
  
 Подготовленное выполнение по-прежнему не является таким же, как статического SQL. Статический SQL первые четыре шага обработки инструкции SQL выполняются во время компиляции. В подготовленное выполнение эти действия по-прежнему выполняются во время выполнения, но они выполняются только один раз; выполнение плана происходит только в том случае, когда вызывается EXECUTE. Это позволяет исключить некоторые недостатки производительности неотъемлемой частью архитектуры динамического SQL. Следующий рисунок показывает различия между статическим SQL, динамического SQL и немедленное выполнение и динамического SQL с помощью подготовленного выполнения.
