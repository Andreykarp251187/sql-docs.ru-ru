---
title: Динамический СЗЛ Документы Майкрософт
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL [ODBC], embedded SQL
- SQL statements [ODBC], dynamic SQL
- SQL statements [ODBC], embedded SQL
- dynamic SQL [ODBC]
- SQL [ODBC], dynamic SQL
- embedded SQL [ODBC]
ms.assetid: 0bfb9ab7-9c15-4433-93bc-bad8b6c9d287
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 56419723540114f122be2582f0de7c7e7d0c54f3
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81306692"
---
# <a name="dynamic-sql"></a>Динамический SQL
Несмотря на то, что статический S'L хорошо работает во многих ситуациях, существует класс приложений, в которых доступ к данным не может быть определен заранее. Например, предположим, что электронная таблица позволяет пользователю ввести запрос, который электронная таблица затем отправляет в DBMS для получения данных. Содержимое этого запроса, очевидно, не может быть известно программисту при написании программы электронной таблицы.  
  
 Для решения этой проблемы в электронной таблице используется форма встроенного S'L, называемая динамической S'L. В отличие от статических инструкций по S'L, которые жестко закодированы в программе, динамические операторы S'L могут быть построены во время выполнения и помещены в переменную узла строки. Затем они отправляются в DBMS для обработки. Поскольку DBMS должен генерировать план доступа во время выполнения динамических инструкций S'L, динамический S'L, как правило, медленнее, чем статический S'L. При компилировании программы, содержащей динамические операторы S'L, динамические операторы S'L не удаляются из программы, как в статическом S'L. Вместо этого они заменяются вызовом функции, который передает выписку в DBMS; статические операторы S'L в той же программе обрабатываются нормально.  
  
 Самый простой способ выполнения динамического оператора S'L — это заявление EXECUTE IMMEDIATE. Это заявление передает выписку s'L DBMS для компиляции и выполнения.  
  
 Одним из недостатков заявления EXECUTE IMMEDIATE является то, что DBMS должен проходить каждый из пяти этапов обработки оператора S'L каждый раз, когда выписка выполняется. Накладные расходы, связанные с этим процессом, могут быть значительными, если многие операторы выполняются динамически, и это расточительно, если эти заявления похожи. Для решения этой ситуации динамическая система S'L предлагает оптимизированную форму выполнения, называемую подготовленным исполнением, в которой используются следующие действия:  
  
1.  Программа строит заявление S'L в буфере, так же, как и для заявления EXECUTE IMMEDIATE. Вместо переменных хоста, вопросительный знак (?) может быть заменен на констант в любом месте текста оператора, чтобы указать, что значение для константы будет поставляться позже. Вопросительный знак называется параметрным маркером.  
  
2.  Программа передает выписку по S'L dBMS с заявлением PREPARE, в котором содержится просьба о том, чтобы DBMS анализировал, проверял и оптимизировал выписку и генерировал для него план выполнения. Затем программа использует выписку EXECUTE (не выписку EXECUTE IMMEDIATE) для выполнения оператора PREPARE на более позднем этапе. Он передает значения параметров для оператора через специальную структуру данных, называемую областью данных S'L или S'LDA.  
  
3.  Программа может использовать выписку EXECUTE повторно, предоставляя различные значения параметров каждый раз при выполнении динамического оператора.  
  
 Подготовленное выполнение по-прежнему не то же самое, что статическое S'L. В статическом S'L первые четыре этапа обработки оператора S'L происходят во время компиляции. При подготовленном исполнении эти шаги все еще выполняются во время выполнения, но выполняются они только один раз; выполнение плана происходит только тогда, когда EXECUTE называется. Это помогает устранить некоторые недостатки производительности, присущие архитектуре динамического S'L. На следующей иллюстрации показаны различия между статичным S'L, динамическим S'L с немедленным выполнением и динамическим S'L с подготовленным исполнением.
