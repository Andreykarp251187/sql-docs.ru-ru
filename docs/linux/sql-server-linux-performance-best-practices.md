---
title: Рекомендации по производительности для SQL Server в Linux
description: Эта статья содержит рекомендации по производительности и рекомендации по запуску SQL Server в Linux.
author: rgward
ms.author: bobward
ms.reviewer: vanto
ms.date: 09/14/2017
ms.topic: conceptual
ms.prod: sql
ms.technology: linux
ms.openlocfilehash: 543488eada46a088f3c634ce2326c7e2db2a97a5
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "68105442"
---
# <a name="performance-best-practices-and-configuration-guidelines-for-sql-server-on-linux"></a>Рекомендации по производительности и рекомендации по конфигурации для SQL Server в Linux

[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md-linuxonly](../includes/appliesto-ss-xxxx-xxxx-xxx-md-linuxonly.md)]

В этой статье приводятся рекомендации и рекомендации для обеспечения максимальной производительности для приложений баз данных, которые подключаются к SQL Server в Linux. Эти рекомендации предназначены для запуска на платформе Linux. Все обычные рекомендации по SQL Server, такие как Проектирование индекса, по-прежнему применяются.

Следующие правила содержат рекомендации по настройке SQL Server и операционной системы Linux.

## <a name="sql-server-configuration"></a>Конфигурация SQL Server

Рекомендуется выполнить следующие задачи по настройке после установки SQL Server в Linux для обеспечения лучшей производительности для вашего приложения.

### <a name="best-practices"></a>Рекомендации

- **Использование СХОДСТВА ПРОЦЕССА для узла и/или ЦП**

   Рекомендуется использовать `ALTER SERVER CONFIGURATION` присвоить `PROCESS AFFINITY` для всех **NUMANODEs** и/или процессоров используется для SQL Server (который в основном предназначено для всех узлов и ЦП) в операционной системе Linux. Соответствие процессоров помогает поддерживать эффективное поведение Linux и планирование SQL. С помощью **NUMANODE** параметр — это самый простой метод. Обратите внимание, что следует использовать **PROCESS AFFINITY** даже при наличии только одного узла NUMA на компьютере.  См. в разделе [ALTER SERVER CONFIGURATION](../t-sql/statements/alter-server-configuration-transact-sql.md) Дополнительные сведения о том, как задать **PROCESS AFFINITY**.

- **Настройка нескольких файлов данных tempdb**

   Так как при установке SQL Server в Linux не предлагает возможность настройки нескольких файлов базы данных tempdb, рекомендуется рассмотреть создание tempdb на несколько файлов данных после установки. Дополнительные сведения см. в руководстве в этой статье, [рекомендации, чтобы уменьшить количество конфликтов распределения в базе данных tempdb SQL Server](https://support.microsoft.com/help/2154845/recommendations-to-reduce-allocation-contention-in-sql-server-tempdb-d).

### <a name="advanced-configuration"></a>Расширенная конфигурация

Дополнительные параметры конфигурации, которые можно выполнять после установки SQL Server на Linux приведены следующие рекомендации. Эти параметры необходимо настроить основаны на требованиях вашей рабочей нагрузке и конфигурации из операционной системы Linux.

- **Задать ограничение памяти с помощью mssql-conf**

   Чтобы убедиться, что имеется достаточно свободной физической памяти для операционной системы Linux, процесс SQL Server по умолчанию использует только 80% физической памяти ОЗУ. Для некоторых систем, какой большой объем физической памяти ОЗУ, 20% может быть значительным числом. Например в системе с 1 ТБ ОЗУ, параметр по умолчанию останутся около 200 ГБ ОЗУ неиспользуемые. В этом случае может потребоваться настроить ограничение объема памяти больше, чем значение. См. в документации на **mssql-conf** средство и [memory.memorylimitmb](sql-server-linux-configure-mssql-conf.md#memorylimit) параметр, который управляет отображается для SQL Server (в единицах МБ) памяти.

   При изменении этого параметра, не следует это значение слишком велико. Если вы не оставляют достаточно памяти, могут возникнуть проблемы с ОС Linux и других приложений Linux.

## <a name="linux-os-configuration"></a>Настройки ОС Linux

Рекомендуется использовать следующие параметры конфигурации операционной системы Linux добиться оптимальной установки SQL Server.

### <a name="kernel-settings-for-high-performance"></a>Параметры ядра для обеспечения высокой производительности
Это рекомендуемый операционной системы Linux параметры, связанные с высокой производительности и пропускной способности для установки SQL Server. См. в документации операционной системы Linux для процесса настроить эти параметры.



> [!Note]
> Для Red Hat Enterprise Linux (RHEL) пользователей профиль производительности пропускной способности будет настроить эти параметры автоматически (за исключением C-состояния).

В следующей таблице приведены рекомендации для параметров ЦП:

| Параметр | Значение | Дополнительные сведения |
|---|---|---|
| Регулятор частота ЦП | производительность | См. в разделе **cpupower** команды |
| ENERGY_PERF_BIAS | производительность | См. в разделе **x86_energy_perf_policy** команды |
| min_perf_pct | 100 | См. в документации intel p-состояния |
| C-состояния | Только C1 | См. в документации Linux или системы на том, как обеспечить C-состояния имеет значение C1 только |

В следующей таблице приведены рекомендации для параметров диска:

| Параметр | Значение | Дополнительные сведения |
|---|---|---|
| предварительно считанных с диска | 4096 | См. в разделе **blockdev** команды |
| Параметры sysctl | kernel.sched_min_granularity_ns 10 000 000<br/>kernel.sched_wakeup_granularity_ns = 15000000<br/>vm.dirty_ratio = 40<br/>VM.dirty_background_ratio = 10<br/>VM.swappiness = 10 | См. в разделе **sysctl** команды |

### <a name="kernel-setting-auto-numa-balancing-for-multi-node-numa-systems"></a>Ядра параметр auto numa, балансировки для системах с несколькими узлами NUMA

При установке SQL Server на многоузловой **NUMA** систем, ниже **kernel.numa_balancing** ядра включен по умолчанию. Чтобы разрешить SQL Server для работы с максимальной эффективностью **NUMA** системы балансировки в системе NUMA несколькими узлами numa автоматического отключения:

```bash
sysctl -w kernel.numa_balancing=0
```

### <a name="kernel-settings-for-virtual-address-space"></a>Параметры ядра для виртуального адресного пространства

Значение по умолчанию **vm.max_map_count** (это 65536) не может быть достаточно высоким, для установки SQL Server. Измените это значение (это верхний предел) на 256K.

```bash
sysctl -w vm.max_map_count=262144
```

### <a name="disable-last-accessed-datetime-on-file-systems-for-sql-server-data-and-log-files"></a>Отключить доступ к которым осуществляется Дата и время последнего в файловой системе для файлов данных и журналов SQL Server

Используйте **параметр noatime** атрибута с любой файловой системы, используемый для хранения данных SQL Server и файлов журнала. Обратитесь к документации по Linux, о том, как присвоить этому атрибуту.

### <a name="leave-transparent-huge-pages-thp-enabled"></a>Оставьте в поле прозрачным огромные Pages (THP) включена

В большинстве установок Linux должен зависеть этот параметр по умолчанию. Рекомендуется оставить этот параметр конфигурации включен наиболее согласованный интерфейс для производительности.

### <a name="swapfile"></a>файл подкачки

Убедитесь, что у вас есть правильно настроенного файла подкачки во избежание проблем нехватки памяти. Обратитесь к документации Linux для создания и правильно задать размер файла подкачки.

### <a name="virtual-machines-and-dynamic-memory"></a>Виртуальных машин и динамическая память

Если вы используете SQL Server в Linux на виртуальной машине, убедитесь, что выбор варианта устранения объем памяти, зарезервированный для виртуальной машины. Не используйте такие функции, как динамическая память Hyper-V.

## <a name="next-steps"></a>Следующие шаги

Дополнительные сведения о возможностях SQL Server, которые повышают производительность, см. в разделе [приступить к работе с функциями повышения производительности](sql-server-linux-performance-get-started.md).

Дополнительные сведения о SQL Server в Linux, см. в разделе [Общие сведения об SQL Server в Linux](sql-server-linux-overview.md).
