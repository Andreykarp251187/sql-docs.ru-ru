---
title: Экземпляры отказоустойчивого кластера — SQL Server в Linux | Документация Майкрософт
description: ''
author: MikeRayMSFT
ms.author: mikeray
manager: craigg
ms.date: 08/28/2017
ms.topic: conceptual
ms.prod: sql
ms.technology: linux
ms.openlocfilehash: e42c5cc42b1b6d0de6d9674070f53df33bda31b4
ms.sourcegitcommit: 074d44994b6e84fe4552ad4843d2ce0882b92871
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/05/2019
ms.locfileid: "66705306"
---
# <a name="failover-cluster-instances---sql-server-on-linux"></a>Экземпляры отказоустойчивого кластера — SQL Server в Linux

[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md-linuxonly](../includes/appliesto-ss-xxxx-xxxx-xxx-md-linuxonly.md)]

В этой статье описываются основные понятия, связанные с SQL Server экземпляры отказоустойчивого кластера (FCI) в Linux. 

Чтобы создать экземпляр отказоустойчивого Кластера SQL Server в Linux, см. в разделе [настроить SQL Server FCI в Linux](sql-server-linux-shared-disk-cluster-configure.md)

## <a name="the-clustering-layer"></a>Уровень кластеризации

* В RHEL, кластеризации уровень основан на Red Hat Enterprise Linux (RHEL) [дополнение HA](https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/pdf/High_Availability_Add-On_Overview/Red_Hat_Enterprise_Linux-6-High_Availability_Add-On_Overview-en-US.pdf). 

    > [!NOTE] 
    > Доступ к Red Hat высокого уровня ДОСТУПНОСТИ надстройки и документацию требуется подписка. 

* В SLES, кластеризации уровень основан на SUSE Linux Enterprise [высокий уровень доступности расширения (для которых Имеется)](https://www.suse.com/products/highavailability).

    Дополнительные сведения о конфигурации кластера, параметры агента ресурсов, управления, рекомендации и рекомендации, см. в разделе [SUSE Linux Enterprise высокого уровня доступности расширения 12 SP2](https://www.suse.com/documentation/sle-ha-12/index.html).

Надстройка RHEL высокого уровня ДОСТУПНОСТИ и для которых Имеется SUSE основаны на [Pacemaker](https://clusterlabs.org/).

На следующей схеме показано, хранения показано на двух серверах. Кластеризации компонентов - Corosync и Pacemaker - координату связи и управления ресурсами. Один из серверов имеет активное подключение к ресурсам хранилища и SQL Server. Когда Pacemaker обнаруживает сбой кластеризации компоненты управления перемещения ресурсов на другой узел.  

![Red Hat Enterprise Linux 7 кластер с общими дисками SQL](./media/sql-server-linux-shared-disk-cluster-red-hat-7-configure/LinuxCluster.png) 


> [!NOTE]
> На этом этапе не является образом связанных с WSFC в Windows, как интеграция с SQL Server с помощью Pacemaker в Linux. Из в SQL, есть нет сведений о наличии кластера, все оркестрации выходит в и служба определяется как отдельный экземпляр Pacemaker. Кроме того относится только к WSFC имя виртуальной сети, не имеет эквивалента в одной и той же в Pacemaker. Предполагается, что @@servername и sys.servers для возврата имени узла, а sys.dm_os_cluster_nodes кластера динамические административные представления и sys.dm_os_cluster_properties ни одной записи. Чтобы использовать строку подключения, указывающую на имя сервера строку и не используйте IP-адрес, их нужно зарегистрировать в их DNS-сервера IP-адрес, используемый для создания виртуальный IP-адрес (как описано в следующих разделах) с именем выбранного сервера.

## <a name="number-of-instances-and-nodes"></a>Число экземпляров и узлов

Одно из основных отличий с SQL Server в Linux — это что может существовать только одна установка SQL Server на сервер Linux. Что установки называется экземпляром. Это означает, что в отличие от Windows Server, которая поддерживает до 25 экземпляров отказоустойчивого кластера на отказоустойчивом кластере Windows Server (WSFC), экземпляра отказоустойчивого Кластера под управлением Linux будет иметь только один экземпляр. Это один экземпляр также является экземпляром по умолчанию; отсутствует понятие именованного экземпляра на платформе Linux. 

Кластер Pacemaker может иметь только до 16 узлов при Corosync, поэтому один экземпляр отказоустойчивого Кластера может охватывать до 16 серверов. Экземпляр отказоустойчивого Кластера, реализовано с помощью стандартный выпуск SQL Server поддерживает до двух узлах кластера, даже если в кластере Pacemaker максимальное 16 узлов.

В SQL Server FCI экземпляр SQL Server активен на одном узле или в другой.

## <a name="ip-address-and-name"></a>IP-адрес и имя
В кластере Linux Pacemaker каждым экземпляром отказоустойчивого Кластера SQL Server должен свой собственный уникальный IP-адрес и имя. Если в конфигурацию FCI включает несколько подсетей, один IP-адрес потребуется каждой подсети. Уникальное имя и IP-адреса используются для доступа к FCI, таким образом, приложениям и пользователям не нужно знать, какой базовый сервер в кластере Pacemaker.

Имя экземпляра отказоустойчивого Кластера в DNS должен совпадать с именем ресурса отказоустойчивого Кластера, который создается в кластере Pacemaker.
Имя и IP-адрес должны регистрироваться в DNS.

## <a name="shared-storage"></a>Общее хранилище
Все экземпляры отказоустойчивого кластера, являются ли они в Linux или Windows Server, требуют некоторые формы общего хранилища. Это хранилище предоставляется всем серверам, которые возможно может размещаться FCI, но только один сервер можно использовать хранилище, для экземпляра отказоустойчивого Кластера в любой момент времени. Ниже приведены параметры, доступные для общего хранилища в Linux.

- iSCSI
- Сетевой файловой системы (NFS)
- Server Message Block (SMB) в Windows Server, существует несколько различных параметров. Один из вариантов, в настоящее время не поддерживается для экземпляров отказоустойчивого кластера под управлением Linux является возможность использования диска, который является локальным для узла для базы данных TempDB, который является SQL Server временную рабочую область.

В конфигурации, которая охватывает несколько расположений сохраняемые в одном центре обработки данных должны быть синхронизированы с другими. В случае отработки отказа FCI, смогут подключиться сети и хранилища анализируется должны совпадать. Решения этой задачи требуются некоторые внешнего метода для репликации хранилища, сделано ли это с помощью базового оборудования хранилища или служебной программы на основе программного обеспечения. 

>[!NOTE]
>Для SQL Server развертывания на основе Linux с помощью представленных непосредственно на сервер таких дисков должен быть отформатирован XFS или EXT4. В настоящее время другие файловые системы не поддерживаются. Все изменения будут отражены здесь.

Процесс для представления общего хранилища происходит одинаково для различных поддерживаемых методов.

- Настройка общего хранилища
- Подключить хранилище как папку на серверах, которые будут работать в качестве узлов кластера Pacemaker для FCI
- Если требуется, переместите системные базы данных SQL Server в общее хранилище
- Тест, который SQL Server работает с каждого сервера, подключенных к общему хранилищу

Одно из основных отличий с SQL Server в Linux — что можно настроить расположение файла данных и журналов пользователя по умолчанию, системные базы данных всегда должна существовать в `/var/opt/mssql/data`. На Windows Server есть возможность перемещения системных баз данных, включая базы данных TempDB. Этот факт играет в том, как общее хранилище настраивается для экземпляра отказоустойчивого Кластера.

Путь по умолчанию для несистемных базах данных можно изменить с помощью `mssql-conf` служебной программы. Сведения о том, как изменить значения по умолчанию [изменить расположение каталога данных или журнала по умолчанию](sql-server-linux-configure-mssql-conf.md#datadir). Можно также хранить данные SQL Server и транзакции в других местах до тех пор, пока они имеют с точки зрения безопасности, даже если он находится не в расположении по умолчанию; необходимо указать расположение.

В следующих разделах описаны способы настройки поддерживаемых типах хранилищ для Linux на основе экземпляра отказоустойчивого Кластера SQL Server:

- [Настройка экземпляра отказоустойчивого кластера — iSCSI — SQL Server в Linux](sql-server-linux-shared-disk-cluster-configure-iscsi.md)
- [Настроить экземпляр отказоустойчивого кластера — NFS - сервера SQL в Linux](sql-server-linux-shared-disk-cluster-configure-nfs.md)
- [Настроить экземпляр отказоустойчивого кластера — SMB — SQL Server в Linux](sql-server-linux-shared-disk-cluster-configure-smb.md)
