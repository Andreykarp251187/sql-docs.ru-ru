---
title: Связывание приложений Access с SQL Server в базе данных SQL Azure | Документация Майкрософт
ms.prod: sql
ms.custom: ''
ms.date: 08/17/2017
ms.reviewer: ''
ms.technology: ssma
ms.topic: conceptual
helpviewer_keywords:
- Access databases, linking to SQL Azure
- Access databases, linking to SQL Server
- auto-increment columns
- data types, unsupported
- hyperlink columns
- linking tables
- migrating databases, post-migration issues
- post-migration issues
- reference, post-migration issues
- refreshing linked tables
- slow performance
- unlinking tables
ms.assetid: 82374ad2-7737-4164-a489-13261ba393d4
author: Shamikg
ms.author: Shamikg
manager: murato
ms.openlocfilehash: 58abfde651fb59bc69207db810324eb4c74b8c26
ms.sourcegitcommit: 6fd8c1914de4c7ac24900fe388ecc7883c740077
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "79112062"
---
# <a name="linking-access-applications-to-sql-server---azure-sql-db-accesstosql"></a>Связывание приложений Access с SQL Server в базе данных SQL Azure (Акцесстоскл)
Если вы хотите использовать существующие приложения Access с [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], можно связать исходные таблицы Access с перенесенными [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure таблицами. Связывание изменяет базу данных Access таким образом, чтобы запросы, формы, отчеты и страницы доступа к данным использовали данные в базе [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] данных или SQL Azure, а не данные в базе данных Access.  
  
> [!NOTE]  
> Таблицы Access остаются в доступе, но не обновляются вместе с [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure обновлениями. После связывания таблиц и проверки функциональности может потребоваться удалить таблицы Access.  
  
## <a name="linking-access-and-sql-server-tables"></a>Связывание таблиц доступа и SQL Server  
При связывании таблицы Access с таблицей [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azureой ядро СУБД Jet сохраняет сведения о соединении и метаданные таблицы, но данные хранятся в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure. Такое связывание позволяет приложениям доступа работать с таблицами Access, даже если фактические таблицы и данные находятся [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в или SQL Azure.  
  
> [!NOTE]  
> При использовании [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] проверки подлинности пароль сохраняется в виде открытого текста в связанных таблицах Access. Рекомендуется использовать проверку подлинности Windows.  
  
**Связывание таблиц**  
  
1.  В окне Обозреватель метаданных Access выберите таблицы, которые необходимо связать.  
  
2.  Щелкните правой кнопкой мыши элемент **таблицы**и выберите команду **связать**.  
  
[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Помощник по миграции (SSMA) для доступа создает резервную копию исходной таблицы Access и формирует связанную таблицу.  
  
После связывания таблиц таблицы в SSMA отображаются с небольшим значком ссылки. В Access таблицы отображаются со значком «Linked» (связанный), который представляет собой глобус со стрелкой, указывающей на нее.  
  
При открытии таблицы в Access данные извлекаются с помощью курсора KEYSET. В результате для больших таблиц все данные не извлекаются одновременно. Однако при просмотре таблицы Access при необходимости получает дополнительные данные.  
  
> [!IMPORTANT]  
> Чтобы связать таблицы Access с базой данных Azure, требуется SQL Server Native Client (SNAC) версии 10,5 или более поздней.   
> Последнюю версию SNAC можно получить с помощью [пакета дополнительных компонентов Microsoft® SQL Server® 2008 R2](https://www.microsoft.com/download/details.aspx?id=44272).  
  
## <a name="unlinking-access-tables"></a>Отмена связи с таблицами доступа  
При разрыве связи таблицы доступа из таблицы [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azureа SSMA восстанавливает исходную таблицу Access и ее данные.  
  
**Отмена связи таблиц**  
  
1.  В окне Обозреватель метаданных Access выберите таблицы, связь с которыми необходимо отменить.  
  
2.  Щелкните правой кнопкой мыши элемент **таблицы**и выберите команду **Удалить связь**.  
  
## <a name="linking-tables-to-a-different-server"></a>Связывание таблиц с другим сервером  
Если таблицы Access привязаны к одному экземпляру SQL Server и в дальнейшем требуется изменить ссылки на другой экземпляр, необходимо повторно связать таблицы.  
  
**Связывание таблиц с другим сервером**  
  
1.  В окне Обозреватель метаданных Access выберите таблицы, связь с которыми необходимо отменить.  
  
2.  Щелкните правой кнопкой мыши элемент **таблицы** и выберите команду **Удалить связь**.  
  
3.  Нажмите кнопку **Повторное подключение к SQL Server** .  
  
4.  Подключитесь к экземпляру [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure, к которому необходимо привязать таблицы доступа.  
  
5.  В окне Обозреватель метаданных Access выберите таблицы, которые необходимо связать.  
  
6.  Щелкните правой кнопкой мыши элемент **таблицы**и выберите команду **связать**.  
  
## <a name="updating-linked-tables"></a>Обновление связанных таблиц  
Если определения [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] таблиц или SQL Azure изменены, можно удалить связь и повторно связать таблицы в SSMA, используя процедуры, приведенные ранее в этом разделе. Также можно обновить таблицы с помощью Access.  
  
**Обновление связанных таблиц с помощью Access**  
  
1.  Откройте базу данных Access.  
  
2.  В списке **объекты** выберите пункт **таблицы**.  
  
3.  Щелкните правой кнопкой мыши связанную таблицу, а затем выберите **Диспетчер связанных таблиц**.  
  
4.  Установите флажок рядом с каждой связанной таблицей, которую требуется обновить, а затем нажмите кнопку **ОК**.  
  
## <a name="possible-post-migration-issues"></a>Возможные проблемы, возникающие после миграции  
В следующих разделах перечислены проблемы, которые могут возникнуть в существующих приложениях Access после переноса баз данных из Access [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] в или SQL Azure, а также связывания таблиц вместе с причинами и решениями.  
  
### <a name="slow-performance-with-linked-tables"></a>Снижение производительности с помощью связанных таблиц  
**Причина:** Некоторые запросы могут быть слишком длительными после изменения размера по следующим причинам.  
  
-   Приложение зависит от функций, которые не существуют в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure, в результате чего Jet извлекает таблицы локально для выполнения запроса SELECT.  
  
-   Запросы, которые обновляют или удаляют много строк, отправляются Jet в качестве параметризованного запроса для каждой строки.  
  
**Решение:** Преобразуйте запросы, работающие с задержкой, к передаваемым запросам, хранимым процедурам или представлениям. Преобразование в сквозные запросы имеет следующие проблемы.  
  
-   Передаваемые запросы не могут быть изменены. Изменение результата запроса или добавление новых записей должно осуществляться альтернативным способом, например путем явного **изменения** или **добавления** кнопок в форме, привязанной к запросу.  
  
-   Для некоторых запросов требуется ввод данных пользователем, но сквозные запросы не поддерживают ввод данных пользователем. Вводимые пользователем данные могут быть получены кодом Visual Basic для приложений (VBA), который запрашивает параметры, или формой, используемой в качестве элемента управления вводом. В обоих случаях код VBA отправляет запрос с вводом пользователя на сервер.  
  
### <a name="auto-increment-columns-are-not-updated-until-the-record-is-updated"></a>Столбцы с автоматическим приращением не обновляются, пока запись не будет обновлена  
**Причина:** После вызова RecordSet. AddNew в Jet столбец с автоматическим приращением становится доступным до обновления записи. Это неверно в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure. Новое значение нового значения столбца идентификаторов доступно только после сохранения новой записи.  
  
**Решение:** Перед доступом к полю Identity выполните следующий код Visual Basic для приложений (VBA):  
  
```  
Recordset.Update  
Recordset.Move 0,  
Recordset.LastModified  
```  
  
### <a name="new-records-are-not-available"></a>Новые записи недоступны  
**Причина:** При добавлении записи в таблицу [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azureную с помощью VBA, если поле уникального индекса таблицы имеет значение по умолчанию и не присваивается значение этому полю, Новая запись не отображается до тех пор, пока таблица не будет снова открыта в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure. При попытке получить значение из новой записи появляется следующее сообщение об ошибке:  
  
`Run-time error '3167' Record is deleted.`  
  
**Решение:** При открытии таблицы [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure с помощью кода VBA включите `dbSeeChanges` параметр, как показано в следующем примере:  
  
`Set rs = db.OpenRecordset("TestTable", dbOpenDynaset, dbSeeChanges)`  
  
### <a name="after-migration-some-queries-will-not-allow-the-user-to-add-a-new-record"></a>После миграции некоторые запросы не позволяют пользователю добавить новую запись.  
**Причина:** Если запрос не включает все столбцы, включенные в уникальный индекс, то нельзя добавлять новые значения с помощью запроса.  
  
**Решение:** Убедитесь, что все столбцы, включенные по крайней мере в один уникальный индекс, являются частью запроса.  
  
### <a name="you-cannot-modify-a-linked-table-schema-with-access"></a>Невозможно изменить схему связанной таблицы с доступом  
**Причина:** После переноса данных и связывания таблиц пользователь не может изменить схему таблицы в Access.  
  
**Решение:** Измените схему таблицы с помощью [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], а затем обновите ссылку в Access.  
  
### <a name="hyperlink-functionality-is-lost-after-migrating-data"></a>Функция гиперссылки потеряна после переноса данных  
**Причина:** После переноса данных гиперссылки в столбцах теряют свои функциональные возможности и становятся простыми столбцами типа **nvarchar (max)** .  
  
**Решение.** Отсутствует.  
  
### <a name="some-sql-server-data-types-are-not-supported-by-access"></a>Некоторые SQL Server типы данных не поддерживаются в Access  
**Причина:** Если впоследствии вы обновите [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] таблицы или SQL Azure, чтобы они содержали типы данных, не поддерживаемые Access, то нельзя будет открыть таблицу в Access.  
  
**Решение:** Можно определить запрос доступа, возвращающий только строки с поддерживаемыми типами данных.  
  
## <a name="see-also"></a>См. также  
[Миграция баз данных Access в SQL Server](migrating-access-databases-to-sql-server-azure-sql-db-accesstosql.md)  
  
