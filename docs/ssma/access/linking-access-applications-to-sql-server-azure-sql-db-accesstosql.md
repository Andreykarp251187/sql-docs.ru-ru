---
title: Связывание приложения Access в SQL Server — база данных Azure SQL | Документация Майкрософт
ms.prod: sql
ms.custom: ''
ms.date: 08/17/2017
ms.reviewer: ''
ms.technology: ssma
ms.topic: conceptual
helpviewer_keywords:
- Access databases, linking to SQL Azure
- Access databases, linking to SQL Server
- auto-increment columns
- data types, unsupported
- hyperlink columns
- linking tables
- migrating databases, post-migration issues
- post-migration issues
- reference, post-migration issues
- refreshing linked tables
- slow performance
- unlinking tables
ms.assetid: 82374ad2-7737-4164-a489-13261ba393d4
author: Shamikg
ms.author: Shamikg
manager: murato
ms.openlocfilehash: 20efdf681baa8305b3b2be08b2e9f3efe999d3fa
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62760138"
---
# <a name="linking-access-applications-to-sql-server---azure-sql-db-accesstosql"></a>Связь приложений Access SQL Server — база данных SQL Azure (AccessToSQL)
Если вы хотите использовать существующие приложения Access с [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], можно связать исходные таблицы Access с перенесенными [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или таблиц SQL Azure. Связывание изменяет базу данных Access, благодаря чему ваши запросы, формы, отчеты и данные доступа к страницам использовать данные в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или базы данных SQL Azure вместо данных в базе данных.  
  
> [!NOTE]  
> Ваш доступ к таблицам, остаются в Access, но не обновляются вместе с [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или обновляет SQL Azure. После того как связь между таблицами и проверки функциональности, может потребоваться удалить ваш доступ к таблицам.  
  
## <a name="linking-access-and-sql-server-tables"></a>Связывание таблиц Access и SQL Server  
При связывании таблицы Access [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или таблица SQL Azure, базы данных Jet содержит сведения о подключении и метаданные таблицы, но данные хранятся в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure. Эта привязка позволяет приложений на базе Access вычисляются для доступа к таблицам, несмотря на то, что реально существующих таблиц и данных находятся в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure.  
  
> [!NOTE]  
> Если вы используете [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] проверки подлинности, пароль хранится в виде открытого текста на связанных таблицах Access. Мы рекомендуем использовать проверку подлинности Windows.  
  
**Чтобы связать таблицы**  
  
1.  В обозревателе метаданных доступа выберите таблицы, которые нужно связать.  
  
2.  Щелкните правой кнопкой мыши **таблиц**, а затем выберите **ссылку**.  
  
[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Migration Assistant (SSMA) для доступа создает резервные копии в исходной таблице доступа и создает связанную таблицу.  
  
После привязки таблицы, таблицы в SSMA отображаются со значком небольшой ссылки. В режиме доступа таблицы отображаются со значком «связанный», являющийся шара со стрелкой, указывающей на него.  
  
При открытии таблицы в Access, данные извлекаются с помощью курсора набора ключей. Таким образом для больших таблиц, все данные извлекаются только за один раз. Тем не менее как просмотреть таблицы, доступ получает дополнительные данные по мере необходимости.  
  
> [!IMPORTANT]  
> Чтобы связать таблицы access с базой данных Azure, требуется SQL Server Native Client(SNAC) версии 10.5 или более поздней версии.   
> Можно получить последнюю версию SNAC из [пакет дополнительных компонентов Microsoft® SQL Server® 2008 R2](https://go.microsoft.com/fwlink/?LinkId=196940).  
  
## <a name="unlinking-access-tables"></a>Отсоединение доступа к таблицам  
Когда вы не отмените привязку в таблице Access из [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или таблицу SQL Azure, SSMA восстанавливает исходные таблицы Access и ее данных.  
  
**Чтобы разорвать связь между таблицами**  
  
1.  В обозревателе метаданных доступа выберите таблицы, которые вы хотите удалить связь.  
  
2.  Щелкните правой кнопкой мыши **таблиц**, а затем выберите **отменить связь**.  
  
## <a name="linking-tables-to-a-different-server"></a>Связывание таблиц на другой сервер  
Если вы привязали доступа к таблицам в одном экземпляре SQL Server и более поздней версии требуется изменить ссылки на другой экземпляр, необходимо повторно связать таблицы.  
  
**Чтобы связать таблицы на другой сервер**  
  
1.  В обозревателе метаданных доступа выберите таблицы, которые вы хотите удалить связь.  
  
2.  Щелкните правой кнопкой мыши **таблиц** , а затем выберите **отменить связь**.  
  
3.  Нажмите кнопку **повторно подключиться к SQL Server** кнопку.  
  
4.  Подключитесь к экземпляру [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure, к которому вы хотите связать доступа к таблицам.  
  
5.  В обозревателе метаданных доступа выберите таблицы, которые нужно связать.  
  
6.  Щелкните правой кнопкой мыши **таблиц**, а затем выберите **ссылку**.  
  
## <a name="updating-linked-tables"></a>Обновление связанных таблиц  
Если [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или изменяются определения таблиц SQL Azure, можно удалить связь и повторно свяжите таблицы в SSMA, используя процедуры, приведенные ранее в этом разделе. Можно также обновить таблицы с помощью доступа.  
  
**Обновление связанных таблиц с помощью доступа**  
  
1.  Откройте базу данных Access.  
  
2.  В **объектов** выберите **таблиц**.  
  
3.  Щелкните правой кнопкой мыши связанную таблицу, а затем выберите **Диспетчер связанных таблиц**.  
  
4.  Установите флажок рядом с каждой связанной таблицы, который требуется обновить и нажмите кнопку **ОК**.  
  
## <a name="possible-post-migration-issues"></a>Возможные проблемы после миграции  
В следующих разделах список проблем, которые могут возникнуть в существующие приложения Access, после переноса баз данных с доступом к [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure, а затем связать таблицы, а также причины и способы их устранения.  
  
### <a name="slow-performance-with-linked-tables"></a>Низкая производительность со связанными таблицами  
**Причина.** Некоторые запросы может снижаться после преобразования по следующим причинам:  
  
-   Приложение зависит от функций, которые не существуют в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure, в результате чего Jet извлекать таблицы локально, чтобы выполнить запрос SELECT.  
  
-   Запросы, которые обновляют или удаляют многие строки отправляются Jet качестве параметризованного запроса для каждой строки.  
  
**Решение.** Преобразуйте медленно выполняемых запросов в передаваемых запросах, хранимых процедур или представлений. Преобразование в передаваемых запросах связано со следующими проблемами:  
  
-   Передаваемые запросы нельзя изменить. Результат запроса изменения или добавления новых записей должна быть выполнена альтернативным способом, например путем явного **изменить** или **добавить** кнопки в форме, привязанный к запросу.  
  
-   Некоторые запросы требуют ввод данных пользователем, но передаваемые запросы не поддерживают ввод данных пользователем. Входные данные пользователя можно получить с Visual Basic для приложений (VBA), которые запрашиваются параметров или форму, которая используется в качестве элемента управления вводом. В обоих случаях код VBA в код отправляет запрос с входными данными пользователя на сервер.  
  
### <a name="auto-increment-columns-are-not-updated-until-the-record-is-updated"></a>Столбцов автоприращения не обновляются, пока запись обновляется  
**Причина.** После вызова RecordSet.AddNew в Jet, столбца автоматическим приращением доступна, прежде чем обновления записи. Это не так в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure. Новое значение новое значение столбца удостоверений доступна только после сохранения новой записи.  
  
**Решение.** Выполните следующий код Visual Basic для приложений (VBA) перед обращением к поле идентификации:  
  
```  
Recordset.Update  
Recordset.Move 0,  
Recordset.LastModified  
```  
  
### <a name="new-records-are-not-available"></a>Новые записи недоступны  
**Причина.** При добавлении записи, чтобы [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или таблицу SQL Azure с помощью VBA, в том случае, если поле уникального индекса таблицы имеет значение по умолчанию и не назначить значение к этому полю, новая запись не отображается до повторного открытия таблицы в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure. Если попытаться получить значение из новой записи, появляется следующее сообщение об ошибке:  
  
`Run-time error '3167' Record is deleted.`  
  
**Решение.** При открытии [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или SQL Azure таблица с помощью кода VBA, включают `dbSeeChanges` параметра, как показано в следующем примере:  
  
`Set rs = db.OpenRecordset("TestTable", dbOpenDynaset, dbSeeChanges)`  
  
### <a name="after-migration-some-queries-will-not-allow-the-user-to-add-a-new-record"></a>После миграции некоторые запросы не позволит пользователю добавить новую запись  
**Причина.** Если запрос не содержит все столбцы, включенные в уникальный индекс, нельзя добавить новые значения с помощью запроса.  
  
**Решение.** Убедитесь, что все столбцы, включенные в хотя бы один уникальный индекс являются частью запроса.  
  
### <a name="you-cannot-modify-a-linked-table-schema-with-access"></a>Вы не можете изменить схему связанной таблицы с доступом  
**Причина.** После переноса данных и связывания таблицы пользователь не может изменить схему таблицы в Access.  
  
**Решение.** Изменения схемы таблицы с помощью [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]и затем обновить связь в Access.  
  
### <a name="hyperlink-functionality-is-lost-after-migrating-data"></a>HyperLink функциональные возможности теряются после переноса данных  
**Причина.** После переноса данных, гиперссылки в столбцах потерять свою функциональность и упрощается **nvarchar(max)** столбцов.  
  
**Решение.** Нет.  
  
### <a name="some-sql-server-data-types-are-not-supported-by-access"></a>Некоторые типы данных SQL Server не поддерживаются по доступу  
**Причина.** Если впоследствии обновить ваш [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] или таблиц SQL Azure содержит типы данных, которые не поддерживаются в Microsoft Access, не может открыть таблицу в Access.  
  
**Решение.** Можно определить запрос доступа, который возвращает только те строки, поддерживаемые типы данных.  
  
## <a name="see-also"></a>См. также  
[Миграция баз данных Access в SQL Server](migrating-access-databases-to-sql-server-azure-sql-db-accesstosql.md)  
  
