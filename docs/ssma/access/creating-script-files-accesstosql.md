---
title: Создание файлов сценария (AccessToSQL) | Документация Майкрософт
ms.prod: sql
ms.custom: ''
ms.date: 08/17/2017
ms.reviewer: ''
ms.technology: ssma
ms.topic: conceptual
ms.assetid: 64dfe192-965c-49d4-a3ea-848fbc5f619f
author: Shamikg
ms.author: Shamikg
manager: murato
ms.openlocfilehash: 9d888fa133e6cb1026ae23486dfabfc5e0b13b57
ms.sourcegitcommit: e7d921828e9eeac78e7ab96eb90996990c2405e9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/16/2019
ms.locfileid: "68259830"
---
# <a name="creating-script-files-accesstosql"></a>Создание файлов сценария (AccessToSQL)
Первый шаг перед запуском приложения консоли SSMA заключается в создании файла скрипта и при необходимости создания файла значение переменной и файле подключения сервера.  
  
Файл сценария можно разделить на три раздела, находящие отклик у..,:  
  
1.  **конфигурации:** Позволяет пользователю задавать параметры конфигурации для консольного приложения.  
  
2.  **серверы:** Позволяет пользователю задать исходную и целевую определениями сервера. Это также может быть в файле подключения отдельный сервер.  
  
3.  **команды сценария:** Позволяет пользователю выполнять команды SSMA рабочего процесса.  
  
Ниже подробно описан каждый раздел.  
  
## <a name="configuring-access-console-settings"></a>Настройка параметров доступа к консоли  
Конфигурации сценария, отображаются в файле скрипта консоли.  
  
Один из элементов, указанных в конфигурации узла, они устанавливаются как глобальный параметр т. е. они применимы для всех команд скрипта. Эти элементы конфигурации можно также задать в пределах каждой команды в разделе команды сценария Если пользователю необходимо переопределить глобальные настройки.  
  
Настраивается пользователем следующие варианты.  
  
1.  **Поставщик для окна вывода:** Если атрибут подавлять сообщения имеет значение «true», команда конкретного сообщения не отображаются на консоли. Ниже дается описание атрибутов:  
  
    -   Назначение: Указывает, должен ли результат печати в файл или stdout. Это значение по умолчанию: false.  
  
    -   Имя файла: Путь к файлу (необязательно).  
  
    -   подавлять сообщения: Подавляет сообщения на консоль. Это значение «false», по умолчанию.  
  
    **Пример.**  
  
    ```xml  
    <output-providers>  
  
      <output-window  
  
        suppress-messages="<true/false>"   (optional)  
  
        destination="<file/stdout>"        (optional)  
  
        file-name="<file-name>"            (optional)  
  
       />  
  
    </output-providers>  
    ```  
    *or*  
  
    ```xml  
    <...All commands...>  
  
      <output-window  
  
         suppress-messages="<true/false>"   (optional)  
  
         destination="<file/stdout>"        (optional)  
  
         file-name="<file-name>"            (optional)  
  
       />  
  
    </...All commands...>  
    ```  
  
2.  **Поставщик подключений данных миграции:** Это указывает на то, что исходный или целевой сервер будет считаться для переноса данных.  Источник использование последнее использованное указывает, что последний используется исходного сервера используется для переноса данных. Аналогичным образом target использование последнее использованное указывает, что последнего указанного целевого сервера используется для переноса данных. Пользователь также может указать сервер (источник или цель) с помощью атрибутов исходного сервера или целевого сервера.  
  
    Только один, или указанный атрибут может использоваться т. е.:  
  
    - Источник использование последнее использованное = «true» (по умолчанию) или исходный сервер = «source_servername»  
  
    - target использование последнее использованное = «true» (по умолчанию) или целевой сервер = «target_servername»  
  
    **Пример.**  
  
    ```xml  
    <output-providers>  
  
      <data-migration-connection   source-use-last-used="true"  
  
                                   target-server="target_1"/>  
  
    </output-providers>  
    ```  
    *or*  
  
    ```xml  
    <migrate-data>  
  
      <data-migration-connection   source-server="source_1"  
  
                                   target-use-last-used="true"/>  
  
    </migrate-data>  
    ```  
  
3.  **Всплывающее окно ввода пользователя:** Это позволяет обработку ошибок, когда объекты загружаются из базы данных. Пользователь предоставляет режимы ввода, и в случае ошибки, консоль переход, как пользователь указывает.  
  
    Режимы включают:  
  
    -   **Попросите пользователя -** пользователю будет предложено continue('yes') или ошибкой («нет»).  
  
    -   **Ошибка -** консоли отображает сообщение об ошибке и прекращает.  
  
    -   **по-прежнему-** консоль продолжает выполнение.  
  
    По умолчанию используется режим **ошибка**.  
  
    **Пример.**  
  
    ```xml  
    <output-providers>  
  
      <user-input-popup mode="<ask-user/continue/error>"/>  
  
    </output-providers>  
    ```  
    *or*  
  
    ```xml  
    <!-- Connect to target database -->  
  
    <connect-target-database server="target_0">  
  
      <user-input-popup mode="<ask-user/continue/error>"/>  
  
    </connect-target-database>  
    ```  
  
4.  **Повторное подключение поставщика:** Это позволяет пользователю задавать параметры повторного подключения при сбое подключения. Это можно задать для исходного и целевого серверов.  
  
    Эти режимы повторного подключения являются:  
  
    -   повторное подключение последнего использовать сервер: Если соединение не активен, предпринимается попытка повторного подключения к последнему сервера, используемого не более 5 раз.  
  
    -   Создание ошибка: Если соединение не активен, формируется ошибка.  
  
    По умолчанию используется режим **создания error**.  
  
    **Пример.**  
  
    ```xml  
    <output-providers>  
  
     <reconnect-manager on-source-reconnect="<reconnect-to-last-used-server/generate-an-error>"  
  
                        on-target-reconnect="<reconnect-to-last-used-server/generate-an-error>"/>  
  
    </output-providers>  
    ```  
    *or*  
  
    ```xml  
    <!--synchronization-->  
  
    <synchronize-target>  
  
      <reconnect-manager on-target-reconnect="reconnect-to-last-used-server"/>  
  
    </synchronize-target>  
    ```  
    *or*  
  
    ```xml  
    <!--data migration-->  
  
    <migrate-data server="target_0">  
  
      <reconnect-manager  
  
        on-source-reconnect="reconnect-to-last-used-server"  
  
        on-target-reconnect="generate-an-error"/>  
  
    </migrate-data>  
    ```  
  
5.  **Преобразователь перезаписи поставщика:** Это позволяет обрабатывать объекты, которые уже присутствуют на целевом объекте метабазы. Возможные действия включают:  
  
    -   Ошибка: Консоль выводится сообщение об ошибке и прекращает.  
  
    -   Перезаписать: Производит перезапись существующих значений объекта. Это действие выполняется по умолчанию.  
  
    -   пропустите: Консоль пропускает объекты, которые уже существуют в базе данных  
  
    -   Попросите пользователя: Запрашивает у пользователя входных данных («Да» или «no»)  
  
    **Пример.**  
  
    ```xml  
    <output-providers>  
  
      <object-overwrite action="<error|skip|overwrite|ask-user>"/>  
  
    </output-providers>  
    ```  
    *or*  
  
    ```xml  
    <convert-schema object-name="ssma.TT1">  
  
      <object-overwrite action="<error|skip|overwrite|ask-user>"/>  
  
    </convert-schema>  
    ```  
  
6.  **Поставщик невыполненные предварительные требования:** Это позволяет обрабатывать все предварительные требования, необходимые для обработки команды. По умолчанию строгий режим — «false». Если он имеет значение «true», исключение создается для сбоя выполнения предварительных требований.  
  
    **Пример.**  
  
    ```xml  
    <output-providers>  
  
      <prerequisites strict-mode="<true|false>"/>  
  
    </output-providers>  
    ```  
  
7.  **Остановите операцию:** Во время середине операции, если пользователь хочет остановить операцию, затем **«Ctrl + C»** можно использовать сочетание клавиш. SSMA для доступа к консоли будет ожидать завершения операции и завершает выполнение консоли.  
  
    Если пользователь хочет остановить выполнение немедленно, затем **«Ctrl + C»** сочетание клавиш может быть нажаты для внезапному прекращению SSMA консольного приложения, еще раз.  
  
8.  **Поставщик ход выполнения:** Сообщает о ходе выполнения каждой команды консоли. Эта функция отключена по умолчанию. Атрибуты отчетности о ходе выполнения включают:  
  
    -   off  
  
    -   каждые 1%  
  
    -   каждые 2%  
  
    -   каждые 5%  
  
    -   каждые 10%  
  
    -   каждые 20%  
  
    **Пример.**  
  
    ```xml  
    <output-providers>  
  
     <progress-reporting enable="<true|false>"           (optional)  
  
                         report-messages="<true|false>"  (optional)  
  
                         report-progress="every-1%|every-2%|every-5%|every-10%|every-20%|off" (optional)/>  
  
    </output-providers>  
    ```  
    *or*  
  
    ```xml  
    <...All commands...>  
  
      <progress-reporting  
  
        enable="<true|false>"              (optional)  
  
        report-messages="<true|false>"     (optional)  
  
        report-progress="every-1%|every-2%|every-5%|every-10%|every-20%|off"     (optional)/>  
  
    </...All commands...>  
    ```  
  
9. **Уровень детализации для средства ведения журнала:** Наборы журналов уровня детализации. Это соответствует с параметром все категории в пользовательском Интерфейсе. По умолчанию уровень детализации журнала — «error».  
  
    Параметры уровня ведения журнала:  
  
    -   Неустранимая ошибка: Регистрируются только сообщения Неустранимая ошибка.  
  
    -   Ошибка: Регистрируются только сообщения об ошибках и Неустранимая ошибка.  
  
    -   Предупреждение: Все уровни, за исключением того, записываются сообщения отладки и сведения.  
  
    -   информация: Все уровни, за исключением того, записываются сообщения отладки.  
  
    -   Отладка: Все уровни сообщений в журнал.  
  
    > [!NOTE]  
    > Обязательные сообщения регистрируются на любом уровне.  
  
    **Пример.**  
  
    ```xml  
    <output-providers>  
  
      <log-verbosity level="fatal-error/error/warning/info/debug"/>  
  
    </output-providers>  
    ```  
    *or*  
  
    ```xml  
    <...All commands...>  
  
      <log-verbosity level="fatal-error/error/warning/info/debug"/>  
  
    </...All commands...>  
    ```  
  
10. **Переопределите зашифрованный пароль:** Значение «true», если открытый пароль указан в разделе Определение сервера файла соединения сервера или в файле скрипта, переопределяются зашифрованного пароля, хранящегося в защищенное хранилище, если существует. Если пароль не указан в виде открытого текста, пользователю предлагается ввести пароль.  
  
    Здесь возникают два варианта:  
  
    1.  Если переопределить параметр — **false**, будет этот порядок поиска хранения Protected -&gt;файл скрипта -&gt;Server подключения файла -&gt; запрашивать у пользователя.  
  
    2.  Если переопределить параметр — **true**, будет этот порядок поиска файла скрипта -&gt;Server подключения файла -&gt;запрашивать у пользователя.  
  
    **Пример.**  
  
    ```xml  
    <output-providers>  
  
      <encrypted-password override="<true/false>"/>  
  
    </output-providers>  
    ```  
  
Ненастраиваемые параметр —:  
  
-   **Максимальное попыток восстановить подключение:** Если установленное соединение времени ожидания или нарушено из-за сбоя сети, сервер является обязательным для переподключены. Попытки повторного подключения разрешены максимум **5** повторных попыток, после чего консоль автоматически выполняет повторное подключение. Оборудование автоматическое переподключение сокращает усилия в повторным скрипта.  
  
## <a name="server-connection-parameters"></a>Параметры подключения сервера  
Параметры соединения сервера можно определить в файле скрипта или в файле подключения сервера. Обратитесь к [Создание файлов подключения к серверу &#40;AccessToSQL&#41; ](../../ssma/access/creating-the-server-connection-files-accesstosql.md) более подробные сведения.  
  
## <a name="script-commands"></a>Команды скриптов  
Файл скрипта содержит последовательность команд рабочего процесса миграции в формате XML. Консольное приложение SSMA обрабатывает миграции порядке команды отображаются в файле скрипта.  
  
Например перенос данных обычно конкретной таблицы в базе данных Access следует иерархии: База данных -&gt; таблицы.  
  
При выполнении всех команд в файле скрипта SSMA консольное приложение завершает работу и возвращает элемент управления для пользователя. Содержимое файла сценария, больше или меньше статических переменных, содержащихся в [файлы значение переменной](creating-variable-value-files-accesstosql.md) или в отдельном разделе в файле скрипта для значений переменных.  
  
**Пример.**  
  
```xml  
<!--Sample of script file commands -->  
  
<ssma-script-file>  
  
  <script-commands>  
  
    <create-new-project project-folder="$project_folder$"  
  
                        project-name="$project_name$"  
  
                        overwrite-if-exists="true"/>  
  
    <connect-source-database server="source_2"/>  
  
    <save-project/>  
  
    <close-project/>  
  
  </script-commands>  
  
</ssma-script-file>  
```  
В папке Scripts консоли образец каталога продуктов предоставляются шаблоны, состоящий из 3 файлы скриптов (для выполнения различных сценариев), значение переменной файл и файл подключения сервера:  
  
-   AssessmentReportGenerationSample.xml  
  
-   ConversionAndDataMigrationSample.xml  
  
-   VariableValueFileSample.xml  
  
-   ServersConnectionFileSample.xml  
  
Шаблоны (файлы) можно выполнять после изменения параметров, отображаемых в этой последовательности для релевантности.  
  
Полный список команд сценария можно найти в [выполнение команд консоли SSMA &#40;AccessToSQL&#41;](../../ssma/access/executing-the-ssma-console-accesstosql.md)  
  
## <a name="script-file-validation"></a>Проверка файла скрипта  
Пользователь может просто проверять свой файл сценария, соответствие файлу определения схемы **«A2SSConsoleScriptSchema.xsd»** доступны в папке «Схемы».  
  
## <a name="next-step"></a>Следующий шаг
Следующий шаг в работе консоли — [Создание файлов переменных значений &#40;AccessToSQL&#41;](../../ssma/access/creating-variable-value-files-accesstosql.md).  
  
## <a name="see-also"></a>См. также  
[Создание файлов переменных значений &#40;AccessToSQL&#41;](../../ssma/access/creating-variable-value-files-accesstosql.md)  
  
