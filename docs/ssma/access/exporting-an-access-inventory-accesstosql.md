---
title: Экспорт инвентаризации Access (AccessToSQL) | Документация Майкрософт
ms.prod: sql
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.technology: ssma
ms.topic: conceptual
helpviewer_keywords:
- Access databases
- Access databases, exporting metadata
- exporting
- exporting Access metadata
- exporting, Access metadata
- exporting, querying exported metadata
- inventories of Access databases
- querying exported metadata
ms.assetid: 7e1941fb-3d14-4265-aff6-c77a4026d0ed
author: Shamikg
ms.author: Shamikg
manager: craigg
ms.openlocfilehash: f35ae03cb6588bc7828349dd4a4beafcc5a7b2f3
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62760830"
---
# <a name="exporting-an-access-inventory-accesstosql"></a>Экспорт инвентаризации Access (AccessToSQL)
Если у вас есть несколько баз данных Access, и вы не уверены, какие из них следует перенести в [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], вы можете экспортировать актуальный список всех баз данных Access в проекте. Можно просматривать и запрашивать метаданные инвентаризации, чтобы определить, какие базы данных и объекты внутри них для переноса. Этот инвентаризации позволяет быстро найти ответы на вопросы, например следующие:  
  
-   Что такое крупных баз данных  
  
-   Кто является владельцем большинство баз данных?  
  
-   Какие базы данных содержит те же таблицы?  
  
-   Какие базы данных не были изменены за последние шесть месяцев?  
  
-   Какие базы данных содержат конфиденциальные сведения?  
  
Примеры запросов, которые используются для ответа на эти вопросы приведены в конце этого раздела.  
  
## <a name="exported-metadata"></a>Экспортированные метаданные  
SSMA экспортирует метаданные о доступа баз данных, таблиц, столбцов, индексов, внешние ключи, запросы, отчеты, форм, макросы и модули. Метаданные о каждом из этих категорий элементов экспортируется в отдельной таблице. Схемы этих таблиц см. в разделе [схемы инвентаризации Access](access-inventory-schemas-accesstosql.md).  
  
## <a name="exporting-inventory-data"></a>Экспорт данных инвентаризации  
Экспорт инвентаризации Access, необходимо сначала открыть или Создание проекта SSMA и затем добавить базы данных Access, который требуется проанализировать. После добавления базы данных к проекту SSMA, экспорте метаданных об этих базах данных с заданным [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] базы данных и схемы. При необходимости SSMA создает таблицы для хранения метаданных. SSMA добавляет метаданные базы данных Access для [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] базы данных.  
  
> [!NOTE]  
> Базы данных Access можно разбить на несколько файлов: серверной базы данных, который содержит таблицы и интерфейсные базы данных, содержащие запросы, формы, отчеты, макросы, модули и ярлыки. Если вы хотите перенести базу данных разбиения [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], добавляемый SSMA клиентской базы данных.  
  
Ниже описано, как создать проект, добавьте в проект базы данных, подключиться к [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], а затем экспортировать данные инвентаризации.  
  
**Создание проекта**  
  
1.  Откройте SSMA для Access.  
  
2.  В меню **Файл** выберите пункт **Создать проект**.  
  
    Откроется диалоговое окно **Создание проекта** .  
  
3.  В поле **Name** введите имя проекта.  
  
4.  В **расположение** введите или выберите папку для проекта.  
  
5.  В **Миграция в** поле со списком выберите целевой версии, к которому вы хотите перенести и нажмите кнопку **ОК**.  
  
Дополнительные сведения о создании проектов см. в разделе [Creating and Managing Projects](creating-and-managing-projects-accesstosql.md).  
  
**Чтобы найти и добавить базы данных**  
  
1.  На **файл** меню, щелкните **найти баз данных**.  
  
2.  В мастере найти баз данных введите диск, путь к файлу или UNC-путь, который требуется найти. Можно также щелкнуть **Обзор** выберите диск или в сетевую папку.  
  
3.  Нажмите кнопку **добавить** Добавить расположение в поле списка.  
  
    Повторите предыдущие два шага, чтобы добавить дополнительные местоположения.  
  
4.  При необходимости добавьте условия поиска, чтобы уточнить список баз данных, которые возвращаются.  
  
    > [!IMPORTANT]  
    > **Полностью или частично имя файла** текстовое поле не поддерживает подстановочные знаки.  
  
5.  Нажмите кнопку **сканирования**.  
  
    Откроется окно проверки. Это показывает, что базы данных, которые были найдены и ход выполнения поиска. Чтобы остановить поиск, нажмите кнопку **остановить**.  
  
6.  На странице «Выбор файлов» выберите каждой базы данных, который требуется добавить в проект.  
  
    Можно использовать **выбрать все** и **очистить все** кнопки в верхней части списка, чтобы выбрать или очистить все базы данных. Можно также удерживая нажатой клавишу CTRL, чтобы выбрать несколько строк или удерживайте нажатой клавишу SHIFT, вниз, чтобы выбрать диапазон строк.  
  
7.  Нажмите кнопку **Далее**.  
  
8.  На странице "Проверка", нажмите кнопку **Готово**.  
  
Дополнительные сведения о добавлении баз данных в проекты, см. в разделе [Добавление и удаление файлов баз данных Access](adding-and-removing-access-database-files-accesstosql.md).  
  
**Для подключения к SQL Server**  
  
1.  На **файл** меню, выберите **подключение к SQL Server**.  
  
2.  В диалоговом окне подключения введите или выберите имя экземпляра [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].  
  
    -   Если вы подключаетесь к экземпляру по умолчанию на локальном компьютере, можно ввести **localhost** или точку (**.**).  
  
    -   Если вы подключаетесь к экземпляру по умолчанию на другом компьютере, введите имя компьютера.  
  
    -   Если вы подключаетесь к именованному экземпляру, введите имя компьютера, обратную косую черту и имя экземпляра. Пример: Сервер\экземпляр.  
  
3.  В **базы данных** введите имя целевой базы данных для экспортированных метаданных.  
  
4.  Если экземпляр [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] настроен на прием подключений через нестандартный порт, введите номер порта, который используется для [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] подключений в **порт сервера** поле. Для экземпляра по умолчанию [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], номер порта по умолчанию — 1433. Для именованных экземпляров, пытается получить номер порта из SSMA [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] службы браузера.  
  
5.  В **проверки подлинности** раскрывающееся меню, выберите тип проверки подлинности, используемый для соединения. Чтобы использовать текущую учетную запись Windows, выберите **проверки подлинности Windows**. Для использования [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] имени входа, выберите **проверки подлинности SQL Server**, а затем укажите имя пользователя и пароль.  
  
Дополнительные сведения о подключении к [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], см. в разделе [подключение к SQL Server &#40;AccessToSQL&#41;](../../ssma/access/connecting-to-sql-server-accesstosql.md).  
  
**Чтобы экспортировать данные инвентаризации**  
  
1.  В обозревателе метаданных доступа разверните **доступа к метабазе**.  
  
2.  Установите флажок рядом с полем **баз данных**.  
  
    Чтобы исключить отдельные базы данных или объекты базы данных, разверните **баз данных** папку, а затем снимите флажок рядом с базы данных или объект базы данных.  
  
3.  Щелкните правой кнопкой мыши **баз данных** и выберите **Экспорт схемы**.  
  
4.  В **Выбор схемы для экспорта** диалоговом окне выберите целевую схему для экспортированных метаданных и нажмите кнопку **ОК**.  
  
Каждый раз при экспорте метаданных SSMA добавляет данные в перечень. Существующие данные в данные инвентаризации не обновляется или удаляется.  
  
## <a name="querying-the-exported-metadata"></a>Запрос экспортированных метаданных  
После экспорта метаданные базы данных Access, могут запрашивать метаданные. Приведенные ниже инструкции описывают использование окна редактора запросов в [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] для выполнения запросов.  
  
**Для запроса метаданных**  
  
1.  Из **запустить** последовательно выберите пункты **все программы**, пункты **Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 2005** или **Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 2008**или **Microsoft [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 2012**, а затем нажмите кнопку **SQL Server Management Studio**.  
  
2.  В **соединение с сервером** диалоговом окне Проверьте параметры и нажмите кнопку **Connect**.  
  
3.  На панели инструментов среды Management Studio щелкните **новый запрос** открывать редактор запросов.  
  
4.  В окне редактора запросов введите запрос. Некоторые примеры показаны в следующем разделе.  
  
5.  Нажмите клавишу F5, чтобы выполнить запрос.  
  
## <a name="query-examples"></a>Примеры запросов  
Перед выполнением любой из следующих запросов, необходимо запустить использование *имя_базы_данных* запрос, чтобы убедиться в том, выполняются запросы к базе данных, содержащий экспортированные метаданные. Например, при экспорте метаданных в базу данных с именем MyAccessMetadata, необходимо добавить следующее в начале [!INCLUDE[tsql](../../includes/tsql-md.md)] кода:  
  
```  
USE MyAccessMetadata;  
GO  
```  
В следующих примерах используется **dbo** схемы. При экспорте метаданных в другой схеме, убедитесь, что изменения схемы при выполнении этих запросов.  
  
### <a name="what-tables-and-columns-are-in-these-databases"></a>Какие таблицы и столбцы находятся в этих базах данных?  
Следующий запрос соединяет таблицы, которые содержат столбец, таблицу и метаданных базы данных, а затем возвращает имена всех баз данных, таблицы и столбцы, отсортированные по имени столбца:  
  
```  
SELECT DatabaseName, TableName, ColumnName   
FROM dbo.SSMA_Access_InventoryColumns C  
JOIN dbo.SSMA_Access_InventoryTables T  
ON C.TableId = T.TableId  
JOIN dbo.SSMA_Access_InventoryDatabases D  
ON T.DatabaseId = D.DatabaseId  
ORDER BY ColumnName;  
```  
  
### <a name="what-are-the-largest-databases"></a>Что такое крупных баз данных  
Следующий запрос возвращает имя базы данных, размер файла и число таблиц в каждой базе данных Access, отсортированными по размеру файла:  
  
```  
SELECT DatabaseName, FileSize, TablesCount  
FROM dbo.SSMA_Access_InventoryDatabases  
ORDER BY FileSize DESC;  
```  
  
### <a name="who-is-the-owner-of-most-of-the-databases"></a>Кто является владельцем большинство баз данных?  
Следующий запрос возвращает имя базы данных и владельца каждой базы данных Access, отсортированных по владельцу.  
  
```  
SELECT DatabaseName, FileOwner  
FROM dbo.SSMA_Access_InventoryDatabases  
ORDER BY FileOwner;  
```  
  
### <a name="which-databases-contain-the-same-tables"></a>Какие базы данных содержит те же таблицы?  
Следующий запрос использует вложенный запрос, чтобы найти все имена таблиц, которые отображаются в списке таблиц более одного раза, а затем использует этот список таблиц, чтобы получить имя базы данных. Результаты возвращаются в виде имени базы данных, а затем имя таблицы и сортируются по имени таблицы.  
  
```  
SELECT DatabaseName, TableName   
FROM dbo.SSMA_Access_InventoryTables T  
JOIN dbo.SSMA_Access_InventoryDatabases D  
ON D.DatabaseId = T.DatabaseId  
WHERE TableName IN (  
SELECT TableName   
FROM dbo.SSMA_Access_InventoryTables  
GROUP BY TableName   
HAVING count(*)>1  
)  
ORDER BY TableName;  
```  
  
### <a name="which-databases-were-not-modified-in-the-last-six-months"></a>Какие базы данных не были изменены за последние шесть месяцев?  
Следующий запрос возвращает текущую дату, возвращает значение месяца для шесть месяцев назад и возвращает список баз данных с измененной даты должен превышать шесть месяцев назад.  
  
```  
SELECT DatabaseName, DateModified  
FROM dbo.SSMA_Access_InventoryDatabases  
WHERE DATEDIFF(month, DateModified, GETDATE()) > 6  
ORDER BY DateModified;  
```  
  
### <a name="which-databases-contain-private-information"></a>Какие базы данных содержат конфиденциальные сведения?  
Базы данных Access может содержать конфиденциальные или личные сведения. Может потребоваться переместить эти базы данных, чтобы [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] преимущества ее функциях. Если вы знаете, что столбцы, содержащие конфиденциальные данные с указанным именем, или содержать определенные символы, можно использовать запрос для поиска всех столбцов, содержащих эти сведения. Например можно найти все столбцы, содержащие строку «Зарплата».  Запрос возвращает имя базы данных, имя таблицы и имя столбца.  
  
```  
SELECT DatabaseName, TableName, ColumnName   
FROM dbo.SSMA_Access_InventoryColumns C  
JOIN dbo.SSMA_Access_InventoryTables T  
ON C.TableId = T.TableId  
JOIN dbo.SSMA_Access_InventoryDatabases D  
ON T.DatabaseId = D. DatabaseId  
WHERE ColumnName LIKE '%salary%';  
```  
Если вы не знаете имя столбца, можно написать запрос, возвращающий все столбцы. Чтобы сделать это, удалите предложение WHERE из предыдущего запроса.  
  
## <a name="see-also"></a>См. также  
[Подготовка к миграции базы данных Access](preparing-access-databases-for-migration-accesstosql.md)  
  
