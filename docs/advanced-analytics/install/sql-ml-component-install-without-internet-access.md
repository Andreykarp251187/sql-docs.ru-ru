---
title: Установка языка R и компонентов Python без доступа к Интернету
description: Автономная или отключенная Машинное обучение установки R и Python на изолированном экземпляре SQL Server за сетевым брандмауэром.
ms.prod: sql
ms.technology: machine-learning
ms.date: 07/30/2019
ms.topic: conceptual
author: dphansen
ms.author: davidph
monikerRange: '>=sql-server-2016||>=sql-server-linux-ver15||=sqlallproducts-allversions'
ms.openlocfilehash: ddeea99addae3229575ca581f344332587e85981
ms.sourcegitcommit: 321497065ecd7ecde9bff378464db8da426e9e14
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/01/2019
ms.locfileid: "68715824"
---
# <a name="install-sql-server-machine-learning-r-and-python-on-computers-with-no-internet-access"></a>Установка SQL Server машинного обучения R и Python на компьютерах без доступа к Интернету
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md-winonly](../../includes/appliesto-ss-xxxx-xxxx-xxx-md-winonly.md)]

По умолчанию установщики подключаются к сайтам загрузки Майкрософт, чтобы получить необходимые и обновленные компоненты для машинного обучения на SQL Server. Если ограничения брандмауэра не позволяют установщику достичь этих сайтов, можно использовать устройство, подключенное к Интернету, для загрузки файлов, пересылки файлов на автономный сервер, а затем запустить программу установки.

Аналитика в базе данных состоит из экземпляра ядра СУБД, а также дополнительных компонентов для интеграции R и Python в зависимости от версии SQL Server. 

+ SQL Server 2017 и более поздних версий включает R и Python 
+ SQL Server 2016 — только R.

На изолированном сервере функции машинного обучения и языка R/Python добавляются через CAB-файлы. 

::: moniker range=">=sql-server-2017||=sqlallproducts-allversions"
## <a name="sql-server-2017-offline-install"></a>Автономная установка SQL Server 2017

Чтобы установить SQL Server Службы машинного обучения (R и Python) на изолированном сервере, сначала Скачайте первоначальный выпуск SQL Server и соответствующие CAB-файлы для поддержки R и Python. Даже если планируется немедленно обновить сервер для использования последнего накопительного обновления, сначала необходимо установить первоначальный выпуск.

> [!Note]
> SQL Server 2017 не содержит пакетов обновления. Это первый выпуск SQL Server для использования начального выпуска в качестве единственной базовой строки с обслуживанием только с помощью накопительных обновлений. 

### <a name="1---download-2017-cabs"></a>1\. Загрузка CAB-файлов 2017

На компьютере с подключением к Интернету Скачайте CAB-файлы, предоставляющие функции R и Python для первоначального выпуска и установочный носитель для SQL Server 2017. 

Выпуск  |Ссылка на скачивание  |
---------|---------------|
Microsoft R Open     |[SRO_3.3.3.24_1033.cab](https://go.microsoft.com/fwlink/?LinkId=851496)|
Microsoft R Server      |[SRS_9.2.0.24_1033.cab](https://go.microsoft.com/fwlink/?LinkId=851507)|
Открытие Microsoft Python     |[SPO_9.2.0.24_1033.cab](https://go.microsoft.com/fwlink/?LinkId=851502) |
Сервер Microsoft Python    |[SPS_9.2.0.24_1033.cab](https://go.microsoft.com/fwlink/?LinkId=851508) |

###  <a name="2---get-sql-server-2017-installation-media"></a>2\. получение установочного носителя SQL Server 2017

1. На компьютере с подключением к Интернету Скачайте [программу установки SQL Server 2017](https://www.microsoft.com/sql-server/sql-server-downloads). 

2. Дважды щелкните Setup (Настройка) и выберите тип установки для **скачивания носителя** . При использовании этого параметра программа установки создает локальный ISO-файл (или. cab), содержащий установочный носитель.

   ![Выбор типа установки для скачивания носителя](media/offline-download-tile.png "Скачать носитель")

::: moniker-end

::: moniker range="=sql-server-2016||=sqlallproducts-allversions"

## <a name="sql-server-2016-offline-install"></a>Автономная установка SQL Server 2016

SQL Server 2016 в базе данных (Analytics) — только для R, с двумя CAB-файлами для пакетов продуктов и корпорацией Майкрософт с открытым кодом R, соответственно. Начните с установки одного из следующих выпусков: RTM, SP 1, SP 2. После установки базовая установка накопительные обновления можно применить в качестве следующего шага.

На компьютере с подключением к Интернету Скачайте CAB-файлы, используемые программой установки для установки аналитики в базе данных на SQL Server 2016. 

### <a name="1---download-2016-cabs"></a>1\. Загрузка CAB-файлов 2016

Выпуск  | Microsoft R Open | Microsoft R Server |
---------|-----------------|---------------------|
**SQL Server 2016 RTM**     | [SRO_3.2.2.803_1033.cab](https://go.microsoft.com/fwlink/?LinkId=761266) |[SRS_8.0.3.0_1033.cab](https://go.microsoft.com/fwlink/?LinkId=735051) |
**SQL Server 2016 с пакетом обновления 1 (SP1)**     | [SRO_3.2.2.15000_1033.cab](https://go.microsoft.com/fwlink/?LinkId=824879) |[SRS_8.0.3.15000_1033.cab](https://go.microsoft.com/fwlink/?LinkId=824881) | 
**SQL Server 2016 SP 2**  |[SRO_3.2.2.16000_1033.cab](https://go.microsoft.com/fwlink/?LinkId=866039) |[SRS_8.0.3.17000_1033.cab](https://go.microsoft.com/fwlink/?LinkId=850317) |

### <a name="2---get-sql-server-2016-installation-media"></a>2\. получение установочного носителя SQL Server 2016

Вы можете установить SQL Server 2016 RTM, SP 1 или SP 2 в качестве первой установки на конечном компьютере. Любая из этих версий может принимать накопительное обновление.

Один из способов получить ISO-файл с установочным носителем — с помощью [Visual Studio dev Essentials](https://visualstudio.microsoft.com/dev-essentials/). Войдите, а затем воспользуйтесь ссылкой для **загрузки** , чтобы найти выпуск SQL Server 2016, который вы хотите установить. Загрузка выполняется в формате ISO-файла, который можно скопировать на целевой компьютер для автономной установки.

::: moniker-end

## <a name="transfer-files"></a>Перенос файлов

Скопируйте SQL Server установочный носитель (ISO или CAB) и CAB-файлы аналитики в базе данных на целевой компьютер. Поместите CAB-файлы и файл установочного носителя в одну и ту же папку на целевом компьютере, например в папку% TEMP * пользователя программы установки.

Для CAB-файлов Python требуется папка% TEMP%. Для R можно использовать% TEMP% или задать для параметра миркачедиректори путь к CAB-файлу.

::: moniker range=">=sql-server-2017||=sqlallproducts-allversions"
На следующем снимке экрана показаны SQL Server файлы CAB и ISO. 

![Список переносимых файлов](media/offline-file-list.png "Список файлов")
::: moniker-end

## <a name="run-setup"></a>Запуск программы установки

При запуске SQL Server установки на компьютере, отключенном от Интернета, программа установки добавляет в мастер страницу **автономной установки** , позволяющую указать расположение CAB-файлов, скопированных на предыдущем шаге.

1. Чтобы начать установку, дважды щелкните файл ISO или CAB, чтобы получить доступ к установочному носителю. Вы должны увидеть файл **Setup. exe** .

2. Щелкните правой кнопкой мыши файл **Setup. exe** и запустите от имени администратора.

3. Когда мастер установки отобразит страницу лицензирования для компонентов R или Python с открытым исходным кодом, нажмите кнопку **принять**. Принятие условий лицензионного соглашения позволяет перейти к следующему шагу.

4. При получении доступа к странице **Автономная установка** в поле **путь установки**укажите папку, содержащую CAB-файлы, скопированные ранее.

   ![Страница мастера для выбора папки CAB-файлов](media/screenshot-sql-offline-cab-page.png "Папка CAB-файлов")

5. Продолжайте работу, следуя инструкциям на экране, чтобы завершить установку.

<a name="apply-cu"></a>

## <a name="apply-cumulative-updates"></a>Применить накопительные обновления

Мы рекомендуем применить Последнее накопительное обновление к компонентам ядра СУБД и машинного обучения. Накопительные обновления устанавливаются с помощью программы установки. 

::: moniker range=">=sql-server-2017||=sqlallproducts-allversions"
1. Начните с базового экземпляра. Накопительные обновления можно применять только к существующим установкам первоначального выпуска SQL Server.

2. На подключенном к Интернету устройстве перейдите в Список накопительных обновлений для своей версии SQL Server:

  + [Обновления SQL Server 2017](https://sqlserverupdates.com/sql-server-2017-updates/)
::: moniker-end

::: moniker range="=sql-server-2016||=sqlallproducts-allversions"
1. Начните с базового экземпляра. Накопительные обновления можно применять только к существующим установкам первоначального выпуска SQL Server 2016, SQL Server 2016 1 или SQL Server 2016 SP 2.

2. На подключенном к Интернету устройстве перейдите в Список накопительных обновлений для своей версии SQL Server:

  + [Обновления SQL Server 2016](https://sqlserverupdates.com/sql-server-2016-updates/)
::: moniker-end

3. Выберите Последнее накопительное обновление, чтобы скачать исполняемый файл.

4. Получите соответствующие CAB-файлы для R и Python. Ссылки для загрузки см. в разделе [скачивания CAB-файлов для накопительных обновлений SQL Server экземплярах аналитики в базе данных](sql-ml-cab-downloads.md).

5. Перенесите все файлы, исполняемые и CAB-файлы в ту же папку на автономном компьютере.

6. Запустите программу установки. Примите условия лицензионного соглашения и на странице Выбор компонентов проверьте компоненты, для которых применяются накопительные пакеты обновления. Вы должны увидеть все компоненты, установленные для текущего экземпляра, включая функции машинного обучения.

    ![Выбор компонентов из дерева компонентов](media/cumulative-update-feature-selection.png "список компонентов")

5. Продолжайте работу с мастером, принимая условия лицензионного соглашения для дистрибутивов R и Python. Во время установки вам будет предложено выбрать расположение папки с обновленными CAB-файлами.

## <a name="set-environment-variables"></a>Задание переменных среды

Для интеграции функций R необходимо задать переменную среды **MKL_CBWR** , чтобы [обеспечить последовательный вывод данных](https://software.intel.com/articles/introduction-to-the-conditional-numerical-reproducibility-cnr) из вычислений Intel Math Kernel Library (MKL).

1. На панели управления щелкните **система и система безопасности** >  > **Дополнительные** > **переменные среды**системы.

2. Создайте новую пользовательскую или системную переменную. 

  + Задайте для переменной имя`MKL_CBWR`
  + Присвойте переменной значение`AUTO`

Для этого шага требуется перезагрузка сервера. Если вы собираетесь включить выполнение скрипта, можно удерживать его при перезапуске до тех пор, пока не будет выполнена вся настройка.

## <a name="post-install-configuration"></a>Настройка после установки

::: moniker range=">=sql-server-2017||=sqlallproducts-allversions"
После завершения установки перезапустите службу, а затем настройте сервер, чтобы включить выполнение скрипта:

+ [Включить выполнение внешнего скрипта](sql-machine-learning-services-windows-install.md#bkmk_enableFeature)

Для начальной автономной установки SQL Server Службы машинного обучения требуется та же конфигурация, что и в сети.

+ [Проверка установки](sql-machine-learning-services-windows-install.md#verify-installation)
+ [Дополнительная настройка по мере необходимости](sql-machine-learning-services-windows-install.md#additional-configuration)
::: moniker-end

::: moniker range="=sql-server-2016||=sqlallproducts-allversions"
После завершения установки перезапустите службу, а затем настройте сервер, чтобы включить выполнение скрипта:

+ [Включить выполнение внешнего скрипта](sql-r-services-windows-install.md#bkmk_enableFeature)

Для начальной автономной установки SQL Server R Services требуется та же конфигурация, что и в оперативной установке:

+ [Проверка установки](sql-r-services-windows-install.md#verify-installation)
+ [Дополнительная настройка по мере необходимости](sql-r-services-windows-install.md#bkmk_FollowUp)
::: moniker-end

## <a name="next-steps"></a>Следующие шаги

Чтобы проверить состояние установки экземпляра и устранить распространенные проблемы, см. раздел [пользовательские отчеты для SQL Server](../r/monitor-r-services-using-custom-reports-in-management-studio.md).

Сведения о незнакомых сообщениях и записях журнала см. в разделе [вопросы и ответы по обновлению и установке — службы машинного обучения](../r/upgrade-and-installation-faq-sql-server-r-services.md).
