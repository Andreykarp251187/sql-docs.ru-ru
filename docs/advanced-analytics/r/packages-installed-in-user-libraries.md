---
title: Советы по использованию пакетов R, установленных в библиотеках пользователей
ms.prod: sql
ms.technology: machine-learning
ms.date: 06/13/2019
ms.topic: conceptual
author: dphansen
ms.author: davidph
ms.openlocfilehash: a03d78e5d3100105f74e2efe361391a6bcfaf7ac
ms.sourcegitcommit: c1382268152585aa77688162d2286798fd8a06bb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/19/2019
ms.locfileid: "68345276"
---
# <a name="tips-for-using-r-packages-in-sql-server"></a>Советы по использованию пакетов R в SQL Server
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md-winonly](../../includes/appliesto-ss-xxxx-xxxx-xxx-md-winonly.md)]

В этой статье приводятся отдельные разделы для администраторов баз данных, которые не знакомы с R и опытными разработчиками R, которые не знакомы с пакетным доступом в экземпляре SQL Server.

## <a name="new-to-r"></a>Новые для R

Администратор, устанавливающий пакеты R в первый раз, может помочь вам приступить к изучению нескольких основ управления пакетами R.

### <a name="package-dependencies"></a>Зависимости пакетов

Пакеты R часто зависят от нескольких других пакетов, некоторые из которых могут быть недоступны в библиотеке R по умолчанию, используемой экземпляром. Иногда для пакета требуется другая версия зависимого пакета, который уже установлен. Зависимости пакета указаны в файле описания, внедренном в пакет, но иногда являются неполными. Для полной формулировки графа зависимостей можно использовать пакет с именем [ИГРАФ](https://igraph.org/r/) .

Если необходимо установить несколько пакетов или вы хотите, чтобы все пользователи в организации получали правильный тип и версию пакета, мы рекомендуем использовать пакет [miniCRAN](https://mran.microsoft.com/package/miniCRAN) для анализа всей цепочки зависимостей. minicRAN создает локальный репозиторий, который может совместно использоваться несколькими пользователями или компьютерами. Дополнительные сведения см. [в статье Создание локального репозитория пакетов с помощью miniCRAN](create-a-local-package-repository-using-minicran.md).

### <a name="package-sources-versions-and-formats"></a>Источники, версии и форматы пакетов

Существует несколько источников для пакетов R, таких как [Cran](https://cran.r-project.org/) и биоусловное [тестирование](https://www.bioconductor.org/). На официальном веб-сайте для языка<https://www.r-project.org/>R () перечислены многие из этих ресурсов. Корпорация Майкрософт предлагает [mran:](https://mran.microsoft.com/) для распространения R ([MRO](https://mran.microsoft.com/open)) с открытым кодом и других пакетов. Многие пакеты публикуются на GitHub, где разработчики могут получить исходный код.

Пакеты R работают на нескольких вычислительных платформах. Убедитесь, что устанавливаемые версии являются двоичными файлами Windows.

### <a name="know-which-library-you-are-installing-to-and-which-packages-are-already-installed"></a>Определите, в какую библиотеку вы устанавливаете и какие пакеты уже установлены.

Если вы ранее изменили среду r на компьютере, перед установкой какого-либо элемента убедитесь, что в переменной `.libPath` среды r используется только один путь.

Этот путь должен указывать на папку R_SERVICES для экземпляра. Дополнительные сведения, в том числе определение уже установленных пакетов, см. в разделе [по умолчанию пакеты R и Python в SQL Server](../package-management/default-packages.md).

## <a name="new-to-sql-server"></a>Новые для SQL Server

Когда разработчик R работает над кодом, который выполняется на SQL Server, политики безопасности, защищающие сервер, ограничивают возможности управления средой R.

### <a name="r-user-libraries-not-supported-on-sql-server"></a>Пользовательские библиотеки R: не поддерживается в SQL Server

Разработчики r, которым требуется установить новые пакеты R, привыкли устанавливать пакеты в, будут использовать закрытую библиотеку пользователей, когда библиотека по умолчанию недоступна, или если разработчик не является администратором компьютера. Например, в типичной среде разработки R пользователь добавляет расположение пакета в переменную `libPath`среды r или ссылается на полный путь к пакету, как показано ниже:

```R
library("c:/Users/<username>/R/win-library/packagename")
```

Это не работает при выполнении решений R в SQL Server, так как пакеты R должны быть установлены на определенную библиотеку по умолчанию, связанную с экземпляром. Если пакет недоступен в библиотеке по умолчанию, при попытке вызова пакета возникает эта ошибка:

*Ошибка в библиотеке (XXX): пакет с именем "Package-Name" отсутствует*

### <a name="avoid-package-not-found-errors"></a>Избегайте ошибок "пакет не найден"

+ Исключите зависимости от пользовательских библиотек. 

    Неплохой способ разработки — установить необходимые пакеты R в пользовательскую библиотеку, так как она может привести к ошибкам, если решение запускается другим пользователем, у которого нет доступа к расположению библиотеки.

    Кроме того, если пакет установлен в библиотеке по умолчанию, среда выполнения R загружает пакет из библиотеки по умолчанию, даже если указать другую версию в коде R.

+ Измените код, чтобы он выполнялся в общей среде.

+ Избегайте установки пакетов как части решения. Если у вас нет разрешений на установку пакетов, код завершится ошибкой. Даже если у вас есть разрешения на установку пакетов, это следует делать отдельно от другого кода, который необходимо выполнить.

+ проверьте код, чтобы убедиться в отсутствии вызовов к удаленным пакетам;

+ Обновите код, чтобы удалить прямые ссылки на пути пакетов R или библиотек R. 

+ Определите, какая библиотека пакетов связана с экземпляром. Дополнительные сведения см. [в разделе пакеты R и Python по умолчанию в SQL Server](../package-management/default-packages.md).

## <a name="see-also"></a>См. также

+ [Установка новых пакетов R](install-additional-r-packages-on-sql-server.md)
+ [Установка новых пакетов Python](../python/install-additional-python-packages-on-sql-server.md)
+ [Руководства, примеры, решения](../tutorials/machine-learning-services-tutorials.md)