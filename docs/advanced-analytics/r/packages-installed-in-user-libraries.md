---
title: Советы по использованию пакетов R
description: Ознакомьтесь с полезными советами по использованию пакетов R в SQL Server для тех, кто не знаком с R или SQL Server.
ms.prod: sql
ms.technology: machine-learning
ms.date: 08/06/2019
ms.topic: conceptual
author: garyericson
ms.author: garye
ms.reviewer: davidph
monikerRange: '>=sql-server-2016||>=sql-server-linux-ver15||=sqlallproducts-allversions'
ms.openlocfilehash: 5e283ab478a6d65243e9962fd5c26f5f91d87c15
ms.sourcegitcommit: 632ff55084339f054d5934a81c63c77a93ede4ce
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2019
ms.locfileid: "69633625"
---
# <a name="tips-for-using-r-packages"></a>Советы по использованию пакетов R

[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)]

В этой статье приводятся полезные советы по использованию пакетов R в SQL Server. Эти советы предназначены для администраторов баз данных, которые не знакомы с R, и опытные разработчики R, не знакомые с пакетным доступом в экземпляре SQL Server.

## <a name="if-youre-new-to-r"></a>Если вы не знакомы с R

Администратор, устанавливающий пакеты R в первый раз, может помочь вам приступить к изучению нескольких основ управления пакетами R.

### <a name="package-dependencies"></a>Зависимости пакетов

Пакеты R часто зависят от нескольких других пакетов, некоторые из которых могут быть недоступны в библиотеке R по умолчанию, используемой экземпляром. Иногда пакету требуется другая версия зависимого пакета, чем уже установленная. Зависимости пакета указаны в файле описания, внедренном в пакет, но иногда являются неполными. Для полной формулировки графа зависимостей можно использовать пакет с именем [ИГРАФ](https://igraph.org/r/) .

Если необходимо установить несколько пакетов или вы хотите, чтобы все пользователи в организации получали правильный тип и версию пакета, мы рекомендуем использовать пакет [miniCRAN](https://mran.microsoft.com/package/miniCRAN) для анализа всей цепочки зависимостей. minicRAN создает локальный репозиторий, который может совместно использоваться несколькими пользователями или компьютерами. Дополнительные сведения см. [в статье Создание локального репозитория пакетов с помощью miniCRAN](create-a-local-package-repository-using-minicran.md).

### <a name="package-sources-versions-and-formats"></a>Источники, версии и форматы пакетов

Существует несколько источников для пакетов R, таких как [Cran](https://cran.r-project.org/) и биоусловное [тестирование](https://www.bioconductor.org/). На официальном веб-сайте для языка<https://www.r-project.org/>R () перечислены многие из этих ресурсов. Корпорация Майкрософт предлагает [mran:](https://mran.microsoft.com/) для распространения R ([MRO](https://mran.microsoft.com/open)) с открытым кодом и других пакетов. Многие пакеты публикуются на GitHub, где разработчики могут получить исходный код.

::: moniker range=">=sql-server-2016||=sqlallproducts-allversions"
Пакеты R работают на нескольких вычислительных платформах. Убедитесь, что устанавливаемые версии являются двоичными файлами Windows.
::: moniker-end

::: moniker range=">=sql-server-linux-ver15||=sqlallproducts-allversions"
Пакеты R работают на нескольких вычислительных платформах. Убедитесь, что устанавливаемые версии являются двоичными файлами Linux.
::: moniker-end

### <a name="know-which-library-youre-installing-to-and-which-packages-are-already-installed"></a>Узнайте, в какую библиотеку вы устанавливаете и какие пакеты уже установлены

Если вы ранее изменили среду r на компьютере, прежде чем устанавливать что-либо, убедитесь, что переменная `.libPath` среды r использует только один путь.

Этот путь должен указывать на папку R_SERVICES для экземпляра. Дополнительные сведения, в том числе определение уже установленных пакетов, см. в разделе [Получение сведений о пакете R](../package-management/r-package-information.md).

## <a name="if-youre-new-to-sql-server"></a>Если вы не знакомы с SQL Server

Когда разработчик R работает над кодом, который выполняется на SQL Server, политики безопасности, защищающие сервер, ограничивают возможности управления средой R. Следующие советы описывают типичные ситуации и предоставляют рекомендации по работе в этой среде.

### <a name="r-user-libraries-not-supported-on-sql-server"></a>Пользовательские библиотеки R: не поддерживается в SQL Server

Разработчики r, которым требуется установить новые пакеты R, привыкли устанавливать пакеты в, будут использовать закрытую библиотеку пользователей, когда библиотека по умолчанию недоступна, или если разработчик не является администратором компьютера. Например, в типичной среде разработки R пользователь добавляет расположение пакета в переменную `libPath`среды r или ссылается на полный путь к пакету, как показано ниже:

```R
library("c:/Users/<username>/R/win-library/packagename")
```

Это не работает при выполнении решений R в SQL Server, так как пакеты R должны быть установлены на определенную библиотеку по умолчанию, связанную с экземпляром. Если пакет недоступен в библиотеке по умолчанию, при попытке вызова пакета возникает эта ошибка:

*Ошибка в библиотеке (XXX): пакет с именем "Package-Name" отсутствует*

Сведения об установке пакетов R в SQL Server см. в разделе [Установка новых пакетов r на SQL Server службы машинного обучения или SQL Server R Services](install-additional-r-packages-on-sql-server.md).

### <a name="how-to-avoid-package-not-found-errors"></a>Как избежать ошибок «пакет не найден»

Использование следующих рекомендаций поможет избежать ошибок "пакет не найден".

+ Исключите зависимости от пользовательских библиотек.

    Неплохая практика разработки — установить необходимые пакеты R в настраиваемую библиотеку пользователей. Это может привести к ошибкам, если решение запускается другим пользователем, у которого нет доступа к расположению библиотеки.

    Кроме того, если пакет установлен в библиотеке по умолчанию, среда выполнения R загружает пакет из библиотеки по умолчанию, даже если указать другую версию в коде R.

+ Убедитесь, что код может выполняться в общей среде.

+ Избегайте установки пакетов как части решения. Если у вас нет разрешений на установку пакетов, код завершится ошибкой. Даже если у вас есть разрешения на установку пакетов, это следует делать отдельно от другого кода, который необходимо выполнить.

+ проверьте код, чтобы убедиться в отсутствии вызовов к удаленным пакетам;

+ Обновите код, чтобы удалить прямые ссылки на пути пакетов R или библиотек R.

+ Определите, какая библиотека пакетов связана с экземпляром. Дополнительные сведения см. в разделе [Получение сведений о пакете R](../package-management/r-package-information.md).

## <a name="see-also"></a>См. также

+ [Установка новых пакетов R](install-additional-r-packages-on-sql-server.md)
+ [Установка новых пакетов Python](../python/install-additional-python-packages-on-sql-server.md)
+ [Руководства, примеры, решения](../tutorials/machine-learning-services-tutorials.md)