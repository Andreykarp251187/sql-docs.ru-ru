---
title: Обзор SQL Server Службы машинного обучения (R, Python)
description: Общие сведения о функции Службы машинного обучения в SQL Server, где можно интегрировать Python и R с реляционными данными для обработки и анализа данных и статистического моделирования, моделей машинного обучения, прогнозной аналитики, визуализации данных и т. д.
ms.prod: sql
ms.technology: machine-learning
ms.date: 06/13/2019
ms.topic: overview
author: dphansen
ms.author: davidph
monikerRange: '>=sql-server-2016||=sqlallproducts-allversions'
ms.openlocfilehash: ead0dd3d9ba69a4bf0079fe8065a2d5aa7a11d3e
ms.sourcegitcommit: 63c6f3758aaacb8b72462c2002282d3582460e0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/25/2019
ms.locfileid: "68495399"
---
# <a name="sql-server-machine-learning-services-r-python"></a>Службы машинного обучения SQL Server (R, Python)
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)]

Службы машинного обучения — это функция SQL Server, используемая для выполнения скриптов R и Python в базе данных. Эта функция включает [пакеты Microsoft R и Python](#components) для высокопроизводительной прогнозной аналитики и машинного обучения. Реляционные данные могут использоваться в скриптах R и Python с помощью хранимых процедур, скрипта T-SQL, содержащего инструкции R и Python, или кода R и Python, содержащего T-SQL.

Если ранее вы использовали [SQL Server 2016 R Services](r/sql-server-r-services.md), Службы машинного обучения в SQL Server 2017 и более поздних версий — это поддержка r следующего поколения, с обновленными версиями базовых r, RevoScaleR, MicrosoftML и другими библиотеками, представленными в 2016.

В базе данных SQL Azure [службы машинного обучения (с R)](https://docs.microsoft.com/azure/sql-database/sql-database-machine-learning-services-overview) сейчас находится в общедоступной предварительной версии.

## <a name="bring-compute-power-to-the-data"></a>Перенесите мощность вычислений в данные

Ключевое предложение Службы машинного обучения — это мощь своих корпоративных пакетов R и Python для предоставления расширенной аналитики в масштабе, а также возможность выполнять вычисления и обработку, где находятся данные, устраняя необходимость извлечения данных по сеть. Это дает несколько преимуществ.

+ Защита данных. Перенос выполнения R и Python ближе к источнику данных позволяет избежать непроизводительна или небезопасного перемещения данных.
+ Скорость. Базы данных оптимизированы для операций на основе наборов. Последние нововведения в базах данных, таких как таблицы в памяти, делают сводки и агрегаты великолепными и являются идеальным дополнением к обработке и анализу данных.
+ Простота развертывания и интеграции. [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]является центральной точкой операций для многих других задач управления данными и приложений. Используя данные, находящиеся в базе данных или хранилище отчетов, вы гарантируете, что данные, используемые решениями машинного обучения, являются актуальными и обновленными. 
+ Эффективность в облаке и в локальной среде. Вместо обработки данных в сеансах R или Python можно полагаться на конвейеры данных предприятия, [!INCLUDE[ssISnoversion](../includes/ssisnoversion-md.md)] включая и фабрику данных Azure. Отчеты о результатах или анализы можно с легкостью получать с помощью Power BI или [!INCLUDE[ssRSnoversion](../includes/ssrsnoversion-md.md)].

Используя правильное сочетание SQL и R для разнообразных задач по обработке и анализу данных, исследователи данных и разработчики систем могут повысить эффективность работы.

<a name="components"></a>

## <a name="components"></a>Компоненты

SQL Server 2017 поддерживает R и Python. В следующей таблице описаны компоненты.

| Компонент | Описание |
|-----------|-------------|
| Служба панель запуска SQL Server | Служба, которая управляет взаимодействием между внешними средами выполнения R и Python и экземпляром ядра СУБД. |
| Пакеты R | [**RevoScaleR**](r/ref-r-revoscaler.md) — это основная библиотека масштабируемых R. функций в этой библиотеке, которые являются наиболее широко используемыми. В этих библиотеках доступны преобразования и манипуляции, Статистическая сводка, Визуализация и многие формы моделирования и анализа. Кроме того, функции в этих библиотеках автоматически распределяют рабочие нагрузки между доступными ядрами для параллельной обработки, с возможностью работать с блоками данных, которые согласовываются и управляются ядром вычислений.  <br/>[**MicrosoftML (R)** ](r/ref-r-microsoftml.md) добавляет алгоритмы машинного обучения для создания пользовательских моделей для анализа текста, анализа изображений и анализа тональности. <br/>[**sqlRUtils**](r/ref-r-sqlrutils.md) предоставляет вспомогательные функции для размещения скриптов R в хранимой процедуре T-SQL, регистрации хранимой процедуры с базой данных и выполнения хранимой процедуры из среды разработки R.<br/>для создания или выполнения запроса многомерных выражений в скрипте R используется [**OLAP**](r/ref-r-olapr.md) .|
| Microsoft R Open (MRO) | [**MRO**](https://mran.microsoft.com/open) — это дистрибутив R с открытым кодом Майкрософт. Пакет и интерпретатор включены. Всегда используйте версию MRO, установленную программой установки. |
| Инструменты R | Окна консоли r и командные запросы являются стандартными инструментами в распределении R.  |
| Примеры и сценарии R |  Пакеты R и RevoScaleR с открытым исходным кодом включают встроенные наборы данных, позволяющие создавать и запускать сценарии с использованием предварительно установленных данных. |
| Пакеты Python | [**revoscalepy**](python/ref-py-revoscalepy.md) — это основная библиотека для масштабируемого Python с функциями для манипулирования данными, преобразования, визуализации и анализа. <br/>[**microsoftml (Python)** ](python/ref-py-microsoftml.md) добавляет алгоритмы машинного обучения для создания пользовательских моделей для анализа текста, анализа изображений и анализа тональности.  |
| Средства Python | Встроенное средство командной строки Python полезно для нерегламентированного тестирования и задач.  |
| Anaconda | Anaconda — это дистрибутив Python и необходимых пакетов с открытым исходным кодом. |
| Примеры и сценарии Python | Как и в языке R, Python включает встроенные наборы данных и скрипты.  |
| Предварительно обученные модели в R и Python | Предварительно обученные модели создаются для конкретных вариантов использования и обслуживаются командой инженеров по обработке и анализу данных в корпорации Майкрософт. Вы можете использовать предварительно обученные модели "как есть" для оценки положительных отрицательных тональности в тексте или для обнаружения функций в изображениях с помощью предоставленных новых входных данных. Модели выполняются в Службы машинного обучения, но не могут быть установлены с помощью SQL Server установки. Дополнительные сведения см. [в разделе Установка предварительно обученных моделей машинного обучения на SQL Server](install/sql-pretrained-models-install.md). |

## <a name="using-sql-mls"></a>Использование SQL MLS

Разработчики и аналитики часто имеют код, выполняющийся на локальном экземпляре SQL Server. Добавляя Службы машинного обучения и обеспечивая выполнение внешних скриптов, вы получаете возможность выполнять код R и Python в SQL Server модальностей: заключение скрипта в хранимые процедуры, хранение моделей в SQL Server таблице или объединение функций T-SQL и R или Python. в запросах.

Выполнение сценариев в пределах модели безопасности данных: разрешения на реляционную базу данных являются базой данных для доступа к данным в скрипте. Пользователь, выполняющий скрипт R или Python, не должен иметь возможность использовать какие-либо данные, к которым этот пользователь не может получить доступ в запросе SQL. Для выполнения внешнего скрипта необходимы стандартные разрешения на чтение и запись базы данных, а также дополнительное разрешение. Модели и код, создаваемые для реляционных данных, упаковываются в хранимые процедуры или сериализуются в двоичный формат и хранятся в таблице или загружаются с диска при сериализации потока необработанных байтов в файл.

Наиболее распространенным подходом для аналитики в базе данных является использование [sp_execute_external_script](../relational-databases/system-stored-procedures/sp-execute-external-script-transact-sql.md), передача скрипта R или Python в качестве входного параметра.

Классическое взаимодействие между клиентом и сервером — еще один подход. На любой клиентской рабочей станции с интегрированной средой разработки можно установить [Microsoft R Client](https://docs.microsoft.com/machine-learning-server/r-client/what-is-microsoft-r-client) или [библиотеки Python](https://docs.microsoft.com/machine-learning-server/install/python-libraries-interpreter), а затем написать код, который передает выполнение (называемый *удаленным контекстом вычислений*) к данным и операциям для удаленного SQL Server. 

Наконец, если вы используете автономный [сервер](r/r-server-standalone.md) и выпуск Developer, вы можете создавать решения на клиентской рабочей станции с помощью одних и тех же библиотек и интерпретаторов, а затем развертывать рабочий код на SQL Server службы машинного обучения (в базе данных). 

## <a name="how-to-get-started"></a>Как приступить к работе

### <a name="step-1-install-the-software"></a>Шаг 1. Установка программного обеспечения

+ [Службы машинного обучения SQL Server (в базе данных)](install/sql-machine-learning-services-windows-install.md)
 
### <a name="step-2-configure-a-development-tool"></a>Шаг 2. Настройка средства разработки

Специалисты по обработке и анализу данных обычно используют R или Python на своих ноутбуках или на рабочих станциях разработки, для изучения данных, а также для создания и настройки прогнозных моделей до достижения хорошей прогнозной модели. При использовании аналитики в базе данных в SQL Server нет необходимости изменять этот процесс. После завершения установки можно выполнить код R или Python на SQL Server локально и удаленно.

![rsql_keyscenario2](r/media/rsql-keyscenario2.png) 

+ **Используйте предпочтительную среду IDE**. Вы можете связать библиотеки R и Python с выбранным средством разработки. Дополнительные сведения см. в статьях [Настройка средств R](r/set-up-a-data-science-client.md) и [Настройка средств Python](python/setup-python-client-tools-sql.md).  

+ **Работать удаленно или локально**. Специалисты по обработке и анализу данных могут подключаться к SQL Server и переносить данные на клиент для локального анализа, как обычно. Однако лучше использовать API **RevoScaleR** или **revoscalepy** для отправки вычислений на компьютер SQL Server, избегая дорогостоящего и небезопасного перемещения данных.

+ **Внедрите скрипты R или Python в SQL Server хранимые процедуры**. Когда код полностью оптимизирован, заключите его в хранимую процедуру, чтобы избежать ненужного перемещения данных и оптимизации задач по обработке данных.

### <a name="step-3-write-your-first-script"></a>Шаг 3. Напишите первый скрипт

Вызывайте функции R или Python в скрипте T-SQL:

+ [CЕРВЕРНЫЙ Изучение аналитики базы данных с помощью языка R](tutorials/sqldev-in-database-r-for-sql-developers.md)
+ [CЕРВЕРНЫЙ Сквозное пошаговое руководство с R](tutorials/walkthrough-data-science-end-to-end-walkthrough.md)
+ [Языке Запуск Python с помощью T-SQL](tutorials/run-python-using-t-sql.md)
+ [Языке Изучение аналитики базы данных с помощью Python](tutorials/sqldev-in-database-python-for-sql-developers.md)

Выберите оптимальный язык для задачи. R лучше подходит для статистических вычислений, которые трудно реализовать с помощью SQL. Для операций на основе наборов данных используйте возможности SQL Server для достижения максимальной производительности. Используйте ядро СУБД в памяти для очень быстрых вычислений над столбцами.

### <a name="step-4-optimize-your-solution"></a>Шаг 4. Оптимизация решения

Когда модель готова к масштабированию корпоративных данных, анализу данных часто работает с DBA или разработчиком SQL для оптимизации таких процессов, как:

+ Формирование признаков
+ Прием данных и преобразование данных
+ Способ

Традиционно специалисты по обработке и анализу данных столкнулись с проблемами с производительностью и масштабом, особенно при использовании большого набора данных. Это связано с тем, что общая реализация среды выполнения является однопотоковой и может вместить только те наборы данных, которые помещаются в доступную память на локальном компьютере. Интеграция с SQL Server Службы машинного обучения предоставляет несколько функций для повышения производительности с дополнительными данными:

+ **RevoScaleR**: Этот пакет R содержит реализации некоторых наиболее популярных функций R, переработанных для обеспечения параллелизма и масштабирования. Пакет также включает функции, повышающие производительность и масштабирование путем отправки вычислений на SQL Server компьютер, который обычно имеет гораздо больше памяти и вычислительной мощности.

+ **revoscalepy**. Эта библиотека Python реализует самые популярные функции в RevoScaleR, такие как удаленные контексты вычислений, и многие алгоритмы, поддерживающие распределенную обработку.

Дополнительные сведения о производительности см. в этом [практическом примере производительности](r/performance-case-study-r-services.md) , а [R и оптимизация данных](r/r-and-data-optimization-r-services.md).

### <a name="step-5-deploy-and-consume"></a>Шаг 5. Развертывание и использование

После подготовки скрипта или модели к использованию в рабочей среде разработчик базы данных может внедрить код или модель в хранимую процедуру, чтобы сохраненный код R или Python можно было вызывать из приложения. Хранение и выполнение кода R из SQL Server имеет много преимуществ: можно использовать удобный интерфейс SQL Server и все вычисления выполняются в базе данных, избегая ненужного перемещения данных.

![rsql_keyscenario1](r/media/rsql-keyscenario1.png)

+ **Обеспечение безопасности и расширяемость**. SQL Server использует новую архитектуру расширяемости, которая обеспечивает безопасность ядра СУБД и изолирует сеансы R и Python. Кроме того, вы можете управлять пользователями, которые могут выполнять сценарии, и указывать, к каким базам данных можно получить доступ с помощью кода. Можно управлять объемом ресурсов, выделенных для среды выполнения, чтобы предотвратить влияние больших вычислений на общую производительность сервера.

+ **Планирование и аудит**. При запуске заданий внешних скриптов в SQL Server можно контролировать и проверять данные, используемые специалистами по обработке и анализу данных. Вы также можете планировать задания и создавать рабочие процессы, содержащие внешние сценарии R или Python, так же как и любые другие задания T-SQL или хранимые процедуры.

Чтобы воспользоваться преимуществами функций управления ресурсами и безопасности в SQL Server, процесс развертывания может включать следующие задачи:

+ Преобразование кода в функцию, которая может выполняться оптимально в хранимой процедуре
+ Настройка безопасности и блокировка пакетов, используемых определенной задачей
+ Включение управления ресурсами (требуется выпуск Enterprise)

Дополнительные сведения см. в статье [Управление ресурсами для r](r/resource-governance-for-r-services.md) и [r Управление пакетами для SQL Server](r/install-additional-r-packages-on-sql-server.md).

## <a name="version-history"></a>Журнал версий

SQL Server 2017 Службы машинного обучения — это новое поколение служб SQL Server 2016 R, дополненное к включению Python. В следующей таблице приведен полный список всех версий продукта от момента появления до текущего выпуска. 

| Название продукта | Версия подсистемы | Дата выпуска |
|--------------|---------|--------------|
| Службы машинного обучения SQL Server 2017 (в базе данных) | R Server 9.2.1 <br/> Python Server 9.2 | Октябрь 2017 г. |
| Machine Learning Server SQL Server 2017 (автономная) | R Server 9.2.1 <br/> Python Server 9.2 | Октябрь 2017 г. |
| Службы R SQL Server 2016 (в базе данных) | R Server 9,1  | 2017 июля  |
| SQL Server 2016 R Server (изолированный)  |  R Server 9,1 | 2017 июля |

Сведения о версиях пакетов по выпуску см. в карте версий в разделе [Обновление компонентов R и Python](install/upgrade-r-and-python.md#version-map).

## <a name="portability-and-related-products"></a>Переносимость и связанные продукты

Для обеспечения переносимости пользовательского кода R и Python используются средства распространения пакетов и интерпретаторы, встроенные в несколько продуктов. Те же пакеты, которые поставляются в SQL Server, также доступны в нескольких других продуктах и службах Майкрософт, включая версию, отличную от версии SQL [Microsoft Machine Learning Server](https://docs.microsoft.com/machine-learning-server/). 

Бесплатные клиенты, включающие интерпретаторы R и Python, [Microsoft R Client](https://docs.microsoft.com/machine-learning-server/r-client/what-is-microsoft-r-client) и [библиотеки Python](https://docs.microsoft.com/machine-learning-server/install/python-libraries-interpreter).

В Azure пакеты и интерпретаторы Microsoft R и Python также доступны на Машинное обучение Azure и в таких службах Azure, как [HDInsight](https://docs.microsoft.com/azure/hdinsight/r-server/r-server-overview), и [виртуальных машинах Azure](https://docs.microsoft.com/machine-learning-server/install/machine-learning-server-azure-vm-on-linux). Виртуальная машина для обработки и [анализа данных](https://azure.microsoft.com/services/virtual-machines/data-science-virtual-machines/) включает в себя полнофункциональную рабочую станцию разработки с инструментами от многих поставщиков, а также библиотек и интерпретаторов от корпорации Майкрософт.

## <a name="see-also"></a>См. также

[Установка SQL Server Службы машинного обучения](install/sql-machine-learning-services-windows-install.md)
