---
title: Установить новые языковые пакеты Python
description: Добавьте новые пакеты Python в SQL Server 2017 Службы машинного обучения (в базе данных) и Machine Learning Server (автономный).
ms.prod: sql
ms.technology: machine-learning
ms.date: 06/16/2019
ms.topic: conceptual
author: dphansen
ms.author: davidph
ms.openlocfilehash: fc8c7148369ec1a501106e573e195a8f0b7f060a
ms.sourcegitcommit: 9062c5e97c4e4af0bbe5be6637cc3872cd1b2320
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/24/2019
ms.locfileid: "68470257"
---
# <a name="install-new-python-packages-on-sql-server"></a>Установить новые пакеты Python на SQL Server
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)]

В этой статье описывается, как установить новые пакеты Python на экземпляре SQL Server 2017 Службы машинного обучения. Как правило, процесс установки новых пакетов аналогичен процессу в стандартной среде Python. Однако некоторые дополнительные действия необходимы, если сервер не подключен к Интернету.

Дополнительные сведения о расположении пакетов и путях установки см. в разделе [Получение сведений о пакете R или Python](../package-management/installed-package-information.md).

## <a name="prerequisites"></a>Предварительные требования

+ [SQL Server 2017 службы машинного обучения (в базе данных)](../install/sql-machine-learning-services-windows-install.md) с параметром языка Python. 

+ Пакеты должны быть совместимыми с Python 3,5 и запускаться в Windows. 

+ Для установки пакетов требуется административный доступ к серверу.

## <a name="considerations"></a>Замечания

Прежде чем добавлять пакеты, определите, подходит ли этот пакет для среды SQL Server. Обычно сервер базы данных является общим ресурсом, который поддает несколько рабочих нагрузок. При добавлении пакетов, которые помещают на сервере слишком много вычислительных операций, производительность снизится. 

Кроме того, некоторые популярные пакеты Python (например, Flask) выполняют задачи, такие как веб-разработка, которые лучше подходят для автономной среды. Мы рекомендуем использовать в базе данных Python для задач, которые используют преимущества тесной интеграции с ядром СУБД, например машинное обучение, а не задачи, которые просто запрашивают базу данных.

Серверы баз данных часто заблокированы. Во многих случаях доступ к Интернету полностью блокируется. Для пакетов с длинным списком зависимостей необходимо заранее определять эти зависимости и устанавливать каждый из них вручную.

## <a name="add-a-new-python-package"></a>Добавление нового пакета Python

В этом примере предполагается, что вы хотите установить новый пакет непосредственно на SQL Server компьютере.

Установка пакета производится для каждого экземпляра. При наличии нескольких экземпляров Службы машинного обучения необходимо добавить пакет в каждый из них.

Пакет, установленный в этом примере, — это [CNTK](https://docs.microsoft.com/cognitive-toolkit/), платформа для глубокого обучения от Майкрософт, которая поддерживает настройку, обучение и совместное использование различных типов нейронных сетей.

### <a name="step-1-download-the-windows-version-of-the-python-package"></a>Шаг 1. Загрузка версии пакета Python для Windows

+ При установке пакетов Python на сервере без доступа к Интернету необходимо загрузить файл WHL на другой компьютер, а затем скопировать его на сервер.

    Например, на отдельном компьютере можно загрузить файл WHL с этого сайта [https://cntk.ai/PythonWheel/CPU-Only](https://cntk.ai/PythonWheel/CPU-Only/cntk-2.1-cp35-cp35m-win_amd64.whl), а затем скопировать `cntk-2.1-cp35-cp35m-win_amd64.whl` его в локальную папку на SQL Server компьютере.

+ SQL Server 2017 использует Python 3,5. 

> [!IMPORTANT]
> Убедитесь, что вы получаете версию пакета для Windows. Если файл заканчивается на. gz, то, вероятно, это не правильная версия.

На этой странице содержатся загружаемые файлы для нескольких платформ и для нескольких версий Python: [Настройка CNTK](https://docs.microsoft.com/cognitive-toolkit/Setup-CNTK-on-your-machine)

### <a name="step-2-open-a-python-command-prompt"></a>Шаг 2. Открытие командной строки Python

Расположение библиотеки Python по умолчанию, используемой SQL Server. Если вы установили несколько экземпляров, выберите папку PYTHON_SERVICE для экземпляра, в который нужно добавить пакет.

Например, если Службы машинного обучения установлен с использованием значений по умолчанию, а машинное обучение включено в экземпляре по умолчанию, то путь будет выглядеть следующим образом:

    `C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\PYTHON_SERVICES`

Откройте командную строку Python, связанную с экземпляром.

> [!TIP]
> Для последующей отладки и тестирования может потребоваться настроить среду Python, относящуюся к библиотеке экземпляров.

### <a name="step-3-install-the-package-using-pip"></a>Шаг 3. Установка пакета с помощью PIP

+ Если вы привыкли использовать командную строку Python, используйте PIP. exe для установки новых пакетов. Установщик **PIP** можно найти во `Scripts` вложенной папке. 

  SQL Server программа установки не добавляет скрипты в системный путь. Если возникает ошибка, `pip` не известная как внутренняя или внешняя команда, можно добавить папку Scripts в переменную Path в Windows.

  Полный путь к папке **Scripts** в установке по умолчанию выглядит следующим образом:

    C:\Program Files\Microsoft SQL Server\MSSQL14. MSSQLSERVER\PYTHON_SERVICES\Scripts

+ Если вы используете Visual Studio 2017 или Visual Studio 2015 с расширениями Python, можно запустить `pip install` из окна окружения **Python** . Щелкните **пакеты**, а затем в текстовом поле укажите имя или расположение пакета для установки. Вводить `pip install`его не нужно; он заполняется автоматически. 

    - Если компьютер имеет доступ к Интернету, укажите имя пакета или URL-адрес определенного пакета и версии. 
    
    Например, чтобы установить версию CNTK, которая поддерживается для Windows и Python 3,5, укажите URL-адрес для скачивания:`https://cntk.ai/PythonWheel/CPU-Only/cntk-2.1-cp35-cp35m-win_amd64.whl`

    - Если компьютер не подключен к Интернету, необходимо загрузить файл WHL перед началом установки. Затем укажите путь к локальному файлу и его имя. Например, вставьте следующий путь и файл, чтобы установить файл WHL, скачанный с сайта:`"C:\Downloads\CNTK\cntk-2.1-cp35-cp35m-win_amd64.whl"`

Возможно, вам будет предложено повысить уровень разрешений для завершения установки.

По мере выполнения установки в окне командной строки можно просмотреть сообщения о состоянии:

```python
pip install https://cntk.ai/PythonWheel/CPU-Only/cntk-2.1-cp35-cp35m-win_amd64.whl
Collecting cntk==2.1 from https://cntk.ai/PythonWheel/CPU-Only/cntk-2.1-cp35-cp35m-win_amd64.whl
  Downloading https://cntk.ai/PythonWheel/CPU-Only/cntk-2.1-cp35-cp35m-win_amd64.whl (34.1MB)
    100% |################################| 34.1MB 13kB/s
...
Installing collected packages: cntk
Successfully installed cntk-2.1
```


### <a name="step-4-load-the-package-or-its-functions-as-part-of-your-script"></a>Шаг 4. Загрузка пакета или его функций в составе скрипта

После завершения установки можно сразу приступить к использованию пакета, как описано в следующем шаге.

Примеры глубокого обучения с использованием CNTK см. в следующих руководствах: [API Python для CNTK](https://cntk.ai/pythondocs/tutorials.html)

Чтобы использовать функции из пакета в скрипте, вставьте стандартный `import <package_name>` оператор в первоначальные строки скрипта:

```python
import numpy as np
import cntk as cntk
cntk._version_
```

## <a name="list-installed-packages-using-conda"></a>Список установленных пакетов с помощью conda

Список установленных пакетов можно получить разными способами. Например, установленные пакеты можно просмотреть в окнах окружения **Python** Visual Studio.

При использовании командной строки Python можно использовать либо **PIP** , либо диспетчер пакетов **conda** , включенный в среду Anaconda Python, добавленную программой установки SQL Server.

1. Перейдите в папку C:\Program Files\Microsoft SQL Server\MSSQL14. MSSQLSERVER\PYTHON_SERVICES\Scripts

1. Щелкните правой кнопкой мыши **conda. exe** > **Запуск от имени администратора**и `conda list` введите, чтобы получить список пакетов, установленных в текущей среде.

1. Аналогичным образом щелкните правой кнопкой мыши **PIP. exe** > с**правами администратора**и `pip list` введите, чтобы получить ту же информацию. 

Дополнительные сведения о **conda** и их использовании для создания нескольких сред Python и управления ими см. в разделе [Управление средами с помощью conda](https://conda.io/docs/user-guide/tasks/manage-environments.html).

> [!Note]
> SQL Server программа установки не добавляет PIP или Conda к системному пути и рабочему SQL Server экземпляру, поэтому рекомендуется хранить ненужные исполняемые файлы из пути. Однако для сред разработки и тестирования можно добавить папку Scripts в переменную среды системного пути, чтобы выполнять команды PIP и Conda в любом расположении.
