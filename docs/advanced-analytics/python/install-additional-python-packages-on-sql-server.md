---
title: Установка новых пакетов языка Python - машинного обучения SQL Server
description: Добавление новых пакетов Python для служб SQL Server 2017 машинного обучения (в базе данных) и сервер машинного обучения (автономный).
ms.prod: sql
ms.technology: machine-learning
ms.date: 06/16/2019
ms.topic: conceptual
author: dphansen
ms.author: davidph
ms.openlocfilehash: f30c00503a0dd183619550d3ab0e92c0be1449dd
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "67962773"
---
# <a name="install-new-python-packages-on-sql-server"></a>Установка новых пакетов Python в SQL Server
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md-winonly](../../includes/appliesto-ss-xxxx-xxxx-xxx-md-winonly.md)]

В этой статье описывается установка новых пакетов Python в экземпляре служб SQL Server 2017 машинного обучения. Как правило процесс установки новых пакетов аналогична в стандартную среду Python. Тем не менее некоторые дополнительные действия требуются, если сервер имеет подключение к Интернету.

Дополнительные сведения о пути расположения и установки пакета, см. в разделе [получить R или Python данные пакетов](../package-management/installed-package-information.md).

## <a name="prerequisites"></a>Предварительные требования

+ [Служб SQL Server 2017 машинного обучения (в базе данных)](../install/sql-machine-learning-services-windows-install.md) с параметром языка Python. 

+ Пакеты должны быть Python 3.5-совместимым и выполнения в Windows. 

+ Чтобы установить пакеты требуется административный доступ к серверу.

## <a name="considerations"></a>Замечания

Прежде чем добавлять пакеты, рассмотрите возможность, является ли пакет хорошо подходит для среды SQL Server. Обычно сервер базы данных — это общий ресурс, размещении нескольких рабочих нагрузок. При добавлении пакетов, вызывать слишком много вычислительную нагрузку на сервер, то производительность снижается. 

Кроме того некоторые популярные пакеты Python (например, Flask) выполнять задачи, такие как веб-разработки, которые лучше подходят для изолированной среды. Мы рекомендуем использовать Python в базе данных для задачи, которые получают преимущества от тесной интеграции с ядром СУБД, такие как машинное обучение, вместо задачи, которые просто запросить базу данных.

Серверы баз данных часто заблокированы. Во многих случаях полностью блокируется доступ к Интернету. Для пакетов с длинный список зависимостей необходимо заранее определить эти зависимости и быть готовым для установки каждого из них вручную.

## <a name="add-a-new-python-package"></a>Добавить новый пакет Python

В этом примере мы предполагаем, что вы хотите установить новый пакет непосредственно на компьютере SQL Server.

Установка пакета находится на один экземпляр. Если у вас есть несколько экземпляров служб машинного обучения, необходимо добавить пакет для каждого из них.

Пакет, установленный в этом примере является [CNTK](https://docs.microsoft.com/cognitive-toolkit/), это платформа для глубокого обучения от Майкрософт, которая поддерживает настройку, обучение и совместное использование различных типов нейронных сетей.

### <a name="step-1-download-the-windows-version-of-the-python-package"></a>Шаг 1. Скачать Windows пакета Python

+ При установке пакетов Python на сервере без доступа к Интернету, необходимо загрузить его WHL на другом компьютере и скопируйте его на сервер.

    Например, на отдельном компьютере, можно загрузить файл WHL с этого сайта [ https://cntk.ai/PythonWheel/CPU-Only ](https://cntk.ai/PythonWheel/CPU-Only/cntk-2.1-cp35-cp35m-win_amd64.whl)и затем скопируйте файл `cntk-2.1-cp35-cp35m-win_amd64.whl` в локальную папку на компьютере SQL Server.

+ SQL Server 2017 использует Python 3.5. 

> [!IMPORTANT]
> Убедитесь, что вы получаете Windows версию пакета. Если файл заканчивается .gz, скорее всего, не имеет правильную версию.

Эта страница содержит файлы для загрузки для нескольких платформ, а также для нескольких версий Python: [Настройка CNTK](https://docs.microsoft.com/cognitive-toolkit/Setup-CNTK-on-your-machine)

### <a name="step-2-open-a-python-command-prompt"></a>Шаг 2. Откройте командную строку Python

Найдите расположение библиотеки Python по умолчанию, используемый сервером SQL Server. Если вы установили несколько экземпляров, перейдите к папке PYTHON_SERVICE для экземпляра, где вы хотите добавить пакет.

Например если установлен службы машинного обучения, используя значения по умолчанию и обучении включен на экземпляре по умолчанию, путь будет следующим:

    `C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\PYTHON_SERVICES`

Откройте командную строку Python, связанный с экземпляром.

> [!TIP]
> Для будущих отладки и тестирования, может потребоваться настроить среду Python, относящиеся к библиотеке экземпляра.

### <a name="step-3-install-the-package-using-pip"></a>Шаг 3. Установите пакет с помощью pip

+ Если вы привыкли, с помощью командной строки Python, используйте PIP.exe, чтобы установить новые пакеты. Можно найти **pip** установщика в `Scripts` во вложенную папку. 

  Программа установки SQL Server не добавляет скриптов в системный путь. Если отобразится сообщение об ошибке, `pip` не является внутренней или внешней командой, можно добавить в папку Scripts в переменную PATH в Windows.

  Полный путь к **сценариев** в установке по умолчанию выглядит следующим образом:

    C:\Program Files\Microsoft SQL Server\MSSQL14. MSSQLSERVER\PYTHON_SERVICES\Scripts

+ Если вы используете Visual Studio 2017 или Visual Studio 2015 с помощью расширений Python, можно запустить `pip install` из **окружения Python** окна. Нажмите кнопку **пакетов**и в текстовом поле введите имя или расположение пакета для установки. Не нужно вводить `pip install`; он заполняется для вас автоматически. 

    - Если компьютер имеет доступ к Интернету, укажите имя пакета или URL-адрес из определенного пакета и версии. 
    
    Например чтобы установить версию CNTK, который поддерживается для Windows и Python 3.5, укажите URL-адрес скачивания: `https://cntk.ai/PythonWheel/CPU-Only/cntk-2.1-cp35-cp35m-win_amd64.whl`

    - Если компьютер не имеет доступа к Интернету, перед началом установки необходимо загрузить файл WHL. Укажите локальный путь к файлу и имя. Например вставьте следующий путь и файл, чтобы установить файл WHL, Скачанный с сайта: `"C:\Downloads\CNTK\cntk-2.1-cp35-cp35m-win_amd64.whl"`

Может быть предложено повысить права для выполнения установки.

В ходе установки вы увидите сообщения о состоянии в окне командной строки:

```python
pip install https://cntk.ai/PythonWheel/CPU-Only/cntk-2.1-cp35-cp35m-win_amd64.whl
Collecting cntk==2.1 from https://cntk.ai/PythonWheel/CPU-Only/cntk-2.1-cp35-cp35m-win_amd64.whl
  Downloading https://cntk.ai/PythonWheel/CPU-Only/cntk-2.1-cp35-cp35m-win_amd64.whl (34.1MB)
    100% |################################| 34.1MB 13kB/s
...
Installing collected packages: cntk
Successfully installed cntk-2.1
```


### <a name="step-4-load-the-package-or-its-functions-as-part-of-your-script"></a>Шаг 4. Загрузить пакет или его функции как часть скрипта

По завершении установки можно немедленно начать с помощью пакета, как описано в следующем шаге.

Примеры глубокого обучения с использованием CNTK см. в этих учебниках: [API Python для CNTK](https://cntk.ai/pythondocs/tutorials.html)

Чтобы использовать функции из пакета в сценарии, вставить стандартные `import <package_name>` инструкции в начальной строки скрипта:

```python
import numpy as np
import cntk as cntk
cntk._version_
```

## <a name="list-installed-packages-using-conda"></a>Вывод списка установленных пакетов, с помощью conda

Разными способами, которые можно получить список установленных пакетов. Например, можно просмотреть установленные пакеты в **окружения Python** windows из Visual Studio.

При использовании в командной строке Python, можно использовать либо **Pip** или **conda** диспетчера пакетов, включенных в среде Anaconda Python, добавить программа установки SQL Server.

1. Перейдите к C:\Program Files\Microsoft SQL Server\MSSQL14. MSSQLSERVER\PYTHON_SERVICES\Scripts

1. Щелкните правой кнопкой мыши **conda.exe** > **Запуск от имени администратора**и введите `conda list` для получения списка пакетов, установленных в текущей среде.

1. Аналогичным образом, щелкните правой кнопкой мыши **pip.exe** > **Запуск от имени администратора**и введите `pip list` для возвращают одинаковые сведения. 

Дополнительные сведения о **conda** и как ее можно использовать для создания и управление несколькими средами Python, см. в разделе [управлению средами с помощью conda](https://conda.io/docs/user-guide/tasks/manage-environments.html).

> [!Note]
> Программа установки SQL Server не удалось добавить Pip или Conda в системный путь и на действующем экземпляре SQL Server, сохранение необязательные исполняемые файлы из этого пути является лучшим способом. Тем не менее для сред разработки и тестирования, можно добавить в папку Scripts переменную среды PATH системы под управлением Pip и Conda команды из любого места.
