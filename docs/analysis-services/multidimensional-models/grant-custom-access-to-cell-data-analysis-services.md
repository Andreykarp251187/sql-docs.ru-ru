---
title: Предоставление настраиваемого доступа к данным ячейки (службы Analysis Services) | Документация Майкрософт
ms.date: 05/02/2018
ms.prod: sql
ms.technology: analysis-services
ms.custom: multidimensional-models
ms.topic: conceptual
ms.author: owend
ms.reviewer: owend
author: minewiskan
manager: kfile
ms.openlocfilehash: 42348298676334a84d9c4d3664aec2eeda4feed6
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "68177707"
---
# <a name="grant-custom-access-to-cell-data-analysis-services"></a>Предоставление настраиваемого доступа к данным ячейки (службы Analysis Services)
[!INCLUDE[ssas-appliesto-sqlas](../../includes/ssas-appliesto-sqlas.md)]
  Настройка безопасности ячеек используется для предоставления доступа или отказа в доступе с целью распределения данных в кубе. Следующая иллюстрация демонстрирует комбинацию разрешенных и запрещенных мер в Сводной Таблице при подключении в качестве пользователя, роль которого предоставляет доступ только к определенным мерам. В этом примере используемой роли доступны только меры **Объем продаж торгового посредника** и **Совокупная стоимость продуктов торгового посредника** . Все остальные меры безоговорочно запрещены (шаги, используемые для достижения данного результата, приведены ниже в следующем разделе, Предоставление доступа к специальным мерам).  
  
 ![Сводная таблица, отображающая разрешенные и запрещенные ячейки](../../analysis-services/multidimensional-models/media/ssas-permscellsallowed.png "Сводная таблица, отображающая разрешенных и запрещенных ячеек")  
  
 Разрешения для ячейки применяются к данным внутри ячейки, и не применяются к ее метаданным. Обратите внимание, как ячейка выводится на экран в результатах запроса, отображая значение **#N/A** вместо фактического значения ячейки. Значение **#N/A** отображается в ячейке, если только клиентское приложение не преобразует это значение или не указано другое значение посредством установки свойства Secured Cell Value в строке подключения.  
  
 Чтобы полностью скрыть ячейку, то необходимо ограничить элементы измерения, атрибуты измерения и элементы атрибутов измерений-, доступные для просмотра. Дополнительные сведения см. в разделе [Предоставление настраиваемого доступа к данным измерений (службы Analysis Services)](../../analysis-services/multidimensional-models/grant-custom-access-to-dimension-data-analysis-services.md).  
  
 В качестве администратора вы можете определять, имеют ли пользователи разрешение на чтение, производное чтение или на чтение/запись в ячейках внутри куба. Размещение разрешений в ячейке является самым нижним разрешенным уровнем безопасности, поэтому перед тем, как вы начнете применять разрешения на этом уровне, необходимо помнить о нескольких фактах:  
  
-   Безопасность на уровне ячейки не может расширить права, которые были ограничены на более высоком уровне. Пример: если роль запрещает доступ к данным измерения, безопасность на уровне ячейки не может переопределить заданное множество. Другой пример: рассмотрим роль с разрешением на **Чтение** в кубе и с разрешением на **Чтение и запись** в ячейке — у данных ячейки не будет разрешения на **Чтение и запись**; у них будет разрешение на **Чтение**.  
  
-   Пользовательские разрешения часто необходимо согласовывать между элементами измерения и ячейками в рамках единой роли. Предположим, например, что вы хотите запретить доступ к нескольким мерам, касающимся скидок, для разных комбинаций посредников. Используя данные измерения **Торговые посредники** и меру **Сумма скидки** , нужно сочетать в рамках одной и той же роли разрешения и для меры (с помощью инструкций, приведенных в этом разделе), и для членов измерения. Сведения о настройке разрешений для измерения см. в разделе [Предоставление настраиваемого доступа к данным измерений (службы Analysis Services)](../../analysis-services/multidimensional-models/grant-custom-access-to-dimension-data-analysis-services.md) .  
  
 Безопасность на уровне ячейки определяется посредством выражений MDX. Так как ячейка является кортежем (говоря иными словами - точкой пересечения между многими измерениями и мерами), необходимо использовать многомерные выражения для идентификации определенных ячеек.  
  
## <a name="allow-access-to-specific-measures"></a>Предоставление доступа к специальным мерам  
 Вы можете использовать безопасность ячейки для того, чтобы явно указать доступные меры. После того, как вы точно определите разрешенные элементы, все остальные меры станут недоступными. Это, возможно, самый простой сценарий реализации через скрипт многомерных выражений, проиллюстрированный нижеследующими этапами.  
  
1.  В [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] подключитесь к экземпляру [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)], выберите базу данных, откройте папку **Роли** , а затем выберите роль базы данных (или создайте новую). Членство уже должно быть определено, а роль должна иметь **Read** доступ к кубу. Сведения о настройке разрешений для измерения см. в разделе [Предоставление разрешений кубу или модели (службы Analysis Services)](../../analysis-services/multidimensional-models/grant-cube-or-model-permissions-analysis-services.md) .  
  
2.  В **Данных Ячейки**, проверьте выбор куба, чтобы удостовериться, что вы выбрали правильный, затем выберите **Включить разрешения на чтение**.  
  
     Если вы выбираете только этот флажок и не осуществляете многомерное выражение, эффект будет таким же, как и от отказа в доступе ко всем ячейкам в кубе. Так происходит потому, что допустимым множеством по умолчанию является пустое множество всякий раз, когда [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] разрешает подмножество ячеек куба.  
  
3.  Введите следующее многомерное выражение.  
  
    ```  
    (Measures.CurrentMember IS [Measures].[Reseller Sales Amount]) OR (Measures.CurrentMember IS [Measures].[Reseller Total Product Cost])  
    ```  
  
     Данное выражение точно определяет, какие меры видны пользователям. Никакие другие меры не будут доступны пользователям, подключенным посредством данной роли. Обратите внимание, что [CurrentMember (многомерные выражения)](../../mdx/currentmember-mdx.md) устанавливает контекст и сопровождается разрешенной мерой. Это выражение действует так: если текущий элемент содержит меру **Объем продаж торгового посредника** или **Совокупная стоимость продуктов торгового посредника**, значение отображается. В противном случае - ограничение доступа. Выражение состоит из нескольких частей, каждая часть заключена в скобки. Оператор **OR** используется для определения нескольких мер.  
  
## <a name="deny-access-to-specific-measures"></a>Отказ в доступе к специальным мерам  
 Следующее многомерное выражение MDX, также указанное в окне **Создание роли** | **Данные ячейки** | **Разрешить чтение содержимого куба**, дает обратный эффект, делая некоторые меры недоступными. В этом примере **Сумма скидки** и **Процент скидки** сделаны недоступными с помощью операторов **NOT** и **AND** . Все другие меры будут доступны пользователям, подключенным посредством данной роли.  
  
```  
(NOT Measures.CurrentMember IS [Measures].[Discount Amount]) AND (NOT Measures.CurrentMember IS [Measures].[Discount Percentage])  
```  
  
 В Excel, безопасность ячеек раскрывается на следующей иллюстрации:  
  
 ![Столбцы, которые показывают ячейки как недоступные Excel](../../analysis-services/multidimensional-models/media/ssas-permscellshidemeasure.png "Excel столбцы, которые показывают ячейки как недоступные")  
  
## <a name="set-read-permissions-on-calculated-measures"></a>Настройка разрешений на чтение на вычисляемых мерах  
 Разрешения на вычисляемых мерах могут быть настроены независимо от их составных частей. Перейдите вперед к следующему разделу относительно Производного Чтения, если вы хотите согласовать разрешения между вычисляемыми мерами и их зависимыми мерами.  
  
 Для того, чтобы понять, как Разрешения на чтение работают для вычисляемых мер, рассмотрим **Валовую Прибыль Посредника** в AdventureWorks. Она выводится из мер **Объема Товарооборота Посредника** и **Общей Стоимости Товаров Посредника** . Поскольку роль обладает Разрешением на чтение ячеек **Валовой Прибыли Посредника** , данная мера является видимой даже если разрешения на других мерах прямо запрещены. Для примера скопируйте следующее многомерное выражение в окно **Создание роли** | **Данные ячейки** | **Разрешить чтение содержимого куба**.  
  
```  
(NOT Measures.CurrentMember IS [Measures].[Reseller Sales Amount])  
AND (NOT Measures.CurrentMember IS [Measures].[Reseller Total Product Cost])  
```  
  
 В Excel, подключитесь к кубу, используя текущую роль, и выберите все три меры, чтобы увидеть эффекты безопасности ячейки. Обратите внимание на то, что меры в заданных значениях не доступны, однако вычисляемая мера доступна пользователю.  
  
 ![Таблица Excel с доступными и недоступными ячейками](../../analysis-services/multidimensional-models/media/ssas-permscalculatedcells.png "таблица Excel с доступными и недоступными ячейками")  
  
## <a name="set-read-contingent-permissions-on-calculated-measures"></a>Настройка разрешений Производного Чтение на вычисляемых мерах  
 Безопасность ячеек предлагает альтернативу, Производное Чтение, для настройки разрешений на соответствующих ячейках, участвующих в вычислении. Снова рассмотрим пример **Валовая Прибыль Посредника** . При вводе того же многомерного выражения, предоставленного в предыдущем разделе, размещенного на этот раз во второй текстовой области диалогового окна **Создание роли** | **Данные ячейки** (в текстовой области под строкой **Разрешить чтение содержимого ячейки в зависимости от уровня безопасности, установленного для ячейки**), результат будет очевиден при просмотре в Excel. Поскольку **Валовая Прибыль Посредника** обусловлена **Объемом Товарооборота Посредника** и **Общей Стоимостью Товаров Посредника**, валовая прибыль в настоящее время недоступна, поскольку недоступны ее составные части.  
  
> [!NOTE]  
>  Что произойдет, если вы установите в ячейке и разрешения Чтения и разрешения Производного Чтения в рамках единой роли? Роль предоставит в ячейке разрешения Чтения, а не разрешения Производного Чтения.  
  
 Как следует из предыдущих разделов, выбор только лишь флажка **Включить разрешения на производное чтение** , без предоставления любого многомерного выражения, запретит доступ ко всем ячейкам в кубе. Так происходит потому, что допустимым множеством по умолчанию является пустое множество всякий раз, когда [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] разрешает подмножество ячеек куба.  
  
## <a name="set-readwrite-permissions-on-a-cell"></a>Установка разрешений Чтение/Запись в ячейке  
 Разрешения Чтение/запись в ячейке используются для разрешения обратной записи только в том случае, если элементы имеют разрешения чтение/запись на самом кубе. Разрешения, предоставляемые на уровне ячеек, не могут превосходить прав, предоставленных на уровне куба. Дополнительные сведения см. в разделе [Set Partition Writeback](../../analysis-services/multidimensional-models/set-partition-writeback.md) .  
  
## <a name="see-also"></a>См. также  
 [Конструктор многомерных выражений (службы Analysis Services — многомерные данные)](http://msdn.microsoft.com/library/fecbf093-65ea-4e1b-b637-f04876f1cb0f)   
 [Базовый скрипт многомерных выражений (многомерные выражения)](../../analysis-services/multidimensional-models/mdx/the-basic-mdx-script-mdx.md)   
 [Предоставление разрешений на обработку (службы Analysis Services)](../../analysis-services/multidimensional-models/grant-process-permissions-analysis-services.md)   
 [Предоставление разрешений измерению (службы Analysis Services)](../../analysis-services/multidimensional-models/grant-permissions-on-a-dimension-analysis-services.md)   
 [Предоставление настраиваемого доступа к данным измерений (службы Analysis Services)](../../analysis-services/multidimensional-models/grant-custom-access-to-dimension-data-analysis-services.md)   
 [Предоставление разрешений кубу или модели (службы Analysis Services)](../../analysis-services/multidimensional-models/grant-cube-or-model-permissions-analysis-services.md)  
  
  
