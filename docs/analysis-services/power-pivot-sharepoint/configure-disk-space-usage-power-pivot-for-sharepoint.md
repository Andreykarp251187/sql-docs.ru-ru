---
title: Настройка использования места на диске (PowerPivot для SharePoint) | Документация Майкрософт
ms.date: 05/02/2018
ms.prod: sql
ms.technology: analysis-services
ms.custom: ppvt-sharepoint
ms.topic: conceptual
ms.author: owend
ms.reviewer: owend
author: minewiskan
manager: kfile
ms.openlocfilehash: 6fa6090a675326db06491d54b82a6844363ee3e9
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "68208312"
---
# <a name="configure-disk-space-usage-power-pivot-for-sharepoint"></a>Настройка использования места на диске (PowerPivot для SharePoint)
[!INCLUDE[ssas-appliesto-sqlas](../../includes/ssas-appliesto-sqlas.md)]
  Чтобы обеспечить ускоренную перезагрузку, [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint кэширует базу данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] в свободном месте на диске главного компьютера. Каждая база данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , загружаемая в память, сначала кэшируется на диске, обеспечивая возможность быстрой перезагрузки при обслуживании новых запросов в будущем. По умолчанию [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint использует свободное место на диске для кэширования баз данных, но это можно изменить, задав параметры, ограничивающие использование дискового пространства.  
  
 В этом разделе описано, как установить ограничения на использование места на диске.  
  
 В этом разделе не представлены инструкции по управлению местом на диске для баз данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] (внедренных в книги Excel), которые хранятся в базах данных содержимого. [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] могут быть большими, в связи с чем требования к емкости хранилища фермы возрастают. Кроме того, если включено управление версиями, в одной базе данных содержимого вполне могут появиться несколько копий данных, что еще больше повышает потребность в месте на диске для хранения содержимого. Хотя базы данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] — это важный фактор, влияющий на процесс управления дисками, ими невозможно управлять отдельно от другого содержимого, хранящегося в ферме SharePoint. С интенсификацией использования книг [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] в компании следует внимательнее отслеживать показатели дискового пространства. Операции с книгами [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] также можно отслеживать на панели мониторинга [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , удаляя книги, которые больше не используются.  
  
## <a name="how-power-pivot-for-sharepoint-manages-cached-databases"></a>Как управлять кэшированными базами данных в PowerPivot для SharePoint  
 Для управления кэшем системная служба [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] через равные интервалы времени выполняет фоновое задание по очистке неиспользуемых или устаревших баз данных, для которых в библиотеке содержимого доступны более новые версии. Цель очистки заключается в выгрузке неактивных баз данных из памяти и удалении неиспользуемых кэшированных баз данных из файловой системы. Задание по очистке служит для долгосрочного обслуживания и позволяет добиться того, чтобы базы данных не сохранялись в системе неограниченное время. На активном сервере базы данных могут удаляться чаще в силу большой загрузки памяти на сервере, удаления баз данных в SharePoint или появления более новых версий базы данных в текущей библиотеке.  
  
 Несмотря на то что изменить расписание выполнения задания по очистке нельзя, можно настроить управление файлом кэша с помощью серверных свойств конфигурации, отвечающих за следующие параметры:  
  
-   Ограничение объема места на диске, используемого кэшем.  
  
-   Объем данных, удаляемых при достижении максимального дискового пространства.  
  
## <a name="how-to-check-disk-space-usage"></a>Как проверить использование места на диске  
 [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint устанавливается на сервере приложений в ферме SharePoint. Каждая установка имеет каталог данных, включающий папку Backup. В папке Backup содержатся все файлы данных, закэшированные экземпляром служб Analysis Services на компьютере. По умолчанию папка Backup находится по следующему пути:  
  
 `%drive%:\Program Files\Microsoft SQL Server\MSAS10_50.PowerPivot\OLAP\Backup\Sandboxes\<serviceApplicationName>`  
  
 Чтобы проверить, какой объем общего места на диске занимает кэш, необходимо проверить размер папки Backup. В центре администрирования нет свойства, которое указывает текущий размер кэша.  
  
 В папке Backup находится общее хранилище кэша для любой базы данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , загруженной в память на локальном компьютере. Если на ферме определено несколько приложений службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , любое из них может использовать локальный сервер для загрузки и последующего кэширования данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Как загрузка данных, так и их кэширование являются серверными операциями служб Analysis Services. В силу этого использование дискового пространства управляется на уровне экземпляра служб Analysis Services с учетом папки Backup. Параметры конфигурации, ограничивающие использование дискового пространства, таким образом, задаются на одном экземпляре служб Analysis Services SQL Server, который запущен на сервере приложений SharePoint.  
  
 В кэше содержатся только базы данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] базы данных хранятся в нескольких файлах в одной родительской папке с именем Backup. Так как базы данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] предназначены для использования в книге Excel в качестве внутренних данных, они имеют имена на основе идентификаторов GUID, а не описательные имена. Папка GUID в папке  **\<serviceApplicationName >** является родительской папкой [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] базы данных. По мере загрузки баз данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] на сервер для каждой из них создаются дополнительные папки.  
  
 Поскольку данные [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] могут быть загружены в любой экземпляр служб Analysis Services в ферме, одни и те же данные могут одновременно кэшироваться на нескольких компьютерах в ферме. Такой подход позволяет повысить производительность за счет использования места на диске, в результате пользователи получают более быстрый доступ к данным, уже имеющимся на диске.  
  
 Чтобы немедленно уменьшить объем занятого места на диске, можно отключить службу, а затем удалить базы данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] из папки Backup. Удаление файлов вручную является временной мерой, так как более новая копия базы данных будет снова помещена в кэш при следующем запросе данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Постоянное решение предполагает ограничение использования дискового пространства кэшем.  
  
 На уровне системы можно создать оповещения по электронной почте, сообщающие о нехватке места на диске. Microsoft System Center имеет функцию отправки уведомлений по электронной почте. Для настройки уведомлений также можно использовать диспетчер ресурсов сервера файлов, планировщик заданий или скрипт PowerShell. Следующие ссылки предоставляют полезные сведения о настройке уведомлений о недостатке места на диске:  
  
-   [Новые возможности диспетчера ресурсов файлового сервера](http://technet.microsoft.com/library/hh831746.aspx) (http://technet.microsoft.com/library/hh831746.aspx).  
  
-   [Пошаговое руководство диспетчера ресурсов файлового сервера для Windows Server 2008 R2](http://go.microsoft.com/fwlink/?LinkID=204875) (http://go.microsoft.com/fwlink/?LinkID=204875).  
  
-   [Настройка оповещений мало свободного пространства в Windows Server 2008](http://go.microsoft.com/fwlink/?LinkID=204870) ( http://go.microsoft.com/fwlink/?LinkID=204870).  
  
## <a name="how-to-limit-the-amount-of-disk-space-used-for-storing-cached-files"></a>Ограничение объема места на диске, используемого для хранения кэшированных файлов  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление службами на сервере**.  
  
2.  Нажмите **Службы SQL Server Analysis Services**.  
  
     Обратите внимание, что ограничения задаются для экземпляра служб Analysis Services, который выполняется на физическом сервере, а не на уровне приложения службы. Единственный предел максимального объема места на диске, заданный для экземпляра служб Analysis Services, распространяется на все приложения службы, использующие этот локальный экземпляр.  
  
3.  В разделе "Использование диска" задайте значение (в гигабайтах) для параметра **Общее дисковое пространство** , чтобы указать верхний предел объема дискового пространства, используемого для кэширования. 0 — значение по умолчанию, которое позволяет службам Analysis Services использовать все свободное место на диске.  
  
4.  В использовании диска в **удалить кэшированные базы данных в последней "n" часов** задайте критерий последнего использования для очистки кэша при — место на диске с максимальным количеством.  
  
     Значение по умолчанию — 4 часа, т. е. все базы данных, которые были неактивными в течение последних 4 часов и более, удаляются из файловой системы. Базы данных, которые являются неактивными, но все еще находятся в памяти, выгружаются, а затем удаляются из файловой системы.  
  
## <a name="how-to-limit-how-long-a-database-is-kept-in-the-cache"></a>Ограничение времени хранения базы данных в кэше  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.  
  
2.  Щелкните **Приложение службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] по умолчанию**, чтобы открыть панель мониторинга.  
  
3.  В разделе «Действия» выберите пункт **Настройка параметров приложения службы**.  
  
4.  В разделе «Кэш на диске» можно указать время хранения неактивной базы данных в памяти для обслуживания новых запросов (по умолчанию 48 часов), а также время ее хранения в кэше (по умолчанию 120 часов).  
  
     Параметр**Хранить неактивную базу данных в памяти** указывает время хранения неактивной базы данных в памяти для обслуживания новых запросов к этим данным. Активная база данных всегда остается в памяти, пока к ней поступают запросы, но после того, как она перестает быть активной, система будет хранить эту базу данных в памяти в течение определенного периода времени на случай поступления новых запросов к этим данным.  
  
     Так как базы данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] сначала кэшируются, а затем загружаются в память, файлы базы данных сразу же занимают место на диске. Тем не менее, пока база данных активна (и в течение 48 часов после этого), все запросы направляются сначала к базе данных, находящейся в памяти, при этом кэшированная база данных игнорируется. Если база данных остается неактивной в течение 48 часов, ее файл выгружается из памяти, но остается в кэше. Оттуда его можно быстро загрузить в память, когда локальный экземпляр сервера [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] получает новый запрос на подключение к этим данным. Запросы на соединение с неактивными базами данных обслуживаются из кэша, а не из библиотеки содержимого, что сводит влияние на базы данных содержимого к минимуму.  
  
     Важно отметить, что библиотека содержимого является единственным постоянным расположением для баз данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Кэшированные копии используются только в том случае, если в библиотеке находится такая же база данных, как и копия на диске.  
  
     Параметр**Хранить неактивную базу данных в кэше** указывает время хранения неактивной базы данных в файловой системе после ее выгрузки из памяти. С помощью этого параметра задание очистки определяет, какие файлы подлежат удалению. Все базы данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , остающиеся неактивными в течение 168 часов (48 часов в памяти и 120 часов в кэше), удаляются с диска заданием очистки.  
  
5.  Нажмите кнопку **ОК** , чтобы сохранить внесенные изменения.  
  
## <a name="next-steps"></a>Следующие шаги  
 Установка [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint предусматривает определение правил работоспособности, которые позволяют предпринимать корректирующие действия при обнаружении проблем с работоспособностью сервера, конфигурацией или доступностью. Некоторые из этих правил определяют условия срабатывания правила с помощью параметров конфигурации. Если настройка производительности сервера выполняется своевременно, можно также обратиться к этим параметрам, чтобы удостовериться, что значения по умолчанию наилучшим образом подходят для данной системы. Дополнительные сведения см. в разделе [Настройка правил определения работоспособности PowerPivot](../../analysis-services/power-pivot-sharepoint/configure-power-pivot-health-rules.md).  
  
## <a name="see-also"></a>См. также  
 [Настройка и администрирование сервера Power Pivot в центре администрирования](../../analysis-services/power-pivot-sharepoint/power-pivot-server-administration-and-configuration-in-central-administration.md)  
  
  
