---
title: Создание и настройка приложения службы PowerPivot в ЦС | Документация Майкрософт
ms.date: 05/02/2018
ms.prod: sql
ms.technology: analysis-services
ms.custom: ppvt-sharepoint
ms.topic: conceptual
ms.author: owend
ms.reviewer: owend
author: minewiskan
manager: kfile
ms.openlocfilehash: e79087f98d5947706720b1dc63c000ae9d9e0ad5
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "68164042"
---
# <a name="create-and-configure-power-pivot-service-application-in-ca"></a>Создание и настройка приложения службы PowerPivot в ЦС
[!INCLUDE[ssas-appliesto-sqlas](../../includes/ssas-appliesto-sqlas.md)]
  Приложение службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] — это общий экземпляр системной службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Каждое приложение службы имеет свое удостоверение, параметры настройки, свойства и внутреннее хранилище данных.  
  
 Этот раздел состоит из следующих подразделов.  
  
 [Определение необходимости в создании нового приложения службы PowerPivot](#determine)  
  
 [Создание приложения службы PowerPivot](#CreateApp)  
  
 [Настройка приложения службы PowerPivot](#ConfigApp)  
  
 [Назначение приложения службы PowerPivot веб-приложению](#AssignGSA)  
  
 [Изменение свойств приложения службы](#EditGSA)  
  
##  <a name="determine"></a> Определение необходимости в создании нового приложения службы PowerPivot  
 Для установки [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint на ферме должно быть как минимум одно приложение службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Приложение службы создается автоматически, если при настройке сервера использовалось средство настройки [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Иначе необходимо создать приложение службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] вручную в центре администрирования.  
  
 Создание приложения службы открывает доступ к службе и формирует базу данных приложения службы. В зависимости от параметров, выбранных при создании приложения службы, соединение со службой [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] добавляется в группу соединений служб по умолчанию. Все веб-приложения SharePoint, которые подписаны на группу соединений служб по умолчанию, автоматически получают немедленный доступ к приложению службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .  
  
 Может быть создано несколько приложений службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Хотя одного приложения службы достаточно для большинства сценариев развертывания, может оказаться целесообразным создание дополнительного приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] при наличии следующих бизнес-требований.  
  
-   Использование разных учетных записей автоматического обновления данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для каждого из приложений.  
  
-   Использование разных значений времени ожидания, журналов использования и пороговых значений для отчетов об ответах на запросы.  
  
-   Делегирование прав администрирования службы другому пользователю. Администратор получает доступ к журналу обновления данных, журналу использования и другим свойствам только того приложения, которое администрирует. Если необходимо изолировать данные для разных веб-приложений SharePoint (например, для компаний, которые предлагают услуги размещения с гарантией изоляции данных для веб-приложений SharePoint разных клиентов), для удовлетворения требований к изоляции можно создать отдельные приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] и предоставить каждому администратору в отдельности доступ только к параметрам конфигурации и свойствам того приложения, которым он управляет.  
  
 При создании дополнительных приложений службы возникают новые требования по ассоциациям управления службами. А именно, потребуется создание и использование пользовательского списка ассоциаций служб для каждого дополнительного приложения службы.  
  
 Если никаких особых причин для создания нового приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] нет, лучше пользоваться одним приложением службы для всех веб-приложений фермы.  
  
##  <a name="CreateApp"></a> Создание приложения службы PowerPivot  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.  
  
2.  В ленте **Приложение службы** нажмите кнопку **Создать**.  
  
3.  Выберите **Приложение службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] SQL Server**. Если этого пункта нет в списке, это означает, что [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint не установлен или установлен неправильно.  
  
4.  На странице **Создание нового приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)]**  введите имя приложения. По умолчанию используется PowerPivotServiceApplication\<номер >. При создании нескольких приложений службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] описательное имя поможет другим администраторам понять, как используется это приложение.  
  
5.  В разделе «Пул приложений» создайте для данного приложения новый пул (рекомендуется). Выберите или создайте управляемую учетную запись для пула приложений. Обязательно укажите учетную запись домена. Учетная запись пользователя домена позволяет использовать функцию управляемой учетной записи SharePoint, с помощью которой пароли и данные учетной записи можно изменять в одном месте. Учетные записи домена также требуются, если планируется расширение развернутой системы и включение дополнительных экземпляров службы, которые будут работать под одним идентификатором.  
  
6.  В поле **Сервер базы данных**значением по умолчанию является экземпляр компонента SQL Server Database Engine, на котором размещены базы данных конфигурации фермы. Можно использовать этот сервер либо выбрать другой SQL Server.  
  
7.  В **имя базы данных**, значение по умолчанию — PowerPivotServiceApplication1_\<guid >. Необходимо создать уникальную базу данных для каждого приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Имя базы данных по умолчанию соответствует используемому по умолчанию имени приложения службы. Если было введено уникальное имя приложения службы, следуйте аналогичным соглашениях об именах при выборе имени базы данных, чтобы ими можно было управлять совместно.  
  
8.  В списке **Проверка подлинности базы данных**по умолчанию выбрано значение «Проверка подлинности Windows». Если выбран параметр **Проверка подлинности SQL**, то рекомендации по использованию этого типа проверки подлинности в развернутой системе SharePoint см. в руководстве администратора SharePoint.  
  
9. Кроме того, можно установить флажок **Добавить прокси-сервер для этого приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] к группе прокси-серверов по умолчанию для фермы**. . При этом соединение с приложением службы будет добавлено в список группы соединений служб по умолчанию.  
  
     Этот флажок должен быть выбран при создании первого приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Наличие приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] в группе соединений по умолчанию необходимо для правильной работы панели управления [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .  
  
     Если группа соединений по умолчанию уже существует, добавлять в нее вновь создаваемые приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] не требуется. Добавление нескольких записей приложений службы одного типа не поддерживается, это может привести к возникновению ошибок. При создании дополнительных приложений службы не вносите их в группу соединений по умолчанию, вместо этого добавьте в пользовательские списки.  
  
     Дополнительные сведения о связях службы см. в разделе [Подключение приложения службы PowerPivot к веб-приложению SharePoint в центре администрирования](../../analysis-services/power-pivot-sharepoint/connect-power-pivot-service-app-to-sharepoint-web-app-in-ca.md).  
  
10. Нажмите кнопку **ОК.** Эта служба появится в списке приложений служб фермы рядом с другими управляемыми службами.  
  
##  <a name="ConfigApp"></a> Настройка приложения службы PowerPivot  
 Приложение службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] создается с использованием конфигурации по умолчанию. В большинстве случаев рекомендуется использовать параметры по умолчанию. Изменять их следует, только если подключения обрываются или время ответа слишком велико, либо если для разных веб-приложений SharePoint используются различные параметры службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.  
  
     В списке приложений служб должно отображаться только что созданное приложение службы. Приложение по умолчанию — **PowerPivotServiceApplication1**.  
  
2.  Щелкните приложение службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Откроется панель управления [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .  
  
3.  В списке **Действия** (в правом верхнем углу панели мониторинга) выберите **Настройка параметров приложения службы**.  
  
4.  Измените значение в поле **Время ожидания загрузки базы данных**, указав время, в течение которого служба [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] будет ожидать ответа от экземпляра служб SQL Server Analysis Services ([!INCLUDE[ssGemini](../../includes/ssgemini-md.md)]), получившего запрос на загрузку данных. Так как очень большие наборы данных требуют большого времени для передачи по каналу, должно быть установлено время, достаточное для того, чтобы экземпляр службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] извлек книгу Excel и передал данные [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] экземпляру служб Analysis Services для обработки запроса. Так как [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] работает с особенно большими наборами данных, значение по умолчанию составляет 30 минут.  
  
5.  Измените значение в поле **Время ожидания соединения**, указав время, в течение которого неактивное подключение к данным будет оставаться открытым. Значение по умолчанию составляет 30 минут. В течение этого времени служба [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] будет использовать неактивное подключение к данным только для запросов на чтение от одного и того же пользователя SharePoint к одним и тем же данным [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . При отсутствии других запросов к данным за указанный период соединение удаляется из пула. Допустимые значения: от 1 до 3600 секунд. Дополнительные сведения о пулах подключений см. в разделе [Справочник по параметрам конфигурации (PowerPivot для SharePoint)](../../analysis-services/power-pivot-sharepoint/configuration-setting-reference-power-pivot-for-sharepoint.md).  
  
6.  В поле **Максимальный размер пула соединения пользователя**измените значение, указав максимальное количество неактивных подключений, для которых служба [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] будет создавать отдельные пулы подключений для каждого уникального сочетания пользователя SharePoint, набора данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] и версии.  
  
     Значением по умолчанию является 1000 неактивных соединений. Допустимыми значениями являются -1 (не ограничено), 0 (отключает использование пулов соединений пользователя) или от 1 до 10000.  
  
     Эти пулы соединений позволяют службе более эффективно поддерживать текущие соединения к одним и тем же данным только для чтения для одного и того же пользователя. Если использование пулов соединений отключено, то каждое соединение будет создаваться заново.  
  
     Имейте в виду, что изменение ограничения на размер пула соединений, в том числе установка значения 0, не влияет на потерянные соединения. Пулы соединений используются для сокращения времени ожидания при подключении к данным. Служба [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] никогда не запрещает создание подключений из-за параметров пула подключений.  
  
7.  Измените значение в поле **Максимальный размер пула административных подключений**, указав количество открытых подключений в пуле подключений, созданных для обмена данными между службами [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] и Analysis Services. Каждый экземпляр службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] открывает отдельное административное подключение с экземпляром Analysis Services, находящимся на том же компьютере. [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] создает отдельный пул для повторного использования административных подключений с целью проверки неактивных подключений и наблюдения за исправностью сервера. Значением по умолчанию является 200 соединений. Допустимыми значениями являются -1 (неограниченно), 0 (отключение использования пулов административных соединений) или от 1 до 10000. Если выбрано значение 0, то каждое соединение будет создаваться заново.  
  
8.  В поле **Способ размещения**можно указать схему балансировки нагрузки, которую системная служба [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] будет использовать для выбора конкретного приложения службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для балансировки нагрузки начального запроса. По умолчанию применяется режим **По исправности**, при котором запросы распределяются исходя из состояния сервера, определяемого с учетом объема доступной памяти и загрузки ЦП. Также при необходимости можно выбрать режим **Циклический перебор** , предусматривающий распределение запросов по службам в цикле в одном и том же порядке, независимо от того, занят сервер или простаивает.  
  
9. На странице «Обновление данных» в поле **Рабочие часы**можно указать диапазон часов, определяющих рабочий день. Обновление данных по расписанию может быть запущено после окончания бизнес-дня для заведения данных транзакций, созданных в течение рабочих часов.  
  
10. В поле **[!INCLUDE[ssGemini](../../includes/ssgemini-md.md)]** можно указать стандартное целевое приложение служб безопасного хранения, в котором хранится стандартная учетная запись для запуска заданий обновления данных [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Следует указывать имя, а не идентификатор целевого приложения. Целевое приложение для автоматического обновления данных создается автоматически, если при установке [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] для SharePoint в программе установки SQL Server был выбран параметр "Новый сервер". В противном случае целевое приложение необходимо создать вручную. Инструкции по настройке учетной записи см. в статье [Настройка учетной записи автоматического обновления данных PowerPivot (PowerPivot для SharePoint)](http://msdn.microsoft.com/81401eac-c619-4fad-ad3e-599e7a6f8493).  
  
11. В разделе **Разрешить пользователям вводить пользовательские учетные данные Windows**можно установить или снять флажок, указывающий, могут ли владельцы расписания вводить произвольные учетные данные Windows для запуска обновления данных по расписанию. Если этот флажок установлен, то приложение службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] создает и обслуживает целевое приложение для каждого набора этих сохраненных учетных данных. Дополнительные сведения см. в статье [Настройка сохраненных учетных данных для обновления данных PowerPivot (PowerPivot для SharePoint)](http://msdn.microsoft.com/987eff0f-bcfe-4bbd-81e0-9aca993a2a75).  
  
12. В поле **Максимальный размер журнала обработки**можно указать время, в течение которого исторические записи о процессе обновления данных будут сохраняться. Эта информация отображается на страницах истории обновления данных, содержащихся в каждой книге с обновленными данными. Также она отображается на панели управления [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .  
  
13. На странице «Сбор данных об использовании» в поле **Интервал отчетов о запросах**задайте интервал времени для сбора статистики в отчете о запросах. Статистика о запросах передается в виде одиночного события, позволяя свести к минимуму обмен данными между серверами.  
  
14. В поле «Журнал данных об использовании» укажите время, в течение которого должны храниться записи данных об использовании. Сведения об использовании отображаются на панели управления [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] . Эффективность этих отчетов будет невелика, если для журнала данных об использовании указано слишком низкое значение.  
  
15. На странице «Сбор данных об использовании» для каждого порогового значения ответа укажите верхнее ограничение, определяющее, когда заканчивается одна категория и начинается другая. Эти категории устанавливают базовый уровень, по которому оценивается запрос. Эти категории могут быть использованы для наблюдения за трендом продолжительности обработки запросов системой. Эта информация отображается на панели управления [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .  
  
16. Нажмите кнопку **ОК** , чтобы сохранить внесенные изменения.  
  
     Изменения времени ожидания загрузки или метода распределения применяются только для новых входящих запросов. Для запросов, которые уже обрабатываются, применяются те значения, которые были установлены при получении запроса.  
  
##  <a name="AssignGSA"></a> Назначение приложения службы PowerPivot веб-приложению  
 Настроенное приложение службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] можно назначить веб-приложению путем добавления в список подключений приложений служб для этого веб-приложения. Для этого имеется два способа.  
  
-   Добавьте его в группу соединения **По умолчанию** . *Группа соединений по умолчанию* — это набор соединений с приложениями служб, которые доступны любому веб-приложению, ссылающемуся на них. В этот список необходимо добавить приложение службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] .  
  
-   Создайте **пользовательский** список соединений для веб-приложения. Если было создано несколько приложений службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , то для использования необходимо выбрать одно, добавив его в пользовательский список.  
  
 Группа соединений по умолчанию может принимать более одного приложения службы одного типа. Имейте в виду, что добавление нескольких приложений службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] в этот список не поддерживается.  
  
1.  В разделе **Управление приложениями**центра администрирования выберите **Управление веб-приложениями**.  
  
2.  Выберите приложение, которому должно быть назначено соединение (например, SharePoint-80).  
  
3.  Нажмите **Соединения службы**.  
  
4.  В поле **Изменить следующую группу взаимосвязей**выберите **default** или **[custom]** .  
  
5.  Если выбран пункт **[custom]** , установите флажок для всех соединений приложений служб, которые будут использоваться. Если есть несколько приложений службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] (обозначены типом **Прокси-сервер приложения службы PowerPivot**), то должно быть выбрано только одно.  
  
6.  Нажмите кнопку **ОК**.  
  
##  <a name="EditGSA"></a> Изменение свойств приложения службы  
 Повторное открытие страницы свойств, на которой указаны имя приложения службы, пул приложений, параметры базы данных и взаимосвязи служб, производится следующим образом.  
  
1.  В разделе «Управление приложениями» центра администрирования выберите пункт **Управление приложениями служб**.  
  
2.  Выберите приложение службы [!INCLUDE[ssGemini](../../includes/ssgemini-md.md)] , но не щелкайте его. Чтобы выбрать строку целиком можно щелкнуть имя типа.  
  
3.  На ленте нажмите **Свойства** .  
  
## <a name="see-also"></a>См. также  
 [Настройка и администрирование сервера Power Pivot в центре администрирования](../../analysis-services/power-pivot-sharepoint/power-pivot-server-administration-and-configuration-in-central-administration.md)  
  
  
