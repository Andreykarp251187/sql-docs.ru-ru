---
title: Новые возможности в SQL Server 2017 Analysis Services | Документация Майкрософт
ms.date: 03/08/2019
ms.prod: sql
ms.technology: analysis-services
ms.custom: ''
ms.topic: conceptual
ms.author: owend
ms.reviewer: owend
author: minewiskan
manager: kfile
monikerRange: '>= sql-server-2017 || = sqlallproducts-allversions'
ms.openlocfilehash: 1f322b395f897780f3693d1186767aeef7dbfd4a
ms.sourcegitcommit: a6949111461eda0cc9a71689f86b517de3c5d4c1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2019
ms.locfileid: "67263267"
---
# <a name="whats-new-in-sql-server-2017-analysis-services"></a>Новые возможности в SQL Server 2017 Analysis Services
[!INCLUDE[ssas-appliesto-sql2017](../includes/ssas-appliesto-sql2017.md)]

SQL Server 2017 Analysis Services см. в разделе некоторые из наиболее важных улучшений с SQL Server 2012. Основываясь на успехе табличном режиме (впервые появился в SQL Server 2012 Analysis Services), этот выпуск позволяет эффективнее, чем когда-либо табличные модели.

Многомерный режим и Power Pivot в режиме интеграции с SharePoint являются основой для многих развертываний служб Analysis Services. В жизненном цикле продукта служб Analysis Services отлажены этих режимов. Нет новых компонентов какой-либо из этих режимов, в этом выпуске. Тем не менее исправления ошибок и улучшения производительности включены.

Описанные здесь возможности включены в SQL Server 2017 Analysis Services. Но чтобы воспользоваться их преимуществами, необходимо также использовать последние версии [SQL Server Data Tools](../ssdt/download-sql-server-data-tools-ssdt.md) (SSDT) и [SQL Server Management Studio](../ssms/download-sql-server-management-studio-ssms.md) (SSMS). SSDT и SSMS обновляются каждый месяц с помощью новых и улучшенных функций, которые обычно осуществляются в новые функциональные возможности SQL Server.  

Хотя очень важно узнать о новых возможностях, также важно знать, что рекомендуется к использованию и более не поддерживается в этом выпуске и будущих выпусках. Обязательно ознакомьтесь с [обратная совместимость (SQL Server 2017 Analysis Services)](analysis-services-backward-compatibility-sql2017.md).

Давайте рассмотрим некоторые из ключевых новых функций в этом выпуске.

## <a name="1400-compatibility-level-for-tabular-models"></a>Уровень совместимости 1400 для табличных моделей
  Чтобы воспользоваться преимуществами множества новых функций и функций, описанных здесь, новых или существующих табличных моделей необходимо задать или обновленным до уровня совместимости 1400. Модели с уровнем совместимости 1400 нельзя развертывать в SQL Server 2016 с пакетом обновления 1 (SP1) или более ранней версии либо переводить на более низкий уровень совместимости. Дополнительные сведения см. в разделе [уровень совместимости табличных моделей служб Analysis Services](../analysis-services/tabular-models/compatibility-level-for-tabular-models-in-analysis-services.md).
  
В SSDT можно выбрать новый уровень совместимости 1400 при создании проектов табличной модели. 

![AS_NewTabular1400Project](../analysis-services/media/as-newtabular1400project.png)


Для обновления существующей табличной модели в SSDT, в обозревателе решений щелкните правой кнопкой мыши **Model.bim**, а затем в **свойства**, задайте **уровень совместимости** свойства  **SQL Server 2017 (1400)** . 

![AS_Model_Properties](../analysis-services/media/as-model-properties.png)

Важно помнить, после обновления существующей модели 1400, невозможно понизить. Обязательно сохраните резервную копию базы данных модели 1200.

## <a name="modern-get-data-experience"></a>Современный интерфейс получения данных
Когда дело доходит до импорта данных из источников данных в табличных моделях, SQL Server Data Tools (SSDT) представляет новый **получить данные** возможности для моделей на уровне совместимости 1400. Он основан на аналогичном интерфейсе в Power BI Desktop и Microsoft Excel 2016. Современными возможностями получения данных обеспечивает преобразование данных мощно расширяет функциональность и возможности комбинирования данных с помощью построителя запросов на получение данных и M-выражений.

Современный интерфейс получения данных обеспечивает поддержку для широкого диапазона источников данных. В дальнейшем обновления включают поддержку для еще большего.

![AS_Get_Data_in_SSDT](../analysis-services/media/as-get-data-in-ssdt.png)

 Мощный и интуитивно понятный пользовательский интерфейс упрощает выбор ваши данные и проще, чем когда-либо возможности преобразования и комбинирования данных.

![Расширенные гибридных веб-приложений](../analysis-services/media/as-get-data-advanced.png)


Современный интерфейс получения данных и возможности M гибридных веб-приложений не применяются к upraded существующих табличных моделей 1200 уровня совместимости 1400. Новые возможности применяется только для новых моделей, созданных на уровне совместимости 1400.

## <a name="encoding-hints"></a>Подсказки службы кодирования
Этой версии появилась подсказки службы кодирования, расширенная функция, использующаяся для оптимизации обработки (обновления данных) больших табличных моделей в памяти. Чтобы лучше понять кодирования, см. в разделе [производительности настройки из табличных моделей в SQL Server 2012 Analysis Services](https://msdn.microsoft.com/library/dn393915.aspx) Технический документ, чтобы лучше понять кодирования.

* Значение кодировки обеспечивает более высокую производительность запросов для столбцов, которые обычно используются только для агрегатов.

* Кодирование хэша является предпочтительным для столбцов group-by (часто таблицы измерения значения) и внешних ключей. Строковые столбцы всегда являются хэш в кодировке.

Числовые столбцы можно использовать любой из этих методов кодирования. Когда службы Analysis Services начинает обработку таблицы, если любой из таблиц является пустым (с или без секций) или выполняемой операции обработки всей таблицы, примеры значений будут создаваться для каждого числового столбца определить, следует ли применять значение или кодирование хэша . По умолчанию значение кодировки выбирается при пример различных значений в столбце слишком малы, — в противном случае кодирование хэша обычно обеспечивает более высокую степень сжатия. Возможно, для служб Analysis Services для изменения метода шифрования после столбца частично обработки на основе дальнейшей информации о распределении данных и перезапустите процесс кодирования; Тем не менее это приводит к увеличению времени обработки и неэффективным. Технический документ по повышению производительности рассматривается повторно кодировка более подробно и описывается, как сделать это с помощью SQL Server Profiler.

Подсказки службы кодирования позволяют разработчику модели, указав предпочтение, метод шифрования, учитывая знания из данных профилирования и/или в ответ на повторное кодирование событий трассировки. Так как статистическое выражение по кодировке хэш столбцы медленнее, чем к столбцам, значение в кодировке, кодирование может быть указан как подсказку для таких столбцов. Не гарантируется, что применяется приоритет. Это подсказка в отличие от параметра. Чтобы задать указание кодировки, установите свойство EncodingHint по столбцу. Возможными значениями являются «Default», «Значение» и «Hash». Следующий фрагмент кода JSON на основе метаданных из файла Model.bim указывает значение кодировки для столбца Sales Amount.

```
{
    "name": "Sales Amount",
    "dataType": "decimal",
    "sourceColumn": "SalesAmount",
    "formatString": "\\$#,0.00;(\\$#,0.00);\\$#,0.00",
    "sourceProviderType": "Currency",
    "encodingHint": "Value"
}
```

## <a name="ragged-hierarchies"></a>Неоднородные иерархии
В табличных моделях можно моделировать иерархии типа "родители-потомки". Иерархии с разным количеством уровней часто называют неоднородными. По умолчанию неоднородные иерархии отображаются с пустыми полями для уровней ниже последнего дочернего уровня. Вот пример неоднородной иерархии на организационной диаграмме:

![AS_Ragged_Hierarchy](../analysis-services/media/as-ragged-hierarchy.png)

В этом выпуске появилось свойство **Скрыть члены** . Свойству **Скрыть члены** иерархии можно присвоить значение **Скрыть пустые члены**.

![AS_Hide_Blank_Members](../analysis-services/media/as-hide-blank-members.png)

 >[!NOTE]
 > Пустые члены в модели представлены пустым значением DAX, а не пустой строкой.

Если задано значение **Скрыть пустые члены**и модель развернута, более удобную для восприятия версию иерархии можно просмотреть в таких клиентских средствах создания отчетов, как Excel.

![AS_Non_Ragged_Hierarchy](../analysis-services/media/as-non-ragged-hierarchy.png)


## <a name="detail-rows"></a>Строки детализации
Теперь можно определить настраиваемый набор строк, на основе которого формируется значение меры. Строки детализации похожи на действие детализации по умолчанию в многомерных моделях. Это позволяет конечным пользователям просматривать более подробные данные, чем на агрегированном уровне. 

На приведенной ниже сводной таблице представлен объем продаж в Интернете по годам из образца табличной модели Adventure Works. Вы можете щелкнуть правой кнопкой мыши ячейку с агрегированным значением меры, а затем выбрать пункт **Показать подробности** , чтобы просмотреть строки детализации.

![AS_Show_Details](../analysis-services/media/as-show-details.png)

По умолчанию отображаются связанные данные из таблицы продаж в Интернете. Такие ограниченные возможности зачастую бесполезны для пользователя, так как таблица может не содержать столбцы, включающие нужную информацию, например имя клиента и сведения о заказе. С помощью строк детализации можно указать свойство **Выражение свойств детализации** для мер.

#### <a name="detail-rows-expression-property-for-measures"></a>Свойство "Выражение строк детализации" для мер
Свойство **Выражение свойств детализации** для мер позволяет создателям моделей настраивать столбцы и строки, возвращаемые конечным пользователям.

![AS_Detail_Rows_Expression_Property](../analysis-services/media/as-detail-rows-expression-property.png)

[SELECTCOLUMNS](/dax/selectcolumns-function-dax) DAX функция обычно используется в выражении строк детализации. В приведенном ниже примере определяются столбцы, возвращаемые для строк в таблице продаж в Интернете в образце табличной модели Adventure Works.

```
SELECTCOLUMNS(
    'Internet Sales',
    "Customer First Name", RELATED( Customer[Last Name]),
    "Customer Last Name", RELATED( Customer[First Name]),
    "Order Date", 'Internet Sales'[Order Date],
    "Internet Total Sales", [Internet Total Sales]
)
```

Когда свойство определено и модель развернута, настраиваемый набор строк возвращается при выборе пользователем команды **Показать подробности**. Контекст фильтра выбранной ячейки учитывается автоматически. В этом примере отображаются только строки для значения 2010.

![AS_Detail_Rows](../analysis-services/media/as-detail-rows.png)

#### <a name="default-detail-rows-expression-property-for-tables"></a>Свойство "Выражение строк детализации по умолчанию" для таблиц
Так же как и меры, таблицы имеют свойство для определения выражения строк детализации. Свойство **Выражение строк детализации по умолчанию** используется по умолчанию для всех мер в таблице. Меры, которые не имеют собственное выражение наследует выражение из таблицы и Показать набор строк, определенный для таблицы. Это позволяет повторно использовать выражения, и новые меры, добавляемые в таблицу позднее, автоматически наследует выражение.

![AS_Default_Detail_Rows_Expression](../analysis-services/media/as-default-detail-rows-expression.png)
 
#### <a name="detailrows-dax-function"></a>Функция DAX DETAILROWS
В этом выпуске появилась функция DAX `DETAILROWS` , которая возвращает набор строк, определяемый выражением строк детализации. Она действует аналогично инструкции `DRILLTHROUGH` в MDX, которая также совместима с выражениями строк детализации, определенными в табличных моделях.

Приведенный ниже запрос DAX возвращает набор строк, определенный выражением строк детализации для меры или ее таблицы. Если выражение не определено, возвращаются данные таблицы продаж в Интернете, так как она содержит меру.

```
EVALUATE DETAILROWS([Internet Total Sales])
```

## <a name="object-level-security"></a>Безопасность на уровне объекта
В этом выпуске добавлена [безопасность на уровне объекта](../analysis-services/tabular-models/object-level-security.md) для таблиц и столбцов. Помимо ограничения доступа к данным таблиц и столбцов, можно защитить конфиденциальные имена таблиц и столбцов. Благодаря этому злоумышленник не сможет узнать о существовании этих таблиц.

Безопасность на уровне объекта необходимо задать с помощью метаданных на основе JSON, модель языка скриптов табличной (TMSL) или табличной модели объектов (TOM). 

Например, приведенный ниже код позволяет защитить таблицу Product в образце табличной модели Adventure Works путем присвоения свойству **MetadataPermission** класса **TablePermission** значения **None**.

```
//Find the Users role in Adventure Works and secure the Product table
ModelRole role = db.Model.Roles.Find("Users");
Table productTable = db.Model.Tables.Find("Product");
if (role != null && productTable != null)
{
    TablePermission tablePermission;
    if (role.TablePermissions.Contains(productTable.Name))
    {
        tablePermission = role.TablePermissions[productTable.Name];
    }
    else
    {
        tablePermission = new TablePermission();
        role.TablePermissions.Add(tablePermission);
        tablePermission.Table = productTable;
    }
    tablePermission.MetadataPermission = MetadataPermission.None;
}
db.Update(UpdateOptions.ExpandFull);
```

## <a name="dynamic-management-views-dmvs"></a>Динамические административные представления
[Динамические административные представления](../analysis-services/instances/use-dynamic-management-views-dmvs-to-monitor-analysis-services.md) запросов в SQL Server Profiler, которые возвращают сведения о локальных операциях сервера и исправности сервера.
Этот выпуск включает усовершенствования [динамические административные представления](https://docs.microsoft.com/sql/analysis-services/instances/use-dynamic-management-views-dmvs-to-monitor-analysis-services) (DMV) для табличных моделей на уровне совместимости 1200 и 1400.

[DISCOVER_CALC_DEPENDENCY](https://docs.microsoft.com/bi-reference/schema-rowsets/xml/discover-calc-dependency-rowset) теперь работает с табличными моделями 1200 и 1400. Табличные модели 1400 Показать зависимости между секцию M, M-выражений и структурированных источников данных. Дополнительные сведения см. в разделе [служб Analysis Services блог](https://blogs.msdn.microsoft.com/analysisservices/2017/07/17/whats-new-in-sql-server-2017-rc1-for-analysis-services/).

[MDSCHEMA_MEASUREGROUP_DIMENSIONS](https://docs.microsoft.com/bi-reference/schema-rowsets/ole-db-olap/mdschema-measuregroup-dimensions-rowset) включены улучшения для этого динамического административного Представления, который используется различными клиентскими средствами для отображения мер размерности. Например функцию "Проводник" в сводных таблицах Excel позволяет пользователю кросс drill для измерения, связанные с выбранной меры. Этот выпуск исправляет столбца количества элементов, которые ранее отображаются неправильные значения.

## <a name="dax-enhancements"></a>Улучшения DAX
Этот выпуск включает поддержку новых функций DAX и функциональные возможности. Чтобы можно было воспользоваться, необходимо использовать последнюю версию SSDT. Дополнительные сведения см. в разделе [новые DAX-функции](/dax/new-dax-functions).

Одна из наиболее важные части новые функции DAX — новый [оператор IN функциональную CONTAINSROW](/dax/in-operator-containsrow-function) для выражений DAX. Она аналогична оператору [`TSQL IN`](https://msdn.microsoft.com/library/ms177682.aspx) , обычно используемому для указания нескольких значений в предложении `WHERE` .

Ранее многозначные фильтры обычно задавались с помощью логического оператора `OR` , как в следующем выражении меры:

```
Filtered Sales:=CALCULATE (
        [Internet Total Sales],
                 'Product'[Color] = "Red"
            || 'Product'[Color] = "Blue"
            || 'Product'[Color] = "Black"
    )
```

С помощью оператора `IN` это стало проще:
```
Filtered Sales:=CALCULATE (
        [Internet Total Sales], 'Product'[Color] IN { "Red", "Blue", "Black" }
    )
```

В этом случае оператор `IN` ссылается на таблицу с одним столбцом и тремя строками — по одному из каждых указанных цветов. Обратите внимание на то, что синтаксис конструктора таблицы предусматривает использование фигурных скобок.

Оператор `IN` функционально эквивалентен функции `CONTAINSROW` .
```
Filtered Sales:=CALCULATE (
        [Internet Total Sales], CONTAINSROW({ "Red", "Blue", "Black" }, 'Product'[Color])
    )
```

Оператор `IN` также можно эффективно использовать с конструкторами таблиц. Например, следующая мера выполняет фильтрацию по сочетанию цвета и категории продукта:
```
Filtered Sales:=CALCULATE (
        [Internet Total Sales],
        FILTER( ALL('Product'),
              ( 'Product'[Color] = "Red"   && Product[Product Category Name] = "Accessories" )
         || ( 'Product'[Color] = "Blue"  && Product[Product Category Name] = "Bikes" )
         || ( 'Product'[Color] = "Black" && Product[Product Category Name] = "Clothing" )
        )
    )
```

Благодаря новому оператору `IN` приведенное выше выражение меры эквивалентно следующему:
```
Filtered Sales:=CALCULATE (
        [Internet Total Sales],
        FILTER( ALL('Product'),
            ('Product'[Color], Product[Product Category Name]) IN
            { ( "Red", "Accessories" ), ( "Blue", "Bikes" ), ( "Black", "Clothing" ) }
        )
    )
```

## <a name="additional-improvements"></a>Дополнительные улучшения
Помимо всех новых функций служб Analysis Services, SSDT и SSMS также включены следующие улучшения:

* Повторное использование иерархии и столбца отображается на более полезные расположений в списке полей Power BI.
* Дата отношения для простого создания связи с измерениями даты, на основе полей дат.
* Параметр установки по умолчанию для служб Analysis Services теперь находится в табличном режиме.
* Новые источники данных для получения данных (Power Query).
* Редактор DAX для SSDT.
* Для запросов M поддерживают источники данных DirectQuery.
* Усовершенствования SSMS, такие как просмотр, редактирование и сценарии для структурированных источников данных.



## <a name="see-also"></a>См. также
[Заметки о выпуске SQL Server 2017](../sql-server/sql-server-2017-release-notes.md)   
[Что нового в SQL Server 2017](../sql-server/what-s-new-in-sql-server-2017.md)
