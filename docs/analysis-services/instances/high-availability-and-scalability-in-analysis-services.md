---
title: Высокая доступность и масштабируемость в службах Analysis Services | Документация Майкрософт
ms.date: 05/02/2018
ms.prod: sql
ms.technology: analysis-services
ms.custom: ''
ms.topic: conceptual
ms.author: owend
ms.reviewer: owend
author: minewiskan
manager: kfile
ms.openlocfilehash: 09fc0a9d9814a399d679b1391678fb5e11ad8a3f
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "68181518"
---
# <a name="high-availability-and-scalability-in-analysis-services"></a>Высокий уровень доступности и масштабируемость в службах Analysis Services
[!INCLUDE[ssas-appliesto-sqlas](../../includes/ssas-appliesto-sqlas.md)]
  В этой статье описаны наиболее часто используемые методы для создания баз данных служб Analysis Services, высокой доступности и масштабируемости. Несмотря на то что к каждой цели можно обращаться отдельно, в реальности они часто идут рука об руку: от масштабируемого развертывания больших рабочих нагрузок по выполнению запросов или обработке данных обычно ожидается высокая доступность.  
  
 А вот обратное верно не всегда. Высокий уровень доступности без масштабирования может быть единственной целью при наличии строгих соглашений об уровне обслуживания для критически важных, но умеренных рабочих нагрузок по выполнению запросов.  
  
 Для всех режимов серверов (многомерного, табличного и режима интеграции с SharePoint) используются одни и те же методы обеспечения высокой доступности и масштабируемости служб Analysis Services. Если не указано иное, предполагается, что информация в этой статье относится к всем режимам.  
  
## <a name="key-points"></a>Основные моменты  
 Поскольку методы обеспечения высокой доступности и масштабируемости отличаются от методов ядра реляционной базы данных, краткое описание основных моментов позволит быстро ознакомиться с методами, которые используются в службах Analysis Services.  
  
-   В службах Analysis Services используются механизмы высокой доступности и масштабируемости, встроенные в платформу сервера Windows: балансировка нагрузки сети (NLB), отказоустойчивая кластеризация Windows Server или оба.  
  
    > [!NOTE]  
    >  Функция Always On ядра реляционной базы данных не распространяется на службы Analysis Services.  Экземпляр служб Analysis Services нельзя настроить для работы в группе доступности Always On.  
    >   
    >  Несмотря на то что службы Analysis Services не выполняются в группах доступности AlwaysOn, они могут извлекать и обрабатывать данные из реляционной базы данных Always On. Инструкции по настройке высокодоступной реляционной базы данных для использования со службами Analysis Services см. в разделе [Службы Analysis Services с группами доступности AlwaysOn](../../database-engine/availability-groups/windows/analysis-services-with-always-on-availability-groups.md).  
  
-   Если единственной целью является высокий уровень доступности, она может быть достигнута за счет избыточности в отказоустойчивом кластере. Предполагается, что сменные узлы имеют такую же конфигурацию аппаратного и программного обеспечения, как у активного узла.  Отказоустойчивая кластеризация Windows Server обеспечивает высокий уровень доступности, но без масштабирования.  
  
-   Масштабируемость (c доступностью или без) достигается с помощью NLB в базах данных только для чтения.  Масштабируемость обычно играет роль, если объем запросов велик или подвергается внезапным пиковым нагрузкам.  
  
     В сочетании с несколькими базами данных, доступными только для чтения, балансировка нагрузки обеспечивает и масштабирование, и высокую доступность, поскольку все узлы активны, а при отказе одного сервера запросы автоматически перераспределяются между остальными узлами. Если вам требуется и масштабируемость, и высокая доступность, выбирайте NLB-кластер.  
  
 С точки зрения обработки масштабируемость и высокий уровень доступности не так важны, поскольку время выполнения и объем операций вы контролируете сами. Обработка может быть частичной или добавочной, распределенной между разными частями модели, однако в какой-то момент модель необходимо будет полностью обработать на одном сервере, обеспечив, таким образом, согласованность данных между всеми индексами и агрегатами. В основе надежной масштабируемой архитектуры лежит оборудование, способное выполнять всю обработку в любом необходимом ритме. Для больших решений эта работа структурируется как независимая операция с собственными аппаратными ресурсами.  
  
##  <a name="bkmk_serverconfig"></a> Сравнение конфигураций с одним или несколькими серверами  
 В обычном развертывании с одним сервером рабочие нагрузки по обработке данных и запросам выполняются одновременно при условии, что ресурсов системы для этого достаточно. Для поддержки запросов службы Analysis Services сохраняют существующие структуры данных неизменными, пока обновленная версия обрабатывается в фоновом режиме. Во всех режимах сервера существует аппаратное требование о наличии достаточного объема памяти и дискового пространства для обработки временных структур данных, хотя каждый режим предъявляет разные требования к системным ресурсам и имеет разную степень готовности к NUMA.  
  
 **Одиночные серверы и масштабируемость**  
  
 Одиночный высокопроизводительный, многоядерный сервер должен обеспечивать достаточный уровень масштабируемости сам по себе. Теоретически в высокопроизводительной системе с большим числом ядер, ОЗУ и дисковым пространством можно увеличить масштаб отдельной системы.  
  
 В случае многомерных баз данных свойства конфигурации сервера можно изменить таким образом, чтобы между процессами и процессорами возникла взаимосвязь. Подробнее см. в разделе [Thread Pool Properties](../../analysis-services/server-properties/thread-pool-properties.md) .  
  
 **Развертывания в конфигурации с несколькими серверами**  
  
 Операционные требования могут предписывать использование сразу нескольких серверов. Например, отказоустойчивые кластеры по определению включают несколько серверов, причем каждый узел работает в одной и той же конфигурации аппаратного и программного обеспечения.  
  
 Аналогичным образом, если для выполнения рабочих нагрузок запросов требуется высокая доступность, необходимо использовать несколько серверов. В этом сценарии рекомендуемая конфигурация служб Analysis Services — это комбинация баз данных, доступных только для чтения и для чтения и записи и выполняемых в разных экземплярах служб Analysis Services на выделенном для этого оборудовании. Базы данных, доступные только для чтения, обрабатывают запросы. Базы данных, доступные только для записи, используются для обработки. В следующем разделе приводится расширенное описание этого наиболее часто используемого метода.  
  
 **Виртуальные машины и высокий уровень доступности**  
  
 Другая стратегия удовлетворения требования о высоком уровне доступности может включать применение виртуальных машин. Если доступность обеспечивает резервный сервер, подготовка которого занимает не минуты, а часы, можно использовать виртуальные машины, запускаемые по запросу и заполняемые обновленными базами данных, полученными из централизованного расположения.  
  
## <a name="scalability-using-read-only-and-read-write-databases"></a>Масштабируемость с использованием баз данных, доступных только для чтения и для чтения и записи  
 Для эскалации рабочих нагрузок по запросам и обработке рекомендуется использовать балансировку сетевой нагрузки. Базы данных служб Analysis Services в решении с балансировкой сетевой нагрузки должны быть определены как базы данных, доступные только для чтения, чтобы обеспечить согласованность различных запросов.  
  
 Хотя рекомендации в статье [Горизонтальное масштабирование запросов для служб Analysis Services с использованием баз данных, доступных только для чтения](https://technet.microsoft.com/library/ff795582\(v=sql.100\).aspx) (опубликованной в 2008 году), устарели, в целом они по-прежнему действительны. Несмотря на то что операционные системы и компьютерное оборудование эволюционировали, а ссылки на конкретные платформы и ограничения ЦПУ больше не актуальны, основной метод использования баз данных, доступных только для чтения или для чтения и записи, для больших объемов данных по запросам остался неизменным.  
  
 Этот метод можно описать следующим образом.  
  
-   Для обработки базы данных используется выделенное оборудование и экземпляры служб Analysis Services. По завершении обработки база данных переводится в режим доступности только для чтения. Инструкции см. в разделе [Switch an Analysis Services database between ReadOnly and ReadWrite modes](../../analysis-services/multidimensional-models/switch-an-analysis-services-database-between-readonly-and-readwrite-modes.md) .  
  
-   Одна и та же база данных служб Analysis Services, доступная только для чтения, выполняется сразу на нескольких одинаковых серверах запросов. Серверы развертываются в кластере NLB, а доступ к ним осуществляется по одному имени виртуального сервера, который служит единой точкой входа в кластер.  
  
-   Для копирования всего каталога данных с сервера обработки на каждый сервер запросов и присоединения одной и той же базы данных в режиме только для чтения ко всем серверам запросов используется robocopy. Можно использовать моментальные снимки SAN, синхронизацию или любой другой инструмент или метод, применяемый для перемещения производственных баз данных.  
  
## <a name="resource-demands-for-tabular-and-multidimensional-workloads"></a>Требования к ресурсам для табличных и многомерных рабочих нагрузок  
 В следующей таблице представлены полные сведения о том, каким образом службы Analysis Services используют системные ресурсы для запросов и обработки в зависимости от режима сервера и хранилища. Они помогут вам понять, на что нужно обратить внимание в многосерверной среде, обрабатывающей распределенную рабочую нагрузку.  
  
|||  
|-|-|  
|**Сервер и режим хранения**|**Влияние на системный ресурс**|  
|Табличная рабочая нагрузка в памяти (по умолчанию), где запросы выполняются как табличное сканирование структуры данных в памяти.|Выделяет ОЗУ и ЦПУ с высокой тактовой частотой.|  
|Табличная рабочая нагрузка в режиме DirectQuery, где запросы переносятся на резервные серверы реляционных баз данных, а обработка ограничивается построением метаданных в модели.|Акцент на производительность реляционной базы данных, уменьшение задержки в сети и максимальное увеличение пропускной способности. Более быстрый ЦПУ может, помимо прочего, повысить производительность обработчика запросов для служб Analysis Services.|  
|Многомерные модели с использованием хранилища MOLAP|Выбор сбалансированной конфигурации, включающей дисковые операции ввода-вывода для быстрой загрузки данных и достаточный объем ОЗУ для хранения кэшированных данных.|  
|Многомерные модели с использованием хранилища ROLAP|Максимальное число дисковых операций ввода-вывода и минимальная задержка в сети.|  
  
## <a name="high-availability-and-redundancy-through-wsfc"></a>Высокий уровень доступности и избыточности с помощью WSFC  
 Службы Analysis Services можно установить в существующий отказоустойчивый кластер (WSFC) — это обеспечит высокий уровень доступности, позволяющий восстановить службу в кратчайшие сроки.  
  
 Отказоустойчивые кластеры предоставляют полный доступ (чтение и обратная запись) к базе данных, но только по одному узлу за раз. Базы данных-получатели выполняются на дополнительных узлах в кластере, которые выступают как резервные серверы в случае отказа первого узла.  
  
 Основное преимущество отказоустойчивой кластеризации — это быстрое восстановление после отказа службы. Это преимущество связано с некоторыми ограничениями. Во-первых, пока отработка отказа не требуется, выделенные ресурсы кластера бездействуют. Во-вторых, при отработке отказа все подключения сбрасываются, а незафиксированная работа пропадает. Большинство клиентских приложений смогут справиться с такой ситуацией. Чаще всего при нажатии кнопки обновления приложение вернет все результаты. 
 
 При рассмотрении WSFC учитывайте следующие моменты:

- Режим "активный/активный" в данный момент не поддерживается. Режим "активный/пассивный (отказоустойчивый)" — единственная поддерживаемая конфигурация WSFC для служб Analysis Services.
- При кластеризации служб Analysis Services убедитесь, что все узлы в кластере работают на одинаковом или схожем оборудовании и имеют одинаковый операционный контекст — версию и пакеты обновления операционной системы, версию и пакеты обновления (или накопительные обновления) служб Analysis Services и режим сервера.
- Старайтесь не использовать пассивный узел как активный узел с другой рабочей нагрузки. Если в экстренной ситуации узел не справится с обоими потоками рабочей нагрузки, достигнутое повышение производительности компьютера потеряет смысл.
 
 В этом техническом документе предоставлены подробные инструкции и справочные сведения по развертыванию служб Analysis Services в отказоустойчивом кластере: [Кластеризация SQL Server Analysis Services](https://msdn.microsoft.com/library/dn736073.aspx). Это руководство написано для SQL Server 2012, однако применяется и к более новым версиям служб Analysis Services.  
  
## <a name="see-also"></a>См. также  
 [Синхронизация баз данных служб Analysis Services](../../analysis-services/multidimensional-models/synchronize-analysis-services-databases.md)   
 [Принудительное установление связь NUMA для табличных баз данных служб Analysis Services](https://blogs.msdn.microsoft.com/sqlcat/2013/11/05/forcing-numa-node-affinity-for-analysis-services-tabular-databases/)   
 [Для служб Analysis Services практический пример: Использование табличных моделей в крупномасштабных коммерческих решениях](https://msdn.microsoft.com/library/dn751533.aspx)  
  
  
