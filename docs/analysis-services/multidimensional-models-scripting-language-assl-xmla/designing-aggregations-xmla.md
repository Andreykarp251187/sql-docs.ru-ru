---
title: Проектирование агрегатов (XMLA) | Документация Майкрософт
ms.date: 05/02/2018
ms.prod: sql
ms.technology: analysis-services
ms.custom: xmla
ms.topic: conceptual
ms.author: owend
ms.reviewer: owend
author: minewiskan
manager: kfile
ms.openlocfilehash: b9f681b3c99bd0e8351a844f28b16be6249de199
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "63288495"
---
# <a name="designing-aggregations-xmla"></a>Создание агрегатов (XMLA)
  Статические схемы связываются с секциями определенных групп мер, чтобы эти секции при хранении агрегатов использовали одинаковую структуру. Используя ту же структуру хранилища для секций позволяет легко определить секции, которые могут быть объединены с помощью [MergePartitions](https://docs.microsoft.com/bi-reference/xmla/xml-elements-commands/mergepartitions-element-xmla) команды. Дополнительные сведения о статистических схем см. в разделе [агрегаты и статистические схемы](../../analysis-services/multidimensional-models-olap-logical-cube-objects/aggregations-and-aggregation-designs.md).  
  
 Чтобы определить агрегаты для статистической схемы, можно использовать [DesignAggregations](https://docs.microsoft.com/bi-reference/xmla/xml-elements-commands/designaggregations-element-xmla) в XML для аналитики (XMLA) команду. **DesignAggregations** команда имеет свойства, которые определяют, какая статическая схема для использования в качестве ссылки и способы управления процессом проектирования по этой ссылке. С помощью **DesignAggregations** команда и его свойства, можно спроектировать агрегаты последовательно или в пакете и затем просмотреть итоговую статистику создания для оценки процесса проектирования.  
  
## <a name="specifying-an-aggregation-design"></a>Задание статистической схемы  
 [Объект](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/object-element-xmla) свойство **DesignAggregations** команды должен содержать ссылку на объект для существующей статистической схемой. Ссылка содержит идентификаторы базы данных, куба, группы мер и статистической схемы. Если этой статистической схемы еще не существует, то возникнет ошибка.  
  
## <a name="controlling-the-design-process"></a>Управление процессом проектирования  
 Можно использовать следующие свойства **DesignAggregations** команду, чтобы управлять алгоритм, используемый для определения агрегатов для статистической схемы:  
  
-   [Действия](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/steps-element-xmla) свойство определяет, сколько итераций **DesignAggregations** должна выполнить команда, перед возвратом управления клиентскому приложению.  
  
-   [Время](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/time-element-xmla) свойство определяет, сколько миллисекунд **DesignAggregations** должна выполнить команда, перед возвратом управления клиентскому приложению.  
  
-   [Оптимизации](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/optimization-element-xmla) свойство определяет процент улучшения производительности **DesignAggregations** команду следует попытаться достигнуть. При итеративном проектировании агрегатов это свойство необходимо передавать только в первой команде.  
  
-   [Хранения](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/storage-element-xmla) свойство определяет предполагаемый объем дискового пространства, в байтах, используемой **DesignAggregations** команды. При итеративном проектировании агрегатов это свойство необходимо передавать только в первой команде.  
  
-   [Материализовать](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/materialize-element-xmla) свойство определяет, является ли **DesignAggregations** команда должна создавать агрегаты, определенные во время проектирования. При последовательном проектировании агрегатов на время, пока они ни будут готовы к сохранению, этому свойству следует присвоить значение FALSE. При присваивании этому свойству значения TRUE текущий процесс проектирования завершается, а определенные агрегаты добавляются в указанную статистическую схему.  
  
## <a name="specifying-queries"></a>Задание запросов  
 DesignAggregations поддержка оптимизации с учетом использования команды, добавив один или несколько **запроса** элементов в [запросы](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/queries-element-xmla) свойство. **Запросы** свойство может содержать один или несколько [запроса](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/query-element-xmla) элементов. Если **запросы** не содержит свойство **запроса** задано статистическая схема элементов, в **объекта** элемент использует по умолчанию структура, содержащая общий набор агрегатов. Этот общий набор агрегатов разработана для удовлетворения критериев, заданных в **оптимизации** и **хранения** свойства **DesignAggregations** команды.  
  
 Каждый элемент **Query** представляет собой целевой запрос, с помощью которого при проектировании можно определить агрегаты, охватывающие наиболее часто используемые запросы. Можно определить целевые запросы самостоятельно, либо при помощи данных, сохраненных экземпляром служб [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] в журнале запросов, получить сведения о наиболее часто используемых запросах. Мастер оптимизации с учетом использования извлекает целевые запросы на основе времени, использования или указанного пользователя при отправке с помощью журнала запросов **DesignAggregations** команды. Дополнительные сведения см. в разделе [основано на использовании Справка F1 мастера оптимизации](http://msdn.microsoft.com/library/e5f5a938-ae7c-4f4e-9416-a7f94ac82763).  
  
 При многократном проектировании агрегатов поисковые запросы необходимо передать только в первой команде **DesignAggregations** , поскольку экземпляр служб [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] сохраняет целевые запросы и использует их при выполнении последующих команд **DesignAggregations** . После передачи целевых запросов в первой команде **DesignAggregations** многократной обработки, любые последующие команды **DesignAggregations** , в свойстве **Queries** которых содержатся поисковые запросы, приведут к формированию ошибки.  
  
 Элемент **Query** содержит значение с разделителями-запятыми, включающее следующие аргументы.  
  
 *Frequency*,*Dataset*[,*Dataset*...]  
  
 *Частота*  
 Весовой коэффициент, соответствующий количеству предыдущих выполнений данного запроса. Если элемент **Query** представляет новый запрос, значение *Frequency* представляет весовой коэффициент, использованный во время проектирования в целях оценки запроса. По мере увеличения частоты, увеличивается и вес, присвоенный запросу во время проектирования.  
  
 *Набор данных*  
 Числовая строка, определяющая атрибуты измерения, включаемые в запрос. Количество символов в данной строке должно совпадать с количеством атрибутов в измерении. Ноль (0) обозначает, что атрибут, находящийся на указанной порядковой позиции, в запрос для указанного измерения не включается, тогда как единица (1) обозначает включение атрибута, находящегося на указанной порядковой позиции, в запрос для указанного измерения.  
  
 Так, например, строка «011» относится к запросу, в котором задействовано измерение с тремя атрибутами, причем в запрос включены только второй и третий атрибут.  
  
> [!NOTE]  
>  Некоторые атрибуты не рассматриваются в наборе данных. Дополнительные сведения об исключенных атрибутах см. в разделе [элемент запроса &#40;XMLA&#41;](https://docs.microsoft.com/bi-reference/xmla/xml-elements-properties/query-element-xmla).  
  
 Каждое измерение в группе мер, включающее статистическую схему, представлено значением *Dataset* в элементе **Query** . Порядок значений *Dataset* должен соответствовать порядку измерений, включенных в группу мер.  
  
## <a name="designing-aggregations-using-iterative-or-batch-processes"></a>Проектирование агрегатов при помощи последовательного или пакетного процесса  
 Можно использовать **DesignAggregations** команды в составе итеративного или пакетного процесса, в зависимости от интерактивные возможности, необходимые во время проектирования.  
  
### <a name="designing-aggregations-using-an-iterative-process"></a>Проектирование агрегатов при помощи последовательного процесса  
 Чтобы проектировать агрегаты последовательно, отправляют несколько **DesignAggregations** команд для точного управления процессом проектирования. Мастер статистических схем использует этот же подход для точного управления процессом проектирования. Дополнительные сведения см. в разделе [статистической обработки Справка F1 мастера](http://msdn.microsoft.com/library/39e23cf1-6405-4fb6-bc14-ba103314362d).  
  
> [!NOTE]  
>  Для последовательного проектирования агрегатов требуется явный сеанс. Дополнительные сведения о явных сеансах см. в разделе [Управление соединениями и сеансами &#40;XMLA&#41;](../../analysis-services/multidimensional-models-scripting-language-assl-xmla/managing-connections-and-sessions-xmla.md).  
  
 Чтобы начать последовательный процесс, сначала отправьте **DesignAggregations** команду, которая содержит следующие сведения:  
  
-   **Хранения** и **оптимизации** значения свойств, на который нацелена всего процесса проектирования.  
  
-   **Действия** и **время** значения свойств, на которых ограничено первый шаг процесса проектирования.  
  
-   Если необходима оптимизация на основе использования **запросы** запрашивает свойство, содержащее цель на целевые всего процесса проектирования.  
  
-   **Материализовать** свойство, значение false. Присваивание этому свойству значения FALSE показывает, что по завершении этой команды процесс проектирования не будет сохранять определенные агрегаты в статистической схеме.  
  
 При первом **DesignAggregations** завершения команды, команда возвращает набор строк, содержащий статистику проектирования. Оценка этих данных позволит определить, следует ли продолжать процесс проектирования или же его необходимо завершить. Если процесс стоит продолжить, затем следует отправить другой **DesignAggregations** команду, которая содержит **действия** и **время** значения, с которыми этот шаг разработки обработка ограничено. После этого производится оценка итоговой статистики и определяется, следует ли продолжать процесс проектирования. Такой последовательный процесс отправки **DesignAggregations** команды и оценки результатов продолжается до достижения поставленных целей и иметь соответствующий набор определенных агрегатов.  
  
 После достижения набор агрегатов, которые вы хотите, отправляется одна завершающая **DesignAggregations** команды. Этой конечной **DesignAggregations** команды должны иметь его **действия** свойство, значение 1 и его **материализовать** свойством, имеющим значение true. С помощью этих параметров, завершающая **DesignAggregations** команда заканчивает процесс проектирования и сохраняет определенный агрегат в статистической.  
  
### <a name="designing-aggregations-using-a-batch-process"></a>Проектирование агрегатов при помощи пакетного процесса  
 Можно также создать статистические выражения в рамках пакетного процесса путем отправки одной **DesignAggregations** команду, которая содержит **действия**, **время**, **хранилища** , и **оптимизации** значения свойств, на которых целевые и ограниченную всего процесса проектирования. Если необходима оптимизация на основе использования, поисковые запросы, на которых являются целью процесса проектирования также должна быть включена в **запросы** свойство. Также убедитесь, что **материализовать** свойство имеет значение true, таким образом, чтобы процесс проектирования сохранил определенные агрегаты в статистической завершения команды.  
  
 Пакетный процесс позволяет проектировать агрегаты как в рамках явного, так и неявного сеанса. Дополнительные сведения о явных и неявных сеансах см. в разделе [Управление соединениями и сеансами &#40;XMLA&#41;](../../analysis-services/multidimensional-models-scripting-language-assl-xmla/managing-connections-and-sessions-xmla.md).  
  
## <a name="returning-design-statistics"></a>Возврат статистики проектирования  
 Когда **DesignAggregations** команда возвращает элемент управления клиентскому приложению, команда возвращает набор строк, содержащий одну строку, в которой представлена Статистика проектирования для команды. Набор строк содержит столбцы, перечисленные в следующей таблице.  
  
|Столбец|Data type|Описание|  
|------------|---------------|-----------------|  
|Шаги|Целочисленный|Число шагов, выполняемых командой перед возвратом управления клиентскому приложению.|  
|Time|Long integer|Время (в миллисекундах), прошедшее до того момента, когда команда вернула управление клиентскому приложению.|  
|Optimization|Double|Примерный процент прироста производительности, достигнутый командой перед возвратом управления клиентскому приложению.|  
|Память|Long integer|Примерный объем в байтах, занятый командой перед возвратом управления клиентскому приложению.|  
|Aggregations|Long integer|Число статических схем, определенных командой перед возвратом управления клиентскому приложению.|  
|LastStep|Логическое значение|Указывает, представляют ли данные в наборе строк последний шаг в процессе проектирования. Если **материализовать** команды было установлено на значение равно true, значение этого столбца задано значение true.|  
  
 Можно использовать Статистика проектирования, которые содержатся в наборе строк, возвращаемом после выполнения каждой **DesignAggregations** команды в обоих итеративный и при пакетном проектировании. При последовательном проектировании она может использоваться для определения и отображения хода выполнения. При проектировании агрегатов в пакетном режиме эту статистику можно использовать для определения количества агрегатов, созданных командой.  
  
## <a name="see-also"></a>См. также  
 [Разработка с использованием XMLA в службах Analysis Services](../../analysis-services/multidimensional-models-scripting-language-assl-xmla/developing-with-xmla-in-analysis-services.md)  
  
  
