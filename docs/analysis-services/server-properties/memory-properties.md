---
title: Свойства памяти служб Analysis | Документация Майкрософт
ms.date: 03/15/2019
ms.prod: sql
ms.technology: analysis-services
ms.custom: ''
ms.topic: conceptual
ms.author: owend
ms.reviewer: owend
author: minewiskan
manager: kfile
ms.openlocfilehash: b33bf47f77d65679bc079b526d480841af71c0c4
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "62714441"
---
# <a name="memory-properties"></a>Свойства памяти
[!INCLUDE[ssas-appliesto-sqlas-all-aas](../../includes/ssas-appliesto-sqlas-all-aas.md)]

  Службы Analysis Services предварительно выделяет небольшой объем памяти при запуске, чтобы запросы могли выполняться незамедлительно. Дополнительная память выделяется по мере увеличения числа запросов и рабочей нагрузки. 
  
  С помощью параметров конфигурации можно контролировать пороговые уровни нагрузки, при которых будет выделяться дополнительная память. Например, параметр **HardMemoryLimit** задает принудительное состояние нехватки памяти (по умолчанию этот порог неактивен), при котором запросы отклоняются до тех пор, пока не будет доступно больше ресурсов.

Дополнительные сведения о максимальный объем используемой памяти на экземпляр SQL Server Analysis Services в выпуске, см. в разделе [выпуски и поддерживаемые функции SQL Server](../../sql-server/editions-and-components-of-sql-server-2017.md#Cross-BoxScaleLimits).
  
 Следующие параметры применимы к серверам табличные и многомерные, если не указано иное.  
 
## <a name="default-memory-configuration"></a>Конфигурация памяти по умолчанию

Конфигурация по умолчанию каждый экземпляр служб Analysis Services выделяет небольшой объем ОЗУ (40 МБ до 50 МБ) при запуске, даже если экземпляр неактивен. 

Помните, что параметры конфигурации задаются для каждого экземпляра отдельно. Если вы используете несколько экземпляров служб Analysis Services, например, табличный и многомерный экземпляры одного и того же оборудования, каждый экземпляр получает собственный объем памяти независимо от других экземпляров.

В приведенной ниже таблице дается краткое описание самых распространенных параметров памяти (более подробные сведения см. в справочнике). Настройте следующие параметры только в том случае, если службы Analysis Services делят ресурсы памяти с другими приложениями на одном сервере.

Параметр | Описание
--------|------------
LowMemoryLimit | Нижнее пороговое значение, при достижении которого сервер начинает высвобождать память, выделенную редко используемым объектам (для многомерных экземпляров).
VertiPaqMemoryLimit | Нижнее пороговое значение, при достижении которого сервер начинает высвобождать память, выделенную редко используемым объектам (для табличных экземпляров).
TotalMemoryLimit | Верхнее пороговое значение, при достижении которого службы Analysis Services начинают высвобождать память более агрессивно, чтобы освободить место для уже выполняемых запросов и запросов, имеющих высокий приоритет. 
HardMemoryLimit | Еще одно пороговое значение, при достижении которого службы Analysis Services начинают отклонять поступающие запросы из-за нехватки памяти. 
 
## <a name="property-reference"></a>Справочник по свойствам

Указанные ниже свойства относятся к табличному и многомерному режимам (если не указано иное).

 Значения в диапазоне от 1 до 100 представляют процент **общего объема физической памяти** или **виртуального адресного пространства**в зависимости от того, какое значение меньше. Значения, превышающие 100, представляют собой ограничения памяти в байтах.
  
 **LowMemoryLimit**  
 64-разрядное свойство со значением двойной точности с плавающей запятой, определяющий первое пороговое значение, по которому службы Analysis Services начинают освобождать память для объектов с низким приоритетом, например, редко используемого кэша. Сервер не выделяет память сверх установленного этим свойством лимита. Значение по умолчанию равно 65, то есть предел недостатка памяти составляет 65 % от объема физической памяти или виртуального адресного пространства (в зависимости от того, какое значение меньше).  
  
 **TotalMemoryLimit**  
 Определяет порог, при достижении которого сервер начинает перераспределять память, освобождая место для других запросов. При достижении этого ограничения экземпляр начнет постепенно очищать память из кэшей, закрывая истекшие сеансы и выгружая неиспользуемые вычисления. Значение по умолчанию равно 80 % от объема физической памяти или виртуального адресного пространства (в зависимости от того, какое значение меньше). **TotalMemoryLimit** всегда должен быть меньше, чем **HardMemoryLimit**  
  
 **HardMemoryLimit**  
 Задает порог памяти, после достижения которого экземпляр агрессивно прерывает активные сеансы пользователей, чтобы уменьшить использование памяти. Всех завершенных сеансах будет получена ошибка о отменяемого за нехватки памяти. Значение по умолчанию 0 означает, что для параметра **HardMemoryLimit** будет задано среднее значение между **TotalMemoryLimit** и общим объемом физической памяти системы. Если объем физической памяти системы превышает объем виртуального адресного пространства процесса, то при вычислении параметра **HardMemoryLimit**вместо физической памяти используется виртуальное адресное пространство.  

**QueryMemoryLimit**   
Azure Analysis Services. Дополнительное свойство для управления, сколько памяти можно использовать временных результатов во время запроса. Применяется только к меры DAX и запросы. Не учитывает для выделения общей памяти, используемые для запроса. Указан в процентах до 100. Кроме того, она представлена в байтах. Указывается при установке значения 0 означает отсутствие ограничений. Для анализа Azure значение по умолчанию определяется плана. 

|План  |Значение по умолчанию  |
|---------|---------|
|D1     |   80      |
|Все другие планы     |    20     | 

 **VirtualMemoryLimit**  
  Дополнительное свойство, которое следует изменять только под руководством службы поддержки [!INCLUDE[msCoName](../../includes/msconame-md.md)] .  
  
 **VertiPaqPagingPolicy**  
  Определяет использование подкачки в случае, если серверу не хватает памяти (только для табличных экземпляров). Допустимы следующие значения:  
  
Параметр  |Описание  
---------|---------
**0**     |  (по умолчанию для служб Azure Analysis Services) Отключает механизм подкачки страниц. При недостатке памяти обработка прерывается с ошибкой нехватки памяти. Если подкачка запрещена, вы должны предоставить права доступа Windows учетной записи службы. Инструкции см. в разделе [Настройка учетных записей служб (службы Analysis Services)](../../analysis-services/instances/configure-service-accounts-analysis-services.md). 
**1**     |  (по умолчанию для SQL Server Analysis Services) Данное свойство разрешает подкачку на диск с использованием файла подкачки операционной системы (pagefile.sys).   
  
Если задано значение 1, то ошибки обработки вследствие ограничений памяти менее вероятны, поскольку сервер использует подкачку на диск по указанному методу. Установка свойства **VertiPaqPagingPolicy** не гарантирует полное отсутствие ошибок памяти. Ошибки нехватки памяти по-прежнему могут возникать при следующих условиях.  
  
-   Недостаточно памяти для всех словарей. Во время обработки, сервер блокирует словари для каждого столбца в памяти, а также всех словарей не может превышать значение, указанное для **VertiPaqMemoryLimit**.  
  
-   Недостаточно виртуального адресного пространства для процесса.  
  
 Чтобы устранить постоянные ошибки памяти, можно изменить структуру модели, чтобы сократить объем данных, нуждающихся в обработке, или увеличить объем физической памяти на компьютере.  
  
 **VertiPaqMemoryLimit**  
 Если подкачка на диск разрешена, это свойство задает уровень использования памяти (в процентах от общего объема памяти), при котором начинается подкачка (только для табличных экземпляров). Значение по умолчанию равно 60. Если память используется менее чем на 60 процентов, сервер не осуществляет подкачку на диск. Это свойство зависит от свойства **VertiPaqPagingPolicyProperty**, которое должно быть равно 1, чтобы подкачка происходила.  
  
 **HighMemoryPrice**  
 Дополнительное свойство, которое следует изменять только под руководством службы поддержки [!INCLUDE[msCoName](../../includes/msconame-md.md)] .  
  
 **MemoryHeapType**  
  Дополнительное свойство, которое следует изменять только под руководством службы поддержки [!INCLUDE[msCoName](../../includes/msconame-md.md)] . Ниже приведены допустимые значения в службах Analysis Services в SQL Server 2016 с пакетом обновления 1 (SP1) и более поздних версий.
  
  Параметр | Описание
--------|------------
**-1** | Automatic (по умолчанию). Подсистема самостоятельно определяет, что следует использовать.
**1** | Куча служб Analysis Services.
**2** | Куча Windows с низкой степенью фрагментации (LFH).
**5** | Гибридный распределитель. Этот механизм распределения будет использовать LFH Windows для \<= выделение 16 КБ и кучу AS для > выделение 16 КБ. 
**6** | Распределитель Intel TBB. Доступен в службах Analysis Services в SQL Server 2016 с пакетом обновления 1 (SP1) и более поздних версий.
  
  
 **HeapTypeForObjects**  
  Дополнительное свойство, которое следует изменять только под руководством службы поддержки [!INCLUDE[msCoName](../../includes/msconame-md.md)] . Допустимы следующие значения:
  
   Параметр | Описание
--------|------------
**-1** | Automatic (по умолчанию). Подсистема самостоятельно определяет, что следует использовать.
**0** | Куча LFH Windows.
**1** | Распределитель слотов Analysis Services.
**3** | Каждый объект имеет свою собственную кучу Analysis Services.

 
 **DefaultPagesCountToReuse**  
 Дополнительное свойство, которое следует изменять только под руководством службы поддержки [!INCLUDE[msCoName](../../includes/msconame-md.md)] .  
  
 **HandleIA64AlignmentFaults**  
 Дополнительное свойство, которое следует изменять только под руководством службы поддержки [!INCLUDE[msCoName](../../includes/msconame-md.md)] .  
  
 **MidMemoryPrice**  
 Дополнительное свойство, которое следует изменять только под руководством службы поддержки [!INCLUDE[msCoName](../../includes/msconame-md.md)] .  
  
 **MinimumAllocatedMemory**  
 Дополнительное свойство, которое следует изменять только под руководством службы поддержки [!INCLUDE[msCoName](../../includes/msconame-md.md)] .  
  
 **PreAllocate**  
 Дополнительное свойство, которое следует изменять только под руководством службы поддержки [!INCLUDE[msCoName](../../includes/msconame-md.md)] .  
  
 **SessionMemoryLimit**  
 Дополнительное свойство, которое следует изменять только под руководством службы поддержки [!INCLUDE[msCoName](../../includes/msconame-md.md)] .  
  
 **WaitCountIfHighMemory**  
 Дополнительное свойство, которое следует изменять только под руководством службы поддержки [!INCLUDE[msCoName](../../includes/msconame-md.md)] .  
  
## <a name="see-also"></a>См. также  
 [Свойства сервера в службах Analysis Services](../../analysis-services/server-properties/server-properties-in-analysis-services.md)   
 [Определение режима работы сервера экземпляра служб Analysis Services](../../analysis-services/instances/determine-the-server-mode-of-an-analysis-services-instance.md)  
