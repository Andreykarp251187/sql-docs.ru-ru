---
title: Метод Save | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
apitype: COM
f1_keywords:
- _Recordset::Save
- _Recordset::raw_Save
helpviewer_keywords:
- Save method [ADO]
ms.assetid: ed3d9678-5c28-4e61-8bb3-7dfb66d99cf5
author: MightyPen
ms.author: genemi
manager: jroth
ms.openlocfilehash: 0953b76ff642387679c907e6f0b3364cbac898df
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "66711382"
---
# <a name="save-method"></a>Метод Save
Сохраняет [записей](../../../ado/reference/ado-api/recordset-object-ado.md) в файле или [Stream](../../../ado/reference/ado-api/stream-object-ado.md) объекта.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
recordset.Save Destination, PersistFormat  
```  
  
#### <a name="parameters"></a>Параметры  
 *Назначение*  
 Необязательный параметр. Объект **Variant** , представляющая полный путь имя файла, где **набор записей** должен быть сохранен, или ссылка на **Stream** объекта.  
  
 *PersistFormat*  
 Необязательный параметр. Объект [PersistFormatEnum](../../../ado/reference/ado-api/persistformatenum.md) значение, указывающее формат, в котором **записей** должен быть сохранен (XML или ADTG). Значение по умолчанию — **adPersistADTG**.  
  
## <a name="remarks"></a>Примечания  
 [Метода Save](../../../ado/reference/ado-api/save-method.md) метод может вызываться только при открытии **записей**. Используйте [метод Open (объект Recordset ADO)](../../../ado/reference/ado-api/open-method-ado-recordset.md) способ восстановления более поздней версии **записей** из *назначения*.  
  
 Если [свойство фильтра](../../../ado/reference/ado-api/filter-property.md) свойство распространяется на **записей**, а затем сохраняются только те строки, которые доступны в разделе фильтра. Если **записей** является иерархической, затем текущий дочерний элемент **записей** и его дочерние элементы сохраняются, включая родительский элемент **набор записей**. Если метод Save дочернего **записей** — вызывается, дочерние и все его дочерние элементы сохраняются, но не является родительским.  
  
 При первом сохранении **записей**, она необязательна для указания *назначения*. Если опустить *назначения*, будет создан новый файл с именем, равным значению свойства источника **записей**.  
  
 Опустить *назначения* при последующем вызове **Сохранить** после первого сохранения или ошибка времени выполнения будет выполняться. Если после этого вызвать **Сохранить** с новым *назначения*, **записей** сохраняется новое место назначения. Тем не менее новое место назначения и исходное расположение оба будут открыты.  
  
 **Сохранить** не закрывает **записей** или *назначения*, поэтому можно продолжать работать с **записей** и сохраните изменения. *Назначение* остается открытым, пока **записей** закрыт.  
  
 По соображениям безопасности **Сохранить** метод позволяет только использовать настройки безопасности низким и пользовательский сценарий, выполняемый обозревателем Microsoft Internet Explorer.  
  
 Если **Сохранить** при асинхронном вызове метода **записей** выборки, выполнение или обновление выполняется операция, затем **Сохранить** ожидает, пока асинхронная операция завершена.  
  
 Записи сохраняются, начиная с первой строки **записей**. Когда **Сохранить** метод закончит работу, текущая позиция строки перемещается к первой строке **записей**.  
  
 Для получения наилучших результатов установите [свойство CursorLocation (ADO)](../../../ado/reference/ado-api/cursorlocation-property-ado.md) свойства **adUseClient** с **Сохранить**. Если ваш поставщик не поддерживает все функциональные возможности, необходимые для сохранения **записей** объектов, функция будет доступна служба курсора.  
  
 При **записей** сохраняемое **CursorLocation** свойство значение **adUseServer**, возможности обновления для **записей**ограничено. Как правило только для одной таблицы обновления, вставки и удаления разрешены (зависит от функциональные возможности поставщика). [Метод Resync](../../../ado/reference/ado-api/resync-method.md) также метод недоступен в этой конфигурации.  
  
> [!NOTE]
>  Сохранение **записей** с **поля** типа **adVariant**, **adIDispatch**, или **adIUnknown** — не поддерживается в ADO и может привести к непредсказуемым результатам.  
  
 Только фильтры в виде строк критериям (например OrderDate > "12/31/1999") влияют на содержимое материализованный **записей**. Фильтры, созданные с помощью массива **закладки** или используется значение из [FilterGroupEnum](../../../ado/reference/ado-api/filtergroupenum.md) не повлияет на содержимое из сохраненного **записей**. Эти правила применяются к **записей**, созданные с курсорами на стороне клиента или на стороне сервера.  
  
 Так как *назначения* параметр может принимать любой объект, который поддерживает интерфейс OLE DB IStream, вы можете сохранить **записей** непосредственно на объекте отклика ASP. Дополнительные сведения см. в разделе **сценарий сохраняемости набора записей XML**.  
  
 Вы также можете сохранить **записей** в формате XML в экземпляр объекта DOM в MSXML, как показано в следующем коде Visual Basic:  
  
```  
Dim xDOM As New MSXML.DOMDocument  
Dim rsXML As New ADODB.Recordset  
Dim sSQL As String, sConn As String  
  
sSQL = "SELECT customerid, companyname, contactname FROM customers"  
sConn="Provider=Microsoft.Jet.OLEDB.4.0;Data Source=Northwind.mdb"  
rsXML.Open sSQL, sConn  
rsXML.Save xDOM, adPersistXML   'Save Recordset directly into a DOM tree.  
...  
```  
  
> [!NOTE]
>  Два ограничения применяются при сохранении иерархических наборов записей (данные фигуры) в формате XML. Не удается сохранить в XML, если иерархическое **записей** содержит ожидающие обновления, и вы не можете сохранить параметризованную иерархические **набор записей**.  
  
 Объект **записей** сохранен в формате XML сохраняются в формате UTF-8. Когда такой файл загружается в ADO Stream, Stream объект не будет пытаться открыть **записей** из потока, если только свойство Charset потока присваивается соответствующее значение для формата UTF-8.  
  
## <a name="applies-to"></a>Объект применения  
  
|||  
|-|-|  
|[Объект Recordset (ADO)](../../../ado/reference/ado-api/recordset-object-ado.md)|[Объект Stream (ADO)](../../../ado/reference/ado-api/stream-object-ado.md)|  
  
## <a name="see-also"></a>См. также  
 [Сохранение и открытие примеры методов (VB)](../../../ado/reference/ado-api/save-and-open-methods-example-vb.md)   
 [Сохранение и открытие примеры методов (Visual C++)](../../../ado/reference/ado-api/save-and-open-methods-example-vc.md)   
 [Метод Open (объект Recordset ADO)](../../../ado/reference/ado-api/open-method-ado-recordset.md)   
 [Метод Open (ADO Stream)](../../../ado/reference/ado-api/open-method-ado-stream.md)   
 [Метод SaveToFile](../../../ado/reference/ado-api/savetofile-method.md)
