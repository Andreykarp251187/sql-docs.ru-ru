---
title: Объект Recordset (ADO) | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
apitype: COM
f1_keywords:
- Recordset
helpviewer_keywords:
- Recordset object [ADO]
ms.assetid: ede1415f-c3df-4cc5-a05b-2576b2b84b60
author: MightyPen
ms.author: genemi
manager: jroth
ms.openlocfilehash: cc95d6ef7e61dcde373a646359d134dce0b3389d
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "66711948"
---
# <a name="recordset-object-ado"></a>Объект Recordset (ADO)
Представляет полный набор записей из базовой таблицы или результаты выполнения команды. В любое время **записей** объект ссылается на одну запись в наборе как текущую запись.  
  
## <a name="remarks"></a>Примечания  
 Использовании **записей** объектов для управления данными от поставщика. При использовании ADO, вам данными построена с использованием **записей** объектов. Все **записей** объекты состоят из записей (строк) и полей (столбцов). В зависимости от функциональных возможностей, поддерживаемых поставщиком некоторые **записей** методов или свойств могут быть недоступны.  
  
 ADODB. Набор записей является идентификатор ProgID, который должен использоваться для создания **записей** объекта. Существующие приложения, которые ссылаются на устаревшие ADOR. Идентификатор ProgID набор записей будет продолжать работать без повторной компиляции, но разработки новых приложений следует ссылаться на ADODB. Набор записей.  
  
 Существует четыре курсор другого типа, определенные в ADO.  
  
-   **Динамический курсор** дает возможность просмотра, добавления, изменения и удаления другими пользователями; разрешает все типы перемещения с помощью **записей** , не зависит от закладки; и позволяет закладки, если поставщик поддерживает их.  
  
-   **Курсор набора ключей** Behaves как динамический курсор, за исключением того, что он исключает возможность видеть записи другие пользователи добавить и предотвращает доступ к записям, удалить других пользователей. Изменения данных другими пользователями будет по-прежнему отображаться. Он всегда поддерживает закладки и поэтому позволяет все типы перемещения с помощью **записей**.  
  
-   **Статический курсор** предоставляет статическую копию набора записей можно использовать для поиска данных или создания отчетов; всегда позволяет закладки, а поэтому все типы перемещения с помощью **записей**. Дополнения, изменения или удаления другими пользователями будет недоступен. Это единственный тип курсора, допускается при открытии на стороне клиента **записей** объекта.  
  
-   **Однопроходный курсор** позволяет только просмотреть **записей**. Дополнения, изменения или удаления другими пользователями будет недоступен. Это повышает производительность в ситуациях, когда нужно сделать только один проход **записей**.  
  
 Задайте [CursorType](../../../ado/reference/ado-api/cursortype-property-ado.md) перед открывающей **записей** выбрать тип курсора, или передать *CursorType* аргумент с [откройте](../../../ado/reference/ado-api/open-method-ado-recordset.md)метод. Некоторые поставщики не поддерживают все типы курсоров. Обратитесь к документации поставщика. Если не указать тип курсора, ADO открывает однопроходный курсор по умолчанию.  
  
 Если [CursorLocation](../../../ado/reference/ado-api/cursorlocation-property-ado.md) свойству **adUseClient** открыть **записей**, **UnderlyingValue** свойство [Поле](../../../ado/reference/ado-api/field-object.md) объектов не поддерживается в возвращаемом **записей** объекта. При использовании с некоторыми поставщиками (например, поставщик ODBC Майкрософт для OLE DB в сочетании с Microsoft SQL Server), можно создать **записей** объектов независимо от ранее определенные [подключения](../../../ado/reference/ado-api/connection-object-ado.md)путем передачи строки подключения с **откройте** метод. ADO по-прежнему создает [подключения](../../../ado/reference/ado-api/connection-object-ado.md) , но не присвоить переменной объект этого объекта. Тем не менее при открытии нескольких **записей** объектов за одно и то же подключение, необходимо явным образом создать и открыть **подключения** объекта; это назначает **подключения**объекта переменной объекта. Если вы не используйте эту переменную объекта при открытии вашей **записей** объектов ADO создает новую **подключения** новый объект для каждого **записей**, даже если необходимо передать точно такой же Строка подключения.  
  
 Можно создать столько **записей** объектов при необходимости.  
  
 При открытии **записей**, текущая запись позиционируется для первой записи (если таковые имеются) и [BOF](../../../ado/reference/ado-api/bof-eof-properties-ado.md) и [EOF](../../../ado/reference/ado-api/bof-eof-properties-ado.md) свойствам присваивается **False**. Если нет записей, **BOF** и **EOF** свойства **True**.  
  
 Можно использовать [MoveFirst](../../../ado/reference/ado-api/movefirst-movelast-movenext-and-moveprevious-methods-ado.md), **MoveLast**, **MoveNext**, и **MovePrevious** методов; [переместить](../../../ado/reference/ado-api/move-method-ado.md) метод; и [примеры AbsolutePosition](../../../ado/reference/ado-api/absoluteposition-property-ado.md), [примеры AbsolutePage](../../../ado/reference/ado-api/absolutepage-property-ado.md), и [фильтра](../../../ado/reference/ado-api/filter-property.md) свойства для изменения положения текущей записи, при условии, что поставщик поддерживает соответствующие функциональные возможности. Однопроходный **записей** объекты поддерживают только [MoveNext](../../../ado/reference/ado-api/movefirst-movelast-movenext-and-moveprevious-methods-ado.md) метод. При использовании **переместить** методы, чтобы перейти на каждой записи (или перечислить **записей**), можно использовать **BOF** и **EOF** свойства определить, если вы переместили за начало или конец **записей**.  
  
 Прежде чем использовать все функции **записей** объекта, необходимо вызвать **поддерживает** метод на объекте, чтобы убедиться, что функциональные возможности поддерживаются или недоступны. Не следует использовать функциональные возможности при **поддерживает** метод возвращает значение false. Например, можно использовать **MovePrevious** методу, только если `Recordset.Supports(adMovePrevious)` возвращает **True**. В противном случае отобразится сообщение об ошибке, так как **записей** объект был закрыт и функциональные возможности визуализации недоступна на экземпляре. Если вы заинтересованы в компонент не поддерживается, **поддерживает** будет также возвращает значение false. В этом случае следует избегать вызова в соответствующее свойство или метод для **записей** объекта.  
  
 **Набор записей** объектов может поддерживать два типа обновления: немедленное и пакетные. В немедленное обновление, все изменения данных записываются непосредственно в базовый источник данных при вызове метода [обновления](../../../ado/reference/ado-api/update-method.md) метод. Также можно передать массивы значений в качестве параметров с [AddNew](../../../ado/reference/ado-api/addnew-method-ado.md) и **обновление** методы и одновременно обновить несколько полей в записи.  
  
 Если поставщик поддерживает обновление пакета, может иметь поставщика кэшировать изменения более чем одной записи и передачи их в один вызов к базе данных с помощью [UpdateBatch](../../../ado/reference/ado-api/updatebatch-method.md) метод. Это относится к изменения, внесенные с помощью **AddNew**, **обновление**, и [удалить](../../../ado/reference/ado-api/delete-method-ado-recordset.md) методы. После вызова метода **UpdateBatch** метод, можно использовать [состояние](../../../ado/reference/ado-api/status-property-ado-recordset.md) свойство на наличие конфликтов данных для их устранения.  
  
> [!NOTE]
>  Для выполнения запроса без использования [команда](../../../ado/reference/ado-api/command-object-ado.md) , передать строку запроса для **откройте** метод **записей** объекта. Тем не менее **команда** объекта является обязательным, если вы хотите сохранить текст команды и повторно выполните ее или использовать параметры запроса.  
  
 [Режим](../../../ado/reference/ado-api/mode-property-ado.md) регулирует разрешения на доступ.  
  
 **Поля** коллекции — это элемент по умолчанию **записей** объекта. В результате код следующие две инструкции эквивалентны.  
  
```  
Debug.Print objRs.Fields.Item(0)  ' Both statements print   
Debug.Print objRs(0)              '  the Value of Item(0).  
```  
  
 При **записей** объект передается между процессами, только **набора строк** значения являются маршалируется и свойства **записей** объекта игнорируются. Во время unmarshalling, **набора строк** не был распакован в только что созданный объект **записей** объект, который также задает его свойства, значения по умолчанию.  
  
 **Записей** объект безопасен для скриптов.  
  
 Этот раздел содержит следующие подразделы.  
  
-   [Свойства объекта набора записей, методы и события](../../../ado/reference/ado-api/recordset-object-properties-methods-and-events.md)  
  
## <a name="see-also"></a>См. также  
 [Объект Connection (ADO)](../../../ado/reference/ado-api/connection-object-ado.md)   
 [Коллекция Fields (ADO)](../../../ado/reference/ado-api/fields-collection-ado.md)   
 [Коллекция Properties (ADO)](../../../ado/reference/ado-api/properties-collection-ado.md)   
 [Приложение а. Поставщики](../../../ado/guide/appendixes/appendix-a-providers.md)
