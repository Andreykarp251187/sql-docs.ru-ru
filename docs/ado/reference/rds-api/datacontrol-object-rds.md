---
title: Объект DataControl (служба удаленных рабочих СТОЛОВ) | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
apitype: COM
f1_keywords:
- DataControl
- RDS.DataControl
helpviewer_keywords:
- DataControl object [ADO]
ms.assetid: d85ea4fc-451c-436e-97b8-58f92b149dd0
author: MightyPen
ms.author: genemi
manager: jroth
ms.openlocfilehash: fdd88251e3d41954dcee6ed3c88612941688cbbb
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "66707764"
---
# <a name="datacontrol-object-rds"></a>Объект DataControl (служба удаленных рабочих столов)
Привязывает запрос данных [записей](../../../ado/reference/ado-api/recordset-object-ado.md) на один или несколько элементов управления (например, текстовое поле, элемент управления DataGrid или поле со списком) для отображения **записей** данных на веб-странице.  
  
> [!IMPORTANT]
>  Начиная с Windows 8 и Windows Server 2012, серверные компоненты служб удаленных рабочих СТОЛОВ, больше не включаются в операционной системе Windows (см. в разделе Windows 8 и [настольная книга по совместимости Windows Server 2012](https://www.microsoft.com/download/details.aspx?id=27416) для получения дополнительных сведений). Клиентские компоненты служб удаленных рабочих СТОЛОВ будет поддерживаться в будущих версиях Windows. Избегайте использования этого компонента в новых разработках и запланируйте изменение существующих приложений, в которых он применяется. Приложения, использующие служб удаленных рабочих СТОЛОВ, следует перевести [WCF-сервиса данных](https://go.microsoft.com/fwlink/?LinkId=199565).  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
<OBJECT CLASSID="clsid:BD96C556-65A3-11D0-983A-00C04FC29E33" ID="DataControl"  
   <PARAM NAME="Connect" VALUE="DSN=DSNName;UID=MyUserID;PWD=MyPassword;">  
   <PARAM NAME="Server" VALUE="https://awebsrvr">  
   <PARAM NAME="SQL" VALUE="QueryText">  
</OBJECT>  
```  
  
## <a name="remarks"></a>Примечания  
 Идентификатор класса для **RDS. DataControl** BD96C556-65A3 - 11 D 0-983A-00C04FC29E33 является объект.  
  
> [!NOTE]
>  Если отобразится сообщение об ошибке, [RDS. Пространство данных](../../../ado/reference/rds-api/dataspace-object-rds.md) или **RDS. DataControl** объекта не загрузить, убедитесь, что вы используете правильный класс идентификатор. Класс, из версии 1.0 и 1.1 были изменены идентификаторы для этих объектов. Кроме того, помните, что даже допускает значения NULL столбцов должен быть установлен, при использовании **RDS DataControl** объекта.  
  
 Для базового сценария, необходимо задать только **SQL**, **Connect**, и **Server** свойства **RDS. DataControl** объект, который автоматически вызовет бизнес-объекта по умолчанию, [RDSServer.DataFactory](../../../ado/reference/rds-api/datafactory-object-rdsserver.md).  
  
 Все свойства в **RDS. DataControl** необязательны, поскольку пользовательские бизнес-объектов можно заменить их функциональность.  
  
> [!NOTE]
>  При выполнении запроса для нескольких результатов только первые [записей](../../../ado/reference/ado-api/recordset-object-ado.md) возвращается. Если требуется несколько результирующих наборов, назначьте каждому к своему собственному **DataControl**. Пример запроса для нескольких результатов может выглядеть следующим образом: `"Select * from Authors, Select * from Topics"`  
  
 Добавление «DFMode = 20;» в строке подключения при использовании **RDS. DataControl** объекта может повысить производительность сервера, при обновлении данных. Этот параметр, **RDSServer.DataFactory** объект на сервере использует режим менее ресурсоемки. Тем не менее следующие функции недоступны в этой конфигурации:  
  
-   Использование параметризованных запросов.  
  
-   Получение сведений о параметра или столбца перед вызовом **Execute** метод.  
  
-   Установка **Transact обновлений** для **True**.  
  
-   Получение строки состояния.  
  
-   Вызов [Resync](../../../ado/reference/ado-api/resync-method.md) метод.  
  
-   Обновление (явно или автоматически) через [Update Resync](../../../ado/reference/ado-api/update-resync-property-dynamic-ado.md) свойство.  
  
-   Установка **команда** или [записей](../../../ado/reference/rds-api/recordset-sourcerecordset-properties-rds.md) свойства.  
  
-   С помощью **adCmdTableDirect**.  
  
 **RDS. DataControl** объект выполняется в асинхронном режиме по умолчанию. Если требуется синхронное выполнение приложения, задайте [ExecuteOptions](../../../ado/reference/rds-api/executeoptions-property-rds.md) параметра равным **adcExecSync** и [FetchOptions](../../../ado/reference/rds-api/fetchoptions-property-rds.md) параметра равным **adcFetchUpFront**, как показано в следующем примере.  
  
```  
<OBJECT CLASSID="clsid:BD96C556-65A3-11D0-983A-00C04FC29E33"   
    ID="DataControl"  
   <PARAM NAME="Connect" VALUE="DSN=DSNName;UID=MyUserID;PWD=MyPassword;">  
   <PARAM NAME="Server" VALUE="https://awebsrvr">  
   <PARAM NAME="SQL" VALUE="QueryText">  
   <PARAM NAME="ExecuteOptions" VALUE="1">   <PARAM NAME="FetchOptions" VALUE="1">  
</OBJECT>  
```  
  
 Используйте один **RDS. DataControl** объекта, чтобы связать результаты одного запроса для одного или нескольких визуальных элементов управления. Предположим, например, код запроса запрашивающей данные клиентов, такие как имя, проживания, место из рождения, возраст и состояние клиента с приоритетом. Можно использовать единую **RDS. DataControl** объект для отображения имени клиента, возраст и регион в трех отдельных текстовых полях; Состояние клиента с приоритетом в типа "флажок"; и все данные в элементе управления сетки.  
  
 Использование разных **RDS. DataControl** объектов для связывания результатов нескольких запросов для различных визуальных элементов управления. Например предположим, что используется один запрос для получения сведений о клиенте и второй запрос для получения сведений о товаров, приобретенных клиентом. Вы хотите отобразить результаты первого запроса в три текстовых поля и флажки и результаты второго запроса в сетку. При использовании бизнес-объекта по умолчанию (**RDSServer.DataFactory**), необходимо выполнить следующие действия:  
  
-   Добавьте два **RDS. DataControl** объектов на веб-страницу.  
  
-   Запрашивает записи, два, один для каждого **SQL** свойства двух **RDS. DataControl** объектов. Один **RDS. DataControl** объект будет содержать запрос SQL, выполняется запрос информации клиента; второй будет содержать запрос, список товаров, приобретенных клиентом.  
  
-   В тегах объект каждого привязанного элемента управления укажите значение DATAFLD для задания значений для данных, которые нужно отобразить в каждом визуальному элементу управления.  
  
 Нет никаких ограничений на число на количество **RDS. DataControl** объектов, можно внедрить с помощью тегов ОБЪЕКТОВ на одном веб-странице.  
  
 При определении **RDS. DataControl** веб-страницы, используйте ненулевое значение **высота** и **ширины** значения, например, 1 (во избежание включения дополнительного пространства).  
  
 Компоненты клиента удаленной службы данных уже входит в состав Internet Explorer 4.0; Таким образом, не нужно включать параметр в базе кода вашей **RDS. DataControl** теге объекта.  
  
 С Internet Explorer 4.0 или более поздней версии можно привязать к данным с помощью элементов управления HTML и элементов управления ActiveX® только в том случае, если они помечены как элементы управления модели подразделения.  
  
> [!NOTE]
>  **Пользователи Microsoft Visual Basic** **RDS. DataControl** безопасен для скриптов и используется только в веб-приложений. Клиентское приложение Visual Basic имеет не нужно.  
  
 Этот раздел содержит следующие подразделы.  
  
-   [Свойства, методы и события объекта DataControl (служба удаленных рабочих столов)](../../../ado/reference/rds-api/datacontrol-object-rds-properties-methods-and-events.md)  
  
## <a name="see-also"></a>См. также  
 [Пример объекта DataControl (VBScript)](../../../ado/reference/rds-api/datacontrol-object-example-vbscript.md)






















