---
title: Метод Execute21 (служба удаленных рабочих СТОЛОВ) | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
apitype: COM
helpviewer_keywords:
- Execute21 method [RDS]
ms.assetid: 9f131c8d-1497-416d-8209-abb481c38f7b
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: c1b4608dde67f31067ed34f7c552ba866a2095ed
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62469326"
---
# <a name="execute21-method-rds"></a>Метод Execute21 (служба удаленных рабочих столов)
Выполняет запрос и создает набор записей ADO для использования в ADO 2.1.  
  
> [!IMPORTANT]
>  Начиная с Windows 8 и Windows Server 2012, серверные компоненты служб удаленных рабочих СТОЛОВ, больше не включаются в операционной системе Windows (см. в разделе Windows 8 и [настольная книга по совместимости Windows Server 2012](https://www.microsoft.com/download/details.aspx?id=27416) для получения дополнительных сведений). Клиентские компоненты служб удаленных рабочих СТОЛОВ будет поддерживаться в будущих версиях Windows. Избегайте использования этого компонента в новых разработках и запланируйте изменение существующих приложений, в которых он применяется. Приложения, использующие служб удаленных рабочих СТОЛОВ, следует перевести [WCF-сервиса данных](https://go.microsoft.com/fwlink/?LinkId=199565).  
  
## <a name="syntax"></a>Синтаксис  
  
```  
  
object.Execute21(ConnectionString As String, HandlerString As String, QueryString As String, lMarshalOptions As Long, Properties, TableId, lExecuteOptions As Long, pParameters)  
```  
  
#### <a name="parameters"></a>Параметры  
 *connectionString*  
 Строка, используемая для подключения к поставщику OLE DB, куда будут отправляться запрос для выполнения. Если обработчик задается с помощью *HandlerString*, его можно изменить или заменить строку подключения.  
  
 *HandlerString*  
 Строка определяет обработчик для использования с этого выполнения. Строка состоит из двух частей. Первая часть содержит имя (ProgID) обработчика для использования. Вторая часть строки содержит аргументы, передаваемые обработчику. Способ интерпретации строки аргументов — конкретного обработчика. Эти две части разделяются первого вхождения запятой в строку (несмотря на то, что аргументы строка может содержать дополнительные запятые). Аргументы являются необязательными.  
  
 *QueryString*  
 Команды в командный язык, поддерживаемые поставщиком OLE DB, указанную в строке подключения. Для поставщиков на основе SQL, он может содержать [!INCLUDE[tsql](../../../includes/tsql-md.md)] команды инструкции, но для отличных от SQL поставщиков (например, MSDataShape) это может оказаться [!INCLUDE[tsql](../../../includes/tsql-md.md)] оператора запроса.  
  
 Кроме того Если используется обработчик (настоятельно рекомендуется использовать обработчик), обработчик можно изменить или заменить значение, указанное здесь. Например, обычно заменяет обработчик *QueryString* со строкой запроса из его INI-файла. По умолчанию используется файл Msdfmap.ini.  
  
 *lMarshalOptions*  
 Используется для задания варианты маршалинга для набора строк или объекта recordset, возвращаемых.  
  
 *TableID*  
 Вариант типа VT_BSTR, либо значение VT_EMPTY. Если это значение имеет тип VT_EMPTY, он игнорируется. Если это типа VT_BSTR, набор записей создается с помощью **adCmdTableDirect** с помощью значение, указанное здесь и *QueryString* параметр учитывается.  
  
 *lExecuteOptions*  
 Битовая маска параметров выполнения:  
  
 1 =*ReadOnly* набор записей будет открыт с помощью **adLockReadOnly**.  
  
 2 =*NoBatch* набор записей будет открыт с помощью **adLockOptimistic**.  
  
 4 =*AllParamInfoSupplied* вызывающий объект гарантирует, что предоставлены сведения о параметрах для всех параметров в *pParameters*.  
  
 8 =*GetInfo* сведения о параметрах для запроса будет получен от поставщика OLE DB и возвращено в *pParameters* параметра. Запрос не выполняется и возвращается без набора записей.  
  
 16 = набор записей будет открыт с помощью GetHiddenColumns **adLockBatchOptimistic** и скрытые столбцы, которые будут включены в набор записей.  
  
 Несмотря на то что *ReadOnly*, *NoBatch* и *GetHiddenColumns* являются взаимоисключающими, не является ошибкой для задания более чем один из них. Если несколько параметров, *GetHiddenColumns* приоритет, чем все остальные параметры, за которым следует *ReadOnly*. Если параметры не указаны, по умолчанию открывается набор записей с помощью **adLockBatchOptimistic** , но скрытые столбцы не входят в набор записей.  
  
 *pParameters*  
 Переменная типа variant, содержащий безопасный массив определений параметров. Если *GetInfo* параметр был указан в *lExecuteOptions*, этот параметр используется для возврата определения параметров, полученного от поставщика OLE DB. В противном случае этот параметр может быть пустым.  
  
## <a name="remarks"></a>Примечания  
 *HandlerString* параметр может иметь значение null. Что происходит в этом случае зависит от того, как настроен сервер служб удаленных рабочих СТОЛОВ. Обработчик строку «MSDFMAP.handler» указывает, что следует использовать обработчик предоставленный корпорацией Майкрософт (Msdfmap.dll). Обработчик строку «MASDFMAP.handler,sample.ini» указывает, что следует использовать обработчик Msdfmap.dll и что «sample.ini» аргумент должен передаваться обработчику. Аргумент MSDFMAP.dll интерпретирует как направление, в которых будет производиться sample.ini Проверьте строки соединения и запроса.  
  
> [!NOTE]
>  **Execute21** метод — это версия [выполнение метода (RDS)](../../../ado/reference/rds-api/execute-method-rds.md). Где необходимо использовать **Execute** для обмена данными с помощью ADO 2.1, метод **Execute21** метод может вызываться вместо этого. Возможности **Execute** метод в ADO 2.5 и более поздние версии являются подмножеством возможностей, предоставляемых для того же метода ADO 2.1.  
  
## <a name="applies-to"></a>Объект применения  
 [Объект DataFactory (RDSServer)](../../../ado/reference/rds-api/datafactory-object-rdsserver.md)


