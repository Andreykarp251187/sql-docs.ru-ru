---
title: 'Создание экземпляра события ADO: ADO и WFC | Документация Майкрософт'
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 02/15/2017
ms.reviewer: ''
ms.topic: conceptual
ms.assetid: 9ee4be21-657b-407a-afa4-0b27a6b096ce
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 7dbbbf92c751093d2a7333b7ac1f76888d41d345
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "70212340"
---
# <a name="ado-event-instantiation-ado-and-wfc"></a>Создание экземпляра события ADO: ADO и WFC
Объекты ADO для классов Windows Foundation (ADO/WFC) построены на модели событий ADO и представляют упрощенный прикладной программный интерфейс. Как правило, ADO/WFC перехватывает события ADO, объединяет параметры событий в один класс событий, а затем вызывает обработчик событий.  
  
### <a name="to-use-ado-events-in-adowfc"></a>Использование событий ADO в ADO/WFC  
  
1.  Определите собственный обработчик событий для обработки события. Например, если вы хотите обработать событие **коннекткомплете** в семействе **коннектионевент** , вы можете использовать следующий код:  
  
    ```  
    public void onConnectComplete(Object sender,ConnectionEvent e)  
    {  
        System.out.println("onConnectComplete:" + e);  
    }  
    ```  
  
2.  Определите объект обработчика для представления обработчика событий. Объект обработчика должен иметь тип данных **коннектевенсандлер** для события типа **коннектионевент**или **рекордсетевенсандлер** типа данных для события типа **рекордсетевент**. Например, для обработчика событий **коннекткомплете** необходимо запрограммировать следующий код:  
  
    ```  
    ConnectionEventHandler handler =   
        new ConnectionEventHandler(this, "onConnectComplete");  
    ```  
  
     Первый аргумент конструктора **коннектионевенсандлер** является ссылкой на класс, который содержит обработчик событий, названный во втором аргументе.  
  
3.  Добавьте обработчик событий в список обработчиков, предназначенных для обработки определенного типа события. Используйте метод с именем, например " **надстройка**_EventName_(*обработчик*)".  
  
4.  ADO/WFC внутренне реализует все обработчики событий ADO. Таким образом, событие, вызванное **соединением** или операцией с **набором записей** , перехватывается обработчиком событий ADO/WFC.  
  
     Обработчик событий ADO/WFC передает параметры ADO **коннектионевент** в экземпляре класса ADO/WFC **КОННЕКТИОНЕВЕНТ** или параметры ADO **РЕКОРДСЕТЕВЕНТ** в экземпляре класса ADO/WFC **рекордсетевент** . Эти классы ADO/WFC объединяют параметры событий ADO. то есть каждый класс ADO/WFC содержит один элемент данных для каждого уникального параметра во всех методах ADO **коннектионевент** или **рекордсетевент** .  
  
5.  Затем ADO/WFC вызывает обработчик событий с помощью объекта события ADO/WFC. Например, обработчик **онконнекткомплете** имеет сигнатуру следующего вида:  
  
    ```  
    public void onConnectComplete(Object sender,ConnectionEvent e)  
    ```  
  
     Первый аргумент — это тип объекта, который отправил событие ([соединение](../../../ado/reference/ado-api/connection-object-ado.md) или [набор записей](../../../ado/reference/ado-api/recordset-object-ado.md)), а второй аргумент — объект события ADO/WFC (**коннектионевент** или **рекордсетевент**).  
  
     Сигнатура обработчика событий проще, чем событие ADO. Тем не менее необходимо понимать модель событий ADO, чтобы узнать, какие параметры применяются к событию, и как реагировать на него.  
  
6.  Вернитесь от обработчика событий к обработчику ADO/WFC для события ADO. ADO/WFC копирует соответствующие элементы данных событий ADO/WFC обратно в параметры события ADO, а затем обработчик событий ADO возвращает.  
  
7.  После завершения обработки удалите обработчик из списка обработчиков событий ADO/WFC. Используйте метод с именем, например **removeOn**_EventName_(*handler*).  
  
## <a name="see-also"></a>См. также:  
 [Сводка по обработчику событий ADO](../../../ado/guide/data/ado-event-handler-summary.md)   
 [ADO — индекс синтаксиса WFC](../../../ado/reference/ado-api/ado-wfc-syntax-index.md)   
 [Параметры события](../../../ado/guide/data/event-parameters.md)   
 [Совместная работа обработчиков событий](../../../ado/guide/data/how-event-handlers-work-together.md)   
 [Типы событий](../../../ado/guide/data/types-of-events.md)
