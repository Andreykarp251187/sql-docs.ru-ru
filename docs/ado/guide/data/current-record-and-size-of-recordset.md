---
title: Текущая запись и размер набора записей | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- record location [ADO]
- current record [ADO]
ms.assetid: e63ff331-8655-4be7-82c6-e6cd6cc9d16d
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: bde55939e974c6c879dcd126fac863ef0a866487
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62472607"
---
# <a name="current-record-and-size-of-recordset"></a>Текущая запись и размер набора записей
В этом разделе описывается, как найти текущей позиции курсора в образце **записей** в [пример кода JScript, возвращающего набор записей](../../../ado/guide/data/jscript-code-example-to-return-a-recordset.md).  
  
## <a name="current-record"></a>Текущая запись  
 Соответствует текущей записи в наборе данных, на который указывает положением курсора **записей** объекта. Когда **записей** объект возвращается из источника данных в результате вызова метода **Recordset.Open**, **Command.Execute**, или **Connection.Execute**  (включая **Connection.NamedCommand** и **Connection.StoredProcedure**), курсор имеет значение, чтобы он указывал на первую запись. В примере набора данных текущей начальной записи является «Uncle Bob органических Dried Груши» элемента.  
  
## <a name="size-of-recordset"></a>Размер набора записей  
 Чтобы узнать размер **записей** объекта, получения значения **Recordset.RecordCount** свойство. Это значение равно длинное целое число, указывающее количество записей в **записей**. Если набор данных, возвращенный поставщиком OLEDB для Microsoft SQL Server, это значение дает число возвращаемых строк. Чтение **RecordCount** закрытого свойства **записей** приводит к ошибке.  
  
 Если число записей не может быть определен, значение свойства равно -1.  
  
 Значение **RecordCount** свойства также зависит от возможностей поставщика и используемым типом курсора. Для однонаправленного курсора значение-1. Для статического или набора ключей курсора, используется фактическое число записей, возвращаемых в **записей** объекта. Для динамического курсора значение равно -1 или фактическое число записей, в зависимости от источника данных.  
  
 Курсор, который поддерживает **Recordcount** необходимо работы становится все сложнее и, следовательно, требуются большие вычислительные мощности, чем курсора не поддерживает **Recordcount**. Если вам не нужно знать число записей, с помощью другой тип курсора может повысить производительность приложения, особенно в том случае, если приходится работать с большим набором данных.  
  
 В некоторых случаях поставщик или курсор не удается определить **RecordCount** значение без получения всех записей из источника данных. Чтобы гарантировать точность подсчета, вызвать **записей**. **MoveLast** метод перед вызовом **Recordset.RecordCount**.  
  
 Образец **записей** объекта, полученное с помощью [пример кода JScript](../../../ado/guide/data/jscript-code-example-to-return-a-recordset.md) использует однонаправленного курсора, поэтому вызов **RecordCount** на этот объект всегда приводит к -1. Если вы измените строку, вызывающую **записей**. **Откройте** метод, как показано в следующем примере **RecordCount** свойство возвращает фактическое количество записей, выбранных.  
  
```  
oRs.Open sSQL, sCnStr, adOpenStatic, adLockOptimistic, adCmdText   
```  
  
 Это обусловлено статические курсоры с [поставщик Microsoft OLE DB для SQL Server](../../../ado/guide/appendixes/microsoft-ole-db-provider-for-sql-server.md) поддерживает **RecordCount**. В этом примере есть пять записей и, следовательно, **RecordCount** должно выдавать значение 5.  
  
 Этот раздел содержит следующие подразделы.  
  
 [Границы набора записей](../../../ado/guide/data/boundaries-of-a-recordset.md)
