---
title: Комментарии к hellodata | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- hellodata sample application [ADO]
ms.assetid: a2831d77-7040-4b73-bbae-fe0bf78107ed
author: MightyPen
ms.author: genemi
manager: jroth
ms.openlocfilehash: 23ba7235ddd8ea05b7217c88bc76e7bfe50bbd98
ms.sourcegitcommit: 074d44994b6e84fe4552ad4843d2ce0882b92871
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/05/2019
ms.locfileid: "66702388"
---
# <a name="comments-on-hellodata"></a>Комментарии к HelloData
Приложения HelloData пошаговые инструкции по типичное приложение ADO основные операции: получение, анализ, редактирование и обновление данных. При запуске приложения, нажмите первую кнопку, **получить данные**. Мы выполним **GetData** подпрограммы.  
  
## <a name="getdata"></a>GetData  
 **GetData** помещает допустимую строку подключения в переменную уровня модуля, *m_sConnStr*. Дополнительные сведения о строках подключения см. в разделе [Создание строки подключения](../../../ado/guide/data/creating-a-connection-string.md).  
  
 Назначить обработчик ошибок, с помощью Visual Basic **OnError** инструкции. Дополнительные сведения об обработке ошибок в ADO см. в разделе [обработка ошибок](../../../ado/guide/data/error-handling.md). Новый **подключения** объект создан и **CursorLocation** свойству **adUseClient** так, как в примере HelloData создается  *набор записей отключен*. Это означает, что как только данные были получены из источника данных, физическое соединение с источником данных не работает, но по-прежнему можно работать с данными, которые кэшируются локально в вашей **записей** объекта.  
  
 После открытия соединения, присвойте переменной (sSQL) строкой SQL. Затем создайте экземпляр нового **записей** объекта, `m_oRecordset1`. В следующей строке кода, откройте **записей** в существующую **подключения**, передавая `sSQL` как источник **записей**. ADO вы помочь в создании определения, что SQL-строка вы прошли в качестве источника для **записей** представляет собой текстовое определение команды, передав **adCmdText** в последнем аргументе для **Набора записей открытым** метод. Эта строка также задает **LockType** и **CursorType** связанные с **записей**.  
  
 Следующая строка кода задает **MarshalOptions** равным **adMarshalModifiedOnly**. **MarshalOptions** указывает, какие записи необходимо маршалировать среднего уровня (или веб-сервера). Дополнительные сведения о маршалинге см. в документации COM. При использовании **adMarshalModifiedOnly** с клиентский курсор ([CursorLocation](../../../ado/reference/ado-api/cursorlocation-property-ado.md) = **adUseClient**), только те записи, которые были изменены на Клиент записываются обратно на средний уровень. Установка **MarshalOptions** для **adMarshalModifiedOnly** может повысить производительность, поскольку маршалируются меньшее число строк.  
  
 Затем отключите **записей** , задав его **ActiveConnection** равным **ничего не**. Дополнительные сведения см. разделе «Отключение и повторное подключение набор записей» в [обновление и сохранение данных](../../../ado/guide/data/updating-and-persisting-data.md).  
  
 Закройте подключение к источнику данных и удалите существующие **подключения** объекта. Это освобождает ресурсы, которые его использовать.  
  
 Последним шагом является установка **записей** как **DataSource** для DataGrid для Microsoft элемента управления в форме таким образом, можно отобразить данные из **записей** на форма.  
  
 Нажмите вторую кнопку **проверки данных**. Эта команда запускает **ExamineData** подпрограммы.  
  
## <a name="examinedata"></a>ExamineData  
 ExamineData использует различные методы и свойства **записей** объекта для отображения сведений о данных в **записей**. Он выводит число записей с помощью **RecordCount** свойство. Он проходит по **записей** и печатает значение **примеры AbsolutePosition** свойство в текстовом поле отображаемое в форме. Также при работе в цикл, значение **закладки** свойство для третьей записи помещается в переменную типа variant *vBookmark*, для последующего использования.  
  
 Подпрограмма непосредственно переходит обратно в переменную закладки, сохраненную ранее третья запись. Стандартных вызовов **WalkFields** подпрограмму, которая перебирает **поля** коллекцию **записей** и отображает сведения о каждом **поля**  в коллекции.  
  
 Наконец **ExamineData** использует **фильтра** свойство **записей** экран только те записи, с **CategoryId** равным 2. Результат применения этого фильтра сразу же отображается в сетке отображения в форме.  
  
 Дополнительные сведения о функциональных возможностях, показанный на **ExamineData** подпрограммы, см. в разделе [проверки данных](../../../ado/guide/data/examining-data.md).  
  
 После этого нажмите третью кнопку, **изменение данных**. Мы выполним **EditData** подпрограммы.  
  
## <a name="editdata"></a>EditData  
 При достижении **EditData** подпрограммы, **записей** по-прежнему, отфильтрованный по **CategoryId** , равным 2, таким образом, только элементы, которые удовлетворяют условиям фильтра Видимый. Сначала он проходит по **записей** и увеличивает цену каждого элемента, видимого в **записей** на 10 процентов. Значение **цена** изменяется, задав **значение** свойства для этого поля равно до новой, допустимые значения.  
  
 Помните, что **записей** отключен от источника данных. Изменения, внесенные в **EditData** применяются только к кэшированную копию данных. Дополнительные сведения см. в разделе [редактирования данных](../../../ado/guide/data/editing-data.md).  
  
 Изменения не будут совершаться на источнике данных только после нажатия кнопки Четвертая кнопка **обновление данных**. Мы выполним **UpdateData** подпрограммы.  
  
## <a name="updatedata"></a>UpdateData  
 UpdateData сначала удаляет фильтр, примененный к **записей**. Код удаляет и сбрасывает `m_oRecordset1` как **DataSource** для Microsoft привязан DataGrid на форму, чтобы нефильтрованные **набор записей** отображается в сетке.  
  
 Код затем проверяет, можно ли переместить Назад **записей** с помощью **поддерживает** метод с **adMovePrevious** аргумент.  
  
 Процедура переходит к первой записи с помощью **MoveFirst** метод и отображает исходные и текущие значения поля, с помощью **OriginalValue** и **значение** свойства **поле** объекта. Эти свойства, вместе с **UnderlyingValue** свойство (здесь не используется), рассматриваются в [обновление и сохранение данных](../../../ado/guide/data/updating-and-persisting-data.md).  
  
 Далее, новый **подключения** объект создается и используется, чтобы заново установить подключение к источнику данных. Вы повторно подключите **записей** к источнику данных, задав новое **подключения** как **ActiveConnection** для **записей**. Для отправки обновлений на сервер, этот код вызывает **UpdateBatch** на **записей**.  
  
 Если пакетное обновление завершается успешно, переменную уровня модуля флаг `m_flgPriceUpdated`, имеет значение True. Это будет Напомнить позже, чтобы очистить все изменения, внесенные в базу данных.  
  
 Наконец, код переход к первой записи в **записей** и отображает исходные и текущие значения. Значения такие же после вызова **UpdateBatch**.  
  
 Подробные сведения об обновлении данных, включая что делать при данных на сервере во время вашего **записей** — отключен, см. в разделе [обновление и сохранение данных](../../../ado/guide/data/updating-and-persisting-data.md).  
  
## <a name="formunload"></a>Form_Unload  
 **Form_Unload** подпрограммы важно по следующим причинам. Во-первых поскольку это пример приложения, Form_Unload очищает изменения, внесенные в базу данных до завершения приложения. Во-вторых, в коде показано, как команды можно выполнять непосредственно из открытого **подключения** объекта с помощью **Execute** метод. Наконец он показан пример выполнения запроса, не возвращающие строк (запрос на обновление), в источнике данных.
