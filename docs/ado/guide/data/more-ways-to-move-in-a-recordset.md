---
title: Дополнительные способы перемещения в наборе записей | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- MoveNext method [ADO]
- MoveLast method [ADO]
- MoveFirst method [ADO]
- Recordset object [ADO], moving
- MovePrevious method [ADO]
ms.assetid: 9f8cf1b2-3def-453f-a0ff-4646c5f15262
author: MightyPen
ms.author: genemi
manager: jroth
ms.openlocfilehash: 8cb2edebfd0a23f7b626dfdc4cb55eab9684a2c0
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "66700814"
---
# <a name="more-ways-to-move-in-a-recordset"></a>Дополнительные способы перемещения в наборе записей
Следующие четыре метода используются для перемещения, а также, в **записей**: [Примеры MoveFirst, MoveLast, MoveNext и MovePrevious](../../../ado/reference/ado-api/movefirst-movelast-movenext-and-moveprevious-methods-ado.md). (Некоторые из этих методов недоступны на курсоры последовательного доступа.)  
  
 **MoveFirst** изменения положения текущей записи в первой записи в **записей**. **MoveLast** текущей записи к последней позиции изменяет запись в **записей**. Чтобы использовать **MoveFirst** или **MoveLast**, **записей** объект должен поддерживать закладки или движение курсора назад; в противном случае вызов метода приведет к ошибке.  
  
 **MoveNext** перемещает текущей записи размещения в одном месте вперед. Если вы используете последнюю запись, при вызове **MoveNext**, **EOF** будет присвоено **True**. **MovePrevious** перемещает текущую запись размещения обратно в одном месте. Если вы используете первой записи при вызове **MovePrevious**, **BOF** будет присвоено **True**. Имеет смысл проверить **EOF** и **BOF** свойства при использовании этих методов и для перемещения курсора обратно к допустимым текущего положения записи, если отказаться от начала до конца **записей**, как показано ниже:  
  
```  
. . .  
oRs.MoveNext  
If oRs.EOF Then oRs.MoveLast  
. . .   
```  
  
 Или, в случае использования **MovePrevious** метод:  
  
```  
. . .   
oRs.MovePrevious  
If oRs.BOF Then oRs.MoveFirst  
. . .  
```  
  
 В случаях, где **записей** отфильтровать или упорядочить и изменении текущей записи данных, также может измениться позиция. В таких случаях **MoveNext** метод работает как обычно, но имейте в виду, что позиция перетаскивать записи вперед с новой позиции, а не старое положение. Например, изменение данных в текущей записи, таким образом, что записи перемещается в конец отсортированного списка **записей**, означает, что при вызове **MoveNext** приводит значение текущей записи ADO Позиция после последней записи в **записей** (**EOF** = **True**).  
  
 Поведение различных методов перемещения **записей** зависит объект, в некоторой степени по данным в **записей**. Новые записи, добавленные к **записей** , сначала добавляются в определенном порядке, определяется источником данных и может зависеть от неявно или явно на данные в новой записи. Например, если сортировку или соединение выполняется в рамках запроса, заполняющего **записей**, новая запись будет вставлен в правильное место в **записей**. Если упорядочение не указано явным образом при создании **записей**, изменения в реализации источника данных могут привести к порядок возвращенные строки для непреднамеренного изменения. В сложения, сортировка, фильтрация и редактирования функции **записей** может повлиять на порядок и возможно будут видны какие строки в наборе записей.  
  
 Таким образом **MoveNext**, **MovePrevious**, **MoveFirst**, **MoveLast**, и **переместить** все Чтобы другие операции, выполняемые на том же **записей**. ADO будет всегда пытаться Ведение вашей текущей позиции до его явным образом переместить, но в некоторых случаях промежуточных изменений быть сложно оценить последствия последующих перемещения. Например, если вы вызываете **MoveFirst** до позиции в первой строке отсортированное **записей** и изменить порядок сортировки по возрастанию в порядке убывания, вы находитесь в одной и той же строки -, но теперь она является последней строкой в **записей**. **MoveFirst** вы перейдете к другой строке (новый первой строки).  
  
 Еще один пример, если текущая позиция в определенной строке посередине **записей** и вызове **удалить** , а затем вызвать **MoveNext**, вы находитесь на запись сразу после удаленной записи. Но вызов **MovePrevious** запись предшествующей вы удалили текущей записи, так как удаленная запись больше не учитывается в членстве в active **записей**.  
  
 Особенно сложно определить семантику перемещения согласованность всех поставщиков для методов, которые выполняют перемещение по отношению к текущей записи - **MovePrevious**, **MoveNext**, и **переместить** - зависимым от изменений данных в текущей записи. Например, если вы работаете с отсортированное, отфильтрованы **записей**и изменить данные в текущей записи, чтобы он будет предшествовать все остальные записи, но измененные данные также больше не соответствует фильтру, не совсем понятно, где **MoveNext** операция займет у вас. Наиболее безопасным заключение является, относительный перемещение в пределах **записей** является более рискованны, чем абсолютный перемещения (например с помощью **MoveFirst** или **MoveLast**) данных Изменение во время записи редактируются, добавлены или удалены. Сортировка и фильтрация должно основываться на первичный ключ или идентификатор, так как этот тип значения не следует изменять.
