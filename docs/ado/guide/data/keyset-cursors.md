---
title: Курсоры набора ключей | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- Keyset cursors [ADO]
- cursors [ADO], Keyset
ms.assetid: 14b51b17-6fd9-4146-af45-ca4b0fe6d48a
author: MightyPen
ms.author: genemi
ms.openlocfilehash: c7a12d1579af407bca77c9fa61d660a84a09f04e
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "67924918"
---
# <a name="keyset-cursors"></a>Курсоры ключевого набора
Курсор KEYSET предоставляет функциональные возможности между статическим и динамическим курсорами в возможности обнаружения изменений. Так же как статический курсор, он не всегда обнаруживает изменения, внесенные в членство и порядок элементов результирующего набора. Так же как динамический курсор, он обнаруживает изменения, внесенные в значения строк результирующего набора.  
  
 Такие курсоры управляются с помощью набора уникальных идентификаторов — ключей. Ключи создаются из набора столбцов, который уникально идентифицирует строки результирующего набора. Набор ключей — это набор ключевых значений всех строк, возвращаемых инструкцией запроса.  
  
 При использовании управляемых наборами ключей курсоров ключ создается для каждой строки курсора и сохраняется на клиентском компьютере или на сервере. При обращении к строке сохраненный ключ используется для получения текущих значений данных из источника данных. В курсоре, управляемом набором ключей, членство в результирующем наборе становится фиксированным, когда набор ключей полностью заполняется. Поэтому результаты операций добавления и обновления, влияющих на членство, не включаются в результирующий набор до повторного открытия.  
  
 Изменения значений данных (сделанных либо владельцем набора ключей, либо другими процессами) видимы при прокрутке результирующего набора пользователем. Чтобы результаты вставки извне курсора (другими процессами) были видны, нужно закрыть курсор и открыть его заново. Результаты вставки внутри курсора видны в конце результирующего набора.  
  
 Когда курсор, управляемый набором ключей, пытается извлечь строку, которая была удалена, строка отображается в результирующем наборе как "отверстие". В наборе ключей ключ для этой строки есть, но самой строки в результирующем наборе больше нет. Если значения ключей в строке обновляются, строка считается удаленной, а затем вставлена, поэтому такие строки также отображаются в результирующем наборе как отверстия. Хотя курсор, управляемый набором ключей, всегда может обнаруживать строки, удаленные другими процессами, он может при необходимости удалить ключи для удаляемых строк. Курсоры, управляемые набором ключей, которые делают это, не могут обнаруживать свои собственные удаления, так как свидетельство было удалено.  
  
 Обновление ключевого столбца действует аналогично удалению старого ключа, за которым следует Вставка нового ключа. Новое значение ключа не отображается, если обновление не было выполнено с помощью курсора. Если обновление было выполнено с помощью курсора, новое значение ключа отображается в конце результирующего набора.  
  
 Существует разновидность курсоров, управляемых набором ключей, называемых стандартными курсорами, управляемыми набором ключей. В стандартном курсоре, управляемом набором ключей, членство строк в результирующем наборе и порядок строк фиксируются во время открытия курсора, но изменения в значениях, внесенные владельцем курсора и зафиксированными изменениями, внесенными другими процессами, видимы. Если изменение раскрывает строку для членства или влияет на порядок строки, строка не исчезает или перемещается, пока курсор не будет закрыт и открыт повторно. Вставленные данные не отображаются, но изменения существующих данных отображаются по мере выборки строк.  
  
 Курсор, управляемый набором ключей, трудно использовать правильно, поскольку чувствительность к изменениям данных зависит от многих различных обстоятельств, как описано выше. Однако если приложение не имеет дело с параллельными обновлениями, может программно работать с неверными ключами и иметь прямой доступ к определенным строкам с ключом, курсор, управляемый набором ключей, может работать за вас. Используйте **Адопенкэйсет курсортипинум** , чтобы указать, что вы хотите использовать курсор KEYSET в ADO.  
  
## <a name="see-also"></a>См. также:  
 [Однопроходные курсоры](../../../ado/guide/data/forward-only-cursors.md)   
 [Статические курсоры](../../../ado/guide/data/static-cursors.md)   
 [Динамические курсоры](../../../ado/guide/data/dynamic-cursors.md)
