---
title: Формировать предложение COMPUTE | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- shape commands [ADO]
- compute clause [ADO]
- data shaping [ADO], COMPUTE clause
ms.assetid: 3fdfead2-b5ab-4163-9b1d-3d2143a5db8c
author: MightyPen
ms.author: genemi
manager: jroth
ms.openlocfilehash: e1e268da5eb4c53b6270e474987c69b88383cd9b
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "66700339"
---
# <a name="shape-compute-clause"></a>Предложение COMPUTE для формирования данных
Предложение COMPUTE для формирования создает родительского **записей**, столбцы которых состоят из ссылки на дочерние **записей**; необязательный столбцы, содержимое которой представлено главы, новый, или вычисляемых столбцов, или результат выполнения агрегатные функции на дочернем **записей** или ранее сформированные **записей**; и любых столбцов с дочернего **набор записей** перечисленные в необязательное предложение BY.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
SHAPE child-command [AS] child-alias  
   COMPUTE child-alias [[AS] name], [appended-column-list]  
   [BY grp-field-list]  
```  
  
## <a name="description"></a>Описание  
 Ниже приведены компоненты этого предложения.  
  
 *Дочерняя команда*  
 Состоит из одной из следующих:  
  
-   Команды запроса в фигурных скобках (»{}»), метод возвращает значение потомка **записей** объекта. Команды для базового поставщика данных, и его синтаксис зависит от требований этого поставщика. Оно обычно представлено языка SQL, несмотря на то, что ADO не требует любого языка конкретного запроса.  
  
-   Имя существующего форме **записей**.  
  
-   Команда другой фигуры.  
  
-   Таблица ключевое слово, за которым следует имя таблицы в поставщике данных.  
  
 *дочерний alias*  
 Псевдоним, используемый для ссылки на **записей** возвращаемые *дочерняя команда.* *Дочерних alias* требуется в список столбцов в предложении COMPUTE, а также определяет отношения между родительским и дочерним **записей** объектов.  
  
 *добавлен столбец список-*  
 Список, в котором каждый элемент определяет столбец в создан родительский элемент. Каждый элемент содержит столбец, новый столбец, вычисляемый столбец или значение, являющееся результатом агрегатной функции на дочернем **записей**.  
  
 *grp-field-list*  
 Список столбцов в родительской и дочерней **записей** объектов, определяющих, как должны группироваться строки в дочерней.  
  
 Для каждого столбца в *grp поле list,* отсутствует соответствующий столбец в дочерней и родительской **записей** объектов. Для каждой строки в родительском объекте **записей**, *grp список полей* столбцы имеют уникальные значения и дочерние **набор записей** ссылается родительский строка состоит только из дочернего строки, в которых *grp список полей* столбцы имеют те же значения, что родительскую строку.  
  
 Если предложение BY, дочерние **записей**строки будут сгруппированы на основе на столбцы в предложении COMPUTE. Родительский **записей** включает по одной строке для каждой группы строк в дочерней **записей**.  
  
 Если предложение BY опущено, весь дочерний **записей** рассматривается как одна группа и родительским **записей** будет содержать ровно одна строка. Этой строки будет ссылаться на весь дочерний **записей**. Если предложение BY позволяет вычислять статистические выражения «общий итог» через весь дочерний **записей**.  
  
 Пример:  
  
```  
SHAPE {select * from Orders} AS orders             COMPUTE orders, SUM(orders.OrderAmount) as TotalSales         
```  
  
 Независимо от способа родительского **записей** формируется (ВЫЧИСЛЕНИЙ или APPEND), он будет содержать столбец, используемый для связать ее с дочерним **записей**. При желании родительского **записей** также может содержать столбцы, содержащие статистические функции (SUM, MIN, MAX и т. д.) через дочерние строки. У родительского и дочернего **записей** может содержать столбцы, содержащие выражения строки в **записей**, а также столбцы, которые являются новые и изначально пустое.  
  
## <a name="operation"></a>Операция  
 *Дочерняя команда* выдается поставщику, который возвращает дочерний элемент **записей**.  
  
 Предложение COMPUTE указывает столбцы родительского **набор записей**, который может ссылаться на дочерние **записей**, один или несколько статистических выражений, вычисляемое выражение или новые столбцы. Если предложение BY, он определяет столбцы также добавляются к родительскому **записей**. Указывает предложение BY как строки дочерней **записей** группируются.  
  
 Например предположим, что у вас есть таблицы, с именем демографических данных, которая состоит из штатов, городов и заполнение полей. (Заполнение фигур в таблице приведены исключительно в качестве примера).  
  
|Штат|Город|Заполнение|  
|-----------|----------|----------------|  
|WA|Seattle|700,000|  
|OR|Medford|200,000|  
|OR|Portland|400,000|  
|CA|Лос-Анджелес|800,000|  
|CA|Сан-Диего|600,000|  
|WA|Такома|500,000|  
|OR|Corvallis|300,000|  
  
 Теперь выполните эту команду фигуры:  
  
```  
rst.Open  "SHAPE {select * from demographics} AS rs "  & _  
          "COMPUTE rs, SUM(rs.population) BY state", _  
           objConnection  
```  
  
 Эта команда открывает фигурной **записей** с двумя уровнями. Родительский уровень — это созданный **записей** с составного столбца (`SUM(rs.population)`), ссылающихся на дочерний столбец **набор записей** (`rs`) и столбец для группирования дочерних **Записей** (`state`). Дочерний уровень **записей** получить с помощью команды запроса (`select * from demographics`).  
  
 Дочерние **записей** строк детализации будет, сгруппированных по состоянию, но в других в произвольном порядке. То есть группа не попадет в или алфавитном порядке. Если вы хотите, чтобы родительский **записей** порядка, можно использовать **сортировки записей** для упорядочивания родительского **записей**.  
  
 Теперь можно переходить открытый родительского **набор записей** и получить доступ к детализации дочерних **набор записей** объектов. Дополнительные сведения см. в разделе [доступ к строкам в иерархических наборах записей](../../../ado/guide/data/accessing-rows-in-a-hierarchical-recordset.md).  
  
## <a name="resultant-parent-and-child-detail-recordsets"></a>Итоговый родительским и дочерними наборами записей детализации  
  
### <a name="parent"></a>Parent  
  
|SUM (rs. Заполнение)|rs|Штат|  
|---------------------------|--------|-----------|  
|1,300,000|Ссылка на child1|CA|  
|1,200,000|Ссылка на child2|WA|  
|1,100,000|Ссылка на child3|OR|  
  
## <a name="child1"></a>Child1  
  
|Штат|Город|Заполнение|  
|-----------|----------|----------------|  
|CA|Лос-Анджелес|800,000|  
|CA|Сан-Диего|600,000|  
  
## <a name="child2"></a>Child2  
  
|Штат|Город|Заполнение|  
|-----------|----------|----------------|  
|WA|Seattle|700,000|  
|WA|Такома|500,000|  
  
## <a name="child3"></a>Child3  
  
|Штат|Город|Заполнение|  
|-----------|----------|----------------|  
|OR|Medford|200,000|  
|OR|Portland|400,000|  
|OR|Corvallis|300,000|  
  
## <a name="see-also"></a>См. также  
 [Доступ к строкам в иерархических наборах записей](../../../ado/guide/data/accessing-rows-in-a-hierarchical-recordset.md)   
 [Общие сведения о формировании данных](../../../ado/guide/data/data-shaping-overview.md)   
 [Объект field](../../../ado/reference/ado-api/field-object.md)   
 [Грамматика формального формирования данных](../../../ado/guide/data/formal-shape-grammar.md)   
 [Объект Recordset (ADO)](../../../ado/reference/ado-api/recordset-object-ado.md)   
 [Обязательные поставщики для формирования данных](../../../ado/guide/data/required-providers-for-data-shaping.md)   
 [Предложение APPEND для формирования](../../../ado/guide/data/shape-append-clause.md)   
 [Общие сведения о командах фигуры](../../../ado/guide/data/shape-commands-in-general.md)   
 [Свойство Value (ADO)](../../../ado/reference/ado-api/value-property-ado.md)   
 [Функции Visual Basic для приложений](../../../ado/guide/data/visual-basic-for-applications-functions.md)
