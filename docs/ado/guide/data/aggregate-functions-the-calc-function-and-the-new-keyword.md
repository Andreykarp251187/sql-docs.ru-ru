---
title: Агрегатные функции, функция CALC и ключевое слово NEW | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- data shaping [ADO], functions
- CALC function [ADO]
- NEW keyword [ADO]
- aggregate functions [ADO]
ms.assetid: 0590b466-2a36-49a2-868e-028ef5e49394
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 5a7ed836b9b57ddd690dd85dd94cc12cb967c472
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2020
ms.locfileid: "67926001"
---
# <a name="aggregate-functions-the-calc-function-and-the-new-keyword"></a>Агрегатные функции, функция CALC и ключевое слово NEW
Функция формирования данных поддерживает следующие функции. Имя, присвоенное главе, содержащей столбец для обработки, является *псевдонимом главы*.  
  
 Псевдоним главы может быть полным, состоящим из имени каждого столбца главы, в который входит глава *, содержащая имя столбца,* разделенные точками. Например, если родительская глава, Chap1, содержит дочернюю главу Chap2, имеющую столбец Amount, то полное имя будет Chap1. Chap2. AMT.  
  
|Агрегатные функции|Description|  
|-------------------------|-----------------|  
|SUM (*раздел-Alias*.* имя столбца*)|Вычисляет сумму всех значений в указанном столбце.|  
|AVG (*раздел-Alias*.* имя столбца*)|Вычисляет среднее всех значений в указанном столбце.|  
|MAX (*раздел-Alias*.* имя столбца*)|Вычисляет максимальное значение в указанном столбце.|  
|MIN (*раздел-Alias*.* имя столбца*)|Вычисляет минимальное значение в указанном столбце.|  
|COUNT (*раздел-Alias*[.* column-name*])|Подсчитывает количество строк в указанном псевдониме. Если столбец указан, в счетчик включаются только строки, для которых этот столбец имеет значение, отличное от NULL.|  
|STDEV (*раздел-Alias*.* имя столбца*)|Вычисляет стандартное отклонение в указанном столбце.|  
|ANY (*раздел-Alias*.* имя столбца*)|Значение указанного столбца. ANY имеет прогнозируемое значение, только если значение столбца одинаково для всех строк в главе.<br /><br /> **Примечание** . Если столбец не содержит одинаковое значение для всех строк главы, команда SHAPE произвольно возвращает одно из значений, которое является значением любой функции.|  
  
|Вычисляемое выражение|Description|  
|---------------------------|-----------------|  
|CALC (*выражение*)|Вычисляет произвольное выражение, но только для строки **набора записей** , содержащего функцию Calc. Любое выражение, использующее эти [функции Visual Basic для приложений (VBA)](../../../ado/guide/data/visual-basic-for-applications-functions.md) , разрешено.|  
  
|СОЗДАТЬ ключевое слово|Description|  
|-----------------|-----------------|  
|НОВОЕ *поле-Тип* [(*Ширина* &#124; *шкала* &#124; *точность* &#124; *Ошибка* [, *масштаб* &#124; *Ошибка*])]|Добавляет в **набор записей**пустой столбец указанного типа.|  
  
 *Тип поля* , переданный с помощью ключевого слова New, может быть любым из следующих типов данных.  
  
|Типы данных OLE DB|Эквиваленты типов данных ADO|  
|-----------------------|-----------------------------------|  
|DBTYPE_BSTR|adBSTR|  
|DBTYPE_BOOL|adBoolean|  
|DBTYPE_DECIMAL|adDecimal|  
|DBTYPE_UI1|адунсигнедтининт|  
|DBTYPE_I1|адтининт|  
|DBTYPE_UI2|adUnsignedSmallInt|  
|DBTYPE_UI4|адунсигнединт|  
|DBTYPE_I8|adBigInt|  
|DBTYPE_UI8|адунсигнедбигинт|  
|DBTYPE_GUID|адгуид|  
|DBTYPE_BYTES|Адбинари, Адварбинари, Адлонгварбинари|  
|DBTYPE_STR|Адчар, Адварчар, Адлонгварчар|  
|DBTYPE_WSTR|Адвчар, Адварвчар, Адлонгварвчар|  
|DBTYPE_NUMERIC|adNumeric|  
|DBTYPE_DBDATE|аддбдате|  
|DBTYPE_DBTIME|adDBTime|  
|DBTYPE_DBTIMESTAMP|аддбтиместамп|  
|DBTYPE_VARNUMERIC|адварнумерик|  
|DBTYPE_FILETIME|adFileTime|  
|DBTYPE_ERROR|адеррор|  
  
 Если новое поле имеет тип Decimal (в OLE DB, DBTYPE_DECIMAL или в ADO, АддеЦимал), необходимо указать значения точности и масштаба.  
  
## <a name="see-also"></a>См. также:  
 [Пример формирования данных](../../../ado/guide/data/data-shaping-example.md)   
 [Грамматика формальной фигуры](../../../ado/guide/data/formal-shape-grammar.md)   
 [Общие сведения о командах формирования данных](../../../ado/guide/data/shape-commands-in-general.md)
