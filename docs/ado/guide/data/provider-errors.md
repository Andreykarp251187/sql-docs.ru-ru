---
title: Ошибки поставщика | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- errors collection [ADO]
- provider errors [ADO]
- event-related errors [ADO]
- errors [ADO], provider
- Error object [ADO], provider errors
ms.assetid: cc7d6ff9-2034-45c6-9d61-90b177010054
author: MightyPen
ms.author: genemi
manager: jroth
ms.openlocfilehash: 56fff67f882eceec3c07553e5c465da65a69ce65
ms.sourcegitcommit: fc341b2e08937fdd07ea5f4d74a90677fcdac354
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/05/2019
ms.locfileid: "66718675"
---
# <a name="provider-errors"></a>Ошибки поставщика
При возникновении ошибки поставщика, возвращается ошибка времени выполнения объекта -2147467259. При появлении этой ошибки проверьте **ошибки** коллекцию активных **подключения** объект, который будет содержать одну или несколько ошибок, описывающие, что именно произошло.  
  
## <a name="the-ado-errors-collection"></a>Коллекция ошибок ADO  
 Потому что конкретной операции ADO можно создать несколько ошибок поставщика, ADO, предоставляет доступ к коллекции объектов ошибок через **подключения** объекта. Эта коллекция не содержит объектов, если операция завершается успешно и содержит один или несколько **ошибка** объекты, если что-то пошло не так, и поставщик возникает одна или несколько ошибок. Проверьте каждый объект ошибки, чтобы определить точную причину ошибки.  
  
 Сразу после завершения обработки ошибок, произошедших, можно очистить коллекцию путем вызова **снимите** метод. Это особенно важно, чтобы явным образом Очистить **ошибки** коллекции перед вызовом метода **Resync**, **UpdateBatch**, или **CancelBatch**метод **набор записей** объекта, **откройте** метод на **подключения** , задана объекта или **фильтра** свойство **Записей** объекта. Сняв коллекции явным образом, можно быть уверенным, что любой **ошибка** объектов в коллекции не, оставшихся после предыдущей операции.  
  
 Некоторые операции могут создавать предупреждения вместе с ошибками. Предупреждения также представлены **ошибка** объекты в **ошибки** коллекции. Если поставщик добавляет предупреждение в коллекцию, он не создает ошибку времени выполнения. Проверьте **число** свойство **ошибки** коллекции, чтобы определить, было произведено ли предупреждение по конкретной операции. Если количество объектов в одной или более поздней версии, **ошибка** объект был добавлен в коллекцию. Как выяснилось, что **ошибки** коллекция содержит ошибки или предупреждения, можно выполнять итерации по коллекции и получать сведения о каждом **ошибка** содержащего его объекта. В следующем примере Visual Basic короткий демонстрирует это:  
  
```  
' BeginErrorHandlingVB02  
Private Function DeleteCustomer(ByVal CompanyName As String) As Long  
    On Error GoTo DeleteCustomerError  
  
    rst.Find "CompanyName='" & CompanyName & "'"  
DeleteCustomerError:  
Dim objError As ADODB.Error  
Dim strError As String  
  
    If cnn.Errors.Count > 0 Then  
        For Each objError In cnn.Errors  
            strError = strError & "Error #" & objError.Number & _  
                " " & objError.Description & vbCrLf & _  
                "NativeError: " & objError.NativeError & vbCrLf & _  
                "SQLState: " & objError.SQLState & vbCrLf & _  
                "Reported by: " & objError.Source & vbCrLf & _  
                "Help file: " & objError.HelpFile & vbCrLf & _  
                "Help Context ID: " & objError.HelpContext  
        Next  
        MsgBox strError  
    End If  
End Function  
' EndErrorHandlingVB02  
```  
  
 Включает процедуру обработки ошибок **для каждого** цикл, который проверяет каждый объект в **ошибки** коллекции. В этом примере он накапливает сообщения для отображения. В работающую программу, можно написать код для выполнения соответствующей задачи для каждой ошибки, например, закрыть все открытия файлов и завершение работы программы упорядоченного.  
  
## <a name="the-error-object"></a>Объект Error  
 Изучив **ошибка** объекта можно определить причину возникновения ошибки, а также более важно, какие приложения или какие объекта вызвал ошибку. **Ошибка** объект имеет следующие свойства:  
  
|Имя свойства|Описание|  
|-------------------|-----------------|  
|**Описание**|Текстовое описание возникшей ошибки.|  
|**HelpContext и HelpFile**|Ссылается на файл раздела справки и справки, содержат описание возникшей ошибки.|  
|**NativeError**|Номер ошибки от поставщика.|  
|**номер**|Длинное целое число, представляющее номер (перечисленных в **ErrorValueEnum**) возникшей ошибки.|  
|**Source**|Указывает имя объекта или приложения, вызвавшего ошибку.|  
|**SQLState**|Пятизначный код ошибки, поставщик возвращает во время выполнения инструкции SQL.|  
  
 ADO **ошибка** объект является очень похожа на Visual Basic, standard **Err** объекта. Свойства описания возникшей ошибки. В дополнение к числу ошибок вы также получаете два связанных частей данных. **NativeError** свойство содержит номер ошибки поставщика вы используете. В предыдущем примере поставщиком является поставщик Microsoft OLE DB для SQL Server, таким образом **NativeError** будет содержать ошибки, связанные с SQL Server. **SQLState** свойство имеет пяти букв код, описывающий ошибку в инструкции SQL.  
  
## <a name="event-related-errors"></a>Ошибки, связанные с событиями  
 **Ошибка** объект также используется при возникновении ошибки, связанные с событиями. Можно определить, произошла ли ошибка в процессе, который вызывает событие ADO, проверив **ошибка** объект, передаваемый как параметр события.  
  
 Если операция, вызывающая событие является подтвердила успешно, *adStatus* параметр обработчика событий будет присвоено *adStatusOK*. С другой стороны, если операция, вызвавшая событие был неудачным *adStatus* параметр имеет значение *adStatusErrorsOccurred*. В этом случае *pError* будет содержать параметр **ошибка** , описывающий ошибку.
