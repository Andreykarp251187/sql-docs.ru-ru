---
title: Параметры события | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- Error parameter [ADO]
- Object parameter [ADO]
- Status parameter [ADO]
- events [ADO], parameters
- Reason parameter [ADO]
- event parameters [ADO]
ms.assetid: bd5c5afa-d301-4899-acda-40f98a6afa4d
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 2e44bc264b5fd3e21e35042243ee81f7834c60b2
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "63161643"
---
# <a name="event-parameters"></a>Параметры события
Каждый обработчик событий имеет параметр состояния, который управляет обработчик событий. Для события завершения этот параметр также используется для указания на успешность или сбой операции, который создал событие. Наиболее полная события также имеют параметр "Ошибка" для предоставления сведений о любой ошибки, возможно, произошло и один или несколько объектов параметров, которые ссылаются на объекты ADO, используемые для выполнения операции. Например [ExecuteComplete](../../../ado/reference/ado-api/executecomplete-event-ado.md) событий включает параметры объекта **команда**, **набор записей**, и **подключения** объектов связанный с событием. В следующем примере Microsoft Visual Basic®, вы увидите командной, pRecordset и pConnection объекты, которые представляют **команда**, **записей**, и **подключения** объекты, используемые **Execute** метод.  
  
```  
Private Sub connEvent_ExecuteComplete(ByVal RecordsAffected As Long, _  
     ByVal pError As ADODB.Error, _  
     adStatus As ADODB.EventStatusEnum, _  
     ByVal pCommand As ADODB.Command, _  
     ByVal pRecordset As ADODB.Recordset, _  
     ByVal pConnection As ADODB.Connection)  
```  
  
 За исключением **ошибка** объекта, те же параметры передаются на события будет. Это позволяет изучить каждый из объектов, которые будут использоваться в отложенной операции и определить, разрешены ли операции завершения.  
  
 Некоторые обработчики событий имеют *Причина* параметр, который предоставляет дополнительные сведения о причине события. Например **события WillMove** и **MoveComplete** события могут происходить из-за одного из методов навигации (**MoveNext**, **MovePrevious**, и так далее) благосостояние вызываемой или в результате обновление.  
  
## <a name="status-parameter"></a>Параметр состояния  
 При вызове подпрограммы обработчика событий *состояние* параметра присваивается одно из следующих значений.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**adStatusOK**|Передается будет и события завершения. Это значение означает, что операции, которая вызвала событие успешно завершено.|  
|**adStatusErrorsOccurred**|Передаваемые события завершения. Это значение означает, что не удалось выполнить операцию, которая вызвала событие или событие будет отменена операция. Проверьте *ошибка* параметр для получения дополнительных сведений.|  
|**adStatusCantDeny**|Только события будут переданы. Это значение означает, что событие будет не может отменить операцию. Она должна быть выполнена.|  
  
 Если в вашей будет событие, которое следует продолжить операцию, оставьте *состояние* параметр без изменений. До тех пор, пока не было задано входящего параметра состояния **adStatusCantDeny**, тем не менее, можно отменить выполняющуюся операцию, изменив *состояние* для **adStatusCancel**. При этом событие завершения, связанные с операцией имеет его *состояние* параметру присвоить **adStatusErrorsOccurred**. **Ошибка** объект, передаваемый в событие завершения будет содержать значение **adErrOperationCancelled**.  
  
 Если вы больше не хотите обрабатывать событие, можно задать *состояние* для **adStatusUnwantedEvent** и приложения больше не будет получать уведомления этого события. Однако следует помните, что некоторые события могут вызываться для более чем одна из причин. В этом случае необходимо указать **adStatusUnwantedEvent** для каждой из возможных причин. Например, чтобы прекратить получение уведомлений об ожидающих **RecordChange** событий, необходимо задать *состояние* параметр **adStatusUnwantedEvent** для  **adRsnAddNew**, **adRsnDelete**, **adRsnUpdate**, **adRsnUndoUpdate**, **adRsnUndoAddNew**, **adRsnUndoDelete**, и **adRsnFirstChange** мере их появления.  
  
|Значение|Описание|  
|-----------|-----------------|  
|**adStatusUnwantedEvent**|Запрос, что этот обработчик событий получать дальнейшие уведомления.|  
|**adStatusCancel**|Запросить отмену операции, которая должна возникать.|  
  
## <a name="error-parameter"></a>Параметр ошибки  
 *Ошибка* параметр является ссылкой на объект ADO [ошибка](../../../ado/reference/ado-api/error-object.md) объекта. Когда *состояние* параметр имеет значение **adStatusErrorsOccurred**, **ошибка** объект содержит сведения о причине сбоя операции. Если будет событие, связанное с событием завершения отменил операцию, задав *состояние* параметр **adStatusCancel**, объект ошибки всегда имеет значение  **adErrOperationCancelled**.  
  
## <a name="object-parameter"></a>Параметр объекта  
 Каждое событие получает один или несколько объектов, представляющих объекты, которые участвуют в операции. Например **ExecuteComplete** получает событие **команда** объекта, **набор записей** объекта и **подключения** объекта.  
  
## <a name="reason-parameter"></a>Параметр причина  
 *Причина* параметра *adReason*, Дополнительные сведения о причине события. События с *adReason* параметр может быть вызван несколько раз, даже для той же операции, по другой причине каждый раз. Например **события WillChangeRecord** обработчик событий вызывается для операций, которые собираетесь выполнить или отменить вставки, удаления или изменения записи. Если вы хотите обработать событие, когда оно происходит по определенной причине, можно использовать только *adReason* параметр для фильтрации вхождений, которые вас не интересуют. Например если требуется обрабатывать события изменения записи только в том случае, при их возникновении, так как запись была добавлена, можно использовать примерно следующим образом.  
  
```  
' BeginEventExampleVB01  
Private Sub rsTest_WillChangeRecord(ByVal adReason As ADODB.EventReasonEnum, ByVal cRecords As Long, adStatus As ADODB.EventStatusEnum, ByVal pRecordset As ADODB.Recordset)  
   If adReason = adRsnAddNew Then  
       ' Process event  
       '...  
   Else  
       ' Cancel event notification for all  
       ' other possible adReason values.  
       adStatus = adStatusUnwantedEvent  
   End If  
End Sub  
' EndEventExampleVB01  
```  
  
 В этом случае уведомление может потенциально могут возникнуть для каждого из других причин. Тем не менее он будет появляться только один раз для каждой причины. После уведомление возникла один раз для каждой причины, вы получите уведомление только для добавления новой записи.  
  
 Напротив, необходимо задать *adStatus* для **adStatusUnwantedEvent** только один раз для запроса, обработчик событий без **adReason** принимающему событие остановки параметр уведомления.  
  
## <a name="see-also"></a>См. также  
 [Общие сведения об обработчике событий ADO](../../../ado/guide/data/ado-event-handler-summary.md)   
 [Создание экземпляра события ADO по языку](../../../ado/guide/data/ado-event-instantiation-by-language.md)   
 [Совместная работа обработчиков событий](../../../ado/guide/data/how-event-handlers-work-together.md)   
 [Типы событий](../../../ado/guide/data/types-of-events.md)
