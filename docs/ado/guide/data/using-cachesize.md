---
title: Использование CacheSize | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- locks [ADO], CacheSize property
- CacheSize property [ADO]
ms.assetid: ca1c3422-b6a4-4ba6-af55-54f975b698b1
author: MightyPen
ms.author: genemi
manager: jroth
ms.openlocfilehash: d0b6a1b83b09d504f8f3394a32ee10d556fcd18c
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/15/2019
ms.locfileid: "66699737"
---
# <a name="using-cachesize"></a>Using CacheSize
Используйте **CacheSize** свойства для управления, сколько записей следует извлечь за один раз в локальную память от поставщика. Например если **CacheSize** — 10, после первого открытия **записей** объекта, поставщик извлекает первые 10 записей в локальной памяти. По мере продвижения по **записей** объекта, поставщик возвращает данные из локальной памяти буфера. После перемещения за последней записью в кэше, поставщик извлекает следующие 10 записей из источника данных в кэш.  
  
> [!NOTE]
>  **CacheSize** основан на **максимальное число открытых строк** свойства поставщика (в **свойства** коллекцию **записей** объекта). Невозможно задать **CacheSize** больше, чем значение **максимальное число открытых строк.** Чтобы изменить число строк, которые можно открыть поставщиком, задайте **максимальное число открытых строк**.  
  
 Значение **CacheSize** может корректироваться в течение жизненного цикла **записей** объект, но изменить это значение влияет только на число записей в кэше после последующих получений из источника данных. Изменение только значение свойства не повлияет на текущее содержимое кэша.  
  
 При наличии меньшего числа записей для извлечения чем **CacheSize** указывает, поставщик возвращает оставшиеся записи и ошибка не возникает.  
  
 Объект **CacheSize** не допускается значение 0 и возвращает сообщение об ошибке.  
  
 Записей, полученных из кэша не отражают параллельные изменения, внесенные другими пользователями в исходных данных. Чтобы выполнить принудительное обновление всех кэшированных данных, используйте [Resync](../../../ado/reference/ado-api/resync-method.md) метод.  
  
 Если **CacheSize** присваивается значение больше 1, методы навигации ([переместить](../../../ado/reference/ado-api/move-method-ado.md), [MoveFirst, MoveLast, MoveNext и MovePrevious](../../../ado/reference/ado-api/movefirst-movelast-movenext-and-moveprevious-methods-ado.md)) может привести к навигации удаленной запись, если удаление происходит после записи были получены. После первоначальной выборки последующих операций удаления не отражаются в кэше данных до попытки получить доступ к значению данных из удаленной строки. Однако можно присвоить **CacheSize** 1 устраняет эту проблему, так как удаленные строки не могут быть выбраны.
