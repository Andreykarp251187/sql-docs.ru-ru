---
title: Пример формирования данных | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- data shaping [ADO], about data shaping
ms.assetid: 1bfdcad4-52e1-45bc-ad21-783657ef0a44
author: MightyPen
ms.author: genemi
ms.openlocfilehash: a946329ad95a2b226f186e571152268baa5f37c3
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "67925668"
---
# <a name="data-shaping-example"></a>Пример формирования данных
Следующие данные, формирование команды показано, как построить иерархическую **записей** из **клиентов** и **заказы** таблиц в базе данных "Борей".  
  
```  
SHAPE {SELECT CustomerID, ContactName FROM Customers}   
APPEND ({SELECT OrderID, OrderDate, CustomerID FROM Orders} AS chapOrders   
RELATE customerID TO customerID)   
```  
  
 Если эта команда используется для открытия **набор записей** объекта (как показано в [Visual Basic пример для формирования данных](../../../ado/guide/data/visual-basic-example-of-data-shaping.md)), он создает Глава (**chapOrders**) для каждой из возвращаемых записей из **клиентов** таблицы. Эта глава состоит из подмножества **записей** возвращаемые **заказы** таблицы. **ChapOrders** глава содержит все запрашиваемые данные о заказах, размещенных данного клиента. В этом примере глава состоит из трех столбцов: **OrderID**, **OrderDate**, и **CustomerID**.  
  
 Первые две записи результирующего форме **записей** таковы:  
  
|CustomerID|ContactName|OrderID|OrderDate|CustomerID|  
|----------------|-----------------|-------------|---------------|----------------|  
|ALFKI|Мария Ander|10643<br /><br /> 10692<br /><br /> 10702<br /><br /> 10835<br /><br /> 10952<br /><br /> 11011|1997-08-25<br /><br /> 1997-10-03<br /><br /> 1997-10-13<br /><br /> 1998-01-15<br /><br /> 1998-03-16<br /><br /> 1998-04-09|ALFKI<br /><br /> ALFKI<br /><br /> ALFKI<br /><br /> ALFKI<br /><br /> ALFKI<br /><br /> ALFKI|  
|ANATR|Ана Трухильо|10308<br /><br /> 10625<br /><br /> 10759<br /><br /> 10926|1996-09-18<br /><br /> 1997-08-08<br /><br /> 1997-11-28<br /><br /> 1998-03-04|ANATR<br /><br /> ANATR<br /><br /> ANATR<br /><br /> ANATR|  
  
 В команде ФИГУРЫ, APPEND используется для создания дочернего **записей** связанных с родительским **записей** (как возвращенный командой поставщика сразу после ключевого слова ФИГУРЫ, которые обсуждались ранее) в предложении RELATE. Родительский и дочерний общих обычно имеют по крайней мере один столбец: Значение столбца в строке родительского элемента совпадает с значением столбца во всех строках дочернего элемента.  
  
 Имеется второй способ использования команд формы: а именно, для создания родительской **записей** из дочернего **записей**. Записи в дочернем **записей** группируются, как правило, используя предложение BY и одна строка добавляется к родительскому **записей** для каждой группы, полученный в дочерней. Если предложение BY опущено, дочерние **записей** будет формы, одна группа и родительским **записей** будет содержать ровно одна строка. Это полезно для статистической обработки «общий итог» через весь дочерний **записей**.  
  
 Конструкция команда ФИГУРЫ также предоставляет возможность программно создавать формы **записей**. Вы можете обращаться к компоненты **записей** программно или с помощью соответствующего визуального элемента управления. Команда фигуры выдается как любой другой текст команды ADO. Дополнительные сведения см. в разделе [фигуры команды в целом](../../../ado/guide/data/shape-commands-in-general.md).  
  
 Независимо от способа родительского **записей** является формирования, он будет содержать столбец, используемый для связать ее с дочерним **записей**. Если требуется, родительский **записей** также можно составить столбцы, содержащие статистические функции (SUM, MIN, MAX и т. д.) через дочерние строки. У родительского и дочернего **записей** можно составить столбцы, содержащие выражения строки в **записей**, а также столбцы, которые новые и изначально пустое.  
  
 В этом разделе продолжается со следующим разделом.  
  
-   [Пример формирования данных (Visual Basic)](../../../ado/guide/data/visual-basic-example-of-data-shaping.md)
