---
title: Объект поля | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- Field object [ADO]
ms.assetid: 7d1c4ad5-4be3-42ab-b516-e7133ca300bc
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 80e6576b236db44452c4e89b1d8f3bb8976ab120
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "67923985"
---
# <a name="the-field-object"></a>Объект Field
Каждый **поле** объекта обычно соответствует столбец в таблице базы данных. Тем не менее **поле** может также представлять указатель на другой **записей**, вызывается Глава. Исключения, например столбцах, будет рассматриваться далее в этом руководстве.  
  
 Используйте **значение** свойство **поле** объекты задание или возврат данных для текущей записи. В зависимости от функции предоставляет поставщик, некоторые коллекции, методы или свойства **поле** могут оказаться недоступными.  
  
 С помощью коллекций, методы и свойства **поле** объекта, можно сделать следующее:  
  
-   Возвращает имя поля с помощью **имя** свойство.  
  
-   Просмотр или изменение данных в поле с помощью **значение** свойства. **Значение** — свойство по умолчанию **поле** объекта.  
  
-   Возвращает основные характеристики поля с помощью **тип**, **точности**, и **NumericScale** свойства.  
  
-   Возвратить декларируемый размер поля с помощью **DefinedSize** свойство.  
  
-   Возвращает фактический размер данных в этом поле с помощью **ActualSize** свойство.  
  
-   Определить, какие функции поддерживаются для заданного поля с помощью **атрибуты** свойство и **свойства** коллекции.  
  
-   Изменять значения полей, содержащих двоичные или долго символьных данных с помощью **AppendChunk** и **GetChunk** методы.  
  
 Устранить несоответствия в значения полей во время обновления пакета с помощью **OriginalValue** и **UnderlyingValue** свойства, если поставщик поддерживает пакетные обновления.  
  
## <a name="describing-a-field"></a>Описание поля  
 Свойства рассматривается в разделах, которым будет следовать [поле](../../../ado/reference/ado-api/field-object.md) объект, который представляет сведения, описывающие **поле** самого объекта - метаданные о поле. Эти сведения позволяют понять слишком много о схеме **записей**. Эти свойства включают в себя **тип**, **DefinedSize** и **ActualSize**, **имя**, и **NumericScale**и **точности**.  
  
### <a name="discovering-the-data-type"></a>Обнаружение типа данных  
 **Тип** указывает тип данных поля. Тип данных, константы-перечислители, поддерживаемые ADO описаны в [DataTypeEnum](../../../ado/reference/ado-api/datatypeenum.md) в *Справочник по программированию объектов ADO*.  
  
 Для с плавающей запятой в числовых типах таких **adNumeric**, вы можете получить дополнительные сведения. **NumericScale** свойство указывает, сколько разрядов справа от десятичного разделителя будет использоваться для представления значений для **поле**. **Точности** свойство определяет максимальное число разрядов, используемых для представления значений для **поле**.  
  
### <a name="determining-field-size"></a>Определение размера поля  
 Используйте **DefinedSize** свойства, чтобы определить объем данных **поле** объекта.  
  
 Используйте **ActualSize** фактическую длину возвращаемого свойства **поле** значения объекта. Для всех полей **ActualSize** свойство доступно только для чтения. Если ADO не может определить длину **поле** значения объекта, **ActualSize** возвращает **adUnknown**.  
  
 **DefinedSize** и **ActualSize** свойства имеют разных целей. Например, рассмотрим **поле** объект с объявленным типом **adVarChar** и **DefinedSize** значение 50, содержащей один символ. **ActualSize** он возвращает значение свойства имеет длину в байтах один символ.  
  
### <a name="determining-field-contents"></a>Определение содержимого поля  
 Идентификатор столбца из источника данных, представленного **имя** свойство **поле**. **Значение** свойство **поле** объект возвращает или задает фактическое содержимое поля. Это свойство по умолчанию.  
  
 Чтобы изменить данные в поле, установите **значение** для правильного типа новое значение свойства. Тип курсора должны поддерживать обновления для изменения содержимого поля. База данных не выполнена проверка здесь в пакетном режиме, поэтому вам на наличие ошибок, при вызове **UpdateBatch** в этом случае. Некоторые поставщики также поддерживают ADO **поле** объекта **UnderlyingValue** и **OriginalValue** свойства, чтобы помочь в устранении конфликтов при попытке выполнение пакетных обновлений. Дополнительные сведения об устранении таких конфликтов см. в разделе [редактирования данных](../../../ado/guide/data/editing-data.md).  
  
> [!NOTE]
>  **Поля набора записей** значения не могут устанавливаться при добавлении новых **поля** для **записей**. Вместо этого новый **поля** можно добавить к закрытому **записей**. Затем **записей** должны быть значения открыта и только затем могут быть назначены эти **поля**.  
  
### <a name="getting-more-field-information"></a>Получение дополнительных сведений о поле  
 Объекты ADO имеют два типа свойств: встроенные и динамические. К этому моменту только встроенные свойства **поле** подробно обсуждаются объекта.  
  
 Встроенные свойства являются те свойства, реализованного в ADO и сразу становятся доступными для любого new объекта используются `MyObject.Property` синтаксис. Они не отображаются как **свойство** объектов в объекта **свойства** коллекции.  
  
 Динамические свойства определяются базового поставщика данных и отображаются в **свойства** коллекции на соответствующий объект ADO. Например, свойство поставщика может указывать, если **записей** поддерживает объект транзакции или обновление. Эти дополнительные свойства будет отображаться как **свойство** объектов, в который **записей** объекта **свойства** коллекции. Динамические свойства можно ссылаться только с помощью коллекции, используя синтаксис `MyObject.Properties(0)` или `MyObject.Properties("Name")`.  
  
 Не удается удалить любой тип свойства.  
  
 Динамический **свойство** объект имеет четыре встроенных собственными свойствами:  
  
-   **Имя** свойство является строка, определяющая свойство.  
  
-   **Тип** свойство должно быть целым числом, которое указывает тип данных свойства.  
  
-   **Значение** свойство является переменная типа variant, содержащий значение свойства. **Значение** является свойством по умолчанию для **свойство** объекта.  
  
-   **Атрибуты** свойство **Long** значение, указывающее характеристики свойства, соответствующие поставщику.  
  
 **Свойства** коллекции для **поле** объект содержит дополнительные метаданные о поле. Содержимое этой коллекции зависит от поставщика. В следующем примере кода проверяется **свойства** коллекции примера **записей** появилась в начале этого раздела. Сначала он выполняет поиск содержимого коллекции. Этот код использует [поставщик OLE DB для SQL Server](../../../ado/guide/appendixes/microsoft-ole-db-provider-for-sql-server.md), поэтому **свойства** коллекции содержит сведения, относящиеся к этому поставщику.  
  
```  
'BeginFieldProps  
    Dim objProp As ADODB.Property  
  
    For intLoop = 0 To (objFields.Count - 1)  
        Debug.Print objFields.Item(intLoop).Name  
  
        For Each objProp In objFields(intLoop).Properties  
            Debug.Print vbTab & objProp.Name & " = " & objProp.Value  
        Next objProp  
    Next intLoop  
'EndFieldProps  
```  
  
### <a name="dealing-with-binary-data"></a>Работа с двоичными данными  
 Используйте [AppendChunk](../../../ado/reference/ado-api/appendchunk-method-ado.md) метод **поле** объекта, который заполняется долго двоичных или символьных данных. В ситуациях, где ограничена системной памяти, можно использовать **AppendChunk** метод для обработки длинных значений в части, а не полностью.  
  
 Если **adFldLong** бит в **атрибуты** свойство **поле** присваивается **True**, можно использовать  **AppendChunk** метод для этого поля.  
  
 Первый **AppendChunk** вызвать **поле** объект записывает данные в поле, перезаписывая все существующие данные. Последующие **AppendChunk** вызовов добавления к существующим данным. При добавлении данных в одном поле, а затем задать или прочитать значение другого поля в текущей записи, ADO предполагается, что вы закончите, добавление данных в первое поле. При вызове метода **AppendChunk** метод на первое поле, ADO интерпретирует как новый вызов **AppendChunk** операции и перезаписывает существующие данные. Доступ к полям в других **записей** объекты, не являющиеся клонов первого **набор записей** объекта не приведет к нарушению **AppendChunk** операций.  
  
 Используйте **GetChunk** метод **поле** объекта для извлечения всех или части ее долго двоичных или символьных данных. В ситуациях, где ограничена системной памяти, можно использовать **GetChunk** метод для обработки длинных значений в части, а не полностью.  
  
 Данные, **GetChunk** вызов возвращает назначается *переменной*. Если *размер* больше, чем оставшиеся данные, **GetChunk** метод возвращает только оставшиеся данные без заполнения *переменной* пробелами. Если поле пусто, **GetChunk** метод возвращает значение null.  
  
 Каждое последующее **GetChunk** вызов извлекает данные, начиная с которого предыдущего **GetChunk** вызов остановились. Тем не менее если извлекаются данные из одного поля и затем задать или прочитать значение другого поля в текущей записи, ADO предполагается, что вы изучили, извлечение данных из первого поля. При вызове метода **GetChunk** метод на первое поле, ADO интерпретирует как новый вызов **GetChunk** операции и начинает чтение с самого начала данных. Доступ к полям в других **записей** объекты, не являющиеся клонов первого **набор записей** объекта не приведет к нарушению **GetChunk** операций.  
  
 Если **adFldLong** бит в **атрибуты** свойство **поле** присваивается **True**, можно использовать **GetChunk**  метод для этого поля.  
  
 Если имеется текущая запись, при использовании **GetChunk** или **AppendChunk** метод **поле** объекта, возникает ошибка 3021 (текущая запись).  
  
 Пример использования этих методов для обработки двоичных данных, см. в разделе [метод AppendChunk](../../../ado/reference/ado-api/appendchunk-method-ado.md) и [метод GetChunk](../../../ado/reference/ado-api/getchunk-method-ado.md) примеры в *Справочник по программированию объектов ADO*.
