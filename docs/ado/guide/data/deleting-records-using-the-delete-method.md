---
title: Удаление записей с помощью метода Delete | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- ADO, deleting records
- deleting records [ADO]
- editing data [ADO], Delete method
- Delete method [ADO]
ms.assetid: bfed5cfa-7f57-463b-9da2-0c612a079d30
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 1a099b033422e7c10214371772edd090f0cc15fd
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62472386"
---
# <a name="deleting-records-using-the-delete-method"></a>Удаление записей с помощью метода Delete
С помощью **удалить** метод помечает текущую запись или группу записей в **записей** объект для удаления. Если **записей** объекта не допускает удаление записей, возникает ошибка. Если вы находитесь в режим немедленного обновления, удаления происходит в базе данных немедленно. Если запись не удалось успешно (из-за нарушений целостности базы данных, например), запись будет оставаться в режиме редактирования после вызова **обновления.** Это означает, что необходимо отменить обновление с использованием [CancelUpdate](../../../ado/reference/ado-api/cancelupdate-method-ado.md) перед перемещением текущей записи (например, с помощью [закрыть](../../../ado/reference/ado-api/close-method-ado.md), [переместить](../../../ado/reference/ado-api/move-method-ado.md), или [ NextRecordset](../../../ado/reference/ado-api/nextrecordset-method-ado.md)).  
  
 Если вы находитесь в пакетный режим обновления, записи, помечаются для удаления из кэша и фактическое удаление происходит при вызове **UpdateBatch** метод. (Чтобы просмотреть удаленные записи, задайте **фильтра** свойства **adFilterAffectedRecords** после **удалить** называется.)  
  
 Ошибку при попытке извлечь значения полей из удаленной записи. После удаления текущей записи, удаленная запись остается в текущей до перехода к другой записи. Один раз перемещении из удаленной записи, он больше не доступен.  
  
 Если вложить удалений в транзакции, можно восстановить удаленные записи с помощью **RollbackTrans** метод. Если вы находитесь в пакетный режим обновления, можно отменить ожидающие удаления или группой ожидающих удаления с помощью **CancelBatch** метод.  
  
 Если произошел сбой попытки удаления записей из-за конфликта с базовыми данными (например, запись уже был удален другим пользователем), поставщик возвращает предупреждения, чтобы **ошибки** коллекции, но не привела к остановке программы выполнение. Ошибка времени выполнения возникает только в том случае, если есть конфликты запрошенными записями.  
  
 Если **уникальной таблицы** динамическое свойство имеет значение и **записей** является результатом выполнения операции СОЕДИНЕНИЯ на нескольких таблицах **удалить** метод будет удалить только строки из таблицы, указанной в **уникальной таблицы** свойство.  
  
 **Удалить** метод принимает необязательный аргумент, который позволяет указать, какие записи подвержены **удалить** операции. Только допустимые значения для этого аргумента: один из следующих ADO **AffectEnum** перечисляемые константы:  
  
-   **adAffectCurrent** затрагивает только текущую запись.  
  
-   **adAffectGroup** затрагивает только те записи, которые удовлетворяют текущего **фильтра** значение свойства. **Фильтра** свойству должно быть присвоено **FilterGroupEnum** значение или массив **закладки** для использования этого параметра.  
  
 Ниже приведен пример указания **adAffectGroup** при вызове **удалить** метод. Этот пример добавляет некоторые записи в образец **записей** и обновляет базу данных. А затем фильтрует **записей** с помощью **adFilterAffectedRecords** фильтра константа перечислимого типа, который оставляет только вновь добавленных записей видимым в **набор записей.** Наконец, он вызывает **удалить** метода и указывает, что все записи, удовлетворяющие текущим **фильтра** значение свойства (новые записи) должен быть удален.  
  
```  
'BeginDeleteGroup  
    'add some bogus records  
    With objRs  
        For i = 0 To 8  
            .AddNew  
            .Fields("CompanyName") = "Shipper Number " & i + 1  
            .Fields("Phone") = "(425) 555-000" & (i + 1)  
            .Update  
        Next i  
  
        ' update  
        .UpdateBatch  
  
        'filter on newly added records  
        .Filter = adFilterAffectedRecords  
        Debug.Print "Deleting the " & .RecordCount & _  
                    " records you just added."  
  
        'delete the newly added bogus records  
        .Delete adAffectGroup  
        .Filter = adFilterNone  
        Debug.Print .RecordCount & " records remain."  
    End With  
'EndDeleteGroup  
```
