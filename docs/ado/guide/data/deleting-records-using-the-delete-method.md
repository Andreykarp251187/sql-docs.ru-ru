---
title: Удаление записей с помощью метода Delete | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- ADO, deleting records
- deleting records [ADO]
- editing data [ADO], Delete method
- Delete method [ADO]
ms.assetid: bfed5cfa-7f57-463b-9da2-0c612a079d30
author: rothja
ms.author: jroth
ms.openlocfilehash: a8da01b9c92aeec9c01527370e19c8edfb751da9
ms.sourcegitcommit: 6037fb1f1a5ddd933017029eda5f5c281939100c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2020
ms.locfileid: "82763625"
---
# <a name="deleting-records-using-the-delete-method"></a>Удаление записей с помощью метода Delete
Использование метода **Delete** помечает текущую запись или группу записей в объекте **набора записей** для удаления. Если объект **Recordset** не допускает удаления записей, возникает ошибка. Если вы используете режим немедленного обновления, немедленное удаление происходит в базе данных. Если запись не может быть успешно удалена (например, из-за нарушений целостности базы данных), после вызова метода Update запись остается в режиме редактирования **.** Это означает, что необходимо отменить обновление с помощью [CancelUpdate](../../../ado/reference/ado-api/cancelupdate-method-ado.md) перед переходом к текущей записи (например, с помощью [закрытия](../../../ado/reference/ado-api/close-method-ado.md), [перемещения](../../../ado/reference/ado-api/move-method-ado.md)или [NextRecordset](../../../ado/reference/ado-api/nextrecordset-method-ado.md)).  
  
 Если вы используете режим пакетного обновления, записи помечаются для удаления из кэша, а фактическое удаление происходит при вызове метода **UpdateBatch** . (Чтобы просмотреть удаленные записи, присвойте свойству **Filter** значение **Адфилтераффектедрекордс** после вызова **Delete** .)  
  
 При попытке получить значения полей из удаленной записи возникает ошибка. После удаления текущей записи удаленная запись остается текущей до тех пор, пока вы не перейдете к другой записи. После выхода из удаленной записи она становится недоступной.  
  
 При вложении удалений в транзакцию можно восстановить удаленные записи с помощью метода **RollbackTrans** . Если вы используете режим пакетного обновления, можно отменить ожидающее удаление или группу ожидающих удалений с помощью метода **CancelBatch** .  
  
 Если попытка удаления записей завершается сбоем из-за конфликта с базовыми данными (например, запись уже удалена другим пользователем), поставщик возвращает предупреждения в коллекцию **ошибок** , но не останавливает выполнение программы. Ошибка времени выполнения возникает только в случае возникновения конфликтов во всех запрошенных записях.  
  
 Если задано динамическое свойство **уникальной таблицы** и **набор записей** является результатом выполнения операции JOIN с несколькими таблицами, метод **Delete** удаляет строки только из таблицы с именем в свойстве **уникальной таблицы** .  
  
 Метод **Delete** принимает необязательный аргумент, который позволяет указать, какие записи затрагиваются операцией **удаления** . Допустимыми значениями для этого аргумента являются следующие константы перечисления ADO **аффектенум** :  
  
-   **адаффекткуррент** Влияет только на текущую запись.  
  
-   **адаффектграуп** Затрагивает только те записи, которые соответствуют текущему значению свойства **фильтра** . Для использования этого параметра свойству **Filter** должно быть присвоено значение **Филтерграупенум** или массив **закладок** .  
  
 В следующем коде показан пример указания **адаффектграуп** при вызове метода **Delete** . В этом примере добавляются некоторые записи в образец **набора записей** и обновляется база данных. Затем выполняется фильтрация **набора записей** с помощью перечислимой константы фильтра **адфилтераффектедрекордс** , которая оставляет только вновь добавленные записи, отображаемые в **наборе записей.** Наконец, он вызывает метод **Delete** и указывает, что все записи, которые соответствуют текущему значению свойства **Filter** (новые записи), должны быть удалены.  
  
```  
'BeginDeleteGroup  
    'add some bogus records  
    With objRs  
        For i = 0 To 8  
            .AddNew  
            .Fields("CompanyName") = "Shipper Number " & i + 1  
            .Fields("Phone") = "(425) 555-000" & (i + 1)  
            .Update  
        Next i  
  
        ' update  
        .UpdateBatch  
  
        'filter on newly added records  
        .Filter = adFilterAffectedRecords  
        Debug.Print "Deleting the " & .RecordCount & _  
                    " records you just added."  
  
        'delete the newly added bogus records  
        .Delete adAffectGroup  
        .Filter = adFilterNone  
        Debug.Print .RecordCount & " records remain."  
    End With  
'EndDeleteGroup  
```
