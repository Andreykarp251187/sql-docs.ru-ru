---
title: Проблемы проектирования безопасности ADO | Документация Майкрософт
ms.custom: ''
ms.date: 11/08/2018
ms.reviewer: ''
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- ADO, security
ms.assetid: 86b83a38-efdf-4831-a6d5-7e470d517d1c
author: MightyPen
ms.author: genemi
ms.openlocfilehash: f638f6e48dccccd91849f02c65331d9212f9bbb7
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2019
ms.locfileid: "67927037"
---
# <a name="ado-security-design-features"></a>Функции разработки безопасности ADO
В следующих разделах функции разработки безопасности в ActiveX Data Objects (ADO) 2.8 и более поздних версий. Эти изменения были внесены в ADO 2.8 для повышения безопасности. ADO 6.0, который включен в Windows DAC 6.0 в Windows Vista, является функциональным эквивалентом ADO 2.8, который был включен в компонентах MDAC 2.8 в Windows XP и Windows Server 2003. Этот раздел содержит сведения о том, как наилучшим образом защитить приложения в ADO 2.8 или более поздней.

> [!IMPORTANT]
>  Если вы обновляете приложение из более ранней версии ADO, рекомендуется проверить обновленное приложение на компьютере, не являющийся рабочим, перед развертыванием клиентов. Таким образом, вы можете убедитесь, что вам известно проблем с совместимостью перед развертыванием обновленное приложение.

## <a name="internet-explorer-file-access-scenarios"></a>Сценариев доступа к файлам для Internet Explorer
 Следующие функции последствия, как работает ADO 2.8 и более поздние версии, когда он используется в сценарий веб-страниц в Internet Explorer.

### <a name="revised-and-improved-security-warning-message-box-now-used-to-alert-users"></a>Предупреждающем сообщении для исправленной безопасности теперь используется для информирования пользователей
 Для ADO 2.7 и более ранних версий появится следующее предупреждение при попытке выполнения кода ADO от ненадежного поставщика сценария веб-страницы:

```console
This page accesses data on another domain. Do you want to allow this? To
avoid this message in Internet Explorer, you can add a secure Web site to
your Trusted Sites zone on the Security tab of the Internet Options dialog
box.
```

 Для ADO 2.8 и более поздних версий приведенное выше сообщение больше не отображается. Вместо этого в данном контексте появится следующее сообщение:

```console
This Website uses a data provider that may be unsafe. If you trust the
Website, click OK, otherwise click Cancel.
```

 Приведенное выше сообщение позволяет пользователю принять обоснованное решение, при этом знать последствия вариант:

-   Если пользователь доверяет сайт, нажав кнопку ОК позволит весь код safe диска (все методы ADO и свойства, за исключением доступного диска API, описанные далее в этом разделе) для запуска и выполнения в окне браузера.

-   Если пользователь не доверяет сайт, нажав кнопку "Отмена" блоков кода ADO для доступа к данным из запуске и выполнении в полном объеме.

### <a name="disk-accessible-code-limited-now-to-trusted-sites"></a>Диск доступен код теперь ограничены в список надежных сайтов
 В ADO 2.8, в частности ограничивать возможности ограниченный набор API-интерфейсы, которые может предоставить шанс для чтения или записи к файлам на локальном компьютере были внесены дополнительные изменения. Ниже приведены методы API, которые были дополнительные ограничения для безопасности при запуске Internet Explorer:

-   Для ADO **Stream** объект, если [LoadFromFile](../../ado/reference/ado-api/loadfromfile-method-ado.md) или [SaveToFile](../../ado/reference/ado-api/savetofile-method.md) используются методы.

-   Для ADO **записей** объекта, если параметр [Сохранить](../../ado/reference/ado-api/save-method.md) метод или [откройте](../../ado/reference/ado-api/open-method-ado-recordset.md) метода, например, когда либо **adCmdFile** параметр имеет значение или [поставщик Microsoft OLE DB сохраняемости (MSPersist)](../../ado/guide/appendixes/microsoft-ole-db-persistence-provider-ado-service-provider.md) используется.

 Для этих ограниченные наборы функций потенциально доступно для диска происходит следующее для ADO 2.8 и более поздние версии, при любой код, использующий эти методы в Internet Explorer.

-   Если сайт, который предоставляется код ранее была добавлена в список надежных узлов зоны, код выполняется в браузере и доступа к локальным файлам.

-   Если сайт не отображается в списке зоны надежных узлов, код будет заблокирован, и доступе к локальным файлам.

    > [!NOTE]
    >  В ADO 2.8 и более поздних версий пользователь не оповещения и не рекомендуется добавить сайты в список надежных сайтов зоны. Таким образом управление список надежных сайтов отвечает тех, кто осуществляет развертывание или поддержка приложений на основе веб-сайта, которым требуется доступ к локальной файловой системе.

### <a name="access-blocked-to-the-activecommand-property-on-recordset-objects"></a>Доступ к заблокирован в свойство ActiveCommand на объекта набора записей
 При работе в Internet Explorer, ADO 2.8 блокирует доступ к [ActiveCommand](../../ado/reference/ado-api/activecommand-property-ado.md) свойство для активного **записей** объекта и возвращает сообщение об ошибке. Эта ошибка возникает независимо от того, ли эта страница берется из веб-сайта, зарегистрированных в список надежных сайтов.

### <a name="changes-in-handling-for-ole-db-providers-and-integrated-security"></a>Изменения в обработке для поставщиков OLE DB и встроенной безопасности
 При рассмотрении ADO 2.7 и более ранних версий для потенциальных проблем безопасности и проблем, была обнаружена следующий сценарий:

 В некоторых случаях поставщики OLE DB, которые поддерживает встроенную безопасность [DBPROP_AUTH_INTEGRATED](https://msdn.microsoft.com/library/windows/desktop/ms712973.aspx) свойство потенциально может разрешить сценариев веб-страницы, чтобы повторно использовать объект ADO Connection для случайного подключения к другим серверам используя текущие учетные данные входа пользователей. Чтобы избежать этого, ADO 2.8 и более поздние версии обрабатывать поставщики OLE DB, в зависимости от того, как они выбрали для предоставления или не указано, для встроенной безопасности.

 Для веб-страниц, которые загружаются из узлов, перечисленных в списке зоны надежных узлов в следующей таблице приводится декомпозиция как ADO 2.8 и более поздних версий управляет соединений ADO в каждом случае.

|Параметры IE для проверки подлинности пользователей, вход в систему|Поставщик поддерживает «Integrated Security» и UID и PWD указано (SQLOLEDB)|Поставщик не поддерживает «Integrated Security» (Награда JOLT, MSDASQL, MSPersist)|Поставщик поддерживает «Integrated Security», и ему присваивается SSPI (указаны не UID и PWD)|
|------------------------------------------------|----------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|
|Автоматический вход с помощью текущего имени пользователя и пароля|Разрешить подключение|Разрешить подключение|Разрешить подключение|
|Запрашивает имя пользователя и пароль|Разрешить подключение|Сбой подключения|Сбой подключения|
|Автоматический вход только в зону интрасети|Разрешить подключение|Запрашивать у пользователя с предупреждением безопасности|Запрашивать у пользователя с предупреждением безопасности|
|Анонимный вход|Разрешить подключение|Сбой подключения|Сбой подключения|

 В случае, где отображается предупреждение о безопасности теперь в окне сообщения информирует пользователей:

```console
This Website is using your identity to access a data source. If you trust this Website, click OK, otherwise click Cancel.
```

 Приведенное выше сообщение позволяет пользователю принять более обоснованное решение и действуйте соответствующим образом.

> [!NOTE]
>  Для ненадежных узлов (то есть узлы, не перечисленные в списке зоны надежных узлов) Если поставщик не также является доверенным (как уже говорилось ранее в этом разделе), пользователь может видеть два предупреждения безопасности в строку, предупреждение о поставщике небезопасный и второе предупреждение Попытка использовать свою личность. Если пользователь нажимает кнопку ОК, чтобы первое предупреждение, выполняются параметров Internet Explorer и код ответа поведения, описанные в предыдущей таблице.

## <a name="controlling-whether-password-text-is-returned-in-ado-connection-strings"></a>Управление, возвращается ли текст пароля в строке соединения ADO
 При попытке получить значение [ConnectionString](../../ado/reference/ado-api/connectionstring-property-ado.md) свойство ADO **подключения** объекта, происходят следующие события:

1.  Если при открытом соединении, инициализации затем вызов к базовому поставщику OLE DB для получения строки подключения.

2.  В зависимости от настройки в поставщике OLE DB из [DBPROP_AUTH_PERSIST_SENSITIVE_AUTHINFO](https://msdn.microsoft.com/library/windows/desktop/ms714905.aspx) свойство, пароли включены вместе с другими данными строки подключения, которое возвращается.

 Например если динамические свойства соединения ADO **Persist Security Info** имеет значение **True**, сведения о пароле включается в строку подключения, возвращаемую. В противном случае, если базовый поставщик свойство равно **False** (например, с помощью поставщика SQLOLEDB), сведения о пароле опускается в возвращаемой строки подключения.

 При использовании сторонних (т. е сторонних) поставщиками OLE DB с кодом приложения ADO, могут проверять как **DBPROP_AUTH_PERSIST_SENSITIVE_AUTHINFO** свойство реализуется для определения ли включение сведения о пароле со строками соединения ADO разрешен.

## <a name="checking-for-non-file-devices-when-loading-and-saving-recordsets-or-streams"></a>Проверка для устройств, не являющимся файлами при загрузке и сохранении наборы записей или потоки
 Для ADO 2.7 и более ранних версий, файл операций ввода вывода например [откройте](../../ado/reference/ado-api/open-method-ado-recordset.md) и [Сохранить](../../ado/reference/ado-api/save-method.md) , которые использовались для чтения и записи, в некоторых случаях файловых данных делает возможным URL-адрес или имя файла для использования указанного отличных от дисковых на основе типа файла. Например LPT1, COM2, PRN. TXT, AUX может использоваться в качестве псевдонима для ввода вывода между принтеры и дополнительных устройств в системе с помощью определенных

 Для ADO 2.8 и более поздние версии эта функциональность была обновлена. Для открытия и сохранения **записей** и **Stream** объектов ADO теперь выполняет проверку типа файла, чтобы удостовериться в наличии фактический входной или выходной устройство, указанное в URL-адрес или имя файла.

> [!NOTE]
>  Проверка типа файла как описано в этом разделе применяется только для Windows 2000 и более поздних версий. Он не применяется в ситуациях, где выполняется ADO 2.8 или более поздней версии в более ранних версий Windows, таких как Windows 98.
