---
title: Поставщик Microsoft OLE DB удаленного взаимодействия (поставщик услуг ADO) | Документация Майкрософт
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 11/08/2018
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- OLE DB remoting provider [ADO]
- providers [ADO], OLE DB remoting provider
- remoting provider [ADO]
ms.assetid: a4360ed4-b70f-4734-9041-4025d033346b
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 29addb89a5713b32b98df374a673fff4d549d771
ms.sourcegitcommit: f7fced330b64d6616aeb8766747295807c92dd41
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62853449"
---
# <a name="microsoft-ole-db-remoting-provider-overview"></a>Общие сведения о поставщике Microsoft OLE DB удаленного взаимодействия
Поставщик Microsoft OLE DB удаленного взаимодействия позволяет локального пользователя на клиентском компьютере для вызова поставщиков данных на удаленном компьютере. Укажите параметры поставщика данных для удаленного компьютера, как это делается, если локальный пользователь на удаленном компьютере. Затем укажите параметры, используемые поставщиком удаленного взаимодействия для доступа к удаленной машине. Можно затем получить удаленный компьютер, как если бы вы были локального пользователя.

> [!IMPORTANT]
>  Начиная с Windows 8 и Windows Server 2012, серверные компоненты служб удаленных рабочих СТОЛОВ, больше не включаются в операционной системе Windows (см. в разделе Windows 8 и [настольная книга по совместимости Windows Server 2012](https://www.microsoft.com/download/details.aspx?id=27416) для получения дополнительных сведений). Клиентские компоненты служб удаленных рабочих СТОЛОВ будет поддерживаться в будущих версиях Windows. Избегайте использования этого компонента в новых разработках и запланируйте изменение существующих приложений, в которых он применяется. Приложения, использующие служб удаленных рабочих СТОЛОВ, следует перевести [WCF-сервиса данных](https://go.microsoft.com/fwlink/?LinkId=199565).

## <a name="provider-keyword"></a>Ключевое слово службы
 Чтобы вызвать поставщик OLE DB удаленного взаимодействия, укажите следующие слова и значение в строке подключения. (Обратите внимание, свободное место в имя поставщика.)

```vb
"Provider=MS Remote"
```

## <a name="additional-keywords"></a>Дополнительные ключевые слова
 Когда вызывается этот поставщик услуг, относятся следующие дополнительные ключевые слова.

|Ключевое слово|Описание|
|-------------|-----------------|
|**Источник данных**|Задает имя используемого удаленного источника данных. Он передается поставщику OLE DB удаленного взаимодействия для обработки.<br /><br /> Это ключевое слово эквивалентно [RDS. DataControl](../../../ado/reference/rds-api/datacontrol-object-rds.md) объекта [Connect](../../../ado/reference/rds-api/connect-property-rds.md) свойство.|

## <a name="dynamic-properties"></a>Динамические свойства
 Когда вызывается этот поставщик службы, добавляются следующие динамические свойства [подключения](../../../ado/reference/ado-api/connection-object-ado.md)объекта [свойства](../../../ado/reference/ado-api/properties-collection-ado.md) коллекции.

|Имя динамического свойства.|Описание|
|---------------------------|-----------------|
|**DFMode**|Указывает режим фабрики данных. Строка, указывающая нужную версию [DataFactory](../../../ado/reference/rds-api/datafactory-object-rdsserver.md) объект на сервере. Задать это свойство перед открытием подключения, чтобы запросить определенную версию **DataFactory**. Если запрошенная версия недоступен, будет сделана попытка использовать предыдущую версии. Если нет предыдущей версии, произойдет ошибка. Если **DFMode** меньше, чем доступная версия, произойдет ошибка. Это свойство доступно только для чтения, после подключения.<br /><br /> Может принимать одно из следующих допустимых строковых значений:<br /><br /> -«25»-версии 2.5 (по умолчанию)<br />-«21»-версии 2.1<br />-«20»-версии 2.0<br />-«15» — версии 1.5|
|**Свойства команды**|Указывает значения, которые будут добавляться в строку свойства команды (набор строк), отправляемые на сервер поставщиком удаленного мс. Значение по умолчанию для этой строки — vt_empty.|
|**Текущий DFMode**|Указывает количество Фактическая версия **DataFactory** на сервере. Проверьте это свойство, чтобы увидеть, если версия запросил в **DFMode** был учитывается свойство.<br /><br /> Может принимать одно из следующих значений допустимым длинное целое число:<br /><br /> -25-версии 2.5 (по умолчанию)<br />-21-версии 2.1<br />-20-версии 2.0<br />-15-версии 1.5<br /><br /> Добавление «DFMode = 20;» в строке подключения при использовании **MSRemote** поставщика может повысить производительность сервера, при обновлении данных. Этот параметр, **RDSServer.DataFactory** объект на сервере использует режим менее ресурсоемки. Тем не менее следующие функции недоступны в этой конфигурации:<br /><br /> -Применение параметризованных запросов.<br />— Получение информации параметра или столбца перед вызовом **Execute** метод.<br />— Задание **Transact обновлений** для **True**.<br />— Получение строки состояния.<br />— Вызов **Resync** метод.<br />-Обновление (явно или автоматически) через **Update Resync** свойство.<br />— Задание **команда** или **записей** свойства.<br />— Использование **adCmdTableDirect**.|
|**Обработчик**|Указывает имя программы Настройка на сервере (или обработчика), которое расширяет функциональность [RDSServer.DataFactory](../../../ado/reference/rds-api/datafactory-object-rdsserver.md)и все параметры, используемые обработчиком *,* разделенные запятыми () ","). Значение типа **String**.|
|**Время ожидания для Интернета**|Указывает максимальное число миллисекунд ожидания для запроса и с сервера. (По умолчанию — 5 минут).|
|**Удаленный поставщик**|Указывает имя поставщика данных для использования на удаленном сервере.|
|**Удаленный сервер**|Указывает имя и обмен данными протоколом для использования в данном соединении. Это свойство эквивалентно [RDS. DataContro](../../../ado/reference/rds-api/datacontrol-object-rds.md) объект [Server](../../../ado/reference/rds-api/server-property-rds.md) свойство.|
|**Transact обновлений**|Если задано значение **True**, это значение указывает, что при [UpdateBatch](../../../ado/reference/ado-api/updatebatch-method.md) выполняется на сервере, он будет выполняться внутри транзакции. Значение по умолчанию для этого логического динамические свойства **False**.|

 Можно также установить для записи динамические свойства, указав их имена в качестве ключевых слов в строке подключения. Например, задать **время ожидания для Интернета** динамическое свойство пять секунд, указав:

```vb
Dim cn as New ADODB.Connection
cn.Open "Provider=MS Remote;Internet Timeout=5000"
```

 Можно также задать или получить динамического свойства, указав его имя в качестве индекса в **свойства** свойство. Приведенный ниже показано, как получить и распечатать текущее значение **время ожидания для Интернета** динамического свойства, а затем установите новое значение:

```vb
Debug.Print cn.Properties("Internet Timeout")
cn.Properties("Internet Timeout") = 5000
```

## <a name="remarks"></a>Примечания
 В ADO 2.0, поставщик OLE DB удаленного взаимодействия может быть указан только в *ActiveConnection* параметр [записей](../../../ado/reference/ado-api/recordset-object-ado.md) объект **откройте** метод. Начиная с ADO 2.1, поставщик может также быть указан в *ConnectionString* параметр [подключения](../../../ado/reference/ado-api/connection-object-ado.md) объект **откройте** метод.

 Эквивалент **RDS. DataControl** объект [SQL](../../../ado/reference/rds-api/sql-property.md) свойство недоступно. [Записей](../../../ado/reference/ado-api/recordset-object-ado.md) объект **откройте** метод *источника* используется аргумент.

 **Примечание** указание «...; Удаленный поставщик = удаленное MS;...» Создать сценарий четыре уровня. Сценарии помимо трех уровней не были протестированы и не должно возникнуть необходимости.

## <a name="example"></a>Пример
 Этот пример выполняет запрос на **авторов** таблицы **Pubs** базы данных на сервере с именем *сервер*. Имена удаленного источника данных и удаленного сервера, приведены в [откройте](../../../ado/reference/ado-api/open-method-ado-connection.md) метод[подключения](../../../ado/reference/ado-api/connection-object-ado.md) объекта и SQL-запрос указывается в[откройте](../../../ado/reference/ado-api/open-method-ado-recordset.md) метод [Записей](../../../ado/reference/ado-api/recordset-object-ado.md) объекта. Объект **записей** объект возвращается, редактировать и используется для обновления источника данных.

```vb
Dim rs as New ADODB.Recordset
Dim cn as New ADODB.Connection
cn.Open  "Provider=MS Remote;Data Source=pubs;" & _
         "Remote Server=https://YourServer"
rs.Open "SELECT * FROM authors", cn
...                'Edit the recordset
rs.UpdateBatch     'Equivalent of RDS SubmitChanges
...
```

## <a name="see-also"></a>См. также
 [Обзор удаленного поставщика OLE DB](https://msdn.microsoft.com/4083b72f-68c4-4252-b366-abb70db5ca2b)
